dist: trusty
sudo: false

language: node_js
node_js:
    - '10'

addons:
    apt:
        sources:
            - google-chrome
        packages:
            - google-chrome-stable

cache:
    directories:
        - ./node_modules

install:
    - npm install

stages:
    - test
    - name: deploy # generally, only deploy if we are on 'master'
      if: branch = master

jobs:
    include:
        - stage: test
          name: 'Unit Tests'
          script:
              # run test script
              - yarn run test:ci
          after_success:
              # report code coverage
              - bash <(curl -s https://codecov.io/bash)
        - stage: deploy
          name: 'Deploy to gh-pages'
          script:
              # run deploy script (only on master, see stages)
              - yarn run deploy:ci
