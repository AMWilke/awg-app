!function(e){var t,r,n="0.5.0",i="hasOwnProperty",o=/[\.\/]/,s=/\s*,\s*/,a=function(e,t){return e-t},l={n:{}},u=function(){for(var e=0,t=this.length;t>e;e++)if(void 0!==this[e])return this[e]},c=function(){for(var e=this.length;--e;)if(void 0!==this[e])return this[e]},f=Object.prototype.toString,h=String,p=Array.isArray||function(e){return e instanceof Array||"[object Array]"==f.call(e)};eve=function(e,n){var i,o=r,s=Array.prototype.slice.call(arguments,2),l=eve.listeners(e),f=0,h=[],p={},d=[],g=t;d.firstDefined=u,d.lastDefined=c,t=e,r=0;for(var v=0,y=l.length;y>v;v++)"zIndex"in l[v]&&(h.push(l[v].zIndex),l[v].zIndex<0&&(p[l[v].zIndex]=l[v]));for(h.sort(a);h[f]<0;)if(i=p[h[f++]],d.push(i.apply(n,s)),r)return r=o,d;for(v=0;y>v;v++)if("zIndex"in(i=l[v]))if(i.zIndex==h[f]){if(d.push(i.apply(n,s)),r)break;do{if((i=p[h[++f]])&&d.push(i.apply(n,s)),r)break}while(i)}else p[i.zIndex]=i;else if(d.push(i.apply(n,s)),r)break;return r=o,t=g,d},eve._events=l,eve.listeners=function(e){var t,r,n,i,s,a,u,c,f=p(e)?e:e.split(o),h=l,d=[h],g=[];for(i=0,s=f.length;s>i;i++){for(c=[],a=0,u=d.length;u>a;a++)for(r=[(h=d[a].n)[f[i]],h["*"]],n=2;n--;)(t=r[n])&&(c.push(t),g=g.concat(t.f||[]));d=c}return g},eve.separator=function(e){e?(e="["+(e=h(e).replace(/(?=[\.\^\]\[\-])/g,"\\"))+"]",o=new RegExp(e)):o=/[\.\/]/},eve.on=function(e,t){if("function"!=typeof t)return function(){};for(var r=p(e)?p(e[0])?e:[e]:h(e).split(s),n=0,i=r.length;i>n;n++)!function(e){for(var r,n=p(e)?e:h(e).split(o),i=l,s=0,a=n.length;a>s;s++)i=(i=i.n).hasOwnProperty(n[s])&&i[n[s]]||(i[n[s]]={n:{}});for(i.f=i.f||[],s=0,a=i.f.length;a>s;s++)if(i.f[s]==t){r=!0;break}!r&&i.f.push(t)}(r[n]);return function(e){+e==+e&&(t.zIndex=+e)}},eve.f=function(e){var t=[].slice.call(arguments,1);return function(){eve.apply(null,[e,null].concat(t).concat([].slice.call(arguments,0)))}},eve.stop=function(){r=1},eve.nt=function(e){var r=p(t)?t.join("."):t;return e?new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)").test(r):r},eve.nts=function(){return p(t)?t:t.split(o)},eve.off=eve.unbind=function(e,t){if(e){var r=p(e)?p(e[0])?e:[e]:h(e).split(s);if(r.length>1)for(var n=0,a=r.length;a>n;n++)eve.off(r[n],t);else{r=p(e)?e:h(e).split(o);var u,c,f,d,g,v=[l],y=[];for(n=0,a=r.length;a>n;n++)for(d=0;d<v.length;d+=f.length-2){if(f=[d,1],u=v[d].n,"*"!=r[n])u[r[n]]&&(f.push(u[r[n]]),y.unshift({n:u,name:r[n]}));else for(c in u)u[i](c)&&(f.push(u[c]),y.unshift({n:u,name:c}));v.splice.apply(v,f)}for(n=0,a=v.length;a>n;n++)for(u=v[n];u.n;){if(t){if(u.f){for(d=0,g=u.f.length;g>d;d++)if(u.f[d]==t){u.f.splice(d,1);break}!u.f.length&&delete u.f}for(c in u.n)if(u.n[i](c)&&u.n[c].f){var m=u.n[c].f;for(d=0,g=m.length;g>d;d++)if(m[d]==t){m.splice(d,1);break}!m.length&&delete u.n[c].f}}else for(c in delete u.f,u.n)u.n[i](c)&&u.n[c].f&&delete u.n[c].f;u=u.n}e:for(n=0,a=y.length;a>n;n++){for(c in(u=y[n]).n[u.name].f)continue e;for(c in u.n[u.name].n)continue e;delete u.n[u.name]}}}else eve._events=l={n:{}}},eve.once=function(e,t){var r=function(){return eve.off(e,r),t.apply(this,arguments)};return eve.on(e,r)},eve.version=n,eve.toString=function(){return"You are running Eve "+n},"undefined"!=typeof module&&module.exports?module.exports=eve:"function"==typeof define&&define.amd?define("eve",[],(function(){return eve})):e.eve=eve}(this),function(e,t){if("function"==typeof define&&define.amd)define(["eve"],(function(r){return t(e,r)}));else if("undefined"!=typeof exports){var r=require("eve");module.exports=t(e,r)}else t(e,e.eve)}(window||this,(function(e,t){var r=function(t){var r,n={},i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,16,(new Date).getTime()),!0},o=Array.isArray||function(e){return e instanceof Array||"[object Array]"==Object.prototype.toString.call(e)},s=0,a="M"+(+new Date).toString(36),l=function(){return a+(s++).toString(36)},u=Date.now||function(){return+new Date},c=function(e){var t=this;if(null==e)return t.s;var r=t.s-e;t.b+=t.dur*r,t.B+=t.dur*r,t.s=e},f=function(e){return null==e?this.spd:void(this.spd=e)},h=function(e){var t=this;return null==e?t.dur:(t.s=t.s*e/t.dur,void(t.dur=e))},p=function(){var e=this;delete n[e.id],e.update(),t("mina.stop."+e.id,e)},d=function(){var e=this;e.pdif||(delete n[e.id],e.update(),e.pdif=e.get()-e.b)},g=function(){var e=this;e.pdif&&(e.b=e.get()-e.pdif,delete e.pdif,n[e.id]=e,y())},v=function(){var e,t=this;if(o(t.start)){e=[];for(var r=0,n=t.start.length;n>r;r++)e[r]=+t.start[r]+(t.end[r]-t.start[r])*t.easing(t.s)}else e=+t.start+(t.end-t.start)*t.easing(t.s);t.set(e)},y=function(e){if(e){var o=0;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s],l=a.get();o++,a.s=(l-a.b)/(a.dur/a.spd),a.s>=1&&(delete n[s],a.s=1,o--,function(e){setTimeout((function(){t("mina.finish."+e.id,e)}))}(a)),a.update()}r=!!o&&i(y)}else r||(r=i(y))},m=function(e,t,r,i,o,s,a){var u={id:l(),start:e,end:t,b:r,s:0,dur:i-r,spd:1,get:o,set:s,easing:a||m.linear,status:c,speed:f,duration:h,stop:p,pause:d,resume:g,update:v};n[u.id]=u;var b,x=0;for(b in n)if(n.hasOwnProperty(b)&&2==++x)break;return 1==x&&y(),u};return m.time=u,m.getById=function(e){return n[e]||null},m.linear=function(e){return e},m.easeout=function(e){return Math.pow(e,1.7)},m.easein=function(e){return Math.pow(e,.48)},m.easeinout=function(e){if(1==e)return 1;if(0==e)return 0;var t=.48-e/1.04,r=Math.sqrt(.1734+t*t),n=r-t,i=-r-t,o=Math.pow(Math.abs(n),1/3)*(0>n?-1:1)+Math.pow(Math.abs(i),1/3)*(0>i?-1:1)+.5;return 3*(1-o)*o*o+o*o*o},m.backin=function(e){if(1==e)return 1;var t=1.70158;return e*e*((t+1)*e-t)},m.backout=function(e){if(0==e)return 0;var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},m.elastic=function(e){return e==!!e?e:Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1},m.bounce=function(e){var t,r=7.5625,n=2.75;return 1/n>e?t=r*e*e:2/n>e?t=r*(e-=1.5/n)*e+.75:2.5/n>e?t=r*(e-=2.25/n)*e+.9375:t=r*(e-=2.625/n)*e+.984375,t},e.mina=m,m}(void 0===t?function(){}:t),n=function(e){function r(e,t){if(e){if(e.nodeType)return d(e);if(i(e,"array")&&r.set)return r.set.apply(r,e);if(e instanceof c)return e;if(null==t)return d(e=y.doc.querySelector(String(e)))}return new p(e=null==e?"100%":e,t=null==t?"100%":t)}function n(e,t){if(t){if("#text"==e&&(e=y.doc.createTextNode(t.text||t["#text"]||"")),"#comment"==e&&(e=y.doc.createComment(t.text||t["#text"]||"")),"string"==typeof e&&(e=n(e)),"string"==typeof t)return 1==e.nodeType?"xlink:"==t.substring(0,6)?e.getAttributeNS(B,t.substring(6)):"xml:"==t.substring(0,4)?e.getAttributeNS(P,t.substring(4)):e.getAttribute(t):"text"==t?e.nodeValue:null;if(1==e.nodeType){for(var r in t)if(t[m](r)){var i=b(t[r]);i?"xlink:"==r.substring(0,6)?e.setAttributeNS(B,r.substring(6),i):"xml:"==r.substring(0,4)?e.setAttributeNS(P,r.substring(4),i):e.setAttribute(r,i):e.removeAttribute(r)}}else"text"in t&&(e.nodeValue=t.text)}else e=y.doc.createElementNS(P,e);return e}function i(e,t){return"finite"==(t=b.prototype.toLowerCase.call(t))?isFinite(e):!("array"!=t||!(e instanceof Array||Array.isArray&&Array.isArray(e)))||("null"==t&&null===e||t==typeof e&&null!==e||"object"==t&&e===Object(e)||E.call(e).slice(8,-1).toLowerCase()==t)}function o(e,t){for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return e.push(e.splice(r,1)[0])}function s(e,t,r){return function n(){var i=Array.prototype.slice.call(arguments,0),s=i.join("␀"),a=n.cache=n.cache||{},l=n.count=n.count||[];return a[m](s)?(o(l,s),r?r(a[s]):a[s]):(l.length>=1e3&&delete a[l.shift()],l.push(s),a[s]=e.apply(t,i),r?r(a[s]):a[s])}}function a(e){return e%360*_/180}function l(e){return e.node.ownerSVGElement&&d(e.node.ownerSVGElement)||r.select("svg")}function u(e){i(e,"array")||(e=Array.prototype.slice.call(arguments,0));for(var t=0,r=0,n=this.node;this[t];)delete this[t++];for(t=0;t<e.length;t++)"set"==e[t].type?e[t].forEach((function(e){n.appendChild(e.node)})):n.appendChild(e[t].node);var o=n.childNodes;for(t=0;t<o.length;t++)this[r++]=d(o[t]);return this}function c(e){if(e.snap in Q)return Q[e.snap];var t;try{t=e.ownerSVGElement}catch(r){}this.node=e,t&&(this.paper=new p(t)),this.type=e.tagName||e.nodeName;var n=this.id=R(this);if(this.anims={},this._={transform:[]},e.snap=n,Q[n]=this,"g"==this.type&&(this.add=u),this.type in{g:1,mask:1,pattern:1,symbol:1})for(var i in p.prototype)p.prototype[m](i)&&(this[i]=p.prototype[i])}function f(e){this.node=e}function h(e,t){var r=n(e);return t.appendChild(r),d(r)}function p(e,t){var r,i,o,s=p.prototype;if(e&&e.tagName&&"svg"==e.tagName.toLowerCase()){if(e.snap in Q)return Q[e.snap];var a=e.ownerDocument;for(var l in r=new c(e),i=e.getElementsByTagName("desc")[0],o=e.getElementsByTagName("defs")[0],i||((i=n("desc")).appendChild(a.createTextNode("Created with Snap")),r.node.appendChild(i)),o||(o=n("defs"),r.node.appendChild(o)),r.defs=o,s)s[m](l)&&(r[l]=s[l]);r.paper=r.root=r}else n((r=h("svg",y.doc.body)).node,{height:t,version:1.1,width:e,xmlns:P});return r}function d(e){return e?e instanceof c||e instanceof f?e:e.tagName&&"svg"==e.tagName.toLowerCase()?new p(e):e.tagName&&"object"==e.tagName.toLowerCase()&&"image/svg+xml"==e.type?new p(e.contentDocument.getElementsByTagName("svg")[0]):new c(e):e}function v(e,t){for(var r=0,n=e.length;n>r;r++){var i={type:e[r].type,attr:e[r].attr()},o=e[r].children();t.push(i),o.length&&v(o,i.childNodes=[])}}r.version="0.5.1",r.toString=function(){return"Snap v"+this.version},r._={};var y={win:e.window,doc:e.window.document};r._.glob=y;var m="hasOwnProperty",b=String,x=parseFloat,w=parseInt,k=Math,C=k.max,S=k.min,F=k.abs,_=(k.pow,k.PI),A=(k.round,""),E=Object.prototype.toString,L=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,T=(r._.separator=/[,\s]+/,/[\s]*,[\s]*/),N={hs:1,rg:1},M=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,I=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,j=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\s]*,?[\s]*/gi,O=0,D="S"+(+new Date).toString(36),R=function(e){return(e&&e.type?e.type:A)+D+(O++).toString(36)},B="http://www.w3.org/1999/xlink",P="http://www.w3.org/2000/svg",Q={};r.url=function(e){return"url('#"+e+"')"},r._.$=n,r._.id=R,r.format=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,r=function(e,r,n){var i=n;return r.replace(t,(function(e,t,r,n,o){t=t||n,i&&(t in i&&(i=i[t]),"function"==typeof i&&o&&(i=i()))})),i=(null==i||i==n?e:i)+""};return function(t,n){return b(t).replace(e,(function(e,t){return r(e,t,n)}))}}(),r._.clone=function e(t){if("function"==typeof t||Object(t)!==t)return t;var r=new t.constructor;for(var n in t)t[m](n)&&(r[n]=e(t[n]));return r},r._.cacher=s,r.rad=a,r.deg=function(e){return 180*e/_%360},r.sin=function(e){return k.sin(r.rad(e))},r.tan=function(e){return k.tan(r.rad(e))},r.cos=function(e){return k.cos(r.rad(e))},r.asin=function(e){return r.deg(k.asin(e))},r.acos=function(e){return r.deg(k.acos(e))},r.atan=function(e){return r.deg(k.atan(e))},r.atan2=function(e){return r.deg(k.atan2(e))},r.angle=function e(t,r,n,i,o,s){if(null==o){var a=t-n,l=r-i;return a||l?(180+180*k.atan2(-l,-a)/_+360)%360:0}return e(t,r,o,s)-e(n,i,o,s)},r.len=function(e,t,n,i){return Math.sqrt(r.len2(e,t,n,i))},r.len2=function(e,t,r,n){return(e-r)*(e-r)+(t-n)*(t-n)},r.closestPoint=function(e,t,r){function n(e){var n=e.x-t,i=e.y-r;return n*n+i*i}for(var i,o,s,a,l=e.node,u=l.getTotalLength(),c=u/l.pathSegList.numberOfItems*.125,f=1/0,h=0;u>=h;h+=c)(a=n(s=l.getPointAtLength(h)))<f&&(i=s,o=h,f=a);for(c*=.5;c>.5;){var p,d,g,v,y,m;(g=o-c)>=0&&(y=n(p=l.getPointAtLength(g)))<f?(i=p,o=g,f=y):(v=o+c)<=u&&(m=n(d=l.getPointAtLength(v)))<f?(i=d,o=v,f=m):c*=.5}return{x:i.x,y:i.y,length:o,distance:Math.sqrt(f)}},r.is=i,r.snapTo=function(e,t,r){if(r=i(r,"finite")?r:10,i(e,"array")){for(var n=e.length;n--;)if(F(e[n]-t)<=r)return e[n]}else{var o=t%(e=+e);if(r>o)return t-o;if(o>e-r)return t-o+e}return t},r.getRGB=s((function(e){if(!e||(e=b(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:q};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none",toString:q};if(!(N[m](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=U(e)),!e)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:q};var t,n,o,s,a,l,u=e.match(L);return u?(u[2]&&(o=w(u[2].substring(5),16),n=w(u[2].substring(3,5),16),t=w(u[2].substring(1,3),16)),u[3]&&(o=w((a=u[3].charAt(3))+a,16),n=w((a=u[3].charAt(2))+a,16),t=w((a=u[3].charAt(1))+a,16)),u[4]&&(l=u[4].split(T),t=x(l[0]),"%"==l[0].slice(-1)&&(t*=2.55),n=x(l[1]),"%"==l[1].slice(-1)&&(n*=2.55),o=x(l[2]),"%"==l[2].slice(-1)&&(o*=2.55),"rgba"==u[1].toLowerCase().slice(0,4)&&(s=x(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100)),u[5]?(l=u[5].split(T),t=x(l[0]),"%"==l[0].slice(-1)&&(t/=100),n=x(l[1]),"%"==l[1].slice(-1)&&(n/=100),o=x(l[2]),"%"==l[2].slice(-1)&&(o/=100),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(t/=360),"hsba"==u[1].toLowerCase().slice(0,4)&&(s=x(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100),r.hsb2rgb(t,n,o,s)):u[6]?(l=u[6].split(T),t=x(l[0]),"%"==l[0].slice(-1)&&(t/=100),n=x(l[1]),"%"==l[1].slice(-1)&&(n/=100),o=x(l[2]),"%"==l[2].slice(-1)&&(o/=100),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(t/=360),"hsla"==u[1].toLowerCase().slice(0,4)&&(s=x(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100),r.hsl2rgb(t,n,o,s)):(t=S(k.round(t),255),n=S(k.round(n),255),o=S(k.round(o),255),s=S(C(s,0),1),(u={r:t,g:n,b:o,toString:q}).hex="#"+(16777216|o|n<<8|t<<16).toString(16).slice(1),u.opacity=i(s,"finite")?s:1,u)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:q}}),r),r.hsb=s((function(e,t,n){return r.hsb2rgb(e,t,n).hex})),r.hsl=s((function(e,t,n){return r.hsl2rgb(e,t,n).hex})),r.rgb=s((function(e,t,r,n){if(i(n,"finite")){var o=k.round;return"rgba("+[o(e),o(t),o(r),+n.toFixed(2)]+")"}return"#"+(16777216|r|t<<8|e<<16).toString(16).slice(1)}));var U=function(e){var t=y.doc.getElementsByTagName("head")[0]||y.doc.getElementsByTagName("svg")[0],r="rgb(255, 0, 0)";return(U=s((function(e){if("red"==e.toLowerCase())return r;t.style.color=r,t.style.color=e;var n=y.doc.defaultView.getComputedStyle(t,A).getPropertyValue("color");return n==r?null:n})))(e)},G=function(){return"hsb("+[this.h,this.s,this.b]+")"},z=function(){return"hsl("+[this.h,this.s,this.l]+")"},q=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},X=function(e,t,n){if(null==t&&i(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(n=e.b,t=e.g,e=e.r),null==t&&i(e,string)){var o=r.getRGB(e);e=o.r,t=o.g,n=o.b}return(e>1||t>1||n>1)&&(e/=255,t/=255,n/=255),[e,t,n]},H=function(e,t,n,o){var s={r:e=k.round(255*e),g:t=k.round(255*t),b:n=k.round(255*n),opacity:i(o,"finite")?o:1,hex:r.rgb(e,t,n),toString:q};return i(o,"finite")&&(s.opacity=o),s};r.color=function(e){var t;return i(e,"object")&&"h"in e&&"s"in e&&"b"in e?(t=r.hsb2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.opacity=1,e.hex=t.hex):i(e,"object")&&"h"in e&&"s"in e&&"l"in e?(t=r.hsl2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.opacity=1,e.hex=t.hex):(i(e,"string")&&(e=r.getRGB(e)),i(e,"object")&&"r"in e&&"g"in e&&"b"in e&&!("error"in e)?(t=r.rgb2hsl(e),e.h=t.h,e.s=t.s,e.l=t.l,t=r.rgb2hsb(e),e.v=t.b):((e={hex:"none"}).r=e.g=e.b=e.h=e.s=e.v=e.l=-1,e.error=1)),e.toString=q,e},r.hsb2rgb=function(e,t,r,n){var o,s,a,l,u;return i(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(r=e.b,t=e.s,n=e.o,e=e.h),o=s=a=r-(u=r*t),o+=[u,l=u*(1-F((e=(e*=360)%360/60)%2-1)),0,0,l,u][e=~~e],s+=[l,u,u,l,0,0][e],a+=[0,0,l,u,u,l][e],H(o,s,a,n)},r.hsl2rgb=function(e,t,r,n){var o,s,a,l,u;return i(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(r=e.l,t=e.s,e=e.h),(e>1||t>1||r>1)&&(e/=360,t/=100,r/=100),o=s=a=r-(u=2*t*(.5>r?r:1-r))/2,o+=[u,l=u*(1-F((e=(e*=360)%360/60)%2-1)),0,0,l,u][e=~~e],s+=[l,u,u,l,0,0][e],a+=[0,0,l,u,u,l][e],H(o,s,a,n)},r.rgb2hsb=function(e,t,r){var n,i;return e=(r=X(e,t,r))[0],t=r[1],r=r[2],{h:((0==(i=(n=C(e,t,r))-S(e,t,r))?null:n==e?(t-r)/i:n==t?(r-e)/i+2:(e-t)/i+4)+360)%6*60/360,s:0==i?0:i/n,b:n,toString:G}},r.rgb2hsl=function(e,t,r){var n,i,o,s;return e=(r=X(e,t,r))[0],t=r[1],r=r[2],n=((i=C(e,t,r))+(o=S(e,t,r)))/2,{h:((0==(s=i-o)?null:i==e?(t-r)/s:i==t?(r-e)/s+2:(e-t)/s+4)+360)%6*60/360,s:0==s?0:.5>n?s/(2*n):s/(2-2*n),l:n,toString:z}},r.parsePathString=function(e){if(!e)return null;var t=r.path(e);if(t.arr)return r.path.clone(t.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},o=[];return i(e,"array")&&i(e[0],"array")&&(o=r.path.clone(e)),o.length||b(e).replace(M,(function(e,t,r){var i=[],s=t.toLowerCase();if(r.replace(j,(function(e,t){t&&i.push(+t)})),"m"==s&&i.length>2&&(o.push([t].concat(i.splice(0,2))),s="l",t="m"==t?"l":"L"),"o"==s&&1==i.length&&o.push([t,i[0]]),"r"==s)o.push([t].concat(i));else for(;i.length>=n[s]&&(o.push([t].concat(i.splice(0,n[s]))),n[s]););})),o.toString=r.path.toString,t.arr=r.path.clone(o),o};var W=r.parseTransformString=function(e){if(!e)return null;var t=[];return i(e,"array")&&i(e[0],"array")&&(t=r.path.clone(e)),t.length||b(e).replace(I,(function(e,r,n){var i=[];r.toLowerCase(),n.replace(j,(function(e,t){t&&i.push(+t)})),t.push([r].concat(i))})),t.toString=r.path.toString,t};r._.svgTransform2string=function(e){var t=[];return e=e.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,(function(e,r,n){return n=n.split(/\s*,\s*|\s+/),"rotate"==r&&1==n.length&&n.push(0,0),"scale"==r&&(n.length>2?n=n.slice(0,2):2==n.length&&n.push(0,0),1==n.length&&n.push(n[0],0,0)),"skewX"==r?t.push(["m",1,0,k.tan(a(n[0])),1,0,0]):"skewY"==r?t.push(["m",1,k.tan(a(n[0])),0,1,0,0]):t.push([r.charAt(0)].concat(n)),e})),t},r._.rgTransform=/^[a-z][\s]*-?\.?\d/i,r._.transform2matrix=function(e,t){var n=W(e),i=new r.Matrix;if(n)for(var o=0,s=n.length;s>o;o++){var a,l,u,c,f,h=n[o],p=h.length,d=b(h[0]).toLowerCase(),g=h[0]!=d,v=g?i.invert():0;"t"==d&&2==p?i.translate(h[1],0):"t"==d&&3==p?g?(a=v.x(0,0),l=v.y(0,0),u=v.x(h[1],h[2]),c=v.y(h[1],h[2]),i.translate(u-a,c-l)):i.translate(h[1],h[2]):"r"==d?2==p?(f=f||t,i.rotate(h[1],f.x+f.width/2,f.y+f.height/2)):4==p&&(g?(u=v.x(h[2],h[3]),c=v.y(h[2],h[3]),i.rotate(h[1],u,c)):i.rotate(h[1],h[2],h[3])):"s"==d?2==p||3==p?(f=f||t,i.scale(h[1],h[p-1],f.x+f.width/2,f.y+f.height/2)):4==p?g?(u=v.x(h[2],h[3]),c=v.y(h[2],h[3]),i.scale(h[1],h[1],u,c)):i.scale(h[1],h[1],h[2],h[3]):5==p&&(g?(u=v.x(h[3],h[4]),c=v.y(h[3],h[4]),i.scale(h[1],h[2],u,c)):i.scale(h[1],h[2],h[3],h[4])):"m"==d&&7==p&&i.add(h[1],h[2],h[3],h[4],h[5],h[6])}return i},r._unit2px=function(e,t,r){function i(e){if(null==e)return A;if(e==+e)return e;n(c,{width:e});try{return c.getBBox().width}catch(t){return 0}}function o(e){if(null==e)return A;if(e==+e)return e;n(c,{height:e});try{return c.getBBox().height}catch(t){return 0}}function s(n,i){null==t?u[n]=i(e.attr(n)||0):n==t&&(u=i(null==r?e.attr(n)||0:r))}var a=l(e).node,u={},c=a.querySelector(".svg---mgr");switch(c||(c=n("rect"),n(c,{x:-9e9,y:-9e9,width:10,height:10,class:"svg---mgr",fill:"none"}),a.appendChild(c)),e.type){case"rect":s("rx",i),s("ry",o);case"image":s("width",i),s("height",o);case"text":s("x",i),s("y",o);break;case"circle":s("cx",i),s("cy",o),s("r",i);break;case"ellipse":s("cx",i),s("cy",o),s("rx",i),s("ry",o);break;case"line":s("x1",i),s("x2",i),s("y1",o),s("y2",o);break;case"marker":s("refX",i),s("markerWidth",i),s("refY",o),s("markerHeight",o);break;case"radialGradient":s("fx",i),s("fy",o);break;case"tspan":s("dx",i),s("dy",o);break;default:s(t,i)}return a.removeChild(c),u},y.doc.contains||y.doc.compareDocumentPosition,r._.getSomeDefs=function(e){var t=e.node.ownerSVGElement&&d(e.node.ownerSVGElement)||e.node.parentNode&&d(e.node.parentNode)||r.select("svg")||r(0,0),n=t.select("defs"),i=null!=n&&n.node;return i||(i=h("defs",t.node).node),i},r._.getSomeSVG=l,r.select=function(e){return e=b(e).replace(/([^\\]):/g,"$1\\:"),d(y.doc.querySelector(e))},r.selectAll=function(e){for(var t=y.doc.querySelectorAll(e),n=(r.set||Array)(),i=0;i<t.length;i++)n.push(d(t[i]));return n},setInterval((function(){for(var e in Q)if(Q[m](e)){var t=Q[e],r=t.node;("svg"!=t.type&&!r.ownerSVGElement||"svg"==t.type&&(!r.parentNode||"ownerSVGElement"in r.parentNode&&!r.ownerSVGElement))&&delete Q[e]}}),1e4),c.prototype.attr=function(e,r){var n=this,o=n.node;if(!e){if(1!=o.nodeType)return{text:o.nodeValue};for(var s=o.attributes,a={},l=0,u=s.length;u>l;l++)a[s[l].nodeName]=s[l].nodeValue;return a}if(i(e,"string")){if(!(arguments.length>1))return t("snap.util.getattr."+e,n).firstDefined();var c={};c[e]=r,e=c}for(var f in e)e[m](f)&&t("snap.util.attr."+f,n,e[f]);return n},r.parse=function(e){var t=y.doc.createDocumentFragment(),r=!0,n=y.doc.createElement("div");if((e=b(e)).match(/^\s*<\s*svg(?:\s|>)/)||(e="<svg>"+e+"</svg>",r=!1),n.innerHTML=e,e=n.getElementsByTagName("svg")[0])if(r)t=e;else for(;e.firstChild;)t.appendChild(e.firstChild);return new f(t)},r.fragment=function(){for(var e=Array.prototype.slice.call(arguments,0),t=y.doc.createDocumentFragment(),n=0,i=e.length;i>n;n++){var o=e[n];o.node&&o.node.nodeType&&t.appendChild(o.node),o.nodeType&&t.appendChild(o),"string"==typeof o&&t.appendChild(r.parse(o).node)}return new f(t)},r._.make=h,r._.wrap=d,p.prototype.el=function(e,t){var r=h(e,this.node);return t&&r.attr(t),r},c.prototype.children=function(){for(var e=[],t=this.node.childNodes,n=0,i=t.length;i>n;n++)e[n]=r(t[n]);return e},c.prototype.toJSON=function(){var e=[];return v([this],e),e[0]},t.on("snap.util.getattr",(function(){var e=t.nt(),r=(e=e.substring(e.lastIndexOf(".")+1)).replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()}));return V[m](r)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(r):n(this.node,e)}));var V={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};t.on("snap.util.attr",(function(e){var r=t.nt(),i={};i[r=r.substring(r.lastIndexOf(".")+1)]=e;var o=r.replace(/-(\w)/gi,(function(e,t){return t.toUpperCase()})),s=r.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()}));V[m](s)?this.node.style[o]=null==e?A:e:n(this.node,i)})),p.prototype,r.ajax=function(e,r,n,o){var s=new XMLHttpRequest,a=R();if(s){if(i(r,"function"))o=n,n=r,r=null;else if(i(r,"object")){var l=[];for(var u in r)r.hasOwnProperty(u)&&l.push(encodeURIComponent(u)+"="+encodeURIComponent(r[u]));r=l.join("&")}return s.open(r?"POST":"GET",e,!0),r&&(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),n&&(t.once("snap.ajax."+a+".0",n),t.once("snap.ajax."+a+".200",n),t.once("snap.ajax."+a+".304",n)),s.onreadystatechange=function(){4==s.readyState&&t("snap.ajax."+a+"."+s.status,o,s)},4==s.readyState||s.send(r),s}},r.load=function(e,t,n){r.ajax(e,(function(e){var i=r.parse(e.responseText);n?t.call(n,i):t(i)}))};var J=function(e){var t=e.getBoundingClientRect(),r=e.ownerDocument,n=r.body,i=r.documentElement,o=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0;return{y:t.top+(g.win.pageYOffset||i.scrollTop||n.scrollTop)-o,x:t.left+(g.win.pageXOffset||i.scrollLeft||n.scrollLeft)-s}};return r.getElementByPoint=function(e,t){var r=(this.canvas,y.doc.elementFromPoint(e,t));if(y.win.opera&&"svg"==r.tagName){var n=J(r),i=r.createSVGRect();i.x=e-n.x,i.y=t-n.y,i.width=i.height=1;var o=r.getIntersectionList(i,null);o.length&&(r=o[o.length-1])}return r?d(r):null},r.plugin=function(e){e(r,c,p,y,f)},y.win.Snap=r,r}(e||this);return n.plugin((function(r,n,i,o,s){function a(e,t){if(null==t){var n=!0;if(!(t="linearGradient"==e.type||"radialGradient"==e.type?e.node.getAttribute("gradientTransform"):"pattern"==e.type?e.node.getAttribute("patternTransform"):e.node.getAttribute("transform")))return new r.Matrix;t=r._.svgTransform2string(t)}else t=r._.rgTransform.test(t)?f(t).replace(/\.{3}|\u2026/g,e._.transform||""):r._.svgTransform2string(t),c(t,"array")&&(t=r.path?r.path.toString.call(t):f(t)),e._.transform=t;var i=r._.transform2matrix(t,e.getBBox(1));return n?i:void(e.matrix=i)}function l(e){return function(){var t=e?"<"+this.type:"",r=this.node.attributes,n=this.node.childNodes;if(e)for(var i=0,o=r.length;o>i;i++)t+=" "+r[i].name+'="'+r[i].value.replace(/"/g,'\\"')+'"';if(n.length){for(e&&(t+=">"),i=0,o=n.length;o>i;i++)3==n[i].nodeType?t+=n[i].nodeValue:1==n[i].nodeType&&(t+=y(n[i]).toString());e&&(t+="</"+this.type+">")}else e&&(t+="/>");return t}}var u=n.prototype,c=r.is,f=String,h=r._unit2px,p=r._.$,d=r._.make,g=r._.getSomeDefs,v="hasOwnProperty",y=r._.wrap;u.getBBox=function(e){if("tspan"==this.type)return r._.box(this.node.getClientRects().item(0));if(!r.Matrix||!r.path)return this.node.getBBox();var t=this,n=new r.Matrix;if(t.removed)return r._.box();for(;"use"==t.type;)if(e||(n=n.add(t.transform().localMatrix.translate(t.attr("x")||0,t.attr("y")||0))),t.original)t=t.original;else{var i=t.attr("xlink:href");t=t.original=t.node.ownerDocument.getElementById(i.substring(i.indexOf("#")+1))}var o=t._,s=r.path.get[t.type]||r.path.get.deflt;try{return e?(o.bboxwt=s?r.path.getBBox(t.realPath=s(t)):r._.box(t.node.getBBox()),r._.box(o.bboxwt)):(t.realPath=s(t),t.matrix=t.transform().localMatrix,o.bbox=r.path.getBBox(r.path.map(t.realPath,n.add(t.matrix))),r._.box(o.bbox))}catch(a){return r._.box()}};var m=function(){return this.string};u.transform=function(e){var t=this._;if(null==e){for(var n,i=this,o=new r.Matrix(this.node.getCTM()),s=a(this),l=[s],u=new r.Matrix,c=s.toTransformString(),h=f(s)==f(this.matrix)?f(t.transform):c;"svg"!=i.type&&(i=i.parent());)l.push(a(i));for(n=l.length;n--;)u.add(l[n]);return{string:h,globalMatrix:o,totalMatrix:u,localMatrix:s,diffMatrix:o.clone().add(s.invert()),global:o.toTransformString(),total:u.toTransformString(),local:c,toString:m}}return e instanceof r.Matrix?(this.matrix=e,this._.transform=e.toTransformString()):a(this,e),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?p(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?p(this.node,{patternTransform:this.matrix}):p(this.node,{transform:this.matrix})),this},u.parent=function(){return y(this.node.parentNode)},u.append=u.add=function(e){if(e){if("set"==e.type){var t=this;return e.forEach((function(e){t.add(e)})),this}e=y(e),this.node.appendChild(e.node),e.paper=this.paper}return this},u.appendTo=function(e){return e&&(e=y(e)).append(this),this},u.prepend=function(e){if(e){if("set"==e.type){var t,r=this;return e.forEach((function(e){t?t.after(e):r.prepend(e),t=e})),this}var n=(e=y(e)).parent();this.node.insertBefore(e.node,this.node.firstChild),this.add&&this.add(),e.paper=this.paper,this.parent()&&this.parent().add(),n&&n.add()}return this},u.prependTo=function(e){return(e=y(e)).prepend(this),this},u.before=function(e){if("set"==e.type){var t=this;return e.forEach((function(e){var r=e.parent();t.node.parentNode.insertBefore(e.node,t.node),r&&r.add()})),this.parent().add(),this}var r=(e=y(e)).parent();return this.node.parentNode.insertBefore(e.node,this.node),this.parent()&&this.parent().add(),r&&r.add(),e.paper=this.paper,this},u.after=function(e){var t=(e=y(e)).parent();return this.node.nextSibling?this.node.parentNode.insertBefore(e.node,this.node.nextSibling):this.node.parentNode.appendChild(e.node),this.parent()&&this.parent().add(),t&&t.add(),e.paper=this.paper,this},u.insertBefore=function(e){e=y(e);var t=this.parent();return e.node.parentNode.insertBefore(this.node,e.node),this.paper=e.paper,t&&t.add(),e.parent()&&e.parent().add(),this},u.insertAfter=function(e){e=y(e);var t=this.parent();return e.node.parentNode.insertBefore(this.node,e.node.nextSibling),this.paper=e.paper,t&&t.add(),e.parent()&&e.parent().add(),this},u.remove=function(){var e=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,e&&e.add(),this},u.select=function(e){return y(this.node.querySelector(e))},u.selectAll=function(e){for(var t=this.node.querySelectorAll(e),n=(r.set||Array)(),i=0;i<t.length;i++)n.push(y(t[i]));return n},u.asPX=function(e,t){return null==t&&(t=this.attr(e)),+h(this,e,t)},u.use=function(){var e,t=this.node.id;return t||(t=this.id,p(this.node,{id:t})),e="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?d(this.type,this.node.parentNode):d("use",this.node.parentNode),p(e.node,{"xlink:href":"#"+t}),e.original=this,e},u.clone=function(){var e=y(this.node.cloneNode(!0));return p(e.node,"id")&&p(e.node,{id:e.id}),function(e){function t(e,t){var n=p(e.node,t);(n=(n=n&&n.match(s))&&n[2])&&"#"==n.charAt()&&(n=n.substring(1))&&(l[n]=(l[n]||[]).concat((function(n){var i={};i[t]=r.url(n),p(e.node,i)})))}function n(e){var t=p(e.node,"xlink:href");t&&"#"==t.charAt()&&(t=t.substring(1))&&(l[t]=(l[t]||[]).concat((function(t){e.attr("xlink:href","#"+t)})))}for(var i,o=e.selectAll("*"),s=/^\s*url\(("|'|)(.*)\1\)\s*$/,a=[],l={},u=0,c=o.length;c>u;u++){t(i=o[u],"fill"),t(i,"stroke"),t(i,"filter"),t(i,"mask"),t(i,"clip-path"),n(i);var f=p(i.node,"id");f&&(p(i.node,{id:i.id}),a.push({old:f,id:i.id}))}for(u=0,c=a.length;c>u;u++){var h=l[a[u].old];if(h)for(var d=0,g=h.length;g>d;d++)h[d](a[u].id)}}(e),e.insertAfter(this),e},u.toDefs=function(){return g(this).appendChild(this.node),this},u.pattern=u.toPattern=function(e,t,r,n){var i=d("pattern",g(this));return null==e&&(e=this.getBBox()),c(e,"object")&&"x"in e&&(t=e.y,r=e.width,n=e.height,e=e.x),p(i.node,{x:e,y:t,width:r,height:n,patternUnits:"userSpaceOnUse",id:i.id,viewBox:[e,t,r,n].join(" ")}),i.node.appendChild(this.node),i},u.marker=function(e,t,r,n,i,o){var s=d("marker",g(this));return null==e&&(e=this.getBBox()),c(e,"object")&&"x"in e&&(t=e.y,r=e.width,n=e.height,i=e.refX||e.cx,o=e.refY||e.cy,e=e.x),p(s.node,{viewBox:[e,t,r,n].join(" "),markerWidth:r,markerHeight:n,orient:"auto",refX:i||0,refY:o||0,id:s.id}),s.node.appendChild(this.node),s};var b={};u.data=function(e,n){var i=b[this.id]=b[this.id]||{};if(0==arguments.length)return t("snap.data.get."+this.id,this,i,null),i;if(1==arguments.length){if(r.is(e,"object")){for(var o in e)e[v](o)&&this.data(o,e[o]);return this}return t("snap.data.get."+this.id,this,i[e],e),i[e]}return i[e]=n,t("snap.data.set."+this.id,this,n,e),this},u.removeData=function(e){return null==e?b[this.id]={}:b[this.id]&&delete b[this.id][e],this},u.outerSVG=u.toString=l(1),u.innerSVG=l(),u.toDataURL=function(){if(e&&e.btoa){var t=this.getBBox(),n=r.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+t.x.toFixed(3),y:+t.y.toFixed(3),width:+t.width.toFixed(3),height:+t.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(n)))}},s.prototype.select=u.select,s.prototype.selectAll=u.selectAll})),n.plugin((function(e,n,i,o,s){function a(e,t,r){return function(n){var i=n.slice(e,t);return 1==i.length&&(i=i[0]),r?r(i):i}}var l=n.prototype,u=e.is,c=String,f="hasOwnProperty",h=function(e,t,n,i){"function"!=typeof n||n.length||(i=n,n=r.linear),this.attr=e,this.dur=t,n&&(this.easing=n),i&&(this.callback=i)};e._.Animation=h,e.animation=function(e,t,r,n){return new h(e,t,r,n)},l.inAnim=function(){var e=this,t=[];for(var r in e.anims)e.anims[f](r)&&function(e){t.push({anim:new h(e._attrs,e.dur,e.easing,e._callback),mina:e,curStatus:e.status(),status:function(t){return e.status(t)},stop:function(){e.stop()}})}(e.anims[r]);return t},e.animate=function(e,n,i,o,s,a){"function"!=typeof s||s.length||(a=s,s=r.linear);var l=r.time(),u=r(e,n,l,l+o,r.time,i,s);return a&&t.once("mina.finish."+u.id,a),u},l.stop=function(){for(var e=this.inAnim(),t=0,r=e.length;r>t;t++)e[t].stop();return this},l.animate=function(e,n,i,o){"function"!=typeof i||i.length||(o=i,i=r.linear),e instanceof h&&(o=e.callback,i=e.easing,n=e.dur,e=e.attr);var s,l,p,d,g=[],v=[],y={},m=this;for(var b in e)if(e[f](b)){m.equal?(s=(d=m.equal(b,c(e[b]))).from,l=d.to,p=d.f):(s=+m.attr(b),l=+e[b]);var x=u(s,"array")?s.length:1;y[b]=a(g.length,g.length+x,p),g=g.concat(s),v=v.concat(l)}var w=r.time(),k=r(g,v,w,w+n,r.time,(function(e){var t={};for(var r in y)y[f](r)&&(t[r]=y[r](e));m.attr(t)}),i);return m.anims[k.id]=k,k._attrs=e,k._callback=o,t("snap.animcreated."+m.id,k),t.once("mina.finish."+k.id,(function(){t.off("mina.*."+k.id),delete m.anims[k.id],o&&o.call(m)})),t.once("mina.stop."+k.id,(function(){t.off("mina.*."+k.id),delete m.anims[k.id]})),m}})),n.plugin((function(e,t,r,n,i){function o(e,t,r,n,i,o){return null==t&&"[object SVGMatrix]"==s.call(e)?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,void(this.f=e.f)):void(null!=e?(this.a=+e,this.b=+t,this.c=+r,this.d=+n,this.e=+i,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var s=Object.prototype.toString,a=String,l=Math;!function(t){function r(e){return e[0]*e[0]+e[1]*e[1]}function n(e){var t=l.sqrt(r(e));e[0]&&(e[0]/=t),e[1]&&(e[1]/=t)}t.add=function(e,t,r,n,i,s){if(e&&e instanceof o)return this.add(e.a,e.b,e.c,e.d,e.e,e.f);var a=e*this.a+t*this.c,l=e*this.b+t*this.d;return this.e+=i*this.a+s*this.c,this.f+=i*this.b+s*this.d,this.c=r*this.a+n*this.c,this.d=r*this.b+n*this.d,this.a=a,this.b=l,this},o.prototype.multLeft=function(e,t,r,n,i,s){if(e&&e instanceof o)return this.multLeft(e.a,e.b,e.c,e.d,e.e,e.f);var a=e*this.a+r*this.b,l=e*this.c+r*this.d,u=e*this.e+r*this.f+i;return this.b=t*this.a+n*this.b,this.d=t*this.c+n*this.d,this.f=t*this.e+n*this.f+s,this.a=a,this.c=l,this.e=u,this},t.invert=function(){var e=this,t=e.a*e.d-e.b*e.c;return new o(e.d/t,-e.b/t,-e.c/t,e.a/t,(e.c*e.f-e.d*e.e)/t,(e.b*e.e-e.a*e.f)/t)},t.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(e,t){return this.e+=e*this.a+t*this.c,this.f+=e*this.b+t*this.d,this},t.scale=function(e,t,r,n){return null==t&&(t=e),(r||n)&&this.translate(r,n),this.a*=e,this.b*=e,this.c*=t,this.d*=t,(r||n)&&this.translate(-r,-n),this},t.rotate=function(t,r,n){t=e.rad(t),r=r||0,n=n||0;var i=+l.cos(t).toFixed(9),o=+l.sin(t).toFixed(9);return this.add(i,o,-o,i,r,n),this.add(1,0,0,1,-r,-n)},t.skewX=function(e){return this.skew(e,0)},t.skewY=function(e){return this.skew(0,e)},t.skew=function(t,r){t=t||0,r=r||0,t=e.rad(t),r=e.rad(r);var n=l.tan(t).toFixed(9),i=l.tan(r).toFixed(9);return this.add(1,i,n,1,0,0)},t.x=function(e,t){return e*this.a+t*this.c+this.e},t.y=function(e,t){return e*this.b+t*this.d+this.f},t.get=function(e){return+this[a.fromCharCode(97+e)].toFixed(4)},t.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.determinant=function(){return this.a*this.d-this.b*this.c},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var i=[[this.a,this.b],[this.c,this.d]];t.scalex=l.sqrt(r(i[0])),n(i[0]),t.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*t.shear,i[1][1]-i[0][1]*t.shear],t.scaley=l.sqrt(r(i[1])),n(i[1]),t.shear/=t.scaley,this.determinant()<0&&(t.scalex=-t.scalex);var o=i[0][1],s=i[1][1];return 0>s?(t.rotate=e.deg(l.acos(s)),0>o&&(t.rotate=360-t.rotate)):t.rotate=e.deg(l.asin(o)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(e){var t=e||this.split();return+t.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[+t.dx.toFixed(4),+t.dy.toFixed(4)]:"")+(t.rotate?"r"+[+t.rotate.toFixed(4),0,0]:"")+(1!=t.scalex||1!=t.scaley?"s"+[t.scalex,t.scaley,0,0]:""))}}(o.prototype),e.Matrix=o,e.matrix=function(e,t,r,n,i,s){return new o(e,t,r,n,i,s)}})),n.plugin((function(e,r,n,i,o){function s(n){return function(i){if(t.stop(),i instanceof o&&1==i.node.childNodes.length&&("radialGradient"==i.node.firstChild.tagName||"linearGradient"==i.node.firstChild.tagName||"pattern"==i.node.firstChild.tagName)&&(i=i.node.firstChild,p(this).appendChild(i),i=f(i)),i instanceof r)if("radialGradient"==i.type||"linearGradient"==i.type||"pattern"==i.type){i.node.id||g(i.node,{id:i.id});var s=v(i.node.id)}else s=i.attr(n);else if((s=e.color(i)).error){var a=e(p(this).ownerSVGElement).gradient(i);a?(a.node.id||g(a.node,{id:a.id}),s=v(a.node.id)):s=i}else s=y(s);var l={};l[n]=s,g(this.node,l),this.node.style[n]=b}}function a(e){t.stop(),e==+e&&(e+="px"),this.node.style.fontSize=e}function l(e){for(var t=[],r=e.childNodes,n=0,i=r.length;i>n;n++){var o=r[n];3==o.nodeType&&t.push(o.nodeValue),"tspan"==o.tagName&&(1==o.childNodes.length&&3==o.firstChild.nodeType?t.push(o.firstChild.nodeValue):t.push(l(o)))}return t}function u(){return t.stop(),this.node.style.fontSize}var c=e._.make,f=e._.wrap,h=e.is,p=e._.getSomeDefs,d=/^url\((['"]?)([^)]+)\1\)$/,g=e._.$,v=e.url,y=String,m=e._.separator,b="";e.deurl=function(e){var t=String(e).match(d);return t?t[2]:e},t.on("snap.util.attr.mask",(function(e){if(e instanceof r||e instanceof o){if(t.stop(),e instanceof o&&1==e.node.childNodes.length&&(e=e.node.firstChild,p(this).appendChild(e),e=f(e)),"mask"==e.type)var n=e;else(n=c("mask",p(this))).node.appendChild(e.node);!n.node.id&&g(n.node,{id:n.id}),g(this.node,{mask:v(n.id)})}})),function(e){t.on("snap.util.attr.clip",e),t.on("snap.util.attr.clip-path",e),t.on("snap.util.attr.clipPath",e)}((function(e){if(e instanceof r||e instanceof o){t.stop();for(var n,i=e.node;i;){if("clipPath"===i.nodeName){n=new r(i);break}if("svg"===i.nodeName){n=void 0;break}i=i.parentNode}n||((n=c("clipPath",p(this))).node.appendChild(e.node),!n.node.id&&g(n.node,{id:n.id})),g(this.node,{"clip-path":v(n.node.id||n.id)})}})),t.on("snap.util.attr.fill",s("fill")),t.on("snap.util.attr.stroke",s("stroke"));var x=/^([lr])(?:\(([^)]*)\))?(.*)$/i;t.on("snap.util.grad.parse",(function(e){function t(e,t){for(var r=(t-a)/(e-l),n=l;e>n;n++)o[n].offset=+(+a+r*(n-l)).toFixed(2);l=e,a=t}var r=(e=y(e)).match(x);if(!r)return null;var n=r[1],i=r[2],o=r[3];1==(i=i.split(/\s*,\s*/).map((function(e){return+e==e?+e:e}))).length&&0==i[0]&&(i=[]);var s=(o=(o=o.split("-")).map((function(e){var t={color:(e=e.split(":"))[0]};return e[1]&&(t.offset=parseFloat(e[1])),t}))).length,a=0,l=0;s--;for(var u=0;s>u;u++)"offset"in o[u]&&t(u,o[u].offset);return o[s].offset=o[s].offset||100,t(s,o[s].offset),{type:n,params:i,stops:o}})),t.on("snap.util.attr.d",(function(r){t.stop(),h(r,"array")&&h(r[0],"array")&&(r=e.path.toString.call(r)),(r=y(r)).match(/[ruo]/i)&&(r=e.path.toAbsolute(r)),g(this.node,{d:r})}))(-1),t.on("snap.util.attr.#text",(function(e){t.stop(),e=y(e);for(var r=i.doc.createTextNode(e);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(r)}))(-1),t.on("snap.util.attr.path",(function(e){t.stop(),this.attr({d:e})}))(-1),t.on("snap.util.attr.class",(function(e){t.stop(),this.node.className.baseVal=e}))(-1),t.on("snap.util.attr.viewBox",(function(e){var r;r=h(e,"object")&&"x"in e?[e.x,e.y,e.width,e.height].join(" "):h(e,"array")?e.join(" "):e,g(this.node,{viewBox:r}),t.stop()}))(-1),t.on("snap.util.attr.transform",(function(e){this.transform(e),t.stop()}))(-1),t.on("snap.util.attr.r",(function(e){"rect"==this.type&&(t.stop(),g(this.node,{rx:e,ry:e}))}))(-1),t.on("snap.util.attr.textpath",(function(e){if(t.stop(),"text"==this.type){var n,i,o;if(!e&&this.textPath){for(i=this.textPath;i.node.firstChild;)this.node.appendChild(i.node.firstChild);return i.remove(),void delete this.textPath}if(h(e,"string")){var s=p(this),a=f(s.parentNode).path(e);s.appendChild(a.node),n=a.id,a.attr({id:n})}else(e=f(e))instanceof r&&((n=e.attr("id"))||(n=e.id,e.attr({id:n})));if(n)if(i=this.textPath,o=this.node,i)i.attr({"xlink:href":"#"+n});else{for(i=g("textPath",{"xlink:href":"#"+n});o.firstChild;)i.appendChild(o.firstChild);o.appendChild(i),this.textPath=f(i)}}}))(-1),t.on("snap.util.attr.text",(function(e){if("text"==this.type){for(var r=this.node,n=function(e){var t=g("tspan");if(h(e,"array"))for(var r=0;r<e.length;r++)t.appendChild(n(e[r]));else t.appendChild(i.doc.createTextNode(e));return t.normalize&&t.normalize(),t};r.firstChild;)r.removeChild(r.firstChild);for(var o=n(e);o.firstChild;)r.appendChild(o.firstChild)}t.stop()}))(-1),t.on("snap.util.attr.fontSize",a)(-1),t.on("snap.util.attr.font-size",a)(-1),t.on("snap.util.getattr.transform",(function(){return t.stop(),this.transform()}))(-1),t.on("snap.util.getattr.textpath",(function(){return t.stop(),this.textPath}))(-1),function(){function r(r){return function(){t.stop();var n=i.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+r);return"none"==n?n:e(i.doc.getElementById(n.match(d)[1]))}}function n(e){return function(r){t.stop();var n="marker"+e.charAt(0).toUpperCase()+e.substring(1);if(""!=r&&r){if("marker"==r.type){var i=r.node.id;return i||g(r.node,{id:r.id}),void(this.node.style[n]=v(i))}}else this.node.style[n]="none"}}t.on("snap.util.getattr.marker-end",r("end"))(-1),t.on("snap.util.getattr.markerEnd",r("end"))(-1),t.on("snap.util.getattr.marker-start",r("start"))(-1),t.on("snap.util.getattr.markerStart",r("start"))(-1),t.on("snap.util.getattr.marker-mid",r("mid"))(-1),t.on("snap.util.getattr.markerMid",r("mid"))(-1),t.on("snap.util.attr.marker-end",n("end"))(-1),t.on("snap.util.attr.markerEnd",n("end"))(-1),t.on("snap.util.attr.marker-start",n("start"))(-1),t.on("snap.util.attr.markerStart",n("start"))(-1),t.on("snap.util.attr.marker-mid",n("mid"))(-1),t.on("snap.util.attr.markerMid",n("mid"))(-1)}(),t.on("snap.util.getattr.r",(function(){return"rect"==this.type&&g(this.node,"rx")==g(this.node,"ry")?(t.stop(),g(this.node,"rx")):void 0}))(-1),t.on("snap.util.getattr.text",(function(){if("text"==this.type||"tspan"==this.type){t.stop();var e=l(this.node);return 1==e.length?e[0]:e}}))(-1),t.on("snap.util.getattr.#text",(function(){return this.node.textContent}))(-1),t.on("snap.util.getattr.fill",(function(r){if(!r){t.stop();var n=t("snap.util.getattr.fill",this,!0).firstDefined();return e(e.deurl(n))||n}}))(-1),t.on("snap.util.getattr.stroke",(function(r){if(!r){t.stop();var n=t("snap.util.getattr.stroke",this,!0).firstDefined();return e(e.deurl(n))||n}}))(-1),t.on("snap.util.getattr.viewBox",(function(){t.stop();var r=g(this.node,"viewBox");return r?(r=r.split(m),e._.box(+r[0],+r[1],+r[2],+r[3])):void 0}))(-1),t.on("snap.util.getattr.points",(function(){var e=g(this.node,"points");return t.stop(),e?e.split(m):void 0}))(-1),t.on("snap.util.getattr.path",(function(){var e=g(this.node,"d");return t.stop(),e}))(-1),t.on("snap.util.getattr.class",(function(){return this.node.className.baseVal}))(-1),t.on("snap.util.getattr.fontSize",u)(-1),t.on("snap.util.getattr.font-size",u)(-1)})),n.plugin((function(e,t,r,n,i){var o=/\S+/g,s=String,a=t.prototype;a.addClass=function(e){var t,r,n,i=s(e||"").match(o)||[],a=this.node,l=a.className.baseVal,u=l.match(o)||[];if(i.length){for(t=0;r=i[t++];)~u.indexOf(r)||u.push(r);l!=(n=u.join(" "))&&(a.className.baseVal=n)}return this},a.removeClass=function(e){var t,r,n,i,a=s(e||"").match(o)||[],l=this.node,u=l.className.baseVal,c=u.match(o)||[];if(c.length){for(t=0;n=a[t++];)~(r=c.indexOf(n))&&c.splice(r,1);u!=(i=c.join(" "))&&(l.className.baseVal=i)}return this},a.hasClass=function(e){return!!~(this.node.className.baseVal.match(o)||[]).indexOf(e)},a.toggleClass=function(e,t){if(null!=t)return t?this.addClass(e):this.removeClass(e);var r,n,i,s,a=(e||"").match(o)||[],l=this.node,u=l.className.baseVal,c=u.match(o)||[];for(r=0;i=a[r++];)~(n=c.indexOf(i))?c.splice(n,1):c.push(i);return u!=(s=c.join(" "))&&(l.className.baseVal=s),this}})),n.plugin((function(e,r,n,i,o){function s(e){return e}function a(e){return function(t){return+t.toFixed(3)+e}}var l={"+":function(e,t){return e+t},"-":function(e,t){return e-t},"/":function(e,t){return e/t},"*":function(e,t){return e*t}},u=String,c=/[a-z]+$/i,f=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;t.on("snap.util.attr",(function(e){var r=u(e).match(f);if(r){var n=t.nt(),i=n.substring(n.lastIndexOf(".")+1),o=this.attr(i),s={};t.stop();var a=r[3]||"",h=o.match(c),p=l[r[1]];if(h&&h==a?e=p(parseFloat(o),+r[2]):(o=this.asPX(i),e=p(this.asPX(i),this.asPX(i,r[2]+a))),isNaN(o)||isNaN(e))return;s[i]=e,this.attr(s)}}))(-10),t.on("snap.util.equal",(function(e,r){var n=u(this.attr(e)||""),i=u(r).match(f);if(i){t.stop();var o=i[3]||"",h=n.match(c),p=l[i[1]];return h&&h==o?{from:parseFloat(n),to:p(parseFloat(n),+i[2]),f:a(h)}:{from:n=this.asPX(e),to:p(n,this.asPX(e,i[2]+o)),f:s}}}))(-10)})),n.plugin((function(r,n,i,o,s){var a=i.prototype,l=r.is;a.rect=function(e,t,r,n,i,o){var s;return null==o&&(o=i),l(e,"object")&&"[object Object]"==e?s=e:null!=e&&(s={x:e,y:t,width:r,height:n},null!=i&&(s.rx=i,s.ry=o)),this.el("rect",s)},a.circle=function(e,t,r){var n;return l(e,"object")&&"[object Object]"==e?n=e:null!=e&&(n={cx:e,cy:t,r:r}),this.el("circle",n)};var u=function(){function e(){this.parentNode.removeChild(this)}return function(t,r){var n=o.doc.createElement("img"),i=o.doc.body;n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){r.call(n),n.onload=n.onerror=null,i.removeChild(n)},n.onerror=e,i.appendChild(n),n.src=t}}();a.image=function(e,t,n,i,o){var s=this.el("image");if(l(e,"object")&&"src"in e)s.attr(e);else if(null!=e){var a={"xlink:href":e,preserveAspectRatio:"none"};null!=t&&null!=n&&(a.x=t,a.y=n),null!=i&&null!=o?(a.width=i,a.height=o):u(e,(function(){r._.$(s.node,{width:this.offsetWidth,height:this.offsetHeight})})),r._.$(s.node,a)}return s},a.ellipse=function(e,t,r,n){var i;return l(e,"object")&&"[object Object]"==e?i=e:null!=e&&(i={cx:e,cy:t,rx:r,ry:n}),this.el("ellipse",i)},a.path=function(e){var t;return l(e,"object")&&!l(e,"array")?t=e:e&&(t={d:e}),this.el("path",t)},a.group=a.g=function(e){var t=this.el("g");return 1==arguments.length&&e&&!e.type?t.attr(e):arguments.length&&t.add(Array.prototype.slice.call(arguments,0)),t},a.svg=function(e,t,r,n,i,o,s,a){var u={};return l(e,"object")&&null==t?u=e:(null!=e&&(u.x=e),null!=t&&(u.y=t),null!=r&&(u.width=r),null!=n&&(u.height=n),null!=i&&null!=o&&null!=s&&null!=a&&(u.viewBox=[i,o,s,a])),this.el("svg",u)},a.mask=function(e){var t=this.el("mask");return 1==arguments.length&&e&&!e.type?t.attr(e):arguments.length&&t.add(Array.prototype.slice.call(arguments,0)),t},a.ptrn=function(e,t,r,n,i,o,s,a){if(l(e,"object"))var u=e;else u={patternUnits:"userSpaceOnUse"},e&&(u.x=e),t&&(u.y=t),null!=r&&(u.width=r),null!=n&&(u.height=n),u.viewBox=null!=i&&null!=o&&null!=s&&null!=a?[i,o,s,a]:[e||0,t||0,r||0,n||0];return this.el("pattern",u)},a.use=function(e){return null!=e?(e instanceof n&&(e.attr("id")||e.attr({id:r._.id(e)}),e=e.attr("id")),"#"==String(e).charAt()&&(e=e.substring(1)),this.el("use",{"xlink:href":"#"+e})):n.prototype.use.call(this)},a.symbol=function(e,t,r,n){var i={};return null!=e&&null!=t&&null!=r&&null!=n&&(i.viewBox=[e,t,r,n]),this.el("symbol",i)},a.text=function(e,t,r){var n={};return l(e,"object")?n=e:null!=e&&(n={x:e,y:t,text:r||""}),this.el("text",n)},a.line=function(e,t,r,n){var i={};return l(e,"object")?i=e:null!=e&&(i={x1:e,x2:r,y1:t,y2:n}),this.el("line",i)},a.polyline=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};return l(e,"object")&&!l(e,"array")?t=e:null!=e&&(t={points:e}),this.el("polyline",t)},a.polygon=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};return l(e,"object")&&!l(e,"array")?t=e:null!=e&&(t={points:e}),this.el("polygon",t)},function(){function n(){return this.selectAll("stop")}function i(e,t){var n=c("stop"),i={offset:+t+"%"};e=r.color(e),i["stop-color"]=e.hex,e.opacity<1&&(i["stop-opacity"]=e.opacity),c(n,i);for(var o,s=this.stops(),a=0;a<s.length;a++){if(parseFloat(s[a].attr("offset"))>t){this.node.insertBefore(n,s[a].node),o=!0;break}}return o||this.node.appendChild(n),this}function o(){if("linearGradient"==this.type){var e=c(this.node,"x1")||0,t=c(this.node,"x2")||1,n=c(this.node,"y1")||0,i=c(this.node,"y2")||0;return r._.box(e,n,math.abs(t-e),math.abs(i-n))}var o=this.node.cx||.5,s=this.node.cy||.5,a=this.node.r||0;return r._.box(o-a,s-a,2*a,2*a)}function s(e){var n=e,i=this.stops();if("string"==typeof e&&(n=t("snap.util.grad.parse",null,"l(0,0,0,1)"+e).firstDefined().stops),r.is(n,"array")){for(var o=0;o<i.length;o++)if(n[o]){var s=r.color(n[o].color),a={offset:n[o].offset+"%"};a["stop-color"]=s.hex,s.opacity<1&&(a["stop-opacity"]=s.opacity),i[o].attr(a)}else i[o].remove();for(o=i.length;o<n.length;o++)this.addStop(n[o].color,n[o].offset);return this}}function l(e,t,a,l,u){var f=r._.make("linearGradient",e);return f.stops=n,f.addStop=i,f.getBBox=o,f.setStops=s,null!=t&&c(f.node,{x1:t,y1:a,x2:l,y2:u}),f}function u(e,t,s,a,l,u){var f=r._.make("radialGradient",e);return f.stops=n,f.addStop=i,f.getBBox=o,null!=t&&c(f.node,{cx:t,cy:s,r:a}),null!=l&&null!=u&&c(f.node,{fx:l,fy:u}),f}var c=r._.$;a.gradient=function(e){return function(e,r){var n,i=t("snap.util.grad.parse",null,r).firstDefined();if(!i)return null;i.params.unshift(e),n="l"==i.type.toLowerCase()?l.apply(0,i.params):u.apply(0,i.params),i.type!=i.type.toLowerCase()&&c(n.node,{gradientUnits:"userSpaceOnUse"});for(var o=i.stops,s=o.length,a=0;s>a;a++){var f=o[a];n.addStop(f.color,f.offset)}return n}(this.defs,e)},a.gradientLinear=function(e,t,r,n){return l(this.defs,e,t,r,n)},a.gradientRadial=function(e,t,r,n,i){return u(this.defs,e,t,r,n,i)},a.toString=function(){var e,t=this.node.ownerDocument,n=t.createDocumentFragment(),i=t.createElement("div"),o=this.node.cloneNode(!0);return n.appendChild(i),i.appendChild(o),r._.$(o,{xmlns:"http://www.w3.org/2000/svg"}),e=i.innerHTML,n.removeChild(n.firstChild),e},a.toDataURL=function(){return e&&e.btoa?"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this))):void 0},a.clear=function(){for(var e,t=this.node.firstChild;t;)e=t.nextSibling,"defs"!=t.tagName?t.parentNode.removeChild(t):a.clear.call({node:t}),t=e}}()})),n.plugin((function(e,t,r,n){function i(e){var t=i.ps=i.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout((function(){for(var r in t)t[M](r)&&r!=e&&(t[r].sleep--,!t[r].sleep&&delete t[r])})),t[e]}function o(e,t,r,n){return null==e&&(e=t=r=n=0),null==t&&(t=e.y,r=e.width,n=e.height,e=e.x),{x:e,y:t,width:r,w:r,height:n,h:n,x2:e+r,y2:t+n,cx:e+r/2,cy:t+n/2,r1:O.min(r,n)/2,r2:O.max(r,n)/2,r0:O.sqrt(r*r+n*n)/2,path:x(e,t,r,n),vb:[e,t,r,n].join(" ")}}function s(){return this.join(",").replace(I,"$1")}function a(e){var t=N(e);return t.toString=s,t}function l(e,t,r,n,i,o,s,a,l){return null==l?g(e,t,r,n,i,o,s,a):c(e,t,r,n,i,o,s,a,function(e,t,r,n,i,o,s,a,l){if(!(0>l||g(e,t,r,n,i,o,s,a)<l)){var u,c=1,f=c/2,h=c-f,p=.01;for(u=g(e,t,r,n,i,o,s,a,h);Q(u-l)>p;)u=g(e,t,r,n,i,o,s,a,h+=(l>u?1:-1)*(f/=2));return h}}(e,t,r,n,i,o,s,a,l))}function u(r,n){function i(e){return+(+e).toFixed(3)}return e._.cacher((function(e,o,s){e instanceof t&&(e=e.attr("d"));for(var a,u,f,h,p,d="",g={},v=0,y=0,m=(e=A(e)).length;m>y;y++){if("M"==(f=e[y])[0])a=+f[1],u=+f[2];else{if(v+(h=l(a,u,f[1],f[2],f[3],f[4],f[5],f[6]))>o){if(n&&!g.start){if(d+=["C"+i((p=l(a,u,f[1],f[2],f[3],f[4],f[5],f[6],o-v)).start.x),i(p.start.y),i(p.m.x),i(p.m.y),i(p.x),i(p.y)],s)return d;g.start=d,d=["M"+i(p.x),i(p.y)+"C"+i(p.n.x),i(p.n.y),i(p.end.x),i(p.end.y),i(f[5]),i(f[6])].join(),v+=h,a=+f[5],u=+f[6];continue}if(!r&&!n)return l(a,u,f[1],f[2],f[3],f[4],f[5],f[6],o-v)}v+=h,a=+f[5],u=+f[6]}d+=f.shift()+f}return g.end=d,r?v:n?g:c(a,u,f[0],f[1],f[2],f[3],f[4],f[5],1)}),null,e._.clone)}function c(e,t,r,n,i,o,s,a,l){var u=1-l,c=P(u,3),f=P(u,2),h=l*l,p=h*l,d=e+2*l*(r-e)+h*(i-2*r+e),g=t+2*l*(n-t)+h*(o-2*n+t),v=r+2*l*(i-r)+h*(s-2*i+r),y=n+2*l*(o-n)+h*(a-2*o+n);return{x:c*e+3*f*l*r+3*u*l*l*i+p*s,y:c*t+3*f*l*n+3*u*l*l*o+p*a,m:{x:d,y:g},n:{x:v,y:y},start:{x:u*e+l*r,y:u*t+l*n},end:{x:u*i+l*s,y:u*o+l*a},alpha:90-180*O.atan2(d-v,g-y)/D}}function f(t,r,n,i,s,a,l,u){e.is(t,"array")||(t=[t,r,n,i,s,a,l,u]);var c=_.apply(null,t);return o(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function h(e,t,r){return t>=e.x&&t<=e.x+e.width&&r>=e.y&&r<=e.y+e.height}function p(e,t){return e=o(e),h(t=o(t),e.x,e.y)||h(t,e.x2,e.y)||h(t,e.x,e.y2)||h(t,e.x2,e.y2)||h(e,t.x,t.y)||h(e,t.x2,t.y)||h(e,t.x,t.y2)||h(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function d(e,t,r,n,i){return e*(e*(-3*t+9*r-9*n+3*i)+6*t-12*r+6*n)-3*t+3*r}function g(e,t,r,n,i,o,s,a,l){null==l&&(l=1);for(var u=(l=l>1?1:0>l?0:l)/2,c=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],h=0,p=0;12>p;p++){var g=u*c[p]+u,v=d(g,e,r,i,s),y=d(g,t,n,o,a),m=v*v+y*y;h+=f[p]*O.sqrt(m)}return u*h}function v(e,t,r,n,i,o,s,a){if(!(B(e,r)<R(i,s)||R(e,r)>B(i,s)||B(t,n)<R(o,a)||R(t,n)>B(o,a))){var l=(e-r)*(o-a)-(t-n)*(i-s);if(l){var u=((e*n-t*r)*(i-s)-(e-r)*(i*a-o*s))/l,c=((e*n-t*r)*(o-a)-(t-n)*(i*a-o*s))/l,f=+u.toFixed(2),h=+c.toFixed(2);if(!(f<+R(e,r).toFixed(2)||f>+B(e,r).toFixed(2)||f<+R(i,s).toFixed(2)||f>+B(i,s).toFixed(2)||h<+R(t,n).toFixed(2)||h>+B(t,n).toFixed(2)||h<+R(o,a).toFixed(2)||h>+B(o,a).toFixed(2)))return{x:u,y:c}}}}function y(e,t,r){if(!p(f(e),f(t)))return r?0:[];for(var n=~~(g.apply(0,e)/8),i=~~(g.apply(0,t)/8),o=[],s=[],a={},l=r?0:[],u=0;n+1>u;u++){var h=c.apply(0,e.concat(u/n));o.push({x:h.x,y:h.y,t:u/n})}for(u=0;i+1>u;u++)h=c.apply(0,t.concat(u/i)),s.push({x:h.x,y:h.y,t:u/i});for(u=0;n>u;u++)for(var d=0;i>d;d++){var y=o[u],m=o[u+1],b=s[d],x=s[d+1],w=Q(m.x-y.x)<.001?"y":"x",k=Q(x.x-b.x)<.001?"y":"x",C=v(y.x,y.y,m.x,m.y,b.x,b.y,x.x,x.y);if(C){if(a[C.x.toFixed(4)]==C.y.toFixed(4))continue;a[C.x.toFixed(4)]=C.y.toFixed(4);var S=y.t+Q((C[w]-y[w])/(m[w]-y[w]))*(m.t-y.t),F=b.t+Q((C[k]-b[k])/(x[k]-b[k]))*(x.t-b.t);S>=0&&1>=S&&F>=0&&1>=F&&(r?l++:l.push({x:C.x,y:C.y,t1:S,t2:F}))}}return l}function m(e,t,r){e=A(e),t=A(t);for(var n,i,o,s,a,l,u,c,f,h,p=r?0:[],d=0,g=e.length;g>d;d++){var v=e[d];if("M"==v[0])n=a=v[1],i=l=v[2];else{"C"==v[0]?(f=[n,i].concat(v.slice(1)),n=f[6],i=f[7]):(f=[n,i,n,i,a,l,a,l],n=a,i=l);for(var m=0,b=t.length;b>m;m++){var x=t[m];if("M"==x[0])o=u=x[1],s=c=x[2];else{"C"==x[0]?(h=[o,s].concat(x.slice(1)),o=h[6],s=h[7]):(h=[o,s,o,s,u,c,u,c],o=u,s=c);var w=y(f,h,r);if(r)p+=w;else{for(var k=0,C=w.length;C>k;k++)w[k].segment1=d,w[k].segment2=m,w[k].bez1=f,w[k].bez2=h;p=p.concat(w)}}}}}return p}function b(e){var t=i(e);if(t.bbox)return N(t.bbox);if(!e)return o();for(var r,n=0,s=0,a=[],l=[],u=0,c=(e=A(e)).length;c>u;u++)if("M"==(r=e[u])[0])n=r[1],s=r[2],a.push(n),l.push(s);else{var f=_(n,s,r[1],r[2],r[3],r[4],r[5],r[6]);a=a.concat(f.min.x,f.max.x),l=l.concat(f.min.y,f.max.y),n=r[5],s=r[6]}var h=R.apply(0,a),p=R.apply(0,l),d=o(h,p,B.apply(0,a)-h,B.apply(0,l)-p);return t.bbox=N(d),d}function x(e,t,r,n,i){if(i)return[["M",+e+ +i,t],["l",r-2*i,0],["a",i,i,0,0,1,i,i],["l",0,n-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-r,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-n],["a",i,i,0,0,1,i,-i],["z"]];var o=[["M",e,t],["l",r,0],["l",0,n],["l",-r,0],["z"]];return o.toString=s,o}function w(e,t,r,n,i){if(null==i&&null==n&&(n=r),e=+e,t=+t,r=+r,n=+n,null!=i)var o=Math.PI/180,a=e+r*Math.cos(-n*o),l=e+r*Math.cos(-i*o),u=[["M",a,t+r*Math.sin(-n*o)],["A",r,r,0,+(i-n>180),0,l,t+r*Math.sin(-i*o)]];else u=[["M",e,t],["m",0,-n],["a",r,n,0,1,1,0,2*n],["a",r,n,0,1,1,0,-2*n],["z"]];return u.toString=s,u}function k(t){var r=i(t);if(r.abs)return a(r.abs);if(T(t,"array")&&T(t&&t[0],"array")||(t=e.parsePathString(t)),!t||!t.length)return[["M",0,0]];var n,o=[],l=0,u=0,c=0,f=0,h=0;"M"==t[0][0]&&(c=l=+t[0][1],f=u=+t[0][2],h++,o[0]=["M",l,u]);for(var p,d,g=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),v=h,y=t.length;y>v;v++){if(o.push(p=[]),(n=(d=t[v])[0])!=n.toUpperCase())switch(p[0]=n.toUpperCase(),p[0]){case"A":p[1]=d[1],p[2]=d[2],p[3]=d[3],p[4]=d[4],p[5]=d[5],p[6]=+d[6]+l,p[7]=+d[7]+u;break;case"V":p[1]=+d[1]+u;break;case"H":p[1]=+d[1]+l;break;case"R":for(var m=[l,u].concat(d.slice(1)),b=2,x=m.length;x>b;b++)m[b]=+m[b]+l,m[++b]=+m[b]+u;o.pop(),o=o.concat(E(m,g));break;case"O":o.pop(),(m=w(l,u,d[1],d[2])).push(m[0]),o=o.concat(m);break;case"U":o.pop(),o=o.concat(w(l,u,d[1],d[2],d[3])),p=["U"].concat(o[o.length-1].slice(-2));break;case"M":c=+d[1]+l,f=+d[2]+u;default:for(b=1,x=d.length;x>b;b++)p[b]=+d[b]+(b%2?l:u)}else if("R"==n)m=[l,u].concat(d.slice(1)),o.pop(),o=o.concat(E(m,g)),p=["R"].concat(d.slice(-2));else if("O"==n)o.pop(),(m=w(l,u,d[1],d[2])).push(m[0]),o=o.concat(m);else if("U"==n)o.pop(),o=o.concat(w(l,u,d[1],d[2],d[3])),p=["U"].concat(o[o.length-1].slice(-2));else for(var k=0,C=d.length;C>k;k++)p[k]=d[k];if("O"!=(n=n.toUpperCase()))switch(p[0]){case"Z":l=+c,u=+f;break;case"H":l=p[1];break;case"V":u=p[1];break;case"M":c=p[p.length-2],f=p[p.length-1];default:l=p[p.length-2],u=p[p.length-1]}}return o.toString=s,r.abs=a(o),o}function C(e,t,r,n){return[e,t,r,n,r,n]}function S(e,t,r,n,i,o){var s=1/3,a=2/3;return[s*e+a*r,s*t+a*n,s*i+a*r,s*o+a*n,i,o]}function F(t,r,n,i,o,s,a,l,u,c){var f,h=120*D/180,p=D/180*(+o||0),d=[],g=e._.cacher((function(e,t,r){return{x:e*O.cos(r)-t*O.sin(r),y:e*O.sin(r)+t*O.cos(r)}}));if(!n||!i)return[t,r,l,u,l,u];if(c)S=c[0],_=c[1],k=c[2],C=c[3];else{t=(f=g(t,r,-p)).x,r=f.y,l=(f=g(l,u,-p)).x,u=f.y;var v=(O.cos(D/180*o),O.sin(D/180*o),(t-l)/2),y=(r-u)/2,m=v*v/(n*n)+y*y/(i*i);m>1&&(n*=m=O.sqrt(m),i*=m);var b=n*n,x=i*i,w=(s==a?-1:1)*O.sqrt(Q((b*x-b*y*y-x*v*v)/(b*y*y+x*v*v))),k=w*n*y/i+(t+l)/2,C=w*-i*v/n+(r+u)/2,S=O.asin(((r-C)/i).toFixed(9)),_=O.asin(((u-C)/i).toFixed(9));0>(S=k>t?D-S:S)&&(S=2*D+S),0>(_=k>l?D-_:_)&&(_=2*D+_),a&&S>_&&(S-=2*D),!a&&_>S&&(_-=2*D)}var A=_-S;if(Q(A)>h){var E=_,L=l,T=u;_=S+h*(a&&_>S?1:-1),d=F(l=k+n*O.cos(_),u=C+i*O.sin(_),n,i,o,0,a,L,T,[_,E,k,C])}A=_-S;var N=O.cos(S),M=O.sin(S),I=O.cos(_),j=O.sin(_),R=O.tan(A/4),B=4/3*n*R,P=4/3*i*R,U=[t,r],G=[t+B*M,r-P*N],z=[l+B*j,u-P*I],q=[l,u];if(G[0]=2*U[0]-G[0],G[1]=2*U[1]-G[1],c)return[G,z,q].concat(d);for(var X=[],H=0,W=(d=[G,z,q].concat(d).join().split(",")).length;W>H;H++)X[H]=H%2?g(d[H-1],d[H],p).y:g(d[H],d[H+1],p).x;return X}function _(e,t,r,n,i,o,s,a){for(var l,u,c,f,h,p,d,g,v=[],y=[[],[]],m=0;2>m;++m)if(0==m?(u=6*e-12*r+6*i,l=-3*e+9*r-9*i+3*s,c=3*r-3*e):(u=6*t-12*n+6*o,l=-3*t+9*n-9*o+3*a,c=3*n-3*t),Q(l)<1e-12){if(Q(u)<1e-12)continue;(f=-c/u)>0&&1>f&&v.push(f)}else d=u*u-4*c*l,g=O.sqrt(d),0>d||((h=(-u+g)/(2*l))>0&&1>h&&v.push(h),(p=(-u-g)/(2*l))>0&&1>p&&v.push(p));for(var b,x=v.length,w=x;x--;)b=1-(f=v[x]),y[0][x]=b*b*b*e+3*b*b*f*r+3*b*f*f*i+f*f*f*s,y[1][x]=b*b*b*t+3*b*b*f*n+3*b*f*f*o+f*f*f*a;return y[0][w]=e,y[1][w]=t,y[0][w+1]=s,y[1][w+1]=a,y[0].length=y[1].length=w+2,{min:{x:R.apply(0,y[0]),y:R.apply(0,y[1])},max:{x:B.apply(0,y[0]),y:B.apply(0,y[1])}}}function A(e,t){var r=!t&&i(e);if(!t&&r.curve)return a(r.curve);for(var n=k(e),o=t&&k(t),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=function(e,t,r){var n,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(F.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==r||"S"==r?(n=2*t.x-t.bx,i=2*t.y-t.by):(n=t.x,i=t.y),e=["C",n,i].concat(e.slice(1));break;case"T":"Q"==r||"T"==r?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(S(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(S(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(C(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(C(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(C(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(C(t.x,t.y,t.X,t.Y))}return e},c=function(e,t){if(e[t].length>7){e[t].shift();for(var r=e[t];r.length;)h[t]="A",o&&(p[t]="A"),e.splice(t++,0,["C"].concat(r.splice(0,6)));e.splice(t,1),y=B(n.length,o&&o.length||0)}},f=function(e,t,r,i,s){e&&t&&"M"==e[s][0]&&"M"!=t[s][0]&&(t.splice(s,0,["M",i.x,i.y]),r.bx=0,r.by=0,r.x=e[s][1],r.y=e[s][2],y=B(n.length,o&&o.length||0))},h=[],p=[],d="",g="",v=0,y=B(n.length,o&&o.length||0);y>v;v++){n[v]&&(d=n[v][0]),"C"!=d&&(h[v]=d,v&&(g=h[v-1])),n[v]=u(n[v],s,g),"A"!=h[v]&&"C"==d&&(h[v]="C"),c(n,v),o&&(o[v]&&(d=o[v][0]),"C"!=d&&(p[v]=d,v&&(g=p[v-1])),o[v]=u(o[v],l,g),"A"!=p[v]&&"C"==d&&(p[v]="C"),c(o,v)),f(n,o,s,l,v),f(o,n,l,s,v);var m=n[v],b=o&&o[v],x=m.length,w=o&&b.length;s.x=m[x-2],s.y=m[x-1],s.bx=j(m[x-4])||s.x,s.by=j(m[x-3])||s.y,l.bx=o&&(j(b[w-4])||l.x),l.by=o&&(j(b[w-3])||l.y),l.x=o&&b[w-2],l.y=o&&b[w-1]}return o||(r.curve=a(n)),o?[n,o]:n}function E(e,t){for(var r=[],n=0,i=e.length;i-2*!t>n;n+=2){var o=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];t?n?i-4==n?o[3]={x:+e[0],y:+e[1]}:i-2==n&&(o[2]={x:+e[0],y:+e[1]},o[3]={x:+e[2],y:+e[3]}):o[0]={x:+e[i-2],y:+e[i-1]}:i-4==n?o[3]=o[2]:n||(o[0]={x:+e[n],y:+e[n+1]}),r.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return r}var L=t.prototype,T=e.is,N=e._.clone,M="hasOwnProperty",I=/,?([a-z]),?/gi,j=parseFloat,O=Math,D=O.PI,R=O.min,B=O.max,P=O.pow,Q=O.abs,U=u(1),G=u(),z=u(0,1),q=e._unit2px,X={path:function(e){return e.attr("path")},circle:function(e){var t=q(e);return w(t.cx,t.cy,t.r)},ellipse:function(e){var t=q(e);return w(t.cx||0,t.cy||0,t.rx,t.ry)},rect:function(e){var t=q(e);return x(t.x||0,t.y||0,t.width,t.height,t.rx,t.ry)},image:function(e){var t=q(e);return x(t.x||0,t.y||0,t.width,t.height)},line:function(e){return"M"+[e.attr("x1")||0,e.attr("y1")||0,e.attr("x2"),e.attr("y2")]},polyline:function(e){return"M"+e.attr("points")},polygon:function(e){return"M"+e.attr("points")+"z"},deflt:function(e){var t=e.node.getBBox();return x(t.x,t.y,t.width,t.height)}};e.path=i,e.path.getTotalLength=U,e.path.getPointAtLength=G,e.path.getSubpath=function(e,t,r){if(this.getTotalLength(e)-r<1e-6)return z(e,t).end;var n=z(e,r,1);return t?z(n,t).end:n},L.getTotalLength=function(){return this.node.getTotalLength?this.node.getTotalLength():void 0},L.getPointAtLength=function(e){return G(this.attr("d"),e)},L.getSubpath=function(t,r){return e.path.getSubpath(this.attr("d"),t,r)},e._.box=o,e.path.findDotsAtSegment=c,e.path.bezierBBox=f,e.path.isPointInsideBBox=h,e.closest=function(t,r,n,i){for(var s=100,a=o(t-s/2,r-s/2,s,s),l=[],u=n[0].hasOwnProperty("x")?function(e){return{x:n[e].x,y:n[e].y}}:function(e){return{x:n[e],y:i[e]}},c=0;1e6>=s&&!c;){for(var f=0,p=n.length;p>f;f++){var d=u(f);if(h(a,d.x,d.y)){c++,l.push(d);break}}c||(a=o(t-(s*=2)/2,r-s/2,s,s))}if(1e6!=s){var g,v=1/0;for(f=0,p=l.length;p>f;f++){var y=e.len(t,r,l[f].x,l[f].y);v>y&&(v=y,l[f].len=y,g=l[f])}return g}},e.path.isBBoxIntersect=p,e.path.intersection=function(e,t){return m(e,t)},e.path.intersectionNumber=function(e,t){return m(e,t,1)},e.path.isPointInside=function(e,t,r){var n=b(e);return h(n,t,r)&&m(e,[["M",t,r],["H",n.x2+10]],1)%2==1},e.path.getBBox=b,e.path.get=X,e.path.toRelative=function(t){var r=i(t),n=String.prototype.toLowerCase;if(r.rel)return a(r.rel);e.is(t,"array")&&e.is(t&&t[0],"array")||(t=e.parsePathString(t));var o=[],l=0,u=0,c=0,f=0,h=0;"M"==t[0][0]&&(c=l=t[0][1],f=u=t[0][2],h++,o.push(["M",l,u]));for(var p=h,d=t.length;d>p;p++){var g=o[p]=[],v=t[p];if(v[0]!=n.call(v[0]))switch(g[0]=n.call(v[0]),g[0]){case"a":g[1]=v[1],g[2]=v[2],g[3]=v[3],g[4]=v[4],g[5]=v[5],g[6]=+(v[6]-l).toFixed(3),g[7]=+(v[7]-u).toFixed(3);break;case"v":g[1]=+(v[1]-u).toFixed(3);break;case"m":c=v[1],f=v[2];default:for(var y=1,m=v.length;m>y;y++)g[y]=+(v[y]-(y%2?l:u)).toFixed(3)}else{g=o[p]=[],"m"==v[0]&&(c=v[1]+l,f=v[2]+u);for(var b=0,x=v.length;x>b;b++)o[p][b]=v[b]}var w=o[p].length;switch(o[p][0]){case"z":l=c,u=f;break;case"h":l+=+o[p][w-1];break;case"v":u+=+o[p][w-1];break;default:l+=+o[p][w-2],u+=+o[p][w-1]}}return o.toString=s,r.rel=a(o),o},e.path.toAbsolute=k,e.path.toCubic=A,e.path.map=function(e,t){if(!t)return e;var r,n,i,o,s,a,l;for(i=0,s=(e=A(e)).length;s>i;i++)for(o=1,a=(l=e[i]).length;a>o;o+=2)r=t.x(l[o],l[o+1]),n=t.y(l[o],l[o+1]),l[o]=r,l[o+1]=n;return e},e.path.toString=s,e.path.clone=a})),n.plugin((function(e,n,i,o){var s=Math.max,a=Math.min,l=function(e){if(this.items=[],this.bindings={},this.length=0,this.type="set",e)for(var t=0,r=e.length;r>t;t++)e[t]&&(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},u=l.prototype;u.push=function(){for(var e,t,r=0,n=arguments.length;n>r;r++)(e=arguments[r])&&(this[t=this.items.length]=this.items[t]=e,this.length++);return this},u.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},u.forEach=function(e,t){for(var r=0,n=this.items.length;n>r;r++)if(!1===e.call(t,this.items[r],r))return this;return this},u.animate=function(n,i,o,s){"function"!=typeof o||o.length||(s=o,o=r.linear),n instanceof e._.Animation&&(s=n.callback,o=n.easing,i=o.dur,n=n.attr);var a=arguments;if(e.is(n,"array")&&e.is(a[a.length-1],"array"))var l=!0;var u,c=function(){u?this.b=u:u=this.b},f=0,h=this,p=s&&function(){++f==h.length&&s.call(this)};return this.forEach((function(e,r){t.once("snap.animcreated."+e.id,c),l?a[r]&&e.animate.apply(e,a[r]):e.animate(n,i,o,p)}))},u.remove=function(){for(;this.length;)this.pop().remove();return this},u.bind=function(e,t,r){var n={};if("function"==typeof t)this.bindings[e]=t;else{var i=r||e;this.bindings[e]=function(e){n[i]=e,t.attr(n)}}return this},u.attr=function(e){var t={};for(var r in e)this.bindings[r]?this.bindings[r](e[r]):t[r]=e[r];for(var n=0,i=this.items.length;i>n;n++)this.items[n].attr(t);return this},u.clear=function(){for(;this.length;)this.pop()},u.splice=function(e,t,r){e=0>e?s(this.length+e,0):e,t=s(0,a(this.length-e,t));var n,i=[],o=[],u=[];for(n=2;n<arguments.length;n++)u.push(arguments[n]);for(n=0;t>n;n++)o.push(this[e+n]);for(;n<this.length-e;n++)i.push(this[e+n]);var c=u.length;for(n=0;n<c+i.length;n++)this.items[e+n]=this[e+n]=c>n?u[n]:i[n-c];for(n=this.items.length=this.length-=t-c;this[n];)delete this[n++];return new l(o)},u.exclude=function(e){for(var t=0,r=this.length;r>t;t++)if(this[t]==e)return this.splice(t,1),!0;return!1},u.insertAfter=function(e){for(var t=this.items.length;t--;)this.items[t].insertAfter(e);return this},u.getBBox=function(){for(var e=[],t=[],r=[],n=[],i=this.items.length;i--;)if(!this.items[i].removed){var o=this.items[i].getBBox();e.push(o.x),t.push(o.y),r.push(o.x+o.width),n.push(o.y+o.height)}return{x:e=a.apply(0,e),y:t=a.apply(0,t),x2:r=s.apply(0,r),y2:n=s.apply(0,n),width:r-e,height:n-t,cx:e+(r-e)/2,cy:t+(n-t)/2}},u.clone=function(e){e=new l;for(var t=0,r=this.items.length;r>t;t++)e.push(this.items[t].clone());return e},u.toString=function(){return"Snap‘s set"},u.type="set",e.Set=l,e.set=function(){var e=new l;return arguments.length&&e.push.apply(e,Array.prototype.slice.call(arguments,0)),e}})),n.plugin((function(e,r,n,i){function o(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return 4==e.length?[t,0,e[2],e[3]]:[t,0];case"s":return 5==e.length?[t,1,1,e[3],e[4]]:3==e.length?[t,1,1]:[t,1]}}function s(t,r,n){t=t||new e.Matrix,r=r||new e.Matrix,t=e.parseTransformString(t.toTransformString())||[],r=e.parseTransformString(r.toTransformString())||[];for(var i,s,a,l,u=Math.max(t.length,r.length),c=[],p=[],d=0;u>d;d++){if(a=t[d]||o(r[d]),l=r[d]||o(a),a[0]!=l[0]||"r"==a[0].toLowerCase()&&(a[2]!=l[2]||a[3]!=l[3])||"s"==a[0].toLowerCase()&&(a[3]!=l[3]||a[4]!=l[4])){t=e._.transform2matrix(t,n()),r=e._.transform2matrix(r,n()),c=[["m",t.a,t.b,t.c,t.d,t.e,t.f]],p=[["m",r.a,r.b,r.c,r.d,r.e,r.f]];break}for(c[d]=[],p[d]=[],i=0,s=Math.max(a.length,l.length);s>i;i++)i in a&&(c[d][i]=a[i]),i in l&&(p[d][i]=l[i])}return{from:h(c),to:h(p),f:f(c)}}function a(e){return e}function l(e){return function(t){return+t.toFixed(3)+e}}function u(e){return e.join(" ")}function c(t){return e.rgb(t[0],t[1],t[2],t[3])}function f(e){var t,r,n,i,o,s,a=0,l=[];for(t=0,r=e.length;r>t;t++){for(o="[",s=['"'+e[t][0]+'"'],n=1,i=e[t].length;i>n;n++)s[n]="val["+a+++"]";o+=s+"]",l[t]=o}return Function("val","return Snap.path.toString.call(["+l+"])")}function h(e){for(var t=[],r=0,n=e.length;n>r;r++)for(var i=1,o=e[r].length;o>i;i++)t.push(e[r][i]);return t}function p(e){return isFinite(e)}var d={},g=/[%a-z]+$/i,v=String;d.stroke=d.fill="colour",r.prototype.equal=function(e,r){return t("snap.util.equal",this,e,r).firstDefined()},t.on("snap.util.equal",(function(t,r){var n,i,o=v(this.attr(t)||""),y=this;if("colour"==d[t])return n=e.color(o),i=e.color(r),{from:[n.r,n.g,n.b,n.opacity],to:[i.r,i.g,i.b,i.opacity],f:c};if("viewBox"==t)return{from:n=this.attr(t).vb.split(" ").map(Number),to:i=r.split(" ").map(Number),f:u};if("transform"==t||"gradientTransform"==t||"patternTransform"==t)return"string"==typeof r&&(r=v(r).replace(/\.{3}|\u2026/g,o)),s(o=this.matrix,r=e._.rgTransform.test(r)?e._.transform2matrix(r,this.getBBox()):e._.transform2matrix(e._.svgTransform2string(r),this.getBBox()),(function(){return y.getBBox(1)}));if("d"==t||"path"==t)return{from:h((n=e.path.toCubic(o,r))[0]),to:h(n[1]),f:f(n[0])};if("points"==t)return{from:n=v(o).split(e._.separator),to:i=v(r).split(e._.separator),f:function(e){return e}};if(p(o)&&p(r))return{from:parseFloat(o),to:parseFloat(r),f:a};var m=o.match(g),b=v(r).match(g);return m&&function(t,r){return!(!e.is(t,"array")||!e.is(r,"array"))&&t.toString()==r.toString()}(m,b)?{from:parseFloat(o),to:parseFloat(r),f:l(m)}:{from:this.asPX(t),to:this.asPX(t,r),f:a}}))})),n.plugin((function(e,r,n,i){for(var o=r.prototype,s=("createTouch"in i.doc),a=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],l={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},u=function(e,t){var r="y"==e?"scrollTop":"scrollLeft",n=t&&t.node?t.node.ownerDocument:i.doc;return n[r in n.documentElement?"documentElement":"body"][r]},c=function(){return this.originalEvent.preventDefault()},f=function(){return this.originalEvent.stopPropagation()},h=function(e,t,r,n){var i=s&&l[t]?l[t]:t,o=function(i){var o=u("y",n),a=u("x",n);if(s&&l.hasOwnProperty(t))for(var h=0,p=i.targetTouches&&i.targetTouches.length;p>h;h++)if(i.targetTouches[h].target==e||e.contains(i.targetTouches[h].target)){var d=i;(i=i.targetTouches[h]).originalEvent=d,i.preventDefault=c,i.stopPropagation=f;break}var g=i.clientX+a,v=i.clientY+o;return r.call(n,i,g,v)};return t!==i&&e.addEventListener(t,o,!1),e.addEventListener(i,o,!1),function(){return t!==i&&e.removeEventListener(t,o,!1),e.removeEventListener(i,o,!1),!0}},p=[],d=function(e){for(var r,n=e.clientX,i=e.clientY,o=u("y"),a=u("x"),l=p.length;l--;){if(r=p[l],s){for(var c,f=e.touches&&e.touches.length;f--;)if((c=e.touches[f]).identifier==r.el._drag.id||r.el.node.contains(c.target)){n=c.clientX,i=c.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var h=r.el.node;h.nextSibling,h.parentNode,h.style.display,n+=a,i+=o,t("snap.drag.move."+r.el.id,r.move_scope||r.el,n-r.el._drag.x,i-r.el._drag.y,n,i,e)}},v=function(r){e.unmousemove(d).unmouseup(v);for(var n,i=p.length;i--;)(n=p[i]).el._drag={},t("snap.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,r),t.off("snap.drag.*."+n.el.id);p=[]},y=a.length;y--;)!function(t){e[t]=o[t]=function(r,n){if(e.is(r,"function"))this.events=this.events||[],this.events.push({name:t,f:r,unbind:h(this.node||document,t,r,n||this)});else for(var i=0,o=this.events.length;o>i;i++)if(this.events[i].name==t)try{this.events[i].f.call(this)}catch(g){}return this},e["un"+t]=o["un"+t]=function(e){for(var r=this.events||[],n=r.length;n--;)if(r[n].name==t&&(r[n].f==e||!e))return r[n].unbind(),r.splice(n,1),!r.length&&delete this.events,this;return this}}(a[y]);o.hover=function(e,t,r,n){return this.mouseover(e,r).mouseout(t,n||r)},o.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var m=[];o.drag=function(r,n,i,o,s,a){function l(l,u,c){(l.originalEvent||l).preventDefault(),f._drag.x=u,f._drag.y=c,f._drag.id=l.identifier,!p.length&&e.mousemove(d).mouseup(v),p.push({el:f,move_scope:o,start_scope:s,end_scope:a}),n&&t.on("snap.drag.start."+f.id,n),r&&t.on("snap.drag.move."+f.id,r),i&&t.on("snap.drag.end."+f.id,i),t("snap.drag.start."+f.id,s||o||f,u,c,l)}function u(e,r,n){t("snap.draginit."+f.id,f,e,r,n)}var c,f=this;return arguments.length?(t.on("snap.draginit."+f.id,l),f._drag={},m.push({el:f,start:l,init:u}),f.mousedown(u),f):f.drag((function(e,t){this.attr({transform:c+(c?"T":"t")+[e,t]})}),(function(){c=this.transform().local}))},o.undrag=function(){for(var r=m.length;r--;)m[r].el==this&&(this.unmousedown(m[r].init),m.splice(r,1),t.unbind("snap.drag.*."+this.id),t.unbind("snap.draginit."+this.id));return!m.length&&e.unmousemove(d).unmouseup(v),this}})),n.plugin((function(e,r,n,i){var o=(r.prototype,n.prototype),s=/^\s*url\((.+)\)/,a=String,l=e._.$;e.filter={},o.filter=function(t){var n=this;"svg"!=n.type&&(n=n.paper);var i=e.parse(a(t)),o=e._.id(),s=(n.node.offsetWidth,n.node.offsetHeight,l("filter"));return l(s,{id:o,filterUnits:"userSpaceOnUse"}),s.appendChild(i.node),n.defs.appendChild(s),new r(s)},t.on("snap.util.getattr.filter",(function(){t.stop();var r=l(this.node,"filter");if(r){var n=a(r).match(s);return n&&e.select(n[1])}})),t.on("snap.util.attr.filter",(function(n){if(n instanceof r&&"filter"==n.type){t.stop();var i=n.node.id;i||(l(n.node,{id:n.id}),i=n.id),l(this.node,{filter:e.url(i)})}n&&"none"!=n||(t.stop(),this.node.removeAttribute("filter"))})),e.filter.blur=function(t,r){null==t&&(t=2);var n=null==r?t:[t,r];return e.format('<feGaussianBlur stdDeviation="{def}"/>',{def:n})},e.filter.blur.toString=function(){return this()},e.filter.shadow=function(t,r,n,i,o){return null==o&&(null==i?(o=n,n=4,i="#000"):(o=i,i=n,n=4)),null==n&&(n=4),null==o&&(o=1),null==t&&(t=0,r=2),null==r&&(r=t),i=e.color(i),e.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:i,dx:t,dy:r,blur:n,opacity:o})},e.filter.shadow.toString=function(){return this()},e.filter.grayscale=function(t){return null==t&&(t=1),e.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-t),b:.7152-.7152*(1-t),c:.0722-.0722*(1-t),d:.2126-.2126*(1-t),e:.7152+.2848*(1-t),f:.0722-.0722*(1-t),g:.2126-.2126*(1-t),h:.0722+.9278*(1-t)})},e.filter.grayscale.toString=function(){return this()},e.filter.sepia=function(t){return null==t&&(t=1),e.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-t),b:.769-.769*(1-t),c:.189-.189*(1-t),d:.349-.349*(1-t),e:.686+.314*(1-t),f:.168-.168*(1-t),g:.272-.272*(1-t),h:.534-.534*(1-t),i:.131+.869*(1-t)})},e.filter.sepia.toString=function(){return this()},e.filter.saturate=function(t){return null==t&&(t=1),e.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-t})},e.filter.saturate.toString=function(){return this()},e.filter.hueRotate=function(t){return t=t||0,e.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:t})},e.filter.hueRotate.toString=function(){return this()},e.filter.invert=function(t){return null==t&&(t=1),e.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:t,amount2:1-t})},e.filter.invert.toString=function(){return this()},e.filter.brightness=function(t){return null==t&&(t=1),e.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:t})},e.filter.brightness.toString=function(){return this()},e.filter.contrast=function(t){return null==t&&(t=1),e.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:t,amount2:.5-t/2})},e.filter.contrast.toString=function(){return this()}})),n.plugin((function(e,t,r,n,i){var o=e._.box,s=e.is,a=/^[^a-z]*([tbmlrc])/i,l=function(){return"T"+this.dx+","+this.dy};t.prototype.getAlign=function(e,t){null==t&&s(e,"string")&&(t=e,e=null);var r=(e=e||this.paper).getBBox?e.getBBox():o(e),n=this.getBBox(),i={};switch(t=(t=t&&t.match(a))?t[1].toLowerCase():"c"){case"t":i.dx=0,i.dy=r.y-n.y;break;case"b":i.dx=0,i.dy=r.y2-n.y2;break;case"m":i.dx=0,i.dy=r.cy-n.cy;break;case"l":i.dx=r.x-n.x,i.dy=0;break;case"r":i.dx=r.x2-n.x2,i.dy=0;break;default:i.dx=r.cx-n.cx,i.dy=0}return i.toString=l,i},t.prototype.align=function(e,t){return this.transform("..."+this.getAlign(e,t))}})),n.plugin((function(t,r,n,i){function o(e){e=e.split(/(?=#)/);var t=new String(e[5]);return t[50]=e[0],t[100]=e[1],t[200]=e[2],t[300]=e[3],t[400]=e[4],t[500]=e[5],t[600]=e[6],t[700]=e[7],t[800]=e[8],t[900]=e[9],e[10]&&(t.A100=e[10],t.A200=e[11],t.A400=e[12],t.A700=e[13]),t}t.mui={},t.flat={},t.mui.red=o("#ffebee#ffcdd2#ef9a9a#e57373#ef5350#f44336#e53935#d32f2f#c62828#b71c1c#ff8a80#ff5252#ff1744#d50000"),t.mui.pink=o("#FCE4EC#F8BBD0#F48FB1#F06292#EC407A#E91E63#D81B60#C2185B#AD1457#880E4F#FF80AB#FF4081#F50057#C51162"),t.mui.purple=o("#F3E5F5#E1BEE7#CE93D8#BA68C8#AB47BC#9C27B0#8E24AA#7B1FA2#6A1B9A#4A148C#EA80FC#E040FB#D500F9#AA00FF"),t.mui.deeppurple=o("#EDE7F6#D1C4E9#B39DDB#9575CD#7E57C2#673AB7#5E35B1#512DA8#4527A0#311B92#B388FF#7C4DFF#651FFF#6200EA"),t.mui.indigo=o("#E8EAF6#C5CAE9#9FA8DA#7986CB#5C6BC0#3F51B5#3949AB#303F9F#283593#1A237E#8C9EFF#536DFE#3D5AFE#304FFE"),t.mui.blue=o("#E3F2FD#BBDEFB#90CAF9#64B5F6#64B5F6#2196F3#1E88E5#1976D2#1565C0#0D47A1#82B1FF#448AFF#2979FF#2962FF"),t.mui.lightblue=o("#E1F5FE#B3E5FC#81D4FA#4FC3F7#29B6F6#03A9F4#039BE5#0288D1#0277BD#01579B#80D8FF#40C4FF#00B0FF#0091EA"),t.mui.cyan=o("#E0F7FA#B2EBF2#80DEEA#4DD0E1#26C6DA#00BCD4#00ACC1#0097A7#00838F#006064#84FFFF#18FFFF#00E5FF#00B8D4"),t.mui.teal=o("#E0F2F1#B2DFDB#80CBC4#4DB6AC#26A69A#009688#00897B#00796B#00695C#004D40#A7FFEB#64FFDA#1DE9B6#00BFA5"),t.mui.green=o("#E8F5E9#C8E6C9#A5D6A7#81C784#66BB6A#4CAF50#43A047#388E3C#2E7D32#1B5E20#B9F6CA#69F0AE#00E676#00C853"),t.mui.lightgreen=o("#F1F8E9#DCEDC8#C5E1A5#AED581#9CCC65#8BC34A#7CB342#689F38#558B2F#33691E#CCFF90#B2FF59#76FF03#64DD17"),t.mui.lime=o("#F9FBE7#F0F4C3#E6EE9C#DCE775#D4E157#CDDC39#C0CA33#AFB42B#9E9D24#827717#F4FF81#EEFF41#C6FF00#AEEA00"),t.mui.yellow=o("#FFFDE7#FFF9C4#FFF59D#FFF176#FFEE58#FFEB3B#FDD835#FBC02D#F9A825#F57F17#FFFF8D#FFFF00#FFEA00#FFD600"),t.mui.amber=o("#FFF8E1#FFECB3#FFE082#FFD54F#FFCA28#FFC107#FFB300#FFA000#FF8F00#FF6F00#FFE57F#FFD740#FFC400#FFAB00"),t.mui.orange=o("#FFF3E0#FFE0B2#FFCC80#FFB74D#FFA726#FF9800#FB8C00#F57C00#EF6C00#E65100#FFD180#FFAB40#FF9100#FF6D00"),t.mui.deeporange=o("#FBE9E7#FFCCBC#FFAB91#FF8A65#FF7043#FF5722#F4511E#E64A19#D84315#BF360C#FF9E80#FF6E40#FF3D00#DD2C00"),t.mui.brown=o("#EFEBE9#D7CCC8#BCAAA4#A1887F#8D6E63#795548#6D4C41#5D4037#4E342E#3E2723"),t.mui.grey=o("#FAFAFA#F5F5F5#EEEEEE#E0E0E0#BDBDBD#9E9E9E#757575#616161#424242#212121"),t.mui.bluegrey=o("#ECEFF1#CFD8DC#B0BEC5#90A4AE#78909C#607D8B#546E7A#455A64#37474F#263238"),t.flat.turquoise="#1abc9c",t.flat.greensea="#16a085",t.flat.sunflower="#f1c40f",t.flat.orange="#f39c12",t.flat.emerland="#2ecc71",t.flat.nephritis="#27ae60",t.flat.carrot="#e67e22",t.flat.pumpkin="#d35400",t.flat.peterriver="#3498db",t.flat.belizehole="#2980b9",t.flat.alizarin="#e74c3c",t.flat.pomegranate="#c0392b",t.flat.amethyst="#9b59b6",t.flat.wisteria="#8e44ad",t.flat.clouds="#ecf0f1",t.flat.silver="#bdc3c7",t.flat.wetasphalt="#34495e",t.flat.midnightblue="#2c3e50",t.flat.concrete="#95a5a6",t.flat.asbestos="#7f8c8d",t.importMUIColors=function(){for(var r in t.mui)t.mui.hasOwnProperty(r)&&(e[r]=t.mui[r])}})),n})),function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.rdfstore=e()}}((function(){return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);throw Error("Cannot find module '"+s+"'")}l=r[s]={exports:{}},t[s][0].call(l.exports,(function(e){var r=t[s][1][e];return i(r||e)}),l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){!function(){function e(e){this.message=e}var t=void 0!==r?r:this;e.prototype=Error(),e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var r,n,i=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";t.charAt(0|i)||(o="=",i%1);s+=o.charAt(63&r>>8-i%1*8)){if(255<(n=t.charCodeAt(i+=.75)))throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|n}return s}),t.atob||(t.atob=function(t){if(1==(t=t.replace(/=+$/,"")).length%4)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,o=0,s="";n=t.charAt(o++);~n&&(r=i%4?64*r+n:n,i++%4)?s+=String.fromCharCode(255&r>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s})}()},{}],2:[function(e,t,r){!function(e){function t(e){return 43===(e=e.charCodeAt(0))?62:47===e?63:48>e?-1:58>e?e-48+52:91>e?e-65:123>e?e-97+26:void 0}var r="undefined"!=typeof Uint8Array?Uint8Array:Array;e.toByteArray=function(e){function n(e){l[u++]=e}var i,o,s,a,l;if(0<e.length%4)throw Error("Invalid string. Length must be a multiple of 4");i=e.length,a="="===e.charAt(i-2)?2:"="===e.charAt(i-1)?1:0,l=new r(3*e.length/4-a),o=0<a?e.length-4:e.length;var u=0;for(i=0;i<o;i+=4)n((16711680&(s=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),n((65280&s)>>8),n(255&s);return 2===a?n(255&(s=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===a&&(n((s=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),n(255&s)),l},e.fromByteArray=function(e){var t,r,n,i=e.length%3,o="";for(t=0,n=e.length-i;t<n;t+=3)r=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o+=r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&r);switch(i){case 1:r=e[e.length-1],o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>2),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r<<4&63),o+="==";break;case 2:r=(e[e.length-2]<<8)+e[e.length-1],o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>10),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>4&63),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r<<2&63),o+="="}return o}}(void 0===r?this.base64js={}:r)},{}],3:[function(e,t,r){(function(r,n){(function(){function i(e){return"function"==typeof e}function o(){return function(){b(a)}}function s(){return function(){setTimeout(a,1)}}function a(){for(var e=0;e<C;e+=2)(0,L[e])(L[e+1]),L[e]=void 0,L[e+1]=void 0;C=0}function l(){}function u(e,t){if(e===t)h(e,new TypeError("You cannot resolve a promise with itself"));else if("function"==typeof t||"object"==typeof t&&null!==t)if(t.constructor===e.constructor)!function(e,t){1===t._state?f(e,t._result):2===t._state?h(e,t._result):p(t,void 0,(function(t){u(e,t)}),(function(t){h(e,t)}))}(e,t);else{var r;try{r=t.then}catch(n){T.error=n,r=T}r===T?h(e,T.error):void 0===r?f(e,t):i(r)?function(e,t,r){S((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}(r,t,(function(r){n||(n=!0,t!==r?u(e,r):f(e,r))}),(function(t){n||(n=!0,h(e,t))}),e._label);!n&&i&&(n=!0,h(e,i))}),e)}(e,t,r):f(e,t)}else f(e,t)}function c(e){e._onerror&&e._onerror(e._result),d(e)}function f(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&S(d,e))}function h(e,t){void 0===e._state&&(e._state=2,e._result=t,S(c,e))}function p(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=r,i[o+2]=n,0===o&&e._state&&S(d,e)}function d(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,i,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?v(r,n,i,o):i(o);e._subscribers.length=0}}function g(){this.error=null}function v(e,t,r,n){var o,s,a,l,c=i(r);if(c){try{o=r(n)}catch(S){N.error=S,o=N}if(o===N?(l=!0,s=o.error,o=null):a=!0,t===o)return void h(t,new TypeError("A promises callback cannot return that same promise."))}else o=n,a=!0;void 0===t._state&&(c&&a?u(t,o):l?h(t,s):1===e?f(t,o):2===e&&h(t,o))}function y(e,t){this._instanceConstructor=e,this.promise=new e(l),this._validateInput(t)?(this._input=t,this._remaining=this.length=t.length,this._init(),0===this.length?f(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&f(this.promise,this._result))):h(this.promise,this._validationError())}function m(e){if(this._id=M++,this._result=this._state=void 0,this._subscribers=[],l!==e){if(!i(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof m))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");!function(e,t){try{t((function(t){u(e,t)}),(function(t){h(e,t)}))}catch(r){h(e,r)}}(this,e)}}var b,x,w,k=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},C=0,S=function(e,t){L[C]=e,L[C+1]=t,2===(C+=2)&&(x?x(a):w())},F="undefined"!=typeof window?window:void 0,_=(A=F||{}).MutationObserver||A.WebKitMutationObserver,A=void 0!==r&&"[object process]"==={}.toString.call(r),E="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,L=Array(1e3);w=A?function(){var e=r.nextTick,t=r.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&"0"===t[1]&&"10"===t[2]&&(e=setImmediate),function(){e(a)}}():_?function(){var e=0,t=new _(a),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}():E?function(){var e=new MessageChannel;return e.port1.onmessage=a,function(){e.port2.postMessage(0)}}():void 0===F&&"function"==typeof e?function(){try{var t=e("vertx");return b=t.runOnLoop||t.runOnContext,o()}catch(r){return s()}}():s();var T=new g,N=new g;y.prototype._validateInput=function(e){return k(e)},y.prototype._validationError=function(){return Error("Array Methods must be provided an Array")},y.prototype._init=function(){this._result=Array(this.length)},y.prototype._enumerate=function(){for(var e=this.length,t=this.promise,r=this._input,n=0;void 0===t._state&&n<e;n++)this._eachEntry(r[n],n)},y.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;"object"==typeof e&&null!==e?e.constructor===r&&void 0!==e._state?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=e)},y.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?h(n,r):this._result[t]=r),0===this._remaining&&f(n,this._result)},y.prototype._willSettleAt=function(e,t){var r=this;p(e,void 0,(function(e){r._settledAt(1,t,e)}),(function(e){r._settledAt(2,t,e)}))};var M=0;m.all=function(e){return new y(this,e).promise},m.race=function(e){function t(e){u(n,e)}function r(e){h(n,e)}var n=new this(l);if(!k(e))return h(n,new TypeError("You must pass an array to race.")),n;for(var i=e.length,o=0;void 0===n._state&&o<i;o++)p(this.resolve(e[o]),void 0,t,r);return n},m.resolve=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(l);return u(t,e),t},m.reject=function(e){var t=new this(l);return h(t,e),t},m._setScheduler=function(e){x=e},m._setAsap=function(e){S=e},m._asap=S,m.prototype={constructor:m,then:function(e,t){var r=this._state;if(1===r&&!e||2===r&&!t)return this;var n=new this.constructor(l),i=this._result;if(r){var o=arguments[r-1];S((function(){v(r,n,o,i)}))}else p(this,n,e,t);return n},catch:function(e){return this.then(null,e)}},A={Promise:m,polyfill:F=function(){var e;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(o){throw Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=m)}},void 0!==t&&t.exports?t.exports=A:void 0!==this&&(this.ES6Promise=A),F()}).call(this)}).call(this,e("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"7YKIPe":10}],4:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(void 0===(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(t=arguments.length,n=Array(t-1),s=1;s<t;s++)n[s-1]=arguments[s];r.apply(this,n)}else if(o(r)){for(t=arguments.length,n=Array(t-1),s=1;s<t;s++)n[s-1]=arguments[s];for(t=(r=r.slice()).length,s=0;s<t;s++)r[s].apply(this,n)}return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=void 0!==this._maxListeners?this._maxListeners:n.defaultMaxListeners)&&0<r&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(;0<s--;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(t=this._events[e]))this.removeListener(e,t);else for(;t.length;)this.removeListener(e,t[t.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){return e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],5:[function(e,t,r){},{}],6:[function(e,t,r){function n(e,t,r){if(!(this instanceof n))return new n(e,t,r);var i,o,s=typeof e;if("base64"===t&&"string"===s)for(e=e.trim?e.trim():e.replace(/^\s+|\s+$/g,"");0!=e.length%4;)e+="=";if("number"===s)i=m(e);else if("string"===s)i=n.byteLength(e,t);else{if("object"!==s)throw Error("First argument needs to be a number, array or string.");i=m(e.length)}if(n._useTypedArrays?o=n._augment(new Uint8Array(i)):((o=this).length=i,o._isBuffer=!0),n._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else{var a=e;if(b(a)||n.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length)for(t=0;t<i;t++)n.isBuffer(e)?o[t]=e.readUInt8(t):o[t]=e[t];else if("string"===s)o.write(e,0,t);else if("number"===s&&!n._useTypedArrays&&!r)for(t=0;t<i;t++)o[t]=0}return o}function i(e,t,r){var n="";for(r=Math.min(e.length,r);t<r;t++)n+=String.fromCharCode(e[t]);return n}function o(e,t,r,n){if(n||(E("boolean"==typeof r,"missing or invalid endian"),E(null!=t,"missing offset"),E(t+1<e.length,"Trying to read beyond buffer length")),!(t>=(n=e.length)))return r?(r=e[t],t+1<n&&(r|=e[t+1]<<8)):(r=e[t]<<8,t+1<n&&(r|=e[t+1])),r}function s(e,t,r,n){var i;if(n||(E("boolean"==typeof r,"missing or invalid endian"),E(null!=t,"missing offset"),E(t+3<e.length,"Trying to read beyond buffer length")),!(t>=(n=e.length)))return r?(t+2<n&&(i=e[t+2]<<16),t+1<n&&(i|=e[t+1]<<8),i|=e[t],t+3<n&&(i+=e[t+3]<<24>>>0)):(t+1<n&&(i=e[t+1]<<16),t+2<n&&(i|=e[t+2]<<8),t+3<n&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function a(e,t,r,n){if(n||(E("boolean"==typeof r,"missing or invalid endian"),E(null!=t,"missing offset"),E(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length))return 32768&(e=o(e,t,r,!0))?-1*(65535-e+1):e}function l(e,t,r,n){if(n||(E("boolean"==typeof r,"missing or invalid endian"),E(null!=t,"missing offset"),E(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length))return 2147483648&(e=s(e,t,r,!0))?-1*(4294967295-e+1):e}function u(e,t,r,n){return n||(E("boolean"==typeof r,"missing or invalid endian"),E(t+3<e.length,"Trying to read beyond buffer length")),T.read(e,t,r,23,4)}function c(e,t,r,n){return n||(E("boolean"==typeof r,"missing or invalid endian"),E(t+7<e.length,"Trying to read beyond buffer length")),T.read(e,t,r,52,8)}function f(e,t,r,n,i){i||(E(null!=t,"missing value"),E("boolean"==typeof n,"missing or invalid endian"),E(null!=r,"missing offset"),E(r+1<e.length,"trying to write beyond buffer length"),F(t,65535));var o=e.length;if(!(r>=o))for(i=0,o=Math.min(o-r,2);i<o;i++)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function h(e,t,r,n,i){i||(E(null!=t,"missing value"),E("boolean"==typeof n,"missing or invalid endian"),E(null!=r,"missing offset"),E(r+3<e.length,"trying to write beyond buffer length"),F(t,4294967295));var o=e.length;if(!(r>=o))for(i=0,o=Math.min(o-r,4);i<o;i++)e[r+i]=t>>>8*(n?i:3-i)&255}function p(e,t,r,n,i){i||(E(null!=t,"missing value"),E("boolean"==typeof n,"missing or invalid endian"),E(null!=r,"missing offset"),E(r+1<e.length,"Trying to write beyond buffer length"),_(t,32767,-32768)),r>=e.length||f(e,0<=t?t:65535+t+1,r,n,i)}function d(e,t,r,n,i){i||(E(null!=t,"missing value"),E("boolean"==typeof n,"missing or invalid endian"),E(null!=r,"missing offset"),E(r+3<e.length,"Trying to write beyond buffer length"),_(t,2147483647,-2147483648)),r>=e.length||h(e,0<=t?t:4294967295+t+1,r,n,i)}function g(e,t,r,n,i){i||(E(null!=t,"missing value"),E("boolean"==typeof n,"missing or invalid endian"),E(null!=r,"missing offset"),E(r+3<e.length,"Trying to write beyond buffer length"),A(t,34028234663852886e22,-34028234663852886e22)),r>=e.length||T.write(e,t,r,n,23,4)}function v(e,t,r,n,i){i||(E(null!=t,"missing value"),E("boolean"==typeof n,"missing or invalid endian"),E(null!=r,"missing offset"),E(r+7<e.length,"Trying to write beyond buffer length"),A(t,17976931348623157e292,-17976931348623157e292)),r>=e.length||T.write(e,t,r,n,52,8)}function y(e,t,r){return"number"!=typeof e?r:(e=~~e)>=t?t:0<=e||0<=(e+=t)?e:0}function m(e){return 0>(e=~~Math.ceil(+e))?0:e}function b(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function x(e){return 16>e?"0"+e.toString(16):e.toString(16)}function w(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);if(127>=n)t.push(e.charCodeAt(r));else{var i=r;for(55296<=n&&57343>=n&&r++,n=encodeURIComponent(e.slice(i,r+1)).substr(1).split("%"),i=0;i<n.length;i++)t.push(parseInt(n[i],16))}}return t}function k(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t}function C(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);i++)t[i+r]=e[i];return i}function S(e){try{return decodeURIComponent(e)}catch(a){return String.fromCharCode(65533)}}function F(e,t){E("number"==typeof e,"cannot write a non-number as a number"),E(0<=e,"specified a negative value for writing an unsigned value"),E(e<=t,"value is larger than maximum value for type"),E(Math.floor(e)===e,"value has a fractional component")}function _(e,t,r){E("number"==typeof e,"cannot write a non-number as a number"),E(e<=t,"value larger than maximum allowed value"),E(e>=r,"value smaller than minimum allowed value"),E(Math.floor(e)===e,"value has a fractional component")}function A(e,t,r){E("number"==typeof e,"cannot write a non-number as a number"),E(e<=t,"value larger than maximum allowed value"),E(e>=r,"value smaller than minimum allowed value")}function E(e,t){if(!e)throw Error(t||"Failed assertion")}var L=e("base64-js"),T=e("ieee754");r.Buffer=n,r.SlowBuffer=n,r.INSPECT_MAX_BYTES=50,n.poolSize=8192,n._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(s){return!1}}(),n.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.isBuffer=function(e){return!(null==e||!e._isBuffer)},n.byteLength=function(e,t){var r;switch(e+="",t||"utf8"){case"hex":r=e.length/2;break;case"utf8":case"utf-8":r=w(e).length;break;case"ascii":case"binary":case"raw":r=e.length;break;case"base64":r=L.toByteArray(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*e.length;break;default:throw Error("Unknown encoding")}return r},n.concat=function(e,t){if(E(b(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new n(0);if(1===e.length)return e[0];var r;if("number"!=typeof t)for(r=t=0;r<e.length;r++)t+=e[r].length;var i=new n(t),o=0;for(r=0;r<e.length;r++){var s=e[r];s.copy(i,o),o+=s.length}return i},n.prototype.write=function(e,t,r,i){if(isFinite(t))isFinite(r)||(i=r,r=void 0);else{var o=i;i=t,t=r,r=o}switch(t=Number(t)||0,o=this.length-t,r?(r=Number(r))>o&&(r=o):r=o,i=String(i||"utf8").toLowerCase()){case"hex":for(t=Number(t)||0,i=this.length-t,r?(r=Number(r))>i&&(r=i):r=i,E(0==(i=e.length)%2,"Invalid hex string"),r>i/2&&(r=i/2),i=0;i<r;i++)o=parseInt(e.substr(2*i,2),16),E(!isNaN(o),"Invalid hex string"),this[t+i]=o;n._charsWritten=2*i,e=i;break;case"utf8":case"utf-8":e=n._charsWritten=C(w(e),this,t,r);break;case"ascii":case"binary":e=n._charsWritten=C(k(e),this,t,r);break;case"base64":e=n._charsWritten=C(L.toByteArray(e),this,t,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=[];for(var s,a=0;a<e.length;a++)i=(s=e.charCodeAt(a))>>8,s%=256,o.push(s),o.push(i);e=n._charsWritten=C(o,this,t,r);break;default:throw Error("Unknown encoding")}return e},n.prototype.toString=function(e,t,r){if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(r=void 0!==r?Number(r):r=this.length)===t)return"";switch(e){case"hex":for(e=this.length,(!t||0>t)&&(t=0),(!r||0>r||r>e)&&(r=e),e="";t<r;t++)e+=x(this[t]);r=e;break;case"utf8":case"utf-8":var n=e="";for(r=Math.min(this.length,r);t<r;t++)127>=this[t]?(e+=S(n)+String.fromCharCode(this[t]),n=""):n+="%"+this[t].toString(16);r=e+S(n);break;case"ascii":case"binary":r=i(this,t,r);break;case"base64":r=0===t&&r===this.length?L.fromByteArray(this):L.fromByteArray(this.slice(t,r));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(r=this.slice(t,r),t="",e=0;e<r.length;e+=2)t+=String.fromCharCode(r[e]+256*r[e+1]);r=t;break;default:throw Error("Unknown encoding")}return r},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t||(t=0),i!==r&&0!==e.length&&0!==this.length)if(E(i>=r,"sourceEnd < sourceStart"),E(0<=t&&t<e.length,"targetStart out of bounds"),E(0<=r&&r<this.length,"sourceStart out of bounds"),E(0<=i&&i<=this.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r),100>(i-=r)||!n._useTypedArrays)for(var o=0;o<i;o++)e[o+t]=this[o+r];else e._set(this.subarray(r,r+i),t)},n.prototype.slice=function(e,t){if(e=y(e,r=this.length,0),t=y(t,r,r),n._useTypedArrays)return n._augment(this.subarray(e,t));for(var r,i=new n(r=t-e,void 0,!0),o=0;o<r;o++)i[o]=this[o+e];return i},n.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},n.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},n.prototype.readUInt8=function(e,t){if(t||(E(null!=e,"missing offset"),E(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},n.prototype.readUInt16LE=function(e,t){return o(this,e,!0,t)},n.prototype.readUInt16BE=function(e,t){return o(this,e,!1,t)},n.prototype.readUInt32LE=function(e,t){return s(this,e,!0,t)},n.prototype.readUInt32BE=function(e,t){return s(this,e,!1,t)},n.prototype.readInt8=function(e,t){if(t||(E(null!=e,"missing offset"),E(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){return a(this,e,!0,t)},n.prototype.readInt16BE=function(e,t){return a(this,e,!1,t)},n.prototype.readInt32LE=function(e,t){return l(this,e,!0,t)},n.prototype.readInt32BE=function(e,t){return l(this,e,!1,t)},n.prototype.readFloatLE=function(e,t){return u(this,e,!0,t)},n.prototype.readFloatBE=function(e,t){return u(this,e,!1,t)},n.prototype.readDoubleLE=function(e,t){return c(this,e,!0,t)},n.prototype.readDoubleBE=function(e,t){return c(this,e,!1,t)},n.prototype.writeUInt8=function(e,t,r){r||(E(null!=e,"missing value"),E(null!=t,"missing offset"),E(t<this.length,"trying to write beyond buffer length"),F(e,255)),t>=this.length||(this[t]=e)},n.prototype.writeUInt16LE=function(e,t,r){f(this,e,t,!0,r)},n.prototype.writeUInt16BE=function(e,t,r){f(this,e,t,!1,r)},n.prototype.writeUInt32LE=function(e,t,r){h(this,e,t,!0,r)},n.prototype.writeUInt32BE=function(e,t,r){h(this,e,t,!1,r)},n.prototype.writeInt8=function(e,t,r){r||(E(null!=e,"missing value"),E(null!=t,"missing offset"),E(t<this.length,"Trying to write beyond buffer length"),_(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,r):this.writeUInt8(255+e+1,t,r))},n.prototype.writeInt16LE=function(e,t,r){p(this,e,t,!0,r)},n.prototype.writeInt16BE=function(e,t,r){p(this,e,t,!1,r)},n.prototype.writeInt32LE=function(e,t,r){d(this,e,t,!0,r)},n.prototype.writeInt32BE=function(e,t,r){d(this,e,t,!1,r)},n.prototype.writeFloatLE=function(e,t,r){g(this,e,t,!0,r)},n.prototype.writeFloatBE=function(e,t,r){g(this,e,t,!1,r)},n.prototype.writeDoubleLE=function(e,t,r){v(this,e,t,!0,r)},n.prototype.writeDoubleBE=function(e,t,r){v(this,e,t,!1,r)},n.prototype.fill=function(e,t,r){if(e||(e=0),t||(t=0),r||(r=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),E("number"==typeof e&&!isNaN(e),"value is not a number"),E(r>=t,"end < start"),r!==t&&0!==this.length)for(E(0<=t&&t<this.length,"start out of bounds"),E(0<=r&&r<=this.length,"end out of bounds");t<r;t++)this[t]=e},n.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=x(this[n]),n===r.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n._useTypedArrays)return new n(this).buffer;for(var e=new Uint8Array(this.length),t=0,r=e.length;t<r;t+=1)e[t]=this[t];return e.buffer}throw Error("Buffer.toArrayBuffer not supported in this browser")};var N=n.prototype;n._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=N.get,e.set=N.set,e.write=N.write,e.toString=N.toString,e.toLocaleString=N.toString,e.toJSON=N.toJSON,e.copy=N.copy,e.slice=N.slice,e.readUInt8=N.readUInt8,e.readUInt16LE=N.readUInt16LE,e.readUInt16BE=N.readUInt16BE,e.readUInt32LE=N.readUInt32LE,e.readUInt32BE=N.readUInt32BE,e.readInt8=N.readInt8,e.readInt16LE=N.readInt16LE,e.readInt16BE=N.readInt16BE,e.readInt32LE=N.readInt32LE,e.readInt32BE=N.readInt32BE,e.readFloatLE=N.readFloatLE,e.readFloatBE=N.readFloatBE,e.readDoubleLE=N.readDoubleLE,e.readDoubleBE=N.readDoubleBE,e.writeUInt8=N.writeUInt8,e.writeUInt16LE=N.writeUInt16LE,e.writeUInt16BE=N.writeUInt16BE,e.writeUInt32LE=N.writeUInt32LE,e.writeUInt32BE=N.writeUInt32BE,e.writeInt8=N.writeInt8,e.writeInt16LE=N.writeInt16LE,e.writeInt16BE=N.writeInt16BE,e.writeInt32LE=N.writeInt32LE,e.writeInt32BE=N.writeInt32BE,e.writeFloatLE=N.writeFloatLE,e.writeFloatBE=N.writeFloatBE,e.writeDoubleLE=N.writeDoubleLE,e.writeDoubleBE=N.writeDoubleBE,e.fill=N.fill,e.inspect=N.inspect,e.toArrayBuffer=N.toArrayBuffer,e}},{"base64-js":2,ieee754:23}],7:[function(e,t,r){var n=t.exports;e("events");var i=e("./lib/request"),o=e("url");n.request=function(e,t){"string"==typeof e&&(e=o.parse(e)),e||(e={}),e.host||e.port||(e.port=parseInt(window.location.port,10)),!e.host&&e.hostname&&(e.host=e.hostname),e.scheme||(e.scheme=window.location.protocol.split(":")[0]),e.host||(e.host=window.location.hostname||window.location.host),/:/.test(e.host)&&(e.port||(e.port=e.host.split(":")[1]),e.host=e.host.split(":")[0]),e.port||(e.port="https"==e.scheme?443:80);var r=new i(new s,e);return t&&r.on("response",t),r},n.get=function(e,t){e.method="GET";var r=n.request(e,t);return r.end(),r},n.Agent=function(){},n.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject)for(var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{var r=new window.ActiveXObject(e[t]);return function(){if(r){var n=r;return r=null,n}return new window.ActiveXObject(e[t])}}catch(n){}throw Error("ajax not supported in this browser")}();n.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":8,events:4,url:36}],8:[function(e,t,r){r=e("stream");var n=e("./response"),i=e("Base64");e=e("inherits");var o=t.exports=function(e,t){var r=this;r.writable=!0,r.xhr=e,r.body=[],r.uri=(t.scheme||"http")+"://"+t.host+(t.port?":"+t.port:"")+(t.path||"/"),void 0===t.withCredentials&&(t.withCredentials=!0);try{e.withCredentials=t.withCredentials}catch(c){}if(e.open(t.method||"GET",r.uri,!0),r._headers={},t.headers)for(var o=s(t.headers),a=0;a<o.length;a++){var l=o[a];r.isSafeRequestHeader(l)&&r.setHeader(l,t.headers[l])}t.auth&&this.setHeader("Authorization","Basic "+i.btoa(t.auth));var u=new n;u.on("close",(function(){r.emit("close")})),u.on("ready",(function(){r.emit("response",u)})),e.onreadystatechange=function(){e.__aborted||u.handle(e)}};e(o,r),o.prototype.setHeader=function(e,t){this._headers[e.toLowerCase()]=t},o.prototype.getHeader=function(e){return this._headers[e.toLowerCase()]},o.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},o.prototype.write=function(e){this.body.push(e)},o.prototype.destroy=function(e){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},o.prototype.end=function(e){void 0!==e&&this.body.push(e);var t=s(this._headers);for(e=0;e<t.length;e++){var r=t[e],n=this._headers[r];if(a(n))for(var i=0;i<n.length;i++)this.xhr.setRequestHeader(r,n[i]);else this.xhr.setRequestHeader(r,n)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else{if(a(this.body[0]))for(t=[],e=0;e<this.body.length;e++)t.push.apply(t,this.body[e]);else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(e=i=0;e<this.body.length;e++)i+=this.body[e].length;for(t=new this.body[0].constructor(i),e=r=0;e<this.body.length;e++)for(n=this.body[e],i=0;i<n.length;i++)t[r++]=n[i]}else for(t="",e=0;e<this.body.length;e++)t+=this.body[e].toString();this.xhr.send(t)}},o.unsafeHeaders="accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "),o.prototype.isSafeRequestHeader=function(e){if(!e)return!1;var t;e:if(t=o.unsafeHeaders,e=e.toLowerCase(),t.indexOf)t=t.indexOf(e);else{for(var r=0;r<t.length;r++)if(t[r]===e){t=r;break e}t=-1}return-1===t};var s=Object.keys||function(e){var t,r=[];for(t in e)r.push(t);return r},a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{"./response":9,Base64:1,inherits:24,stream:15}],9:[function(e,t,r){function n(e){e=e.getAllResponseHeaders().split(/\r?\n/);for(var t={},r=0;r<e.length;r++){var n=e[r];if(""!==n){var i=n.match(/^([^:]+):\s*(.*)/);i?(n=i[1].toLowerCase(),i=i[2],void 0!==t[n]?s(t[n])?t[n].push(i):t[n]=[t[n],i]:t[n]=i):t[n]=!0}}return t}r=e("stream"),e=e("util"),t=t.exports=function(e){this.offset=0,this.readable=!0},e.inherits(t,r);var i=!0,o=!0;t.prototype.getResponse=function(e){var t=String(e.responseType).toLowerCase();return"blob"===t?e.responseBlob||e.response:"arraybuffer"===t?e.response:e.responseText},t.prototype.getHeader=function(e){return this.headers[e.toLowerCase()]},t.prototype.handle=function(e){if(2===e.readyState&&o){try{this.statusCode=e.status,this.headers=n(e)}catch(s){o=!1}o&&this.emit("ready")}else if(i&&3===e.readyState){try{this.statusCode||(this.statusCode=e.status,this.headers=n(e),this.emit("ready"))}catch(s){}try{this._emitData(e)}catch(s){i=!1}}else 4===e.readyState&&(this.statusCode||(this.statusCode=e.status,this.emit("ready")),this._emitData(e),e.error?this.emit("error",this.getResponse(e)):this.emit("end"),this.emit("close"))},t.prototype._emitData=function(e){(e=this.getResponse(e)).toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(e,this.offset)),this.offset=e.byteLength):e.length>this.offset&&(this.emit("data",e.slice(this.offset)),this.offset=e.length)};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{stream:15,util:38}],10:[function(e,t,r){function n(){}(e=t.exports={}).nextTick=function(){if("undefined"!=typeof window&&window.setImmediate)return function(e){return window.setImmediate(e)};if("undefined"!=typeof window&&window.postMessage&&window.addEventListener){var e=[];return window.addEventListener("message",(function(t){var r=t.source;r!==window&&null!==r||"process-tick"!==t.data||(t.stopPropagation(),0<e.length&&e.shift()())}),!0),function(t){e.push(t),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=n,e.addListener=n,e.once=n,e.off=n,e.removeListener=n,e.removeAllListeners=n,e.emit=n,e.binding=function(e){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw Error("process.chdir is not supported")}},{}],11:[function(e,t,r){t.exports=function(e,t,r,i){r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;for(e=e.split(t||"&"),t=1e3,i&&"number"==typeof i.maxKeys&&(t=i.maxKeys),i=e.length,0<t&&i>t&&(i=t),t=0;t<i;++t){var a,l=e[t].replace(s,"%20"),u=l.indexOf(r);0<=u?(a=l.substr(0,u),l=l.substr(u+1)):(a=l,l=""),a=decodeURIComponent(a),l=decodeURIComponent(l),Object.prototype.hasOwnProperty.call(o,a)?n(o[a])?o[a].push(l):o[a]=[o[a],l]:o[a]=l}return o};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],12:[function(e,t,r){var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?function(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}(o(e),(function(o){var s=encodeURIComponent(n(o))+r;return i(e[o])?e[o].map((function(e){return s+encodeURIComponent(n(e))})).join(t):s+encodeURIComponent(n(e[o]))})).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=Object.keys||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r}},{}],13:[function(e,t,r){r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":11,"./encode":12}],14:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",i)}function i(){if(!this.allowHalfOpen&&!this._writableState.ended){var e=this;o((function(){e.end()}))}}t.exports=n,t=e("inherits");var o=e("process/browser.js").nextTick,s=e("./readable.js"),a=e("./writable.js");t(n,s),n.prototype.write=a.prototype.write,n.prototype.end=a.prototype.end,n.prototype._write=a.prototype._write},{"./readable.js":18,"./writable.js":20,inherits:24,"process/browser.js":16}],15:[function(e,t,r){function n(){i.call(this)}t.exports=n;var i=e("events").EventEmitter;e("inherits")(n,i),n.Readable=e("./readable.js"),n.Writable=e("./writable.js"),n.Duplex=e("./duplex.js"),n.Transform=e("./transform.js"),n.PassThrough=e("./passthrough.js"),n.Stream=n,n.prototype.pipe=function(e,t){function r(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function n(){u.readable&&u.resume&&u.resume()}function o(){c||(c=!0,e.end())}function s(){c||(c=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(l(),0===i.listenerCount(this,"error"))throw e}function l(){u.removeListener("data",r),e.removeListener("drain",n),u.removeListener("end",o),u.removeListener("close",s),u.removeListener("error",a),e.removeListener("error",a),u.removeListener("end",l),u.removeListener("close",l),e.removeListener("close",l)}var u=this;u.on("data",r),e.on("drain",n),e._isStdio||t&&!1===t.end||(u.on("end",o),u.on("close",s));var c=!1;return u.on("error",a),e.on("error",a),u.on("end",l),u.on("close",l),e.on("close",l),e.emit("pipe",u),e}},{"./duplex.js":14,"./passthrough.js":17,"./readable.js":18,"./transform.js":19,"./writable.js":20,events:4,inherits:24}],16:[function(e,t,r){(e=t.exports={}).nextTick=function(){if("undefined"!=typeof window&&window.setImmediate)return function(e){return window.setImmediate(e)};if("undefined"!=typeof window&&window.postMessage&&window.addEventListener){var e=[];return window.addEventListener("message",(function(t){var r=t.source;r!==window&&null!==r||"process-tick"!==t.data||(t.stopPropagation(),0<e.length&&e.shift()())}),!0),function(t){e.push(t),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.binding=function(e){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw Error("process.chdir is not supported")}},{}],17:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}t.exports=n;var i=e("./transform.js");e("inherits")(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},{"./transform.js":19,inherits:24}],18:[function(e,t,r){(function(r){function n(t,r){var n=(t=t||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.calledRead=this.reading=this.endEmitted=this.ended=this.flowing=!1,this.sync=!0,this.readableListening=this.emittedReadable=this.needReadable=!1,this.objectMode=!!t.objectMode,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.encoding=this.decoder=null,t.encoding&&(d||(d=e("string_decoder").StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function i(e){if(!(this instanceof i))return new i(e);this._readableState=new n(e,this),this.readable=!0,v.call(this)}function o(e,t,r,n,i){var o;o=r;var s=null;return y.isBuffer(o)||"string"==typeof o||null==o||t.objectMode||s||(s=new TypeError("Invalid non-string/buffer chunk")),(o=s)?e.emit("error",o):null==r?(t.reading=!1,t.ended||(t.decoder&&!t.ended&&(r=t.decoder.end())&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length),t.ended=!0,0<t.length?a(e):h(e))):t.objectMode||r&&0<r.length?t.ended&&!i?(r=Error("stream.push() after EOF"),e.emit("error",r)):t.endEmitted&&i?(r=Error("stream.unshift() after end event"),e.emit("error",r)):(!t.decoder||i||n||(r=t.decoder.write(r)),t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):(t.reading=!1,t.buffer.push(r)),t.needReadable&&a(e),function(e,t){t.readingMore||(t.readingMore=!0,m((function(){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),r!==t.length);)r=t.length;t.readingMore=!1})))}(e,t)):i||(t.reading=!1),!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function s(e,t){if(0===t.length&&t.ended)return 0;if(t.objectMode)return 0===e?0:1;if(isNaN(e)||null===e)return t.flowing&&t.buffer.length?t.buffer[0].length:t.length;if(0>=e)return 0;if(e>t.highWaterMark){var r=e;if(8388608<=r)r=8388608;else{r--;for(var n=1;32>n;n<<=1)r|=r>>n;r++}t.highWaterMark=r}return e>t.length?t.ended?t.length:(t.needReadable=!0,0):e}function a(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?m((function(){e.emit("readable")})):e.emit("readable"))}function l(e){function t(e,t,i){!1===e.write(r)&&n.awaitDrain++}var r,n=e._readableState;for(n.awaitDrain=0;n.pipesCount&&null!==(r=e.read());)if(1===n.pipesCount?t(n.pipes):p(n.pipes,t),e.emit("data",r),0<n.awaitDrain)return;0===n.pipesCount?(n.flowing=!1,0<g.listenerCount(e,"data")&&c(e)):n.ranOut=!0}function u(){this._readableState.ranOut&&(this._readableState.ranOut=!1,l(this))}function c(e,t){if(e._readableState.flowing)throw Error("Cannot switch to old mode now.");var r=t||!1,n=!1;e.readable=!0,e.pipe=v.prototype.pipe,e.on=e.addListener=v.prototype.on,e.on("readable",(function(){n=!0;for(var t;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(n=!1,e._readableState.needReadable=!0)})),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,n?m((function(){e.emit("readable")})):this.read(0),this.emit("resume")},e.emit("readable")}function f(e,t){var r=t.buffer,n=t.length,i=!!t.decoder,o=!!t.objectMode;if(0===r.length)return null;if(0===n)n=null;else if(o)n=r.shift();else if(!e||e>=n)n=i?r.join(""):y.concat(r,n),r.length=0;else if(e<r[0].length)n=(o=r[0]).slice(0,e),r[0]=o.slice(e);else if(e===r[0].length)n=r.shift();else{n=i?"":new y(e);for(var s=0,a=0,l=r.length;a<l&&s<e;a++){o=r[0];var u=Math.min(e-s,o.length);i?n+=o.slice(0,u):o.copy(n,s,0,u),u<o.length?r[0]=o.slice(u):r.shift(),s+=u}}return n}function h(e){var t=e._readableState;if(0<t.length)throw Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,m((function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))})))}function p(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}t.exports=i,i.ReadableState=n;var d,g=e("events").EventEmitter,v=e("./index.js"),y=e("buffer").Buffer,m=e("process/browser.js").nextTick;e("inherits")(i,v),i.prototype.push=function(e,t){var r=this._readableState;return"string"!=typeof e||r.objectMode||(t=t||r.defaultEncoding)!==r.encoding&&(e=new y(e,t),t=""),o(this,r,e,t,!1)},i.prototype.unshift=function(e){return o(this,this._readableState,e,"",!0)},i.prototype.setEncoding=function(t){d||(d=e("string_decoder").StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t},i.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var r=e;if(("number"!=typeof e||0<e)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return a(this),null;if(0===(e=s(e,t))&&t.ended)return 0===t.length&&h(this),null;var n=t.needReadable;return t.length-e<=t.highWaterMark&&(n=!0),(t.ended||t.reading)&&(n=!1),n&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),n&&!t.reading&&(e=s(r,t)),null===(r=0<e?f(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&h(this),r},i.prototype._read=function(e){this.emit("error",Error("not implemented"))},i.prototype.pipe=function(e,t){function n(e){e===f&&o()}function i(){e.end()}function o(){e.removeListener("close",a),e.removeListener("finish",c),e.removeListener("drain",d),e.removeListener("error",s),e.removeListener("unpipe",n),f.removeListener("end",i),f.removeListener("end",o),e._writableState&&!e._writableState.needDrain||d()}function s(t){f.unpipe(e),0===v&&0===g.listenerCount(e,"error")&&e.emit("error",t)}function a(){e.removeListener("finish",c),f.unpipe(e)}function c(){e.removeListener("close",a),f.unpipe(e)}var f=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1;var p=t&&!1===t.end||e===r.stdout||e===r.stderr?o:i;h.endEmitted?m(p):f.once("end",p),e.on("unpipe",n);var d=function(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&l(e)}}(f);e.on("drain",d);var v=g.listenerCount(e,"error");return e.once("error",s),e.once("close",a),e.once("finish",c),e.emit("pipe",f),h.flowing||(this.on("readable",u),h.flowing=!0,m((function(){l(f)}))),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",u),t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){e=t.pipes;var r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",u),t.flowing=!1;for(var n=0;n<r;n++)e[n].emit("unpipe",this);return this}e:{r=0;for(var i=(n=t.pipes).length;r<i;r++)if(n[r]===e){n=r;break e}n=-1}return-1===n||(t.pipes.splice(n,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},i.prototype.on=function(e,t){var r=v.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||c(this),"readable"===e&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&a(this):this.read(0))}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){c(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){c(this,!0),this.emit("pause")},i.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",(function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(i){t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)&&!n.push(i)&&(r=!0,e.pause())})),e)"function"==typeof e[i]&&void 0===this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return p(["error","close","destroy","pause","resume"],(function(t){e.on(t,(function(e){return n.emit.apply(n,t,e)}))})),n._read=function(t){r&&(r=!1,e.resume())},n},i._fromList=f}).call(this,e("7YKIPe"))},{"./index.js":15,"7YKIPe":10,buffer:6,events:4,inherits:24,"process/browser.js":16,string_decoder:21}],19:[function(e,t,r){function n(e,t){this.afterTransform=function(e,r){var n;(n=t._transformState).transforming=!1;var i=n.writecb;return i?(n.writechunk=null,n.writecb=null,null!=r&&t.push(r),i&&i(e),(n=t._readableState).reading=!1,(n.needReadable||n.length<n.highWaterMark)&&t._read(n.highWaterMark),n=void 0):n=t.emit("error",Error("no writecb in Transform class")),n},this.transforming=this.needTransform=!1,this.writechunk=this.writecb=null}function i(e){if(!(this instanceof i))return new i(e);s.call(this,e),this._transformState=new n(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",(function(){"function"==typeof this._flush?this._flush((function(e){o(t,e)})):o(t)}))}function o(e,t){if(t)return e.emit("error",t);var r=e._transformState;if(e._writableState.length)throw Error("calling transform done when ws.length != 0");if(r.transforming)throw Error("calling transform done when still transforming");return e.push(null)}t.exports=i;var s=e("./duplex.js");e("inherits")(i,s),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,r){throw Error("not implemented")},i.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r,n.writechunk=e,n.writeencoding=t,n.transforming||(e=this._readableState,(n.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark))},i.prototype._read=function(e){(e=this._transformState).writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0}},{"./duplex.js":14,inherits:24}],20:[function(e,t,r){function n(e,t,r){this.chunk=e,this.encoding=t,this.callback=r}function i(e,t){var r=(e=e||{}).highWaterMark;this.highWaterMark=r||0===r?r:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.finished=this.ended=this.ending=this.needDrain=!1,this.decodeStrings=!1!==e.decodeStrings,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){r?f((function(){i(n)})):i(n),e.emit("error",n)}(e,0,n,t,i);else{var o=r.ending&&0===r.length&&!r.finished&&!r.writing;o||r.bufferProcessing||!r.buffer.length||function(e,t){t.bufferProcessing=!0;for(var r=0;r<t.buffer.length;r++){var n=(l=t.buffer[r]).chunk,i=e,o=t,s=n,a=l.encoding,l=l.callback;if(o.writelen=t.objectMode?1:n.length,o.writecb=l,o.writing=!0,o.sync=!0,i._write(s,a,o.onwrite),o.sync=!1,t.writing){r++;break}}t.bufferProcessing=!1,r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}(e,r),n?f((function(){s(e,r,o,i)})):s(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.buffer=[]}function o(e){if(!(this instanceof o||this instanceof c.Duplex))return new o(e);this._writableState=new i(e,this),this.writable=!0,c.call(this)}function s(e,t,r,n){!r&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain")),n(),r&&a(e,t)}function a(e,t){var r=t.ending&&0===t.length&&!t.finished&&!t.writing;return r&&(t.finished=!0,e.emit("finish")),r}t.exports=o,o.WritableState=i;var l="undefined"!=typeof Uint8Array?function(e){return e instanceof Uint8Array}:function(e){return e&&e.constructor&&"Uint8Array"===e.constructor.name},u="undefined"!=typeof ArrayBuffer?function(e){return e instanceof ArrayBuffer}:function(e){return e&&e.constructor&&"ArrayBuffer"===e.constructor.name};t=e("inherits");var c=e("./index.js"),f=e("process/browser.js").nextTick,h=e("buffer").Buffer;t(o,c),o.prototype.pipe=function(){this.emit("error",Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,r){var i=this._writableState,o=!1;return"function"==typeof t&&(r=t,t=null),!h.isBuffer(e)&&l(e)&&(e=new h(e)),u(e)&&"undefined"!=typeof Uint8Array&&(e=new h(new Uint8Array(e))),h.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=function(){}),i.ended?function(e,t,r){var n=Error("write after end");e.emit("error",n),f((function(){r(n)}))}(this,0,r):function(e,t,r,n){var i=!0;if(!h.isBuffer(r)&&"string"!=typeof r&&null!=r&&!t.objectMode){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),f((function(){n(o)})),i=!1}return i}(this,i,e,r)&&(o=function(e,t,r,i,o){t.objectMode||!1===t.decodeStrings||"string"!=typeof r||(r=new h(r,i));var s=t.objectMode?1:r.length;t.length+=s;var a=t.length<t.highWaterMark;return t.needDrain=!a,t.writing?t.buffer.push(new n(r,i,o)):(t.writelen=s,t.writecb=o,t.writing=!0,t.sync=!0,e._write(r,i,t.onwrite),t.sync=!1),a}(this,i,e,t,r)),o},o.prototype._write=function(e,t,r){r(Error("not implemented"))},o.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,t=e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.ending||n.finished||(e=r,n.ending=!0,a(this,n),e&&(n.finished?f(e):this.once("finish",e)),n.ended=!0)}},{"./index.js":15,buffer:6,inherits:24,"process/browser.js":16}],21:[function(e,t,r){function n(e){return e.toString(this.encoding)}function i(e){return this.charLength=(e=this.charReceived=e.length%2)?2:0,e}function o(e){return this.charLength=(e=this.charReceived=e.length%3)?3:0,e}var s=e("buffer").Buffer;(e=r.StringDecoder=function(e){if(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),e&&!s.isEncoding(e))throw Error("Unknown encoding: "+e);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=i;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=o;break;default:return void(this.write=n)}this.charBuffer=new s(6),this.charLength=this.charReceived=0}).prototype.write=function(e){for(var t="",r=0;this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,r,n),this.charReceived+=n-r,r=n,this.charReceived<this.charLength)return"";var i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1);if(!(55296<=i&&56319>=i)){if(this.charReceived=this.charLength=0,n==e.length)return t;e=e.slice(n,e.length);break}this.charLength+=this.surrogateSize,t=""}return i=this.detectIncompleteChar(e),r=e.length,this.charLength&&(e.copy(this.charBuffer,0,e.length-i,r),this.charReceived=i,r-=i),r=(t+=e.toString(this.encoding,0,r)).length-1,55296<=(i=t.charCodeAt(r))&&56319>=i?(e=this.surrogateSize,this.charLength+=e,this.charReceived+=e,this.charBuffer.copy(this.charBuffer,e,0,e),this.charBuffer.write(t.charAt(t.length-1),this.encoding),t.substring(0,r)):t},e.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var r=e[e.length-t];if(1==t&&6==r>>5){this.charLength=2;break}if(2>=t&&14==r>>4){this.charLength=3;break}if(3>=t&&30==r>>3){this.charLength=4;break}}return t},e.prototype.end=function(e){var t="";return e&&e.length&&(t=this.write(e)),this.charReceived&&(e=this.encoding,t+=this.charBuffer.slice(0,this.charReceived).toString(e)),t}},{buffer:6}],22:[function(e,t,r){var n=e("http");for(var i in e=t.exports,n)n.hasOwnProperty(i)&&(e[i]=n[i]);e.request=function(e,t){return e||(e={}),e.scheme="https",e.protocol="https:",n.request.call(this,e,t)}},{http:7}],23:[function(e,t,r){r.read=function(e,t,r,n,i){var o,s=(1<<(o=8*i-n-1))-1,a=s>>1,l=-7,u=r?-1:1,c=e[t+(i=r?i-1:0)];for(i+=u,r=c&(1<<-l)-1,c>>=-l,l+=o;0<l;r=256*r+e[t+i],i+=u,l-=8);for(o=r&(1<<-l)-1,r>>=-l,l+=n;0<l;o=256*o+e[t+i],i+=u,l-=8);if(0===r)r=1-a;else{if(r===s)return o?NaN:1/0*(c?-1:1);o+=Math.pow(2,n),r-=a}return(c?-1:1)*o*Math.pow(2,r-n)},r.write=function(e,t,r,n,i,o){var s,a=8*o-i-1,l=(1<<a)-1,u=l>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0;o=n?0:o-1;var f=n?1:-1,h=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(t=isNaN(t)?1:0,n=l):(n=Math.floor(Math.log(t)/Math.LN2),1>t*(s=Math.pow(2,-n))&&(n--,s*=2),2<=(t=1<=n+u?t+c/s:t+c*Math.pow(2,1-u))*s&&(n++,s/=2),n+u>=l?(t=0,n=l):1<=n+u?(t=(t*s-1)*Math.pow(2,i),n+=u):(t=t*Math.pow(2,u-1)*Math.pow(2,i),n=0));8<=i;e[r+o]=255&t,o+=f,t/=256,i-=8);for(n=n<<i|t,a+=i;0<a;e[r+o]=255&n,o+=f,n/=256,a-=8);e[r+o-f]|=128*h}},{}],24:[function(e,t,r){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],25:[function(e,t,r){},{}],26:[function(e,t,r){(function(r,n,i){!function(){var o=void 0!==r&&r.versions&&r.versions.node,s=!o&&("undefined"!=typeof window||"undefined"!=typeof self);s&&void 0===n&&("undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:"undefined"!=typeof $&&(n=$));var a=function(t){function a(){}function l(e,t){if(_(t))for(var r=0;r<t.length;++r)t[r]=l(e,t[r]);else if(I(t))t["@list"]=l(e,t["@list"]);else if(F(t)){j(t)&&(t["@id"]=e.getId(t["@id"]));r=Object.keys(t).sort();for(var n=0;n<r.length;++n){var i=r[n];"@id"!==i&&(t[i]=l(e,t[i]))}}return t}function u(e){var t={};if(M(e)){t.type="literal";var r=e["@value"],n=e["@type"]||null;"boolean"==typeof r||"[object Boolean]"===Object.prototype.toString.call(r)?(t.value=r.toString(),t.datatype=n||"http://www.w3.org/2001/XMLSchema#boolean"):L(r)||"http://www.w3.org/2001/XMLSchema#double"===n?(L(r)||(r=parseFloat(r)),t.value=r.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype=n||"http://www.w3.org/2001/XMLSchema#double"):E(r)?(t.value=r.toFixed(0),t.datatype=n||"http://www.w3.org/2001/XMLSchema#integer"):"@language"in e?(t.value=r,t.datatype=n||J,t.language=e["@language"]):(t.value=r,t.datatype=n||V)}else e=F(e)?e["@id"]:e,t.type=0===e.indexOf("_:")?"blank node":"IRI",t.value=e;return"IRI"!==t.type||O(t.value)?t:null}function c(e,r,n,i,o,s){if(_(e))for(var a=0;a<e.length;++a)c(e[a],r,n,i,void 0,s);else if(F(e))if(M(e)){if("@type"in e){var l=e["@type"];0===l.indexOf("_:")&&(e["@type"]=i.getId(l))}s&&s.push(e)}else{if("@type"in e){var u=e["@type"];for(a=0;a<u.length;++a)0===(l=u[a]).indexOf("_:")&&i.getId(l)}for(T(o)&&(o=j(e)?i.getId(e["@id"]):e["@id"]),s&&s.push({"@id":o}),(a=(s=r[n])[o]=s[o]||{})["@id"]=o,l=Object.keys(e).sort(),u=0;u<l.length;++u){if("@id"!==(h=l[u]))if("@reverse"===h){var f,h={"@id":o},p=e["@reverse"];for(f in p)for(var d=p[f],g=0;g<d.length;++g){var v=d[g],y=v["@id"];j(v)&&(y=i.getId(y)),c(v,r,n,i,y),t.addValue(s[y],f,h,{propertyIsArray:!0,allowDuplicate:!1})}}else if("@graph"===h)o in r||(r[o]={}),c(e[h],r,"@merged"===n?n:o,i);else if("@type"!==h&&S(h)){if("@index"===h&&h in a&&(e[h]!==a[h]||e[h]["@id"]!==a[h]["@id"]))throw new $("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:a});a[h]=e[h]}else if(p=e[h],0===h.indexOf("_:")&&(h=i.getId(h)),0===p.length)t.addValue(a,h,[],{propertyIsArray:!0});else for(d=0;d<p.length;++d)g=p[d],"@type"===h&&(g=0===g.indexOf("_:")?i.getId(g):g),y=!1,!F(v=g)||"@value"in v||"@set"in v||"@list"in v||(y=1<Object.keys(v).length||!("@id"in v)),y||N(g)?(v=j(g)?i.getId(g["@id"]):g["@id"],t.addValue(a,h,{"@id":v},{propertyIsArray:!0,allowDuplicate:!1}),c(g,r,n,i,v)):(I(g)?(v=[],c(g["@list"],r,n,i,o,v),g={"@list":v}):c(g,r,n,i,o),t.addValue(a,h,g,{propertyIsArray:!0,allowDuplicate:!1}))}}else s&&s.push(e)}function f(e){for(var t=e["@default"],r=Object.keys(e).sort(),n=0;n<r.length;++n){if("@default"!==(o=r[n])){var i=e[o];(s=t[o])?"@graph"in s||(s["@graph"]=[]):t[o]=s={"@id":o,"@graph":[]};for(var o=s["@graph"],s=Object.keys(i).sort(),a=0;a<s.length;++a){var l=i[s[a]];N(l)||o.push(l)}}}return t}function h(e,t,r,n,i){if(!_(o=r)||1!==o.length||!F(o[0]))throw new $("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:o});for(var o,s={embed:d(r=r[0],o=e.options,"embed"),explicit:d(r,o,"explicit"),requireAll:d(r,o,"requireAll")},a=r,l={},u=0;u<t.length;++u){var c=t[u],f=e.subjects[c];g(f,a,s)&&(l[c]=f)}for(t=Object.keys(l).sort(),a=0;a<t.length;++a)if(c=l[f=t[a]],"@link"===s.embed&&f in e.link)y(n,i,e.link[f]);else{var m;if(null===i&&(e.uniqueEmbeds={}),(u={})["@id"]=f,e.link[f]=u,!(m="@never"===s.embed))e:{for(var b=(m=e.subjectStack).length-1;0<=b;--b)if(m[b]["@id"]===c["@id"]){m=!0;break e}m=!1}if(m)y(n,i,u);else{"@last"===s.embed&&(f in e.uniqueEmbeds&&v(e,f),e.uniqueEmbeds[f]={parent:n,property:i}),e.subjectStack.push(c),f=Object.keys(c).sort();for(m=0;m<f.length;m++)if(S(b=f[m]))u[b]=D(c[b]);else if(!s.explicit||b in r)for(var x=c[b],w=0;w<x.length;++w){var k=x[w];if(I(k)){var C={"@list":[]};y(u,b,C);var A,E=k["@list"];for(A in E)if(N(k=E[A])){var L=b in r?r[b][0]["@list"]:p(s);h(e,[k["@id"]],L,C,"@list")}else y(C,"@list",D(k))}else N(k)?(L=b in r?r[b]:p(s),h(e,[k["@id"]],L,u,b)):y(u,b,D(k))}for(f=Object.keys(r).sort(),m=0;m<f.length;++m)S(b=f[m])||(d(c=r[b][0],o,"omitDefault")||b in u||(x="@null","@default"in c&&(x=D(c["@default"])),_(x)||(x=[x]),u[b]=[{"@preserve":x}]));y(n,i,u),e.subjectStack.pop()}}}function p(e){var t,r={};for(t in e)void 0!==e[t]&&(r["@"+t]=[e[t]]);return[r]}function d(e,t,r){var n="@"+r;return e=n in e?e[n][0]:t[r],"embed"===r&&(!0===e?e="@last":!1===e?e="@never":"@always"!==e&&"@never"!==e&&"@link"!==e&&(e="@last")),e}function g(e,r,n){if("@type"in r&&(1!==r["@type"].length||!F(r["@type"][0]))){for(r=r["@type"],n=0;n<r.length;++n)if(t.hasValue(e,"@type",r[n]))return!0;return!1}var i,o=!0,s=!1;for(i in r){if(S(i)){if("@id"!==i&&"@type"!==i)continue;if(o=!1,"@id"===i&&A(r[i])){if(e[i]!==r[i])return!1;s=!0;continue}}if(o=!1,i in e){if(_(r[i])&&0===r[i].length&&void 0!==e[i])return!1;s=!0}else{var a=_(r[i])&&F(r[i][0])&&"@default"in r[i][0];if(n.requireAll&&!a)return!1}}return o||s}function v(e,r){var n=e.uniqueEmbeds,i=(s=n[r]).parent,o=s.property,s={"@id":r};if(_(i)){for(o=0;o<i.length;++o)if(t.compareValues(i[o],s)){i[o]=s;break}}else{var a=_(i[o]);t.removeValue(i,o,s,{propertyIsArray:a}),t.addValue(i,o,s,{propertyIsArray:a})}var l=function(e){for(var t=Object.keys(n),r=0;r<t.length;++r){var i=t[r];i in n&&F(n[i].parent)&&n[i].parent["@id"]===e&&(delete n[i],l(i))}};l(r)}function y(e,r,n){F(e)?t.addValue(e,r,n,{propertyIsArray:!0}):e.push(n)}function m(e,r,n){if(_(r)){for(var i=[],o=0;o<r.length;++o){var s=m(e,r[o],n);null!==s&&i.push(s)}r=i}else if(F(r)){if("@preserve"in r)return"@null"===r["@preserve"]?null:r["@preserve"];if(M(r))return r;if(I(r))return r["@list"]=m(e,r["@list"],n),r;if((s=x(e,"@id"))in r)if((s=r[s])in n.link){if(-1!==(o=n.link[s].indexOf(r)))return n.link[s][o];n.link[s].push(r)}else n.link[s]=[r];for(i in r)s=m(e,r[i],n),o=t.getContextValue(e,i,"@container"),n.compactArrays&&_(s)&&1===s.length&&null===o&&(s=s[0]),r[i]=s}return r}function b(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1}function x(e,r,n,i,o){if(null===r)return r;T(n)&&(n=null),T(o)&&(o=!1),i=i||{};var s=e.getInverse();if(S(r))return r in s?s[r]["@none"]["@type"]["@none"]:r;if(i.vocab&&r in s){var a=e["@language"]||"@none";s=[];F(n)&&"@index"in n&&s.push("@index");var l="@language",u="@null";if(o)l="@type",u="@reverse",s.push("@set");else if(I(n)){"@index"in n||s.push("@list");var c=n["@list"];u=0===c.length?a:null,a=null;for(o=0;o<c.length;++o){var f=c[o],h="@none",p="@none";if(M(f)?"@language"in f?h=f["@language"]:"@type"in f?p=f["@type"]:h="@null":p="@id",null===u?u=h:h!==u&&M(f)&&(u="@none"),null===a?a=p:p!==a&&(a="@none"),"@none"===u&&"@none"===a)break}u=u||"@none","@none"!==(a=a||"@none")&&(l="@type",u=a)}else M(n)?"@language"in n&&!("@index"in n)?(s.push("@language"),u=n["@language"]):"@type"in n&&(l="@type",u=n["@type"]):(l="@type",u="@id"),s.push("@set");s.push("@none");e:{c=n,o=l,null===u&&(u="@null"),l=[],"@id"!==u&&"@reverse"!==u||!N(c)?l.push(u):("@reverse"===u&&l.push("@reverse"),(u=x(e,c["@id"],null,{vocab:!0}))in e.mappings&&e.mappings[u]&&e.mappings[u]["@id"]===c["@id"]?l.push.apply(l,["@vocab","@id"]):l.push.apply(l,["@id","@vocab"])),l.push("@none"),c=e.inverse[r];for(u=0;u<s.length;++u)if((a=s[u])in c)for(a=c[a][o],f=0;f<l.length;++f)if((h=l[f])in a){s=a[h];break e}s=null}if(null!==s)return s}if(i.vocab&&"@vocab"in e&&(s=e["@vocab"],0===r.indexOf(s)&&r!==s&&!((s=r.substr(s.length))in e.mappings)))return s;for(s=null,o=0,l=[],c=e.fastCurieMap,u=r.length-1;o<u&&r[o]in c;++o)""in(c=c[r[o]])&&l.push(c[""][0]);for(o=l.length-1;0<=o;--o)for(u=(c=l[o]).terms,a=0;a<u.length;++a)(f=u[a]+":"+r.substr(c.iri.length))in e.mappings&&(null!==n||e.mappings[f]["@id"]!==r)||!(null===s||0>b(f,s))||(s=f);if(null!==s)return s;if(!i.vocab&&(null!==(e=e["@base"])&&(A(e)&&(e=t.url.parse(e||"")),n="",""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):r.indexOf("//")&&(n+="//"),0===r.indexOf(n)))){for(r=t.url.parse(r.substr(n.length)),e=e.normalizedPath.split("/"),n=r.normalizedPath.split("/"),i=r.fragment||r.query?0:1;0<e.length&&n.length>i&&e[0]===n[0];)e.shift(),n.shift();if(i="",0<e.length)for(e.pop(),s=0;s<e.length;++s)i+="../";i+=n.join("/"),null!==r.query&&(i+="?"+r.query),null!==r.fragment&&(i+="#"+r.fragment),""===i&&(i="./"),r=i}return r}function w(e,t,r,n){if(r in n){if(n[r])return;throw new $("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:r})}if(n[r]=!1,S(r))throw new $("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r});if(""===r)throw new $("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});e.mappings[r]&&delete e.mappings[r];var i=t[r];if(null===i||F(i)&&null===i["@id"])e.mappings[r]=null,n[r]=!0;else{if(A(i)&&(i={"@id":i}),!F(i))throw new $("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var o=e.mappings[r]={};if(o.reverse=!1,"@reverse"in i){if("@id"in i)throw new $("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var s=i["@reverse"];if(!A(s))throw new $("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!O(s=k(e,s,{vocab:!0,base:!1},t,n)))throw new $("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=s,o.reverse=!0}else if("@id"in i){if(!A(s=i["@id"]))throw new $("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(s!==r){if(!O(s=k(e,s,{vocab:!0,base:!1},t,n))&&!S(s))throw new $("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=s}}var a=r.indexOf(":");if(o._termHasColon=-1!==a,!("@id"in o))if(o._termHasColon)(s=r.substr(0,a))in t&&w(e,t,s,n),e.mappings[s]?(a=r.substr(a+1),o["@id"]=e.mappings[s]["@id"]+a):o["@id"]=r;else{if(!("@vocab"in e))throw new $("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:r});o["@id"]=e["@vocab"]+r}if(n[r]=!0,"@type"in i){if(!A(r=i["@type"]))throw new $("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==r&&"@vocab"!==r){if(!O(r=k(e,r,{vocab:!0,base:!1},t,n)))throw new $("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===r.indexOf("_:"))throw new $("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}o["@type"]=r}if("@container"in i){if("@list"!==(e=i["@container"])&&"@set"!==e&&"@index"!==e&&"@language"!==e)throw new $("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(o.reverse&&"@index"!==e&&"@set"!==e&&null!==e)throw new $("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});o["@container"]=e}if("@language"in i&&!("@type"in i)){if(null!==(i=i["@language"])&&!A(i))throw new $("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==i&&(i=i.toLowerCase()),o["@language"]=i}if("@context"===(s=o["@id"])||"@preserve"===s)throw new $("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t})}}function k(e,r,n,i,o){if(null===r||S(r))return r;if(r=String(r),i&&r in i&&!0!==o[r]&&w(e,i,r,o),(n=n||{}).vocab){var s=e.mappings[r];if(null===s)return null;if(s)return s["@id"]}if(-1!==(s=r.indexOf(":"))){n=r.substr(0,s);var a=r.substr(s+1);return"_"===n||0===a.indexOf("//")?r:(i&&n in i&&w(e,i,n,o),(s=e.mappings[n])?s["@id"]+a:r)}return n.vocab&&"@vocab"in e?e["@vocab"]+r:(n.base&&(r=t.prependBase(e["@base"],r)),r)}function C(e){function r(e,t,n){var i=e[t];e=e[t]={};for(var o,s=0;s<i.length;++s)(o=n>=(o=i[s].iri).length?"":o[n])in e?e[o].push(i[s]):e[o]=[i[s]];for(t in e)""!==t&&r(e,t,n+1)}return{"@base":t.url.parse(e.base||""),mappings:{},inverse:null,getInverse:function(){if(this.inverse)return this.inverse;for(var e=this.inverse={},t=this.fastCurieMap={},n={},i=this["@language"]||"@none",o=this.mappings,s=Object.keys(o).sort(b),a=0;a<s.length;++a){var l=s[a],u=o[l];if(null!==u){var c=u["@container"]||"@none",f=u["@id"];_(f)||(f=[f]);for(var h=0;h<f.length;++h){var p=f[h],d=e[p],g=S(p);d?g||u._termHasColon||n[p].push(l):(e[p]=d={},g||u._termHasColon||(n[p]=[l],g={iri:p,terms:n[p]},p[0]in t?t[p[0]].push(g):t[p[0]]=[g])),d[c]||(d[c]={"@language":{},"@type":{}}),d=d[c],u.reverse?"@reverse"in(d=d["@type"])||(d["@reverse"]=l):"@type"in u?(d=d["@type"],(p=u["@type"])in d||(d[p]=l)):"@language"in u?(d=d["@language"],(p=u["@language"]||"@null")in d||(d[p]=l)):(i in(p=d["@language"])||(p[i]=l),"@none"in(p=d["@type"])||(p["@none"]=l),"@none"in(d=d["@language"])||(d["@none"]=l))}}}for(var v in t)r(t,v,1);return e},clone:function(){var e={};return e["@base"]=this["@base"],e.mappings=D(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e}}}function S(e){if(!A(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function F(e){return"[object Object]"===Object.prototype.toString.call(e)}function _(e){return Array.isArray(e)}function A(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function E(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function L(e){return E(e)&&-1!==String(e).indexOf(".")}function T(e){return void 0===e}function N(e){return F(e)&&1===Object.keys(e).length&&"@id"in e}function M(e){return F(e)&&"@value"in e}function I(e){return F(e)&&"@list"in e}function j(e){var t=!1;return F(e)&&(t="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),t}function O(e){return A(e)&&-1!==e.indexOf(":")}function D(e){if(e&&"object"==typeof e){var t;if(_(e)){t=[];for(var r=0;r<e.length;++r)t[r]=D(e[r])}else if(F(e))for(r in t={},e)t[r]=D(e[r]);else t=e.toString();return t}return e}function R(e,r,n,i){var o=Object.keys(r).length;if(_(e)){for(var s=0;s<e.length;++s)R(e[s],r,n,i);return o<Object.keys(r).length}if(F(e)){for(var a in e)if("@context"!==a)R(e[a],r,n,i);else{var l=e[a];if(_(l)){var u=l.length;for(s=0;s<u;++s){var c=l[s];A(c)&&(c=t.prependBase(i,c),n?_(c=r[c])?(Array.prototype.splice.apply(l,[s,1].concat(c)),s+=c.length-1,u=l.length):l[s]=c:c in r||(r[c]=!1))}}else A(l)&&(l=t.prependBase(i,l),n?e[a]=r[l]:l in r||(r[l]=!1))}return o<Object.keys(r).length}return!1}function B(e,t,r){var n=null,i=function(e,t,r,o,s){if(Object.keys(t).length>Y)return n=new $("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:Y}),s(n);var a={};R(e,a,!1,o)||(R(e,a,!0,o),s(null,e));var l,u=[];for(l in a)!1===a[l]&&u.push(l);var c=u.length;for(l=0;l<u.length;++l)!function(l){if(l in t)return n=new $("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:l}),s(n);var u=D(t);u[l]=!0;var h=function(t,h){if(!n){var p=h?h.document:null;if(!t&&A(p))try{p=JSON.parse(p)}catch(f){t=f}if(t?t=new $("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:l,cause:t}):F(p)||(t=new $("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:l,cause:t})),t)return s(n=t);p="@context"in p?{"@context":p["@context"]}:{"@context":{}},h.contextUrl&&(_(p["@context"])||(p["@context"]=[p["@context"]]),p["@context"].push(h.contextUrl)),i(p,u,r,l,(function(t,r){if(t)return s(t);a[l]=r["@context"],0===--c&&(R(e,a,!0,o),s(null,e))}))}},p=r(l,h);p&&"then"in p&&p.then(h.bind(null,null),h)}(u[l])};i(e,{},t.documentLoader,t.base,r)}function P(e){var t=/^[ \t]*(?:#.*)?$/,r=/^[ \t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \t]+(?:<([^:]+:[^>]*)>)[ \t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+))|(?:"([^"\\]*(?:\\.[^"\\]*)*)"(?:(?:\^\^(?:<([^:]+:[^>]*)>))|(?:@([a-z]+(?:-[a-z0-9]+)*)))?))[ \t]*(?:\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \t]*\.))[ \t]*(?:#.*)?$/,n={};e=e.split(/(?:\r\n)|(?:\n)|(?:\r)/g);for(var i=0,o=0;o<e.length;++o){var s=e[o];if(i++,!t.test(s)){if(null===(l=s.match(r)))throw new $("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:i});if(s={},T(l[1])?s.subject={type:"blank node",value:l[2]}:s.subject={type:"IRI",value:l[1]},s.predicate={type:"IRI",value:l[3]},T(l[4]))if(T(l[5])){s.object={type:"literal"},T(l[7])?T(l[8])?s.object.datatype=V:(s.object.datatype=J,s.object.language=l[8]):s.object.datatype=l[7];var a=l[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");s.object.value=a}else s.object={type:"blank node",value:l[5]};else s.object={type:"IRI",value:l[4]};if(a="@default",T(l[9])?T(l[10])||(a=l[10]):a=l[9],a in n){for(var l=!0,u=(a=n[a],0);l&&u<a.length;++u){var c;e:{c=a[u];for(var f=["subject","predicate","object"],h=0;h<f.length;++h){var p=f[h];if(c[p].type!==s[p].type||c[p].value!==s[p].value){c=!1;break e}}c=c.object.language===s.object.language&&c.object.datatype===s.object.datatype}c&&(l=!1)}l&&a.push(s)}else n[a]=[s]}}return n}function Q(e,t){var r=e.subject,n=e.predicate,i=e.object,o=t||null;"name"in e&&e.name&&(o=e.name.value);var s="";s=(s="IRI"===r.type?s+"<"+r.value+">":s+r.value)+" ",s=(s="IRI"===n.type?s+"<"+n.value+">":s+n.value)+" ";return"IRI"===i.type?s+="<"+i.value+">":"blank node"===i.type?s+=i.value:(s+='"'+(r=i.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"'))+'"',i.datatype===J?i.language&&(s+="@"+i.language):i.datatype!==V&&(s+="^^<"+i.datatype+">")),null!=o&&(s=0!==o.indexOf("_:")?s+" <"+o+">":s+" "+o),s+" .\n"}function U(e){this.prefix=e,this.counter=0,this.existing={}}function G(e,t){var r="";0===e.indexOf("/")&&(r="/");for(var n=e.split("/"),i=[];0<n.length;)"."===n[0]||""===n[0]&&1<n.length?n.shift():".."===n[0]?(n.shift(),t||0<i.length&&".."!==i[i.length-1]?i.pop():i.push("..")):i.push(n.shift());return r+i.join("/")}if(t.compact=function(e,r,n,i){return 2>arguments.length?t.nextTick((function(){i(new TypeError("Could not compact, too few arguments."))})):("function"==typeof n&&(i=n,n={}),n=n||{},null===r?t.nextTick((function(){i(new $("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))})):null===e?t.nextTick((function(){i(null,null)})):("base"in n||(n.base="string"==typeof e?e:""),"compactArrays"in n||(n.compactArrays=!0),"graph"in n||(n.graph=!1),"skipExpansion"in n||(n.skipExpansion=!1),"documentLoader"in n||(n.documentLoader=t.loadDocument),"link"in n||(n.link=!1),n.link&&(n.skipExpansion=!0),void function(e,r,n){if(r.skipExpansion)return t.nextTick((function(){n(null,e)}));t.expand(e,r,n)}(e,n,(function(e,o){if(e)return i(new $("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var s=C(n);t.processContext(s,r,n,(function(e,t){if(e)return i(new $("Could not process context before compaction.","jsonld.CompactError",{cause:e}));var s;try{s=(new Z).compact(t,null,o,n)}catch(c){return i(c)}var a=n;a.compactArrays&&!a.graph&&_(s)?1===s.length?s=s[0]:0===s.length&&(s={}):a.graph&&F(s)&&(s=[s]),F(r)&&"@context"in r&&(r=r["@context"]),_(r=D(r))||(r=[r]),a=r,r=[];for(var l=0;l<a.length;++l)(!F(a[l])||0<Object.keys(a[l]).length)&&r.push(a[l]);if(a=0<r.length,1===r.length&&(r=r[0]),_(s)){var u=x(t,"@graph");l=s;s={},a&&(s["@context"]=r),s[u]=l}else if(F(s)&&a)for(u in l=s,s={"@context":r},l)s[u]=l[u];i(null,s,t)}))}))))},t.expand=function(e,r,n){function i(e){if("base"in r||(r.base=e.documentUrl||""),e={document:D(e.document),remoteContext:{"@context":e.contextUrl}},"expandContext"in r){var t=D(r.expandContext);e.expandContext="object"==typeof t&&"@context"in t?t:{"@context":t}}B(e,r,(function(e,t){if(e)return n(e);var i;try{var o=new Z,s=C(r),a=t.document,l=t.remoteContext["@context"];t.expandContext&&(s=o.processContext(s,t.expandContext["@context"],r)),l&&(s=o.processContext(s,l,r)),F(i=o.expand(s,null,a,r,!1))&&"@graph"in i&&1===Object.keys(i).length?i=i["@graph"]:null===i&&(i=[]),_(i)||(i=[i])}catch(c){return n(c)}n(null,i)}))}if(1>arguments.length)return t.nextTick((function(){n(new TypeError("Could not expand, too few arguments."))}));"function"==typeof r&&(n=r,r={}),"documentLoader"in(r=r||{})||(r.documentLoader=t.loadDocument),"keepFreeFloatingNodes"in r||(r.keepFreeFloatingNodes=!1),t.nextTick((function(){if("string"==typeof e){var t=function(e,r){if(e)return n(e);try{if(!r.document)throw new $("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof r.document&&(r.document=JSON.parse(r.document))}catch(t){return n(new $("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:t,remoteDoc:r}))}i(r)},o=r.documentLoader(e,t);o&&"then"in o&&o.then(t.bind(null,null),t)}else i({contextUrl:null,documentUrl:null,document:e})}))},t.flatten=function(e,r,n,i){if(1>arguments.length)return t.nextTick((function(){i(new TypeError("Could not flatten, too few arguments."))}));"function"==typeof n?(i=n,n={}):"function"==typeof r&&(i=r,r=null,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=t.loadDocument),t.expand(e,n,(function(e,o){if(e)return i(new $("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));var s;try{s=(new Z).flatten(o)}catch(a){return i(a)}if(null===r)return i(null,s);n.graph=!0,n.skipExpansion=!0,t.compact(s,r,n,(function(e,t){if(e)return i(new $("Could not compact flattened output.","jsonld.FlattenError",{cause:e}));i(null,t)}))}))},t.frame=function(e,r,n,i){function o(r){var o,s=r.document;s?(o=s["@context"],r.contextUrl?(o?_(o)?o.push(r.contextUrl):o=[o,r.contextUrl]:o=r.contextUrl,s["@context"]=o):o=o||{}):o={},t.expand(e,n,(function(e,r){if(e)return i(new $("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var a=D(n);a.isFrame=!0,a.keepFreeFloatingNodes=!0,t.expand(s,a,(function(e,n){if(e)return i(new $("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));var s;try{s=(new Z).frame(r,n,a)}catch(c){return i(c)}a.graph=!0,a.skipExpansion=!0,a.link={},t.compact(s,o,a,(function(e,t,r){if(e)return i(new $("Could not compact framed output.","jsonld.FrameError",{cause:e}));e=x(r,"@graph"),a.link={},t[e]=m(r,t[e],a),i(null,t)}))}))}))}if(2>arguments.length)return t.nextTick((function(){i(new TypeError("Could not frame, too few arguments."))}));"function"==typeof n&&(i=n,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=t.loadDocument),"embed"in n||(n.embed="@last"),n.explicit=n.explicit||!1,"requireAll"in n||(n.requireAll=!0),n.omitDefault=n.omitDefault||!1,t.nextTick((function(){if("string"==typeof r){var e=function(e,t){if(e)return i(e);try{if(!t.document)throw new $("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(n){return i(new $("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:n,remoteDoc:t}))}o(t)},t=n.documentLoader(r,e);t&&"then"in t&&t.then(e.bind(null,null),e)}else o({contextUrl:null,documentUrl:null,document:r})}))},t.link=function(e,r,n,i){var o={};r&&(o["@context"]=r),o["@embed"]="@link",t.frame(e,o,n,i)},t.objectify=function(e,r,n,i){"function"==typeof n&&(i=n,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=t.loadDocument),t.expand(e,n,(function(e,o){if(e)return i(new $("Could not expand input before linking.","jsonld.LinkError",{cause:e}));var s;try{s=(new Z).flatten(o)}catch(a){return i(a)}n.graph=!0,n.skipExpansion=!0,t.compact(s,r,n,(function(e,r,n){if(e)return i(new $("Could not compact flattened output before linking.","jsonld.LinkError",{cause:e}));var o=r[e=x(n,"@graph")][0],s=function(e){if(F(e)||_(e)){if(F(e)){if(s.visited[e["@id"]])return;s.visited[e["@id"]]=!0}for(var r in e){var i=e[r],a="@id"===t.getContextValue(n,r,"@type");if(_(i)||F(i)||a)if(A(i)&&a)e[r]=i=o[i],s(i);else if(_(i))for(var l=0;l<i.length;++l)A(i[l])&&a?i[l]=o[i[l]]:F(i[l])&&"@id"in i[l]&&(i[l]=o[i[l]["@id"]]),s(i[l]);else F(i)&&(e[r]=i=o[i["@id"]],s(i))}}};for(var a in s.visited={},s(o),r.of_type={},o)if("@type"in o[a]){_(e=o[a]["@type"])||(e=[e]);for(var l=0;l<e.length;++l)e[l]in r.of_type||(r.of_type[e[l]]=[]),r.of_type[e[l]].push(o[a])}i(null,r)}))}))},t.normalize=function(e,r,n){if(1>arguments.length)return t.nextTick((function(){n(new TypeError("Could not normalize, too few arguments."))}));if("function"==typeof r&&(n=r,r={}),"algorithm"in(r=r||{})||(r.algorithm="URGNA2012"),"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=t.loadDocument),"inputFormat"in r){if("application/nquads"!==r.inputFormat)return n(new $("Unknown normalization input format.","jsonld.NormalizeError"));var i=P(e);(new Z).normalize(i,r,n)}else delete(i=D(r)).format,i.produceGeneralizedRdf=!1,t.toRDF(e,i,(function(e,t){if(e)return n(new $("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:e}));(new Z).normalize(t,r,n)}))},t.fromRDF=function(e,r,n){if(1>arguments.length)return t.nextTick((function(){n(new TypeError("Could not convert from RDF, too few arguments."))}));"function"==typeof r&&(n=r,r={}),"useRdfType"in(r=r||{})||(r.useRdfType=!1),"useNativeTypes"in r||(r.useNativeTypes=!1),"format"in r||!A(e)||"format"in r||(r.format="application/nquads"),t.nextTick((function(){function t(e,t,r){(new Z).fromRDF(e,t,r)}var i;if(r.format){if(!(i=r.rdfParser||X[r.format]))return n(new $("Unknown input format.","jsonld.UnknownFormat",{format:r.format}))}else i=function(){return e};var o=!1;try{e=i(e,(function(e,i){if(o=!0,e)return n(e);t(i,r,n)}))}catch(l){if(!o)return n(l);throw l}if(e){if("then"in e)return e.then((function(e){t(e,r,n)}),n);t(e,r,n)}}))},t.toRDF=function(e,r,n){if(1>arguments.length)return t.nextTick((function(){n(new TypeError("Could not convert to RDF, too few arguments."))}));"function"==typeof r&&(n=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=t.loadDocument),t.expand(e,r,(function(e,t){if(e)return n(new $("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:e}));var i;try{if(i=Z.prototype.toRDF(t,r),r.format){if("application/nquads"===r.format){var o,s=n,a=[];for(o in i)for(var l=i[o],c=0;c<l.length;++c){var f=l[c];"@default"===o&&(o=null),a.push(Q(f,o))}return s(null,a.sort().join(""))}throw new $("Unknown output format.","jsonld.UnknownFormat",{format:r.format})}}catch(u){return n(u)}n(null,i)}))},t.createNodeMap=function(e,r,i){if(1>arguments.length)return t.nextTick((function(){i(new TypeError("Could not create node map, too few arguments."))}));"function"==typeof r&&(i=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=t.loadDocument),t.expand(e,r,(function(e,t){if(e)return i(new $("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:e}));var o;try{o=(new Z).createNodeMap(t,r)}catch(n){return i(n)}i(null,o)}))},t.merge=function(e,r,n,i){function o(e,t){if(!l){if(e)return l=e,i(new $("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));a.push(t),0==--u&&s(a)}}function s(e){var o=!0;"mergeNodes"in n&&(o=n.mergeNodes);var s,a=n.namer||n.issuer||new U("_:b"),l={"@default":{}};try{for(var u=0;u<e.length;++u){var h=e[u],p=(h=t.relabelBlankNodes(h,{issuer:new U("_:b"+u+"-")}),o||0===u?l:{"@default":{}});if(c(h,p,"@default",a),p!==l)for(var d in p){var g=p[d];if(d in l){var v,y=l[d];for(v in g)v in y||(y[v]=g[v])}else l[d]=g}}s=f(l)}catch(m){return i(m)}for(e=[],o=Object.keys(s).sort(),a=0;a<o.length;++a)N(l=s[o[a]])||e.push(l);if(null===r)return i(null,e);n.graph=!0,n.skipExpansion=!0,t.compact(e,r,n,(function(e,t){if(e)return i(new $("Could not compact merged output.","jsonld.MergeError",{cause:e}));i(null,t)}))}if(1>arguments.length)return t.nextTick((function(){i(new TypeError("Could not merge, too few arguments."))}));if(!_(e))return t.nextTick((function(){i(new TypeError('Could not merge, "docs" must be an array.'))}));"function"==typeof n?(i=n,n={}):"function"==typeof r&&(i=r,r=null,n={}),n=n||{};for(var a=[],l=null,u=e.length,h=0;h<e.length;++h){var p,d={};for(p in n)d[p]=n[p];t.expand(e[h],d,o)}},t.relabelBlankNodes=function(e,t){return l((t=t||{}).namer||t.issuer||new U("_:b"),e)},t.prependBase=function(e,r){var n,i=e;if(null===i)n=r;else if(-1!==r.indexOf(":"))n=r;else{A(i)&&(i=t.url.parse(i||"")),n=t.url.parse(r);var o,s,a=i.protocol||"";null!==n.authority?(o=n.authority,s=n.path,i=n.query):(o=i.authority,""===n.path?(s=i.path,i=null!==n.query?n.query:i.query):(0===n.path.indexOf("/")?s=n.path:(s=i.path,""!==n.path&&(0<(s=s.substr(0,s.lastIndexOf("/")+1)).length&&"/"!==s.substr(-1)&&(s+="/"),s+=n.path)),i=n.query)),null!==o&&(a+="//"+o),a+=s=G(s,!!o),null!==i&&(a+="?"+i),null!==n.fragment&&(a+="#"+n.fragment),""===a&&(a="./"),n=a}return n},t.documentLoader=function(e,r){var n=new $("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return o?r(n,{contextUrl:null,documentUrl:e,document:null}):t.promisify((function(e){e(n)}))},t.loadDocument=function(e,r){var n=t.documentLoader(e,r);n&&"then"in n&&n.then(r.bind(null,null),r)},t.promises=function(r){r=r||{};var i=Array.prototype.slice,o=t.promisify,s=r.api||{},a=r.version||"jsonld.js";"string"==typeof r.api&&(r.version||(a=r.api),s={}),s.expand=function(e){if(1>arguments.length)throw new TypeError("Could not expand, too few arguments.");return o.apply(null,[t.expand].concat(i.call(arguments)))},s.compact=function(e,r){if(2>arguments.length)throw new TypeError("Could not compact, too few arguments.");return o.apply(null,[function(e,r,n,i){t.compact(e,r,n,(function(e,t){i(e,t)}))}].concat(i.call(arguments)))},s.flatten=function(e){if(1>arguments.length)throw new TypeError("Could not flatten, too few arguments.");return o.apply(null,[t.flatten].concat(i.call(arguments)))},s.frame=function(e,r){if(2>arguments.length)throw new TypeError("Could not frame, too few arguments.");return o.apply(null,[t.frame].concat(i.call(arguments)))},s.fromRDF=function(e){if(1>arguments.length)throw new TypeError("Could not convert from RDF, too few arguments.");return o.apply(null,[t.fromRDF].concat(i.call(arguments)))},s.toRDF=function(e){if(1>arguments.length)throw new TypeError("Could not convert to RDF, too few arguments.");return o.apply(null,[t.toRDF].concat(i.call(arguments)))},s.normalize=function(e){if(1>arguments.length)throw new TypeError("Could not normalize, too few arguments.");return o.apply(null,[t.normalize].concat(i.call(arguments)))},"jsonld.js"===a&&(s.link=function(e,r){if(2>arguments.length)throw new TypeError("Could not link, too few arguments.");return o.apply(null,[t.link].concat(i.call(arguments)))},s.objectify=function(e){return o.apply(null,[t.objectify].concat(i.call(arguments)))},s.createNodeMap=function(e){return o.apply(null,[t.createNodeMap].concat(i.call(arguments)))},s.merge=function(e){return o.apply(null,[t.merge].concat(i.call(arguments)))});try{t.Promise=n.Promise||e("es6-promise").Promise}catch(u){for(var l in r=function(){throw Error("Unable to find a Promise implementation.")},s)s[l]=r}return s},t.promisify=function(r){if(!t.Promise)try{t.Promise=n.Promise||e("es6-promise").Promise}catch(s){throw Error("Unable to find a Promise implementation.")}var i=Array.prototype.slice.call(arguments,1);return new t.Promise((function(e,t){r.apply(null,i.concat((function(r,n){r?t(r):e(n)})))}))},t.promises({api:t.promises}),a.prototype=t.promises({version:"json-ld-1.0"}),a.prototype.toString=function(){return this instanceof a?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},t.JsonLdProcessor=a,q=!!Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(ie){q=!1}q&&(Object.defineProperty(a,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(a.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:a})),s&&void 0===n.JsonLdProcessor&&(q?Object.defineProperty(n,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:a}):n.JsonLdProcessor=a);var z="function"==typeof setImmediate&&setImmediate,q=z?function(e){z(e)}:function(e){setTimeout(e,0)};t.nextTick="object"==typeof r&&"function"==typeof r.nextTick?r.nextTick:q,t.setImmediate=z?q:t.nextTick,t.parseLinkHeader=function(e){var t={};e=e.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g);for(var r=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,n=0;n<e.length;++n){var i=e[n].match(r);if(i){for(var o={target:i[1]},s=i[2],a=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;i=a.exec(s);)o[i[1]]=void 0===i[2]?i[3]:i[2];_(t[i=o.rel||""])?t[i].push(o):t[i]=i in t?[t[i],o]:o}}return t},t.RequestQueue=function(){this._requests={}},t.RequestQueue.prototype.wrapLoader=function(e){return this._loader=e,this._usePromise=1===e.length,this.add.bind(this)},t.RequestQueue.prototype.add=function(e,r){var n=this;if(!r&&!n._usePromise)throw Error("callback must be specified.");if(n._usePromise)return new t.Promise((function(t,r){var i=n._requests[e];i||(i=n._requests[e]=n._loader(e).then((function(t){return delete n._requests[e],t})).catch((function(t){throw delete n._requests[e],t}))),i.then((function(e){t(e)})).catch((function(e){r(e)}))}));e in n._requests?n._requests[e].push(r):(n._requests[e]=[r],n._loader(e,(function(t,r){var i=n._requests[e];delete n._requests[e];for(var o=0;o<i.length;++o)i[o](t,r)})))},t.DocumentCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=3e4},t.DocumentCache.prototype.get=function(e){if(e in this.cache){var t=this.cache[e];if(t.expires>=+new Date)return t.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},t.DocumentCache.prototype.set=function(e,t){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:t,expires:+new Date+this.expires}},t.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},t.ActiveContextCache.prototype.get=function(e,t){var r=JSON.stringify(e),n=JSON.stringify(t);return(r=this.cache[r])&&n in r?r[n]:null},t.ActiveContextCache.prototype.set=function(e,t,r){if(this.order.length===this.size){var n=this.order.shift();delete this.cache[n.activeCtx][n.localCtx]}e=JSON.stringify(e),t=JSON.stringify(t),this.order.push({activeCtx:e,localCtx:t}),e in this.cache||(this.cache[e]={}),this.cache[e][t]=D(r)},t.cache={activeCtx:new t.ActiveContextCache},t.documentLoaders={},t.documentLoaders.jquery=function(e,r){function n(n,i){return 0!==n.indexOf("http:")&&0!==n.indexOf("https:")?i(new $('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null}):r.secure&&0!==n.indexOf("https")?i(new $('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null}):void e.ajax({url:n,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(e,r,o){if(e={contextUrl:null,documentUrl:n,document:e},r=o.getResponseHeader("Content-Type"),(o=o.getResponseHeader("Link"))&&"application/ld+json"!==r){if(_(o=t.parseLinkHeader(o)[K]))return i(new $("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:n}),e);o&&(e.contextUrl=o.target)}i(null,e)},error:function(e,t,r){i(new $("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:n,cause:r}),{contextUrl:null,documentUrl:n,document:null})}})}r=r||{};var i=new t.RequestQueue;return("usePromise"in r?r.usePromise:"undefined"!=typeof Promise)?i.wrapLoader((function(e){return t.promisify(n,e)})):i.wrapLoader(n)},t.documentLoaders.node=function(r){function n(e,l,u){if(0!==e.indexOf("http:")&&0!==e.indexOf("https:"))return u(new $('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null});if(r.secure&&0!==e.indexOf("https"))return u(new $('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null});var c=null;if(null!==c)return u(null,c);var f,h={Accept:"application/ld+json, application/json"};for(f in r.headers)h[f]=r.headers[f];s({url:e,headers:h,strictSSL:i,followRedirect:!1},(function(r,i,s){if(c={contextUrl:null,documentUrl:e,document:s||null},r)return u(new $("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:e,cause:r}),c);if(s=a.STATUS_CODES[i.statusCode],400<=i.statusCode)return u(new $("URL could not be dereferenced: "+s,"jsonld.InvalidUrl",{code:"loading document failed",url:e,httpStatusCode:i.statusCode}),c);if(i.headers.link&&"application/ld+json"!==i.headers["content-type"]){if(_(s=t.parseLinkHeader(i.headers.link)[K]))return u(new $("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:e}),c);s&&(c.contextUrl=s.target)}if(300<=i.statusCode&&400>i.statusCode&&i.headers.location)return l.length===o?u(new $("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:e,httpStatusCode:i.statusCode,redirects:l}),c):-1!==l.indexOf(e)?u(new $("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:e,httpStatusCode:i.statusCode,redirects:l}),c):(l.push(e),n(i.headers.location,l,u));l.push(e),u(r,c)}))}var i=!("strictSSL"in(r=r||{}))||r.strictSSL,o="maxRedirects"in r?r.maxRedirects:-1,s="request"in r?r.request:e("request"),a=e("http"),l=new t.RequestQueue;if(r.usePromise)return l.wrapLoader((function(e){return t.promisify(n,e,[])}));var u=r.headers||{};if("Accept"in u||"accept"in u)throw new RangeError('Accept header may not be specified as an option; only "application/ld+json, application/json" is supported.');return l.wrapLoader((function(e,t){n(e,[],t)}))},t.documentLoaders.xhr=function(e){function r(r,i){if(0!==r.indexOf("http:")&&0!==r.indexOf("https:"))return i(new $('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});if(e.secure&&0!==r.indexOf("https"))return i(new $('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});var o=new(e.xhr||XMLHttpRequest);o.onload=function(){if(400<=o.status)return i(new $("URL could not be dereferenced: "+o.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:r,httpStatusCode:o.status}),{contextUrl:null,documentUrl:r,document:null});var e,s={contextUrl:null,documentUrl:r,document:o.response},a=o.getResponseHeader("Content-Type");if(n.test(o.getAllResponseHeaders())&&(e=o.getResponseHeader("Link")),e&&"application/ld+json"!==a){if(_(e=t.parseLinkHeader(e)[K]))return i(new $("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r}),s);e&&(s.contextUrl=e.target)}i(null,s)},o.onerror=function(){i(new $("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null})},o.open("GET",r,!0),o.setRequestHeader("Accept","application/ld+json, application/json"),o.send()}e=e||{};var n=/(^|(\r\n))link:/i,i=new t.RequestQueue;return("usePromise"in e?e.usePromise:"undefined"!=typeof Promise)?i.wrapLoader((function(e){return t.promisify(r,e)})):i.wrapLoader(r)},t.useDocumentLoader=function(e){if(!(e in t.documentLoaders))throw new $('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});t.documentLoader=t.documentLoaders[e].apply(t,Array.prototype.slice.call(arguments,1))},t.processContext=function(e,r){var n={},i=2;3<arguments.length&&(n=arguments[2]||{},i+=1);var o=arguments[i];if("base"in n||(n.base=""),"documentLoader"in n||(n.documentLoader=t.loadDocument),null===r)return o(null,C(n));F(r=D(r))&&"@context"in r||(r={"@context":r}),B(r,n,(function(r,i){if(r)return o(r);try{i=(new Z).processContext(e,i,n)}catch(t){return o(t)}o(null,i)}))},t.hasProperty=function(e,t){var r=!1;return t in e&&(r=!_(r=e[t])||0<r.length),r},t.hasValue=function(e,r,n){var i=!1;if(t.hasProperty(e,r))if(r=I(e=e[r]),_(e)||r){for(r&&(e=e["@list"]),r=0;r<e.length;++r)if(t.compareValues(n,e[r])){i=!0;break}}else _(n)||(i=t.compareValues(n,e));return i},t.addValue=function(e,r,n,i){if("propertyIsArray"in(i=i||{})||(i.propertyIsArray=!1),"allowDuplicate"in i||(i.allowDuplicate=!0),_(n)){0!==n.length||!i.propertyIsArray||r in e||(e[r]=[]);for(var o=0;o<n.length;++o)t.addValue(e,r,n[o],i)}else r in e?(o=!i.allowDuplicate&&t.hasValue(e,r,n),_(e[r])||o&&!i.propertyIsArray||(e[r]=[e[r]]),o||e[r].push(n)):e[r]=i.propertyIsArray?[n]:n},t.getValues=function(e,t){var r=e[t]||[];return _(r)||(r=[r]),r},t.removeProperty=function(e,t){delete e[t]},t.removeValue=function(e,r,n,i){"propertyIsArray"in(i=i||{})||(i.propertyIsArray=!1);var o=t.getValues(e,r).filter((function(e){return!t.compareValues(e,n)}));0===o.length?t.removeProperty(e,r):e[r]=1!==o.length||i.propertyIsArray?o:o[0]},t.compareValues=function(e,t){return!!(e===t||M(e)&&M(t)&&e["@value"]===t["@value"]&&e["@type"]===t["@type"]&&e["@language"]===t["@language"]&&e["@index"]===t["@index"])||!!(F(e)&&"@id"in e&&F(t)&&"@id"in t)&&e["@id"]===t["@id"]},t.getContextValue=function(e,t,r){var n=null;return null===t||("@language"===r&&r in e&&(n=e[r]),e.mappings[t]&&(e=e.mappings[t],T(r)?n=e:r in e&&(n=e[r]))),n};var X={};if(t.registerRDFParser=function(e,t){X[e]=t},t.unregisterRDFParser=function(e){delete X[e]},o){if(void 0===H)var H=null;if(void 0===W)var W={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var V="http://www.w3.org/2001/XMLSchema#string",J="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",K="http://www.w3.org/ns/json-ld#context",Y=10,$=function(e,t,r){o?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=Error().stack),this.name=t||"jsonld.Error",this.message=e||"An unspecified JSON-LD error occurred.",this.details=r||{}};o?e("util").inherits($,Error):"undefined"!=typeof Error&&($.prototype=Error());var Z=function(){};Z.prototype.compact=function(e,r,n,i){if(_(n)){for(var o=[],s=0;s<n.length;++s){var a=this.compact(e,r,n[s],i);null!==a&&o.push(a)}if(i.compactArrays&&1===o.length)null===(v=t.getContextValue(e,r,"@container"))&&(o=o[0]);return o}if(F(n)){if(i.link&&"@id"in n&&n["@id"]in i.link)for(o=i.link[n["@id"]],s=0;s<o.length;++s)if(o[s].expanded===n)return o[s].compacted;if(M(n)||N(n))return o=function(e,r,n){if(M(n)){var i=t.getContextValue(e,r,"@type"),o=t.getContextValue(e,r,"@language"),s=t.getContextValue(e,r,"@container");if(!(s="@index"in n&&"@index"!==s)&&(n["@type"]===i||n["@language"]===o))return n["@value"];i=1===(i=Object.keys(n).length)||2===i&&"@index"in n&&!s,o="@language"in e;var a=A(n["@value"]);return r=e.mappings[r]&&null===e.mappings[r]["@language"],!i||o&&a&&!r?(r={},s&&(r[x(e,"@index")]=n["@index"]),"@type"in n?r[x(e,"@type")]=x(e,n["@type"],null,{vocab:!0}):"@language"in n&&(r[x(e,"@language")]=n["@language"]),r[x(e,"@value")]=n["@value"],r):n["@value"]}return s=k(e,r,{vocab:!0}),i=t.getContextValue(e,r,"@type"),n=x(e,n["@id"],null,{vocab:"@vocab"===i}),"@id"===i||"@vocab"===i||"@graph"===s?n:((r={})[x(e,"@id")]=n,r)}(e,r,n),i.link&&N(n)&&(n["@id"]in i.link||(i.link[n["@id"]]=[]),i.link[n["@id"]].push({expanded:n,compacted:o})),o;s="@reverse"===r,o={},i.link&&"@id"in n&&(n["@id"]in i.link||(i.link[n["@id"]]=[]),i.link[n["@id"]].push({expanded:n,compacted:o}));for(var l=Object.keys(n).sort(),u=0;u<l.length;++u){var c=l[u],f=n[c];if("@id"===c||"@type"===c){var h;if(A(f))h=x(e,f,null,{vocab:"@type"===c});else{h=[];for(var p=0;p<f.length;++p)h.push(x(e,f[p],null,{vocab:!0}))}c=x(e,c),v=_(h)&&0===f.length,t.addValue(o,c,h,{propertyIsArray:v})}else if("@reverse"===c){for(a in h=this.compact(e,"@reverse",f,i))e.mappings[a]&&e.mappings[a].reverse&&(f=h[a],v=t.getContextValue(e,a,"@container"),t.addValue(o,a,f,{propertyIsArray:"@set"===v||!i.compactArrays}),delete h[a]);0<Object.keys(h).length&&(c=x(e,c),t.addValue(o,c,h))}else if("@index"===c)"@index"!==(v=t.getContextValue(e,r,"@container"))&&(c=x(e,c),t.addValue(o,c,f));else if("@graph"!==c&&"@list"!==c&&S(c))c=x(e,c),t.addValue(o,c,f);else for(0===f.length&&(h=x(e,c,f,{vocab:!0},s),t.addValue(o,h,f,{propertyIsArray:!0})),p=0;p<f.length;++p){var d=f[p];h=x(e,c,d,{vocab:!0},s);var g,v=t.getContextValue(e,h,"@container"),y=I(d),m=null;if(y&&(m=d["@list"]),m=this.compact(e,h,y?m:d,i),y)if(_(m)||(m=[m]),"@list"!==v)(y={})[x(e,"@list")]=m,m=y,"@index"in d&&(m[x(e,"@index")]=d["@index"]);else if(h in o)throw new $('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===v||"@index"===v)h in o?g=o[h]:o[h]=g={},"@language"===v&&M(m)&&(m=m["@value"]),t.addValue(g,d[v],m);else v=!i.compactArrays||"@set"===v||"@list"===v||_(m)&&0===m.length||"@list"===c||"@graph"===c,t.addValue(o,h,m,{propertyIsArray:v})}}return o}return n},Z.prototype.expand=function(e,r,n,i,o){if(null==n)return null;if(!_(n)&&!F(n))return o||null!==r&&"@graph"!==k(e,r,{vocab:!0})?function(e,r,n){if(null==n)return null;var i=k(e,r,{vocab:!0});if("@id"===i)return k(e,n,{base:!0});if("@type"===i)return k(e,n,{vocab:!0,base:!0});var o=t.getContextValue(e,r,"@type");return"@id"===o||"@graph"===i&&A(n)?{"@id":k(e,n,{base:!0})}:"@vocab"===o?{"@id":k(e,n,{vocab:!0,base:!0})}:S(i)?n:(i={},null!==o?i["@type"]=o:A(n)&&null!==(e=t.getContextValue(e,r,"@language"))&&(i["@language"]=e),-1===["boolean","number","string"].indexOf(typeof n)&&(n=n.toString()),i["@value"]=n,i)}(e,r,n):null;if(_(n)){var s=[],a=t.getContextValue(e,r,"@container");o=o||"@list"===a;for(var l=0;l<n.length;++l){var u=this.expand(e,r,n[l],i);if(o&&(_(u)||I(u)))throw new $("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==u&&(_(u)?s=s.concat(u):s.push(u))}return s}"@context"in n&&(e=this.processContext(e,n["@context"],i));l=k(e,r,{vocab:!0}),s={},u=Object.keys(n).sort();for(var c=0;c<u.length;++c){var f=u[c],h=n[f];if("@context"!==f){var p=k(e,f,{vocab:!0});if(null!==p&&(O(p)||S(p))){if(S(p)){if("@reverse"===l)throw new $("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:h});if(p in s)throw new $("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:p})}if("@id"===p&&!A(h)){if(!i.isFrame)throw new $('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:h});if(!F(h))throw new $('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:h})}if("@type"===p){var d=void 0;if((d=A(a=h))||(d=F(a)&&0===Object.keys(a).length),!d){if(d=!1,_(a)){d=!0;for(var g=0;g<a.length;++g)if(!A(a[g])){d=!1;break}}if(!d)throw new $('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:a})}}if("@graph"===p&&!F(h)&&!_(h))throw new $('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:h});if("@value"===p&&(F(h)||_(h)))throw new $('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:h});if("@language"===p){if(null===h)continue;if(!A(h))throw new $('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:h});h=h.toLowerCase()}if("@index"===p&&!A(h))throw new $('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:h});if("@reverse"===p){if(!F(h))throw new $('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:h});if("@reverse"in(h=this.expand(e,"@reverse",h,i)))for(var v in h["@reverse"])t.addValue(s,v,h["@reverse"][v],{propertyIsArray:!0});for(v in f=s["@reverse"]||null,h)if("@reverse"!==v)for(null===f&&(f=s["@reverse"]={}),t.addValue(f,v,[],{propertyIsArray:!0}),p=h[v],a=0;a<p.length;++a){if(M(d=p[a])||I(d))throw new $('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:h});t.addValue(f,v,d,{propertyIsArray:!0})}}else{if("@language"===(a=t.getContextValue(e,f,"@container"))&&F(h)){d=[],g=Object.keys(h).sort();for(var y=0;y<g.length;++y){var m=g[y],b=h[m];_(b)||(b=[b]);for(var x=0;x<b.length;++x){var w=b[x];if(null!==w){if(!A(w))throw new $("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:h});d.push({"@value":w,"@language":m.toLowerCase()})}}}h=d}else if("@index"===a&&F(h)){for(d=f,g=[],y=Object.keys(h).sort(),m=0;m<y.length;++m)for(_(x=h[b=y[m]])||(x=[x]),x=this.expand(e,d,x,i,!1),w=0;w<x.length;++w){var C=x[w];"@index"in C||(C["@index"]=b),g.push(C)}h=g}else if((d="@list"===p)||"@set"===p){if(g=r,d&&"@graph"===l&&(g=null),h=this.expand(e,g,h,i,d),d&&I(h))throw new $("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else h=this.expand(e,f,h,i,!1);if(null!==h||"@value"===p)if("@list"===p||I(h)||"@list"!==a||(h={"@list":h=_(h)?h:[h]}),e.mappings[f]&&e.mappings[f].reverse)for(f=s["@reverse"]=s["@reverse"]||{},_(h)||(h=[h]),a=0;a<h.length;++a){if(M(d=h[a])||I(d))throw new $('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:h});t.addValue(f,p,d,{propertyIsArray:!0})}else f=-1===["@index","@id","@type","@value","@language"].indexOf(p),t.addValue(s,p,h,{propertyIsArray:f})}}}}if(e=(u=Object.keys(s)).length,"@value"in s){if("@type"in s&&"@language"in s)throw new $('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});if(n=e-1,"@type"in s&&--n,"@index"in s&&--n,"@language"in s&&--n,0!==n)throw new $('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});if(null===s["@value"])s=null;else{if("@language"in s&&!A(s["@value"]))throw new $("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:s});if("@type"in s&&(!O(s["@type"])||0===s["@type"].indexOf("_:")))throw new $('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:s})}}else if("@type"in s&&!_(s["@type"]))s["@type"]=[s["@type"]];else if("@set"in s||"@list"in s){if(1<e&&(2!==e||!("@index"in s)))throw new $('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:s});"@set"in s&&(s=s["@set"],e=(u=Object.keys(s)).length)}else 1===e&&"@language"in s&&(s=null);return!F(s)||i.keepFreeFloatingNodes||o||null!==r&&"@graph"!==l||!(0===e||"@value"in s||"@list"in s||1===e&&"@id"in s)||(s=null),s},Z.prototype.createNodeMap=function(e,t){var r={"@default":{}};return c(e,r,"@default",(t=t||{}).namer||t.issuer||new U("_:b")),f(r)},Z.prototype.flatten=function(e){e=this.createNodeMap(e);for(var t=[],r=Object.keys(e).sort(),n=0;n<r.length;++n){var i=e[r[n]];N(i)||t.push(i)}return t},Z.prototype.frame=function(e,t,r){r={options:r,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}};var n=new U("_:b");return c(e,r.graphs,"@merged",n),r.subjects=r.graphs["@merged"],e=[],h(r,Object.keys(r.subjects).sort(),t,e,null),e},Z.prototype.normalize=function(e,t,r){return"URDNA2015"===t.algorithm?new ee(t).main(e,r):"URGNA2012"===t.algorithm?new te(t).main(e,r):void r(Error("Invalid RDF Dataset Normalization algorithm: "+t.algorithm))},Z.prototype.fromRDF=function(e,r,n){var i,o={},s={"@default":o},a={};for(i in e){var l=e[i];i in s||(s[i]={}),"@default"===i||i in o||(o[i]={"@id":i});for(var u=s[i],c=0;c<l.length;++c){var f=(p=l[c]).subject.value,h=p.predicate.value,p=p.object;f in u||(u[f]={"@id":f});f=u[f];var d="IRI"===p.type||"blank node"===p.type;if(!d||p.value in u||(u[p.value]={"@id":p.value}),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===h&&!r.useRdfType&&d)t.addValue(f,"@type",p.value,{propertyIsArray:!0});else{var g,v=p,y=r.useNativeTypes;"IRI"===v.type||"blank node"===v.type?g={"@id":v.value}:(g={"@value":v.value},v.language?g["@language"]=v.language:((v=v.datatype)||(v=V),y?("http://www.w3.org/2001/XMLSchema#boolean"===v?"true"===g["@value"]?g["@value"]=!0:"false"===g["@value"]&&(g["@value"]=!1):(y=g["@value"],!isNaN(parseFloat(y))&&isFinite(y)&&("http://www.w3.org/2001/XMLSchema#integer"===v?(y=parseInt(g["@value"],10)).toFixed(0)===g["@value"]&&(g["@value"]=y):"http://www.w3.org/2001/XMLSchema#double"===v&&(g["@value"]=parseFloat(g["@value"])))),-1===["http://www.w3.org/2001/XMLSchema#boolean","http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#double",V].indexOf(v)&&(g["@type"]=v)):v!==V&&(g["@type"]=v))),t.addValue(f,h,g,{propertyIsArray:!0}),d&&("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===p.value?("usages"in(p=u[p.value])||(p.usages=[]),p.usages.push({node:f,property:h,value:g})):a[p.value]=!(p.value in a)&&{node:f,property:h,value:g})}}}for(i in s)if("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"in(r=s[i])){for(l=r["http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"],e=0;e<l.usages.length;++e){for(f=(p=l.usages[e]).node,c=p.property,p=p.value,h=[],u=[],d=Object.keys(f).length;"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"===c&&F(a[f["@id"]])&&_(f["http://www.w3.org/1999/02/22-rdf-syntax-ns#first"])&&1===f["http://www.w3.org/1999/02/22-rdf-syntax-ns#first"].length&&_(f["http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"])&&1===f["http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"].length&&(3===d||4===d&&_(f["@type"])&&1===f["@type"].length&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#List"===f["@type"][0])&&(h.push(f["http://www.w3.org/1999/02/22-rdf-syntax-ns#first"][0]),u.push(f["@id"]),f=(p=a[f["@id"]]).node,c=p.property,p=p.value,d=Object.keys(f).length,0===f["@id"].indexOf("_:")););if("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"===c){if("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===f["@id"])continue;p=r[p["@id"]]["http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"][0],h.pop(),u.pop()}for(delete p["@id"],p["@list"]=h.reverse(),f=0;f<u.length;++f)delete r[u[f]]}delete l.usages}for(a=[],i=Object.keys(o).sort(),e=0;e<i.length;++e){if(f=o[r=i[e]],r in s)for(l=f["@graph"]=[],r=s[r],u=Object.keys(r).sort(),c=0;c<u.length;++c)N(h=r[u[c]])||l.push(h);N(f)||a.push(f)}n(null,a)},Z.prototype.toRDF=function(e,t){var r=new U("_:b"),n={"@default":{}};c(e,n,"@default",r);for(var i={},o=Object.keys(n).sort(),s=0;s<o.length;++s){if("@default"===(l=o[s])||O(l)){for(var a=l,l=n[l],f=r,h=t,p=[],d=Object.keys(l).sort(),g=0;g<d.length;++g)for(var v=d[g],y=l[v],m=Object.keys(y).sort(),b=0;b<m.length;++b){var x=m[b],w=y[x];if("@type"===x)x="http://www.w3.org/1999/02/22-rdf-syntax-ns#type";else if(S(x))continue;for(var k=0;k<w.length;++k){var C=w[k],F={};if(F.type=0===v.indexOf("_:")?"blank node":"IRI",F.value=v,O(v)){var _={};if(_.type=0===x.indexOf("_:")?"blank node":"IRI",_.value=x,O(x)&&("blank node"!==_.type||h.produceGeneralizedRdf))if(I(C)){C=C["@list"];for(var A=f,E=p,L={type:"IRI",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},T={type:"IRI",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},N=0;N<C.length;++N){var M=C[N],j={type:"blank node",value:A.getId()};E.push({subject:F,predicate:_,object:j}),F=j,_=L,(M=u(M))&&E.push({subject:F,predicate:_,object:M}),_=T}E.push({subject:F,predicate:_,object:{type:"IRI",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}})}else(C=u(C))&&p.push({subject:F,predicate:_,object:C})}}}i[a]=p}}return i},Z.prototype.processContext=function(e,r,n){if(F(r)&&"@context"in r&&_(r["@context"])&&(r=r["@context"]),0===(r=_(r)?r:[r]).length)return e.clone();for(var i=e,o=0;o<r.length;++o){var s=r[o];if(null===s)i=e=C(n);else{if(F(s)&&"@context"in s&&(s=s["@context"]),!F(s))throw new $("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:s});if(t.cache.activeCtx&&(e=t.cache.activeCtx.get(e,s))){i=e;continue}e=i;i=i.clone();var a={};if("@base"in s){var l=s["@base"];if(null===l)l=null;else{if(!A(l))throw new $('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s});if(""!==l&&!O(l))throw new $('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s})}null!==l&&(l=t.url.parse(l||"")),i["@base"]=l,a["@base"]=!0}if("@vocab"in s){if(null===(l=s["@vocab"]))delete i["@vocab"];else{if(!A(l))throw new $('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});if(!O(l))throw new $('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});i["@vocab"]=l}a["@vocab"]=!0}if("@language"in s){if(null===(l=s["@language"]))delete i["@language"];else{if(!A(l))throw new $('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:s});i["@language"]=l.toLowerCase()}a["@language"]=!0}for(var u in s)w(i,s,u,a);t.cache.activeCtx&&t.cache.activeCtx.set(e,s,i)}}return i};var ee=function(){var e={subject:"s",object:"o",name:"g"},r=function(e){e=e||{},this.name="URDNA2015",this.options=e,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new U("_:c14n"),this.quads=[],this.schedule={},this.schedule.MAX_DEPTH="maxCallStackDepth"in e?e.maxCallStackDepth:500,this.schedule.MAX_TOTAL_DEPTH="maxTotalCallStackDepth"in e?e.maxCallStackDepth:4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice="timeSlice"in e?e.timeSlice:10};return r.prototype.doWork=function(e,r){var n=this.schedule;if(n.totalDepth>=n.MAX_TOTAL_DEPTH)return r(Error("Maximum total call stack depth exceeded; normalization aborting."));!function i(){if(n.depth===n.MAX_DEPTH)return n.depth=0,n.running=!1,t.nextTick(i);var o=(new Date).getTime();if(n.running||(n.start=(new Date).getTime(),n.deadline=n.start+n.timeSlice),o<n.deadline)return n.running=!0,n.depth++,n.totalDepth++,e((function(e,t){n.depth--,n.totalDepth--,r(e,t)}));n.depth=0,n.running=!1,t.setImmediate(i)}()},r.prototype.forEach=function(e,t,r){var n,i,o=this,s=0;if(_(e))i=e.length,n=function(){return s!==i&&(n.value=e[s++],n.key=s,!0)};else{var a=Object.keys(e);i=a.length,n=function(){return s!==i&&(n.key=a[s++],n.value=e[n.key],!0)}}!function e(i,s){return i?r(i):n()?o.doWork((function(){t(n.value,n.key,e)})):void r()}()},r.prototype.waterfall=function(e,t){var r=this;r.forEach(e,(function(e,t,n){r.doWork(e,n)}),t)},r.prototype.whilst=function(e,t,r){var n=this;!function i(o){return o?r(o):e()?void n.doWork(t,i):r()}()},r.prototype.main=function(e,t){var r,n=this;if(n.schedule.start=(new Date).getTime(),n.options.format&&"application/nquads"!==n.options.format)return t(new $("Unknown output format.","jsonld.UnknownFormat",{format:n.options.format}));var i={};n.waterfall([function(t){n.forEach(e,(function(e,t,r){"@default"===t&&(t=null),n.forEach(e,(function(e,r,o){null!==t&&(0===t.indexOf("_:")?e.name={type:"blank node",value:t}:e.name={type:"IRI",value:t}),n.quads.push(e),n.forEachComponent(e,(function(t){"blank node"===t.type&&((t=t.value)in n.blankNodeInfo?n.blankNodeInfo[t].quads.push(e):(i[t]=!0,n.blankNodeInfo[t]={quads:[e]}))})),o()}),r)}),t)},function(e){var t=!0;n.whilst((function(){return t}),(function(e){t=!1,n.hashToBlankNodes={},n.waterfall([function(e){n.forEach(i,(function(e,t,r){n.hashFirstDegreeQuads(t,(function(e,i){if(e)return r(e);i in n.hashToBlankNodes?n.hashToBlankNodes[i].push(t):n.hashToBlankNodes[i]=[t],r()}))}),e)},function(e){var r=Object.keys(n.hashToBlankNodes).sort();n.forEach(r,(function(e,r,o){if(1<(r=n.hashToBlankNodes[e]).length)return o();r=r[0],n.canonicalIssuer.getId(r),delete i[r],delete n.hashToBlankNodes[e],t=!0,o()}),e)}],e)}),e)},function(e){var t=Object.keys(n.hashToBlankNodes).sort();n.forEach(t,(function(e,t,r){var i=[],o=n.hashToBlankNodes[e];n.waterfall([function(e){n.forEach(o,(function(e,t,r){if(n.canonicalIssuer.hasId(e))return r();(t=new U("_:b")).getId(e),n.hashNDegreeQuads(e,t,(function(e,t){if(e)return r(e);i.push(t),r()}))}),e)},function(e){i.sort((function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0})),n.forEach(i,(function(e,t,r){for(var i in e.issuer.existing)n.canonicalIssuer.getId(i);r()}),e)}],r)}),e)},function(e){var t=[];n.waterfall([function(e){n.forEach(n.quads,(function(e,r,i){n.forEachComponent(e,(function(e){"blank node"===e.type&&0!==e.value.indexOf(n.canonicalIssuer.prefix)&&(e.value=n.canonicalIssuer.getId(e.value))})),t.push(Q(e)),i()}),e)},function(e){if(t.sort(),"application/nquads"===n.options.format)return r=t.join(""),e();r=P(t.join("")),e()}],e)}],(function(e){t(e,r)}))},r.prototype.hashFirstDegreeQuads=function(e,t){var r=this,n=r.blankNodeInfo[e];if("hash"in n)return t(null,n.hash);var i=[];r.forEach(n.quads,(function(t,n,o){var s={predicate:t.predicate};r.forEachComponent(t,(function(t,n){s[n]=r.modifyFirstDegreeComponent(e,t,n)})),i.push(Q(s)),o()}),(function(e){if(e)return t(e);i.sort(),n.hash=ne.hashNQuads(r.name,i),t(null,n.hash)}))},r.prototype.modifyFirstDegreeComponent=function(e,t){return"blank node"!==t.type||((t=D(t)).value=t.value===e?"_:a":"_:z"),t},r.prototype.hashRelatedBlankNode=function(e,t,r,n,i){var o,s=this;s.waterfall([function(t){return s.canonicalIssuer.hasId(e)?(o=s.canonicalIssuer.getId(e),t()):r.hasId(e)?(o=r.getId(e),t()):void s.hashFirstDegreeQuads(e,(function(e,r){if(e)return t(e);o=r,t()}))}],(function(e){return e?i(e):((e=new ne(s.name)).update(n),"g"!==n&&e.update(s.getRelatedPredicate(t)),e.update(o),i(null,e.digest()))}))},r.prototype.getRelatedPredicate=function(e){return"<"+e.predicate.value+">"},r.prototype.hashNDegreeQuads=function(e,t,r){var n,i=this,o=new ne(i.name);i.waterfall([function(r){i.createHashToRelated(e,t,(function(e,t){if(e)return r(e);n=t,r()}))},function(e){var r=Object.keys(n).sort();i.forEach(r,(function(e,r,s){o.update(e);var a,l="",u=new re(n[e]);i.whilst((function(){return u.hasNext()}),(function(e){var r=u.next(),n=t.clone(),o="",s=[];i.waterfall([function(t){i.forEach(r,(function(t,r,a){if(i.canonicalIssuer.hasId(t)?o+=i.canonicalIssuer.getId(t):(n.hasId(t)||s.push(t),o+=n.getId(t)),0!==l.length&&o.length>=l.length&&o>l)return e();a()}),t)},function(t){i.forEach(s,(function(t,r,s){i.hashNDegreeQuads(t,n,(function(r,i){return r?s(r):(o+=n.getId(t),o+="<"+i.hash+">",n=i.issuer,0!==l.length&&o.length>=l.length&&o>l?e():void s())}))}),t)},function(e){(0===l.length||o<l)&&(l=o,a=n),e()}],e)}),(function(e){if(e)return s(e);o.update(l),t=a,s()}))}),e)}],(function(e){r(e,{hash:o.digest(),issuer:t})}))},r.prototype.createHashToRelated=function(t,r,n){var i=this,o={};i.forEach(i.blankNodeInfo[t].quads,(function(n,s,a){i.forEach(n,(function(s,a,l){if("predicate"===a||"blank node"!==s.type||s.value===t)return l();var u=s.value;i.hashRelatedBlankNode(u,n,r,e[a],(function(e,t){if(e)return l(e);t in o?o[t].push(u):o[t]=[u],l()}))}),a)}),(function(e){n(e,o)}))},r.prototype.forEachComponent=function(e,t){for(var r in e)"predicate"!==r&&t(e[r],r,e)},r}(),te=function(){var e=function(e){ee.call(this,e),this.name="URGNA2012"};return e.prototype=new ee,e.prototype.modifyFirstDegreeComponent=function(e,t,r){return"blank node"!==t.type||((t=D(t)).value="name"===r?"_:g":t.value===e?"_:a":"_:z"),t},e.prototype.getRelatedPredicate=function(e){return e.predicate.value},e.prototype.createHashToRelated=function(e,t,r){var n=this,i={};n.forEach(n.blankNodeInfo[e].quads,(function(r,o,s){var a;if("blank node"===r.subject.type&&r.subject.value!==e)a=r.subject.value,o="p";else{if("blank node"!==r.object.type||r.object.value===e)return s();a=r.object.value,o="r"}n.hashRelatedBlankNode(a,r,t,o,(function(e,t){t in i?i[t].push(a):i[t]=[a],s()}))}),(function(e){r(e,i)}))},e}();Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r}),t.registerRDFParser("application/nquads",P),t.registerRDFParser("rdfa-api",(function(t){for(var r={"@default":[]},n=t.getSubjects(),i=0;i<n.length;++i){var o=n[i];if(null!==o)if(null!==(a=t.getSubjectTriples(o))){var s,a=a.predicates;for(s in a)for(var l=a[s].objects,u=0;u<l.length;++u){var c=l[u],f={};0===o.indexOf("_:")?f.subject={type:"blank node",value:o}:f.subject={type:"IRI",value:o},0===s.indexOf("_:")?f.predicate={type:"blank node",value:s}:f.predicate={type:"IRI",value:s};var h=c.value;if("http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===c.type){H||(H=e("xmldom").XMLSerializer);for(var p=new H,d=(h="",0);d<c.value.length;d++)c.value[d].nodeType===W.ELEMENT_NODE?h+=p.serializeToString(c.value[d]):c.value[d].nodeType===W.TEXT_NODE&&(h+=c.value[d].nodeValue)}f.object={},"http://www.w3.org/1999/02/22-rdf-syntax-ns#object"===c.type?0===c.value.indexOf("_:")?f.object.type="blank node":f.object.type="IRI":(f.object.type="literal","http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral"===c.type?c.language?(f.object.datatype=J,f.object.language=c.language):f.object.datatype=V:f.object.datatype=c.type),f.object.value=h,r["@default"].push(f)}}}return r})),t.IdentifierIssuer=U,t.UniqueNamer=U,U.prototype.clone=function(){var e=new U(this.prefix);return e.counter=this.counter,e.existing=D(this.existing),e},U.prototype.getId=function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t},U.prototype.getName=U.prototype.getName,U.prototype.hasId=function(e){return e in this.existing},U.prototype.isNamed=U.prototype.hasId;var re=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var t=0;t<e.length;++t)this.left[e[t]]=!0};re.prototype.hasNext=function(){return!this.done},re.prototype.next=function(){for(var e=this.list.slice(),t=null,r=0,n=this.list.length,i=0;i<n;++i){var o=this.list[i],s=this.left[o];(null===t||o>t)&&(s&&0<i&&o>this.list[i-1]||!s&&i<n-1&&o>this.list[i+1])&&(t=o,r=i)}if(null===t)this.done=!0;else for(i=this.left[t]?r-1:r+1,this.list[r]=this.list[i],this.list[i]=t,i=0;i<n;++i)this.list[i]>t&&(this.left[this.list[i]]=!this.left[this.list[i]]);return e};var ne=function(e){if(!(this instanceof ne))return new ne(e);if(-1===["URDNA2015","URGNA2012"].indexOf(e))throw Error("Invalid RDF Dataset Normalization algorithm: "+e);ne._init.call(this,e)};return ne.hashNQuads=function(e,t){for(var r=new ne(e),n=0;n<t.length;++n)r.update(t[n]);return r.digest()},function(t){if(t){var r=e("crypto");ne._init=function(e){this.md=r.createHash("URDNA2015"===e?"sha256":"sha1")},ne.prototype.update=function(e){return this.md.update(e,"utf8")},ne.prototype.digest=function(){return this.md.digest("hex")}}else{ne._init=function(e){e="URDNA2015"===e?new o.Algorithm:new i.Algorithm,this.md=new n(e)},ne.prototype.update=function(e){return this.md.update(e)},ne.prototype.digest=function(){return this.md.digest().toHex()};var n=function(e){if(!(this instanceof n))return new n(e);if(this._algorithm=e,!n._padding||n._padding.length<this._algorithm.blockSize){n._padding=String.fromCharCode(128),e=String.fromCharCode(0);for(var t=64;0<t;)1&t&&(n._padding+=e),0<(t>>>=1)&&(e+=e)}this.start()};n.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var e=this._algorithm.messageLengthSize/4,t=0;t<e;++t)this.fullMessageLength.push(0);return this._input=new n.ByteBuffer,this.state=this._algorithm.start(),this},n.prototype.update=function(e){e=new n.ByteBuffer(unescape(encodeURIComponent(e))),this.messageLength+=e.length();for(var t=[(t=e.length())/4294967296>>>0,t>>>0],r=this.fullMessageLength.length-1;0<=r;--r)this.fullMessageLength[r]+=t[1],t[1]=t[0]+(this.fullMessageLength[r]/4294967296>>>0),this.fullMessageLength[r]>>>=0,t[0]=t[1]/4294967296>>>0;for(this._input.putBytes(e.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(2048<this._input.read||0===this._input.length())&&this._input.compact(),this},n.prototype.digest=function(){var e=new n.ByteBuffer;e.putBytes(this._input.bytes()),e.putBytes(n._padding.substr(0,this._algorithm.blockSize-(this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize&this._algorithm.blockSize-1)));for(var t=new n.ByteBuffer,r=0;r<this.fullMessageLength.length;++r)t.putInt32(this.fullMessageLength[r]<<3|this.fullMessageLength[r+1]>>>28);return this._algorithm.writeMessageLength(e,t),e=this._algorithm.digest(this.state.copy(),e),t=new n.ByteBuffer,e.write(t),t},n.ByteBuffer=function(e){this.data="string"==typeof e?e:"",this.read=0},n.ByteBuffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},n.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},n.ByteBuffer.prototype.putBytes=function(e){this.data+=e},n.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},n.ByteBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},n.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);16>r&&(e+="0"),e+=r.toString(16)}return e};var i={_w:null,Algorithm:function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8}};i.Algorithm.prototype.start=function(){return i._w||(i._w=Array(80)),i._createState()},i.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},i.Algorithm.prototype.digest=function(e,t){for(var r,n,o,s,a,l,u,c=t.length(),f=i._w;64<=c;){for(n=e.h0,o=e.h1,s=e.h2,a=e.h3,l=e.h4,u=0;16>u;++u)r=t.getInt32(),f[u]=r,r=(n<<5|n>>>27)+(a^o&(s^a))+l+1518500249+r,l=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;20>u;++u)r=(r=f[u-3]^f[u-8]^f[u-14]^f[u-16])<<1|r>>>31,f[u]=r,r=(n<<5|n>>>27)+(a^o&(s^a))+l+1518500249+r,l=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;32>u;++u)r=(r=f[u-3]^f[u-8]^f[u-14]^f[u-16])<<1|r>>>31,f[u]=r,r=(n<<5|n>>>27)+(o^s^a)+l+1859775393+r,l=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;40>u;++u)r=(r=f[u-6]^f[u-16]^f[u-28]^f[u-32])<<2|r>>>30,f[u]=r,r=(n<<5|n>>>27)+(o^s^a)+l+1859775393+r,l=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;60>u;++u)r=(r=f[u-6]^f[u-16]^f[u-28]^f[u-32])<<2|r>>>30,f[u]=r,r=(n<<5|n>>>27)+(o&s|a&(o^s))+l+2400959708+r,l=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;80>u;++u)r=(r=f[u-6]^f[u-16]^f[u-28]^f[u-32])<<2|r>>>30,f[u]=r,r=(n<<5|n>>>27)+(o^s^a)+l+3395469782+r,l=a,a=s,s=o<<30|o>>>2,o=n,n=r;e.h0=e.h0+n|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+l|0,c-=64}return e},i._createState=function(){var e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520,copy:function(){var t=i._createState();return t.h0=e.h0,t.h1=e.h1,t.h2=e.h2,t.h3=e.h3,t.h4=e.h4,t},write:function(t){t.putInt32(e.h0),t.putInt32(e.h1),t.putInt32(e.h2),t.putInt32(e.h3),t.putInt32(e.h4)}};return e};var o={_k:null,_w:null,Algorithm:function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8}};o.Algorithm.prototype.start=function(){return o._k||o._init(),o._createState()},o.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},o.Algorithm.prototype.digest=function(e,t){for(var r,n,i,s,a,l,u,c,f,h,p,d,g=t.length(),v=o._k,y=o._w;64<=g;){for(s=0;16>s;++s)y[s]=t.getInt32();for(;64>s;++s)r=((r=y[s-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,n=((n=y[s-15])>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,y[s]=r+y[s-7]+n+y[s-16]|0;for(a=e.h0,l=e.h1,u=e.h2,c=e.h3,f=e.h4,h=e.h5,p=e.h6,d=e.h7,s=0;64>s;++s)n=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),i=a&l|u&(a^l),r=d+(r=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(p^f&(h^p))+v[s]+y[s],d=p,p=h,h=f,f=c+r|0,c=u,u=l,l=a,a=r+(n+=i)|0;e.h0=e.h0+a|0,e.h1=e.h1+l|0,e.h2=e.h2+u|0,e.h3=e.h3+c|0,e.h4=e.h4+f|0,e.h5=e.h5+h|0,e.h6=e.h6+p|0,e.h7=e.h7+d|0,g-=64}return e},o._createState=function(){var e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225,copy:function(){var t=o._createState();return t.h0=e.h0,t.h1=e.h1,t.h2=e.h2,t.h3=e.h3,t.h4=e.h4,t.h5=e.h5,t.h6=e.h6,t.h7=e.h7,t},write:function(t){t.putInt32(e.h0),t.putInt32(e.h1),t.putInt32(e.h2),t.putInt32(e.h3),t.putInt32(e.h4),t.putInt32(e.h5),t.putInt32(e.h6),t.putInt32(e.h7)}};return e},o._init=function(){o._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o._w=Array(64)}}}(o),t.url={},t.url.parsers={simple:{keys:"href scheme authority path query fragment".split(" "),regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:"href protocol scheme authority auth user password hostname port path directory file query fragment".split(" "),regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},t.url.parse=function(e,r){for(var n={},i=t.url.parsers[r||"full"],o=i.regex.exec(e),s=i.keys.length;s--;)n[i.keys[s]]=void 0===o[s]?null:o[s];return n.normalizedPath=G(n.path,!!n.authority),n},o?t.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&t.useDocumentLoader("xhr"),o&&(t.use=function(r){switch(r){case"request":t.request=e("jsonld-request");break;default:throw new $("Unknown extension.","jsonld.UnknownExtension",{extension:r})}},q={exports:{},filename:i},e("pkginfo")(q,"version"),t.version=q.exports.version),t},l=function(){return a((function(){return l()}))};a(l),"function"==typeof e&&void 0!==t&&t.exports&&(t.exports=l),s&&("undefined"==typeof jsonld?jsonld=jsonldjs=l:jsonldjs=l)}()}).call(this,e("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/../node_modules/jsonld/js")},{"7YKIPe":10,crypto:25,"es6-promise":3,http:25,"jsonld-request":25,pkginfo:25,request:25,util:25,xmldom:25}],27:[function(e,t,r){var n=e;e=function(){},r=t.exports={Lexer:e("./lib/N3Lexer"),Parser:e("./lib/N3Parser"),Writer:e("./lib/N3Writer"),Store:e("./lib/N3Store"),StreamParser:e("./lib/N3StreamParser"),StreamWriter:e("./lib/N3StreamWriter"),Util:e("./lib/N3Util")},Object.keys(r).forEach((function(e){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){return delete r[e],r[e]=n("./lib/N3"+e)}})}))},{"./lib/N3Lexer":28,"./lib/N3Parser":29,"./lib/N3Store":30,"./lib/N3StreamParser":31,"./lib/N3StreamWriter":32,"./lib/N3Util":33,"./lib/N3Writer":34}],28:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);if(e&&e.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var t=this;this._tokenize=this.tokenize,this.tokenize=function(e,r){this._tokenize(e,(function(e,n){!e&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(n.type)?r&&r(e,n):r&&r(e||t._syntaxError(n.type,r=null))}))}}}var i=String.fromCharCode,o="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},s=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,a={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},l=/[\x00-\x20<>\\"\{\}\|\^\`]/;n.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(e,t){function r(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}for(var n=this._input;;){for(var i;i=this._newline.exec(n);)n=n.substr(i[0].length,n.length),this._line++;if((i=this._whitespace.exec(n))&&(n=n.substr(i[0].length,n.length)),this._endOfFile.test(n))return t&&e(n=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=n;i=this._line;var o="",s="",a="",u=n[0],c=null,f=0,h=!1;switch(u){case"^":if(1===n.length)break;if("^"!==n[1])return r(this);if(this._prevTokenType="^","<"!==(n=n.substr(2))[0]){h=!0;break}case"<":if(c=this._unescapedIri.exec(n))o="IRI",s=c[1];else if(c=this._iri.exec(n)){if(null===(s=this._unescape(c[1]))||l.test(s))return r(this);o="IRI"}break;case"_":((c=this._blank.exec(n))||t&&(c=this._blank.exec(n+" ")))&&(o="prefixed",a="_",s=c[1]);break;case'"':case"'":if(c=this._unescapedString.exec(n))o="literal",s=c[0];else if(c=this._singleQuotedString.exec(n)){if(null===(s=this._unescape(c[0])))return r(this);o="literal",s=s.replace(/^'|'$/g,'"')}else if(c=this._tripleQuotedString.exec(n)){if(s=c[1]||c[2],this._line+=s.split(/\r\n|\r|\n/).length-1,null===(s=this._unescape(s)))return r(this);o="literal",s=s.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(c=this._langcode.exec(n))?(o="langcode",s=c[1]):(c=this._keyword.exec(n))&&(o=c[0]);break;case".":if(1===n.length?t:"0">n[1]||"9"<n[1]){o=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(c=this._number.exec(n))&&(o="literal",s='"'+c[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(c[1]?"double":/^[+\-]?\d+$/.test(c[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(c=this._sparqlKeyword.exec(n))?o=c[0].toUpperCase():h=!0;break;case"f":case"t":(c=this._boolean.exec(n))?(o="literal",s='"'+c[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):h=!0;break;case"a":(c=this._shortPredicates.exec(n))?(o="abbreviation",s="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):h=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":f=1,o=u;break;default:h=!0}if(h&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(c=this._prefix.exec(n))?((c=this._prefixed.exec(n))||t&&(c=this._prefixed.exec(n+" ")))&&(o="prefixed",a=c[1]||"",s=this._unescape(c[2])):(o="prefix",s=c[1]||"")),"^"===this._prevTokenType&&(o="IRI"===o||"prefixed"===o?"type":""),!o)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?r(this):this._input=n;e(null,{line:i,type:o,value:s,prefix:a}),this._prevTokenType=o,n=n.substr(f||c[0].length,n.length)}},_unescape:function(e){try{return e.replace(s,(function(e,t,r,n){if(t){if(e=parseInt(t,16),isNaN(e))throw Error();return i(e)}if(r){if(e=parseInt(r,16),isNaN(e))throw Error();return 65535>=e?i(e):i(55296+(e-=65536)/1024,56320+(1023&e))}if(!(e=a[n]))throw Error();return e}))}catch(l){return null}},_syntaxError:function(e){return this._input=null,Error('Syntax error: unexpected "'+e+'" on line '+this._line+".")},tokenize:function(e,t){function r(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(t,!1))}function n(){null!==i._input&&i._tokenizeToEnd(t,!0)}var i=this;this._line=1,"string"==typeof e?(this._input=e,o((function(){i._tokenizeToEnd(t,!0)}))):(this._input="",e&&"function"!=typeof e?("function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",r),e.on("end",n)):(this.addChunk=r,this.end=n,t||(t=e)))}},t.exports=n},{}],29:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);this._tripleStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="turtle"===(a="string"==typeof e.format&&e.format.match(/\w*$/)[0].toLowerCase()),r="trig"===a,s=/triple/.test(a),a=/quad/.test(a);a=s||a;(this._supportsNamedGraphs=!t)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(t||r||s),a&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=i,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new o({lineMode:a})}function i(){}var o=e("./N3Lexer"),s=/^[a-z][a-z0-9+.-]*:/i,a=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,l=/(?:^|\/)\.\.?(?:$|[\/#?])/,u=0,c=0;n._resetBlankNodeIds=function(){u=c=0},n.prototype={_setBase:function(e){if(e){if(0<=e.indexOf("#"))throw Error("Invalid base IRI "+e)}else e=null;(this._base=e)&&(this._basePath=e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(a),this._baseRoot=e[0],this._baseScheme=e[1])},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readSubject:function(e){switch(this._predicate=null,e.type){case"IRI":null===this._base||s.test(e.value)?this._subject=e.value:this._subject=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._subject=t+e.value;break;case"[":return this._subject="_:b"+c++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(e);default:return this._error("Expected subject but got "+e.type,e)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"IRI":case"abbreviation":null===this._base||s.test(e.value)?this._predicate=e.value:this._predicate=this._resolveIRI(e);break;case"prefixed":if("_"===e.prefix)return this._error("Disallowed blank node as predicate",e);if(void 0===(t=this._prefixes[e.prefix]))return this._error('Undefined prefix "'+e.prefix+':"',e);this._predicate=t+e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',e)}return this._readObject},_readObject:function(e){switch(e.type){case"IRI":null===this._base||s.test(e.value)?this._object=e.value:this._object=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._object=t+e.value;break;case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":return e="_:b"+c++,this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:e,type:"blank"}),this._subject=e,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',e)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){return"]"!==e.type?this._readBlankNodePunctuation(e):(null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),e=this._tripleStack.pop(),this._subject=e.subject,null!==e.object?(this._predicate=e.predicate,this._object=e.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph)},_readDataTypeOrLang:function(e){switch(e.type){case"type":if(""===e.prefix)e=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);else{var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);e=t+e.value}return this._object+="^^"+e,this._getTripleEndReader();case"langcode":return this._object+="@"+e.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,e)}},_readListItem:function(e){var t=null,r=null,n=this._subject,i=this._tripleStack,o=i[i.length-1],a=this._readListItem;switch(e.type){case"IRI":t=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":if(void 0===(t=this._prefixes[e.prefix]))return this._error('Undefined prefix "'+e.prefix+':"',e);t+=e.value;break;case"literal":t=e.value,a=this._readDataTypeOrLang;break;case"[":r="_:b"+c++,t="_:b"+c++,i.push({subject:r,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",object:t,type:"blank"}),this._subject=t,a=this._readBlankNodeHead;break;case"(":r="_:b"+c++,i.push({subject:r,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",object:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",type:"list"}),this._subject=null,a=this._readListItem;break;case")":if(i.pop(),0!==i.length&&"list"===i[i.length-1].type&&this._callback(null,{subject:o.subject,predicate:o.predicate,object:o.object,graph:this._graph||""}),this._subject=o.subject,null===o.predicate){if(a=this._readPredicate,"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===o.subject)return a}else if(this._predicate=o.predicate,this._object=o.object,a=this._getTripleEndReader(),"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===o.object)return a;r="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil";break;default:return this._error('Expected list item instead of "'+e.type+'"',e)}return null===r&&(this._subject=r="_:b"+c++),null===n?"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===o.object?o.object=r:o.subject=r:this._callback(null,{subject:n,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",object:r,graph:this._graph||""}),null!==t&&this._callback(null,{subject:r,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",object:t,graph:this._graph||""}),a},_readPunctuation:function(e){var t=this._subject,r=this._graph;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);this._graph=null;case".":this._subject=null,e=this._readInTopContext;break;case";":e=this._readPredicate;break;case",":e=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){r=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e),t=this._subject,e=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){if(void 0===(r=this._prefixes[e.prefix]))return this._error('Undefined prefix "'+e.prefix+':"',e);r+=e.value,e=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return null!==t&&this._callback(null,{subject:t,predicate:this._predicate,object:this._object,graph:r||""}),e},_readBlankNodePunctuation:function(e){switch(e.type){case";":e=this._readPredicate;break;case",":e=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),e},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){return"IRI"!==e.type?this._error('Expected IRI to follow prefix "'+this._prefix+':"',e):(e=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e),this._prefixes[this._prefix]=e,this._prefixCallback(this._prefix,e),this._readDeclarationPunctuation)},_readBaseIRI:function(e){if("IRI"!==e.type)return this._error("Expected IRI to follow base declaration",e);try{this._setBase(null===this._base||s.test(e.value)?e.value:this._resolveIRI(e))}catch(a){this._error(a.message,e)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+c++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?this._readInTopContext(e):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_getTripleEndReader:function(){var e=this._tripleStack;if(0===e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(e,t){this._callback(Error(e+" at line "+t.line+"."))},_resolveIRI:function(e){switch((e=e.value)[0]){case void 0:return this._base;case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return this._removeDotSegments(this._basePath+e)}},_removeDotSegments:function(e){if(!l.test(e))return e;for(var t="",r=e.length,n=-1,i=-1,o=0,s="/";n<r;){switch(s){case":":if(0>i&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<r&&"/"!==e[i];)n=i;break;case"?":case"#":n=r;break;case"/":if("."===e[n+1])switch(s=e[1+ ++n],s){case"/":t+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return t+e.substring(o,n)+e.substr(n+1);case".":if(void 0===(s=e[1+ ++n])||"/"===s||"?"===s||"#"===s){if((o=(t+=e.substring(o,n-2)).lastIndexOf("/"))>=i&&(t=t.substr(0,o)),"/"!==s)return t+"/"+e.substr(n+1);o=n+1}}}s=e[++n]}return t+e.substring(o)},parse:function(e,t,r){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+u+++"_","function"==typeof e&&(r=t,t=e,e=null),this._callback=t||i,this._prefixCallback=r||i;var n=this;this._lexer.tokenize(e,(function(e,t){null!==e?(n._callback(e),n._callback=i):void 0!==n._readCallback&&(n._readCallback=n._readCallback(t))})),e||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},t.exports=n},{"./N3Lexer":28}],30:[function(e,t,r){function n(e,t){if(!(this instanceof n))return new n(e,t);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._prefixes=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),this.defaultGraph=t.defaultGraph||"http://example.org/#defaultGraph",e&&this.addTriples(e)}var i=e("./N3Util").expandPrefixedName;n.prototype={get size(){var e=this._size;if(null!==e)return e;var t,r,n,i=this._graphs;for(n in i)for(var o in t=i[n].subjects)for(var s in r=t[o])e+=Object.keys(r[s]).length;return this._size=e},_addToIndex:function(e,t,r,n){return r=(e=e[t]||(e[t]={}))[r]||(e[r]={}),(e=n in r)||(r[n]=null),!e},_removeFromIndex:function(e,t,r,n){var i,o=e[t],s=o[r];for(i in delete s[n],s)return;for(i in delete o[r],o)return;delete e[t]},_findInIndex:function(e,t,r,n,i,o,s,a){var l,u,c=[],f=1<!t+!r+!n?Object.keys(this._ids):this._entities;for(var h in t&&((l=e,e={})[t]=l[t]),e){var p=f[h];if(t=e[h])for(var d in r&&((l=t,t={})[r]=l[r]),t){var g=f[d];if(u=t[d])for(var v=((u=n?n in u?[n]:[]:Object.keys(u)).length-1);0<=v;v--){var y={subject:"",predicate:"",object:"",graph:a};y[i]=p,y[o]=g,y[s]=f[u[v]],c.push(y)}}}return c},_countInIndex:function(e,t,r,n){var i,o,s=0;for(var a in t&&((i=e,e={})[t]=i[t]),e)if(t=e[a])for(var l in r&&((i=t,t={})[r]=i[r]),t)(o=t[l])&&(n?n in o&&s++:s+=Object.keys(o).length);return s},addTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||this.defaultGraph;var i=this._graphs[n];i||(i=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(i)),n=this._ids;var o=this._entities;return e=n[e]||(n[o[++this._id]=e]=this._id),t=n[t]||(n[o[++this._id]=t]=this._id),r=n[r]||(n[o[++this._id]=r]=this._id),n=this._addToIndex(i.subjects,e,t,r),this._addToIndex(i.predicates,t,r,e),this._addToIndex(i.objects,r,e,t),this._size=null,n},addTriples:function(e){for(var t=e.length-1;0<=t;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||this.defaultGraph;var i,o,s,a=this._ids,l=this._graphs;if(!((e=a[e])&&(t=a[t])&&(r=a[r])&&(i=l[n])))return!1;if(!((o=i.subjects[e])&&(s=o[t])&&r in s))return!1;for(e in this._removeFromIndex(i.subjects,e,t,r),this._removeFromIndex(i.predicates,t,r,e),this._removeFromIndex(i.objects,r,e,t),null!==this._size&&this._size--,i.subjects)return!0;return delete l[n],!0},removeTriples:function(e){for(var t=e.length-1;0<=t;t--)this.removeTriple(e[t])},find:function(e,t,r,n){var o=this._prefixes;return this.findByIRI(i(e,o),i(t,o),i(r,o),i(n,o))},findByIRI:function(e,t,r,n){var i,o,s,a=[],l={},u=this._ids;for(var c in n?l[n]=this._graphs[n]:l=this._graphs,l)if(n=l[c]){if(e&&!(i=u[e])||t&&!(o=u[t])||r&&!(s=u[r]))return a;i?s?a.push(this._findInIndex(n.objects,s,i,o,"object","subject","predicate",c)):a.push(this._findInIndex(n.subjects,i,o,null,"subject","predicate","object",c)):o?a.push(this._findInIndex(n.predicates,o,s,null,"predicate","object","subject",c)):s?a.push(this._findInIndex(n.objects,s,null,null,"object","subject","predicate",c)):a.push(this._findInIndex(n.subjects,null,null,null,"subject","predicate","object",c))}return 1===a.length?a[0]:a.concat.apply([],a)},count:function(e,t,r,n){var o=this._prefixes;return this.countByIRI(i(e,o),i(t,o),i(r,o),i(n,o))},countByIRI:function(e,t,r,n){n=n||this.defaultGraph,n=this._graphs[n];var i=this._ids;return!n||e&&!(e=i[e])||t&&!(t=i[t])||r&&!(r=i[r])?0:e?r?this._countInIndex(n.objects,r,e,t):this._countInIndex(n.subjects,e,t,r):t?this._countInIndex(n.predicates,t,r,e):this._countInIndex(n.objects,r,e,t)},createBlankNode:function(e){var t,r;if(e)for(t=e="_:"+e,r=1;this._ids[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,t}},t.exports=n},{"./N3Util":33}],31:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);i.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var t=this,r=new o(e);r.parse((function(e,r){r&&t.push(r)||e&&t.emit("error",e)}),this.emit.bind(this,"prefix")),this._transform=function(e,t,n){r.addChunk(e),n()},this._flush=function(e){r.end(),e()}}var i=e("stream").Transform;r=e("util");var o=e("./N3Parser.js");r.inherits(n,i),t.exports=n},{"./N3Parser.js":29,stream:15,util:38}],32:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);i.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var t=this,r=new o({write:function(e,r,n){t.push(e),n&&n()},end:function(e){t.push(null),e&&e()}},e);this._transform=function(e,t,n){r.addTriple(e,n)},this._flush=function(e){r.end(e)}}var i=e("stream").Transform;r=e("util");var o=e("./N3Writer.js");r.inherits(n,i),t.exports=n},{"./N3Writer.js":34,stream:15,util:38}],33:[function(e,t,r){function n(e,t){for(var r in o)t?e.prototype[r]=i(o[r]):e[r]=o[r];return e}function i(e){return function(t){return e(this,t)}}var o={isIRI:function(e){return e?'"'!==(e=e[0])&&"_"!==e:e},isLiteral:function(e){return e&&'"'===e[0]},isBlank:function(e){return e&&"_:"===e.substr(0,2)},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var r,n,i,o=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return o&&(n=t[r=o[1]],i=o.index),void 0===n?e:0===i?n+e.substr(r.length+1):e.substr(0,i+3)+n+e.substr(i+r.length+4)},createIRI:function(e){return e&&'"'===e[0]?o.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":if(isFinite(e)){t=0==e%1?"http://www.w3.org/2001/XMLSchema#integer":"http://www.w3.org/2001/XMLSchema#decimal";break}default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return o.prefixes({"":e})("")},prefixes:function(e){function t(e,t){if(t||!(e in n)){var r=Object.create(null);t=t||"",n[e]=function(e){return r[e]||(r[e]=t+e)}}return n[e]}var r,n=Object.create(null);for(r in e)t(r,e[r]);return t}};t.exports=n(n)},{}],34:[function(e,t,r){function n(e,t){if(!(this instanceof n))return new n(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function i(e){var t=l[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}var o=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,s=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,a=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,l={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};n.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,r,n,o){try{this._graph!==n&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(n?this._encodeIriOrBlankNode(n)+" {\n":"")),this._subject=null,this._graph="["!==n[0]?n:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(r),o):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),o):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),o)}catch(i){o&&o(i)}},_writeTripleLine:function(e,t,r,n,o){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(r)+(n?" "+this._encodeIriOrBlankNode(n)+".\n":".\n"),o)}catch(i){o&&o(i)}},_encodeIriOrBlankNode:function(e){var t=e[0];return"["===t||"("===t||"_"===t&&":"===e[1]?e:(s.test(e)&&(e=e.replace(a,i)),(t=this._prefixRegex.exec(e))?t[1]?this._prefixIRIs[t[1]]+t[2]:e:"<"+e+">")},_encodeLiteral:function(e,t,r){return s.test(e)&&(e=e.replace(a,i)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=o.exec(e);if(!t)throw Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,r,n,i){void 0===r?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof n?this._writeTriple(e,t,r,"",n):this._writeTriple(e,t,r,n,i)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,r){var n={};n[e]=t,this.addPrefixes(n,r)},addPrefixes:function(e,t){var r,n=this._prefixIRIs,i=!1;for(r in e){var o=e[r];/[#\/]$/.test(o)&&n[o]!==(r+=":")&&(i=!0,n[o]=r,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+r+" <"+o+">.\n"))}if(i){var s;o=r="";for(s in n)r+=r?"|"+s:s,o+=(o?"|":"")+n[s];r=r.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+o+")[^/]*$|^("+r+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(i?"\n":"",t)},blank:function(e,t){var r,n,i=e;switch(void 0===e?i=[]:"string"==typeof e?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return"[]";case 1:if("["!==(r=i[0]).object[0])return"[ "+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object)+" ]";default:for(var o="[",s=0;s<n;s++)(r=i[s]).predicate===e?o+=", "+this._encodeObject(r.object):(o+=(s?";\n  ":"\n  ")+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object),e=r.predicate);return o+"\n]"}},list:function(e){for(var t=e&&e.length||0,r=Array(t),n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return"("+r.join(" ")+")"},_prefixRegex:/$0^/,end:function(e){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(r,n){t=null,e(r,n)};if(this._endStream)try{return this._outputStream.end(t)}catch(r){}t&&t()}},t.exports=n},{}],35:[function(e,t,r){(function(e){!function(n){function i(e){throw RangeError(b[e])}function o(e,t){for(var r=e.length;r--;)e[r]=t(e[r]);return e}function s(e,t){return o(e.split(m),t).join(".")}function a(e){for(var t,r,n=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&56319>=t&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function l(e){return o(e,(function(e){var t="";return 65535<e&&(t+=w((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+w(e)})).join("")}function u(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function c(e,t,r){var n=0;for(e=r?x(e/700):e>>1,e+=x(e/t);455<e;n+=36)e=x(e/35);return x(n+36*e/(e+38))}function f(e){var t,r,n,o,s,a,u=[],f=e.length,h=0,p=128,d=72;for(0>(r=e.lastIndexOf("-"))&&(r=0),n=0;n<r;++n)128<=e.charCodeAt(n)&&i("not-basic"),u.push(e.charCodeAt(n));for(r=0<r?r+1:0;r<f;){for(n=h,t=1,o=36;r>=f&&i("invalid-input"),(36<=(s=10>(s=e.charCodeAt(r++))-48?s-22:26>s-65?s-65:26>s-97?s-97:36)||s>x((2147483647-h)/t))&&i("overflow"),h+=s*t,!(s<(a=o<=d?1:o>=d+26?26:o-d));o+=36)t>x(2147483647/(s=36-a))&&i("overflow"),t*=s;d=c(h-n,t=u.length+1,0==n),x(h/t)>2147483647-p&&i("overflow"),p+=x(h/t),h%=t,u.splice(h++,0,p)}return l(u)}function h(e){var t,r,n,o,s,l,f,h,p,d,g,v,y=[];for(d=(e=a(e)).length,t=128,r=0,s=72,l=0;l<d;++l)128>(p=e[l])&&y.push(w(p));for((n=o=y.length)&&y.push("-");n<d;){for(f=2147483647,l=0;l<d;++l)(p=e[l])>=t&&p<f&&(f=p);for(f-t>x((2147483647-r)/(g=n+1))&&i("overflow"),r+=(f-t)*g,t=f,l=0;l<d;++l)if((p=e[l])<t&&2147483647<++r&&i("overflow"),p==t){for(h=r,f=36;!(h<(p=f<=s?1:f>=s+26?26:f-s));f+=36)v=h-p,h=36-p,y.push(w(u(p+v%h,0))),h=x(v/h);y.push(w(u(h,0))),s=c(r,g,n==o),r=0,++n}++r,++t}return y.join("")}var p="object"==typeof r&&r,d="object"==typeof t&&t&&t.exports==p&&t;(k="object"==typeof e&&e).global!==k&&k.window!==k||(n=k);var g,v=/^xn--/,y=/[^ -~]/,m=/\x2E|\u3002|\uFF0E|\uFF61/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=Math.floor,w=String.fromCharCode,k={version:"1.2.4",ucs2:{decode:a,encode:l},decode:f,encode:h,toASCII:function(e){return s(e,(function(e){return y.test(e)?"xn--"+h(e):e}))},toUnicode:function(e){return s(e,(function(e){return v.test(e)?f(e.slice(4).toLowerCase()):e}))}};if(p&&!p.nodeType)if(d)d.exports=k;else for(g in k)k.hasOwnProperty(g)&&(p[g]=k[g]);else n.punycode=k}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(e,t,r){function n(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}function i(e,t,r){if(e&&o(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return"object"==typeof e&&null!==e}var s=e("punycode");r.parse=i,r.resolve=function(e,t){return i(e,!1,!0).resolve(t)},r.resolveObject=function(e,t){return e?i(e,!1,!0).resolveObject(t):t},r.format=function(e){return"string"==typeof e&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)},r.Url=n;var a=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/;t="{}|\\^`".split("").concat('<>"` \r\n\t'.split(""));var u=["'"].concat(t),c=["%","/","?",";","#"].concat(u),f=["/","?","#"],h=/^[a-z0-9A-Z_-]{0,63}$/,p=/^([a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=e("querystring");n.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);if(e=e.trim(),n=a.exec(e)){var n,i=(n=n[0]).toLowerCase();this.protocol=i,e=e.substr(n.length)}if(r||n||e.match(/^\/\/[^@\/]+@[^@\/]+/)){var o="//"===e.substr(0,2);!o||n&&g[n]||(e=e.substr(2),this.slashes=!0)}if(!g[n]&&(o||n&&!v[n])){for(o=-1,r=0;r<f.length;r++)-1!==(n=e.indexOf(f[r]))&&(-1===o||n<o)&&(o=n);for(-1!==(o=-1===o?e.lastIndexOf("@"):e.lastIndexOf("@",o))&&(r=e.slice(0,o),e=e.slice(o+1),this.auth=decodeURIComponent(r)),o=-1,r=0;r<c.length;r++)-1!==(n=e.indexOf(c[r]))&&(-1===o||n<o)&&(o=n);if(-1===o&&(o=e.length),this.host=e.slice(0,o),e=e.slice(o),this.parseHost(),this.hostname=this.hostname||"",!(o="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1])){var l=this.hostname.split(/\./);for(r=0,n=l.length;r<n;r++){var m=l[r];if(m&&!m.match(h)){for(var b="",x=0,w=m.length;x<w;x++)b=127<m.charCodeAt(x)?b+"x":b+m[x];if(!b.match(h)){n=l.slice(0,r),r=l.slice(r+1),(m=m.match(p))&&(n.push(m[1]),r.unshift(m[2])),r.length&&(e="/"+r.join(".")+e),this.hostname=n.join(".");break}}}}if(this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase(),!o){for(m=this.hostname.split("."),l=[],r=0;r<m.length;++r)n=m[r],l.push(n.match(/[^A-Za-z0-9_-]/)?"xn--"+s.encode(n):n);this.hostname=l.join(".")}r=this.port?":"+this.port:"",this.host=(this.hostname||"")+r,this.href+=this.host,o&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==e[0]&&(e="/"+e))}if(!d[i])for(r=0,n=u.length;r<n;r++)o=u[r],(m=encodeURIComponent(o))===o&&(m=escape(o)),e=e.split(o).join(m);return-1!==(r=e.indexOf("#"))&&(this.hash=e.substr(r),e=e.slice(0,r)),-1!==(r=e.indexOf("?"))?(this.search=e.substr(r),this.query=e.substr(r+1),t&&(this.query=y.parse(this.query)),e=e.slice(0,r)):t&&(this.search="",this.query={}),e&&(this.pathname=e),v[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(r=this.pathname||"",n=this.search||"",this.path=r+n),this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";return this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query)),e=this.search||s&&"?"+s||"",t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),e&&"?"!==e.charAt(0)&&(e="?"+e),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(e=e.replace("#","%23"))+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){"string"==typeof e&&((i=new n).parse(e,!1,!0),e=i);var t=new n;if(Object.keys(this).forEach((function(e){t[e]=this[e]}),this),t.hash=e.hash,""===e.href)return t.href=t.format(),t;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(r){"protocol"!==r&&(t[r]=e[r])})),v[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t;if(e.protocol&&e.protocol!==t.protocol){if(!v[e.protocol])return Object.keys(e).forEach((function(r){t[r]=e[r]})),t.href=t.format(),t;if(t.protocol=e.protocol,e.host||g[e.protocol])t.pathname=e.pathname;else{for(var r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),2>r.length&&r.unshift(""),t.pathname=r.join("/")}return t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(t.path=(t.pathname||"")+(t.search||"")),t.slashes=t.slashes||e.slashes,t.href=t.format(),t}var i=t.pathname&&"/"===t.pathname.charAt(0),o=i=(l=e.host||e.pathname&&"/"===e.pathname.charAt(0))||i||t.host&&e.pathname,s=t.pathname&&t.pathname.split("/")||[],a=(r=e.pathname&&e.pathname.split("/")||[],t.protocol&&!v[t.protocol]);if(a&&(t.hostname="",t.port=null,t.host&&(""===s[0]?s[0]=t.host:s.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),i=i&&(""===r[0]||""===s[0])),l)t.host=e.host||""===e.host?e.host:t.host,t.hostname=e.hostname||""===e.hostname?e.hostname:t.hostname,t.search=e.search,t.query=e.query,s=r;else if(r.length)s||(s=[]),s.pop(),s=s.concat(r),t.search=e.search,t.query=e.query;else if(null!=e.search)return a&&(t.hostname=t.host=s.shift(),a=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=a.shift(),t.host=t.hostname=a.shift()),t.search=e.search,t.query=e.query,null===t.pathname&&null===t.search||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!s.length)return t.pathname=null,t.path=t.search?"/"+t.search:null,t.href=t.format(),t;for(var l=s.slice(-1)[0],u=(r=(t.host||e.host)&&("."===l||".."===l)||""===l,0),c=s.length;0<=c;c--)"."==(l=s[c])?s.splice(c,1):".."===l?(s.splice(c,1),u++):u&&(s.splice(c,1),u--);if(!i&&!o)for(;u--;u)s.unshift("..");return!i||""===s[0]||s[0]&&"/"===s[0].charAt(0)||s.unshift(""),r&&"/"!==s.join("/").substr(-1)&&s.push(""),o=""===s[0]||s[0]&&"/"===s[0].charAt(0),a&&(t.hostname=t.host=o?"":s.length?s.shift():"",a=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=a.shift(),t.host=t.hostname=a.shift()),(i=i||t.host&&s.length)&&!o&&s.unshift(""),s.length?t.pathname=s.join("/"):(t.pathname=null,t.path=null),null===t.pathname&&null===t.search||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},n.prototype.parseHost=function(){var e=this.host,t=l.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:35,querystring:13}],37:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],38:[function(e,t,r){(function(t,n){function i(e,t){var n={seen:[],stylize:s};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),h(t)?n.showHidden=t:t&&r._extend(n,t),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),a(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function s(e,t){return e}function a(e,t,n){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t))return d(s=t.inspect(n,e))||(s=a(e,s,n)),s;if(s=l(e,t))return s;var i=Object.keys(t),o=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),b(t)&&(0<=i.indexOf("message")||0<=i.indexOf("description")))return u(t);if(0===i.length){if(x(t))return e.stylize("[Function"+(t.name?": "+t.name:"")+"]","special");if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(m(t))return e.stylize(Date.prototype.toString.call(t),"date");if(b(t))return u(t)}var s="",h=!1,p=["{","}"];return f(t)&&(h=!0,p=["[","]"]),x(t)&&(s=" [Function"+(t.name?": "+t.name:"")+"]"),v(t)&&(s=" "+RegExp.prototype.toString.call(t)),m(t)&&(s=" "+Date.prototype.toUTCString.call(t)),b(t)&&(s=" "+u(t)),0!==i.length||h&&0!=t.length?0>n?v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),i=h?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)Object.prototype.hasOwnProperty.call(t,String(s))?o.push(c(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(c(e,t,r,n,i,!0))})),o}(e,t,n,o,i):i.map((function(r){return c(e,t,n,o,r,h)})),e.seen.pop(),function(e,t,r){return 60<e.reduce((function(e,t){return 0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(i,s,p)):p[0]+s+p[1]}function l(e,t){if(g(t))return e.stylize("undefined","undefined");if(d(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return p(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):null===t?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function c(e,t,r,n,i,o){var s,l;if((t=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?l=t.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):t.set&&(l=e.stylize("[Setter]","special")),Object.prototype.hasOwnProperty.call(n,i)||(s="["+i+"]"),l||(0>e.seen.indexOf(t.value)?-1<(l=a(e,t.value,null===r?null:r-1)).indexOf("\n")&&(l=o?l.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+l.split("\n").map((function(e){return"   "+e})).join("\n")):l=e.stylize("[Circular]","special")),g(s)){if(o&&i.match(/^\d+$/))return l;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+l}function f(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function p(e){return"number"==typeof e}function d(e){return"string"==typeof e}function g(e){return void 0===e}function v(e){return y(e)&&"[object RegExp]"===Object.prototype.toString.call(e)}function y(e){return"object"==typeof e&&null!==e}function m(e){return y(e)&&"[object Date]"===Object.prototype.toString.call(e)}function b(e){return y(e)&&("[object Error]"===Object.prototype.toString.call(e)||e instanceof Error)}function x(e){return"function"==typeof e}function w(e){return 10>e?"0"+e.toString(10):e.toString(10)}function k(){var e=new Date,t=[w(e.getHours()),w(e.getMinutes()),w(e.getSeconds())].join(":");return[e.getDate(),_[e.getMonth()],t].join(" ")}var C=/%[sdj%]/g;r.format=function(e){if(!d(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=(t=String(e).replace(C,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}})),n[r]);r<o;s=n[++r])t=null!==s&&y(s)?t+" "+i(s):t+" "+s;return t},r.deprecate=function(e,i){if(g(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var S,F={};r.debuglog=function(e){if(g(S)&&(S=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!F[e])if(new RegExp("\\b"+e+"\\b","i").test(S)){var n=t.pid;F[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else F[e]=function(){};return F[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=f,r.isBoolean=h,r.isNull=function(e){return null===e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=p,r.isString=d,r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=g,r.isRegExp=v,r.isObject=y,r.isDate=m,r.isError=b,r.isFunction=x,r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e("./support/isBuffer");var _="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");r.log=function(){console.log("%s - %s",k(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!y(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":37,"7YKIPe":10,inherits:24}],39:[function(e,t,r){function n(e,t){this.name="NonSupportedSparqlFeatureError",this.feature=e,this.message=t||"SPARQL feature "+e+" non supported"}function i(e){this.name=ParserError,this.message=e||"Error parsing SPARQL query"}var o=e("./parser"),s=e("./utils");n.prototype=Error(),n.constructor=n,i.prototype=Error(),i.constructor=i,AbstractQueryTree=function(){},AbstractQueryTree.prototype.parseQueryString=function(e){return o.parse(e)},AbstractQueryTree.prototype.parseExecutableUnit=function(e){if("select"===e.kind||"ask"===e.kind||"modify"===e.kind||"construct"===e.kind)return this.parseSelect(e);if("insertdata"===e.kind||"deletedata"===e.kind)return this.parseInsertData(e);if("load"===e.kind||"clear"===e.kind||"drop"===e.kind||"create"===e.kind)return e;throw Error("unknown executable unit: "+e.kind)},AbstractQueryTree.prototype.parseSelect=function(e){return null==e?(console.log("error parsing query"),null):(e.pattern=this.build(e.pattern,{freshCounter:0}),e)},AbstractQueryTree.prototype.parseInsertData=function(e){return null==e?(console.log("error parsing query"),null):e},AbstractQueryTree.prototype.build=function(e,t){if("groupgraphpattern"===e.token)return this._buildGroupGraphPattern(e,t);if("basicgraphpattern"===e.token){var r={kind:"BGP",value:e.triplesContext};return AbstractQueryTree.translatePathExpressionsInBGP(r,t)}if("graphunionpattern"===e.token)return{kind:"UNION",value:[r=this.build(e.value[0],t),this.build(e.value[1],t)]};if("graphgraphpattern"===e.token)return{kind:"GRAPH",value:this.build(e.value,t),graph:e.graph};if(null!=e.token)throw new n(e.token,"Non implemented SPARQL graph pattern: '"+e.token+"'");throw new i("Error parsing graph pattern: '"+JSON.stringify(e)+"'")},AbstractQueryTree.translatePathExpressionsInBGP=function(e,t){var r,n,i,o=[];for(i=0;i<e.value.length;i++)if(e.value[i].predicate&&"path"===e.value[i].predicate.token){r=e.value[i],n=e.value.slice(i+1);var a=AbstractQueryTree.translatePathExpression(r,t);if(r=null,"BGP"!==a.kind){if("ZERO_OR_MORE_PATH"===a.kind||"ONE_OR_MORE_PATH"===a.kind){if(i=0<o.length?{kind:"JOIN",lvalue:{kind:"BGP",value:o},rvalue:a}:a,"ZERO_OR_MORE_PATH"===a.kind)if("var"===a.y.token&&0===a.y.value.indexOf("fresh:")&&"var"===a.x.token&&0===a.x.value.indexOf("fresh:"))for(var l=0;l<e.value.length;l++)e.value[l].object&&"var"===e.value[l].object.token&&e.value[l].object.value===a.x.value&&((r=s.clone(e.value[l],!0)).object=a.y);else if("var"===a.y.token&&0===a.y.value.indexOf("fresh:"))for(l=0;l<e.value.length;l++)e.value[l].subject&&"var"===e.value[l].subject.token&&e.value[l].subject.value===a.y.value&&((r=s.clone(e.value[l],!0)).subject=a.x);return 0<n.length?(a=AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:n},t),null!=r?{kind:"UNION",value:[{kind:"JOIN",lvalue:i,rvalue:a},{kind:"BGP",value:o=o.concat([r]).concat(n)}]}:{kind:"JOIN",lvalue:i,rvalue:a}):i}return a}o=o.concat(a.value)}else o.push(e.value[i]);return e.value=o,e},AbstractQueryTree.translatePathExpression=function(e,t){if("element"===e.predicate.kind)return"+"===e.predicate.modifier?(e.predicate.modifier=null,{kind:"ONE_OR_MORE_PATH",path:o=AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):"*"===e.predicate.modifier?(e.predicate.modifier=null,{kind:"ZERO_OR_MORE_PATH",path:o=AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):(e.predicate=e.predicate.value,{kind:"BGP",value:[e]});if("sequence"===e.predicate.kind){for(var r,i,o=e.subject,a=e.object,l=e.graph,u=[],c=0;c<e.predicate.value.length;c++)c!=e.predicate.value.length-1?(r={token:"var",value:"fresh:"+t.freshCounter},t.freshCounter++):r=a,i={subject:o,predicate:e.predicate.value[c],object:r},null!=l&&(i.graph=s.clone(l,!0)),u.push(i),c!=e.predicate.value.length-1&&(o=s.clone(r,!0));return AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:u},t)}throw new n("Non supported path expression "+e.predicate.kind)},AbstractQueryTree.prototype._buildGroupGraphPattern=function(e,t){for(var r=e.filters||[],n=e.binds||[],i={kind:"EMPTY_PATTERN"},o=0;o<e.patterns.length;o++){var s=e.patterns[o];"optionalgraphpattern"===s.token?i="FILTER"===(s=this.build(s.value,t)).kind?{kind:"LEFT_JOIN",lvalue:i,rvalue:s.value,filter:s.filter}:{kind:"LEFT_JOIN",lvalue:i,rvalue:s,filter:!0}:(s=this.build(s,t),i="EMPTY_PATTERN"==i.kind?s:{kind:"JOIN",lvalue:i,rvalue:s})}if(i.binds=n,0!=r.length){if("EMPTY_PATTERN"===i.kind||"LEFT_JOIN"===i.kind&&!0===i.filter||"LEFT_JOIN"===i.kind||"JOIN"===i.kind||"UNION"===i.kind||"GRAPH"===i.kind||"BGP"===i.kind)return{kind:"FILTER",filter:r,value:i};throw Error("Unknow kind of algebra expression: "+i.kind)}return i},AbstractQueryTree.prototype.collectBasicTriples=function(e,t){if(null==t&&(t=[]),"select"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("BGP"===e.kind)t=t.concat(e.value);else if("ZERO_OR_MORE_PATH"===e.kind)t=this.collectBasicTriples(e.path);else if("UNION"===e.kind)t=this.collectBasicTriples(e.value[0],t),t=this.collectBasicTriples(e.value[1],t);else if("GRAPH"===e.kind)t=this.collectBasicTriples(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)t=this.collectBasicTriples(e.lvalue,t),t=this.collectBasicTriples(e.rvalue,t);else if("FILTER"===e.kind)t=this.collectBasicTriples(e.value,t);else if("construct"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return t},AbstractQueryTree.prototype.bind=function(e,t){if(null!=e.graph&&e.graph.token&&"var"===e.graph.token&&null!=t[e.graph.value]&&(e.graph=t[e.graph.value]),null!=e.filter){for(var r=[],n=0;n<e.filter.length;n++)e.filter[n].value=this._bindFilter(e.filter[n].value,t),r.push(e.filter[n]);e.filter=r}if("select"===e.kind)e.pattern=this.bind(e.pattern,t);else if("BGP"===e.kind)e.value=this._bindTripleContext(e.value,t);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._bindTripleContext(e.path,t),e.x&&"var"===e.x.token&&null!=t[e.x.value]&&(e.x=t[e.x.value]),e.y&&"var"===e.y.token&&null!=t[e.y.value]&&(e.y=t[e.y.value]);else if("UNION"===e.kind)e.value[0]=this.bind(e.value[0],t),e.value[1]=this.bind(e.value[1],t);else if("GRAPH"===e.kind)e.value=this.bind(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.bind(e.lvalue,t),e.rvalue=this.bind(e.rvalue,t);else if("FILTER"===e.kind){var i=this;e.value=this.bind(e.value,t),e.filter=e.filter.map((function(e){return{token:"filter",value:i._bindFilter(e.value,t)}}))}else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._bindTripleContext=function(e,t){for(var r=0;r<e.length;r++)for(var n in delete e[r].graph,delete e[r].variables,e[r]){var i=e[r][n];"var"===i.token&&null!=t[i.value]&&(e[r][n]=t[i.value])}return e},AbstractQueryTree.prototype._bindFilter=function(e,t){if(null!=e.expressionType){var r=e.expressionType;if("relationalexpression"==r)e.op1=this._bindFilter(e.op1,t),e.op2=this._bindFilter(e.op2,t);else if("conditionalor"==r||"conditionaland"==r)for(r=0;r<e.operands.length;r++)e.operands[r]=this._bindFilter(e.operands[r],t);else if("additiveexpression"==r)for(e.summand=this._bindFilter(e.summand,t),r=0;r<e.summands.length;r++)e.summands[r].expression=this._bindFilter(e.summands[r].expression,t);else if("builtincall"==r)for(r=0;r<e.args.length;r++)e.args[r]=this._bindFilter(e.args[r],t);else if("multiplicativeexpression"==r)for(e.factor=this._bindFilter(e.factor,t),r=0;r<e.factors.length;r++)e.factors[r].expression=this._bindFilter(e.factors[r].expression,t);else if("unaryexpression"==r)e.expression=this._bindFilter(e.expression,t);else if("irireforfunction"==r)for(r=0;r<e.factors.args;r++)e.args[r]=this._bindFilter(e.args[r],t);else"atomic"==r&&"var"==e.primaryexpression&&null!=t[e.value.value]&&(r=t[e.value.value],e.primaryexpression="uri"===r.token?"iri":"literal",e.value=r)}return e},AbstractQueryTree.prototype.replace=function(e,t,r,n){if(null!=e.graph&&e.graph.token&&e.graph.token===t.token&&e.graph.value==t.value&&(e.graph=s.clone(r,!0)),null!=e.filter){for(var i=[],o=0;o<e.filter.length;o++)e.filter[o].value=this._replaceFilter(e.filter[o].value,t,r,n),i.push(e.filter[o]);e.filter=i}if("select"===e.kind)e.pattern=this.replace(e.pattern,t,r,n);else if("BGP"===e.kind)e.value=this._replaceTripleContext(e.value,t,r,n);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._replaceTripleContext(e.path,t,r,n),e.x&&e.x.token===t.token&&e.value===t.value&&(e.x=s.clone(r,!0)),e.y&&e.y.token===t.token&&e.value===t.value&&(e.y=s.clone(r,!0));else if("UNION"===e.kind)e.value[0]=this.replace(e.value[0],t,r,n),e.value[1]=this.replace(e.value[1],t,r,n);else if("GRAPH"===e.kind)e.value=this.replace(e.value,t,r);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.replace(e.lvalue,t,r,n),e.rvalue=this.replace(e.rvalue,t,r,n);else if("FILTER"===e.kind)e.value=this._replaceFilter(e.value,t,r,n);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._replaceTripleContext=function(e,t,r,n){for(var i=0;i<e.length;i++)for(var o in e[i]){var a=e[i][o];"var"===a.token&&"var"===t.token&&a.value===t.value||"blank"===a.token&&"blank"===t.token&&a.value===t.value?e[i][o]=r:"literal"!==a.token&&"uri"!==a.token||"literal"!==t.token&&"uri"!==t.token||a.token!==t.token||s.lexicalFormTerm(a,n)[a.token]!==s.lexicalFormTerm(t,n)[a.token]||(e[i][o]=r)}return e},AbstractQueryTree.prototype._replaceFilter=function(e,t,r,n){if(null!=e.expressionType){var i=e.expressionType;if("relationalexpression"==i)e.op1=this._replaceFilter(e.op1,t,r,n),e.op2=this._replaceFilter(e.op2,t,r,n);else if("conditionalor"==i||"conditionaland"==i)for(i=0;i<e.operands.length;i++)e.operands[i]=this._replaceFilter(e.operands[i],t,r,n);else if("additiveexpression"==i)for(e.summand=this._replaceFilter(e.summand,t,r,n),i=0;i<e.summands.length;i++)e.summands[i].expression=this._replaceFilter(e.summands[i].expression,t,r,n);else if("builtincall"==i)for(i=0;i<e.args.length;i++)e.args[i]=this._replaceFilter(e.args[i],t,r,n);else if("multiplicativeexpression"==i)for(e.factor=this._replaceFilter(e.factor,t,r,n),i=0;i<e.factors.length;i++)e.factors[i].expression=this._replaceFilter(e.factors[i].expression,t,r,n);else if("unaryexpression"==i)e.expression=this._replaceFilter(e.expression,t,r,n);else if("irireforfunction"==i)for(i=0;i<e.factors.args;i++)e.args[i]=this._replaceFilter(e.args[i],t,r,n);else"atomic"==i&&(n=null,(e.primaryexpression==t.token&&e.value==t.value||"iri"==e.primaryexpression&&"uri"==t.token&&e.value==t.value)&&(n=r.value),null!=n&&(e.primaryexpression="uri"===r.token?"iri":r.token,e.value=n))}return e},AbstractQueryTree.prototype.treeWithUnion=function(e){if(null==e||null==e.kind)return!1;if("select"===e.kind)return this.treeWithUnion(e.pattern);if("BGP"===e.kind)return this.treeWithUnion(e.value);if("ZERO_OR_MORE_PATH"===e.kind)return!1;if("UNION"===e.kind){if(null==e.value[0].value||null==e.value[0].value.variables||null==e.value[1].value||null==e.value[1].value.variables)return!0;if(e.value[0].variables.join("/")===e.values[1].variables.join("/"))return!!this.treeWithUnion(e.value[0])||this.treeWithUnion(e.value[1])}else{if("GRAPH"===e.kind||"LEFT_JOIN"!==e.kind&&"JOIN"!==e.kind)return!1;if(this.treeWithUnion(e.lvalue))return!0;this.treeWithUnion(e.rvalue)}},t.exports={AbstractQueryTree:AbstractQueryTree,NonSupportedSparqlFeatureError:n,SparqlParserError:i}},{"./parser":46,"./utils":57}],40:[function(e,t,r){var n=e("./utils"),i=n.nextTick,o=function(e,t){if(0!=arguments.length){this.order=e,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0;var r=this;this._diskWrite(this.root,(function(e){r.root=e,r._updateRootNode(r.root,(function(e){r.comparator=function(e,t){return e<t?-1:e>t?1:0},r.merger=null,null!=t&&t(r)}))}))}};o.prototype._allocateNode=function(){return new s},o.prototype._diskWrite=function(e,t){i((function(){t(e)}))},o.prototype._diskRead=function(e,t){i((function(){t(e)}))},o.prototype._diskDelete=function(e,t){i((function(){t()}))},o.prototype._updateRootNode=function(e,t){t(e)},o.prototype.search=function(e,t,r){this.__search(this,e,this.root,t,r)},o.prototype.__search=function(e,t,r,n,i){for(var o=0;o<r.numberActives&&1===e.comparator(t,r.keys[o].key);)o++;o<r.numberActives&&0===e.comparator(r.keys[o].key,t)?n(null!=i&&1==i||r.keys[o].data):!0===r.isLeaf?n(null):e._diskRead(r.children[o],(function(r){e.__search(e,t,r,n,i)}))},o.prototype.walk=function(e,t){this.__walk(this,this.root,e,t)},o.prototype.__walk=function(e,t,r,i){var o=t.numberActives,s=0;if(t.isLeaf){for(s=0;s<t.numberActives;s++)r(t.keys[s]);return i()}n.whilst((function(){return s<o}),(function(n){e._diskRead(t.children[s],(function(i){e.__walk(e,i,r,(function(){e._diskRead(t.keys[s],(function(e){r(e),s++,n()}))}))}))}),(function(){e._diskRead(t.children[o],(function(t){e.__walk(e,t,r,(function(){i()}))}))}))},o.prototype.walkNodes=function(e){this.__walkNodes(this,root,e,(function(){}))},o.prototype.__walkNodes=function(e,t,r,i){if(t.isLeaf)return r(t),i();r(t);var o=t.numberActives,s=0;n.whilst((function(){return s<o}),(function(n){e._diskRead(t.children[s],(function(t){e.__walkNodes(e,t,r,(function(){s++,n()}))}))}),(function(){e._diskRead(t.children[o],(function(t){e.__walkNodes(e,t,r,(function(){}))}))}))},o.prototype._splitChild=function(e,t,r,n){var i=this._allocateNode();i.isLeaf=r.isLeaf,i.level=r.level,i.numberActives=this.order-1;var o=r.keys[this.order-1];r.keys[this.order-1]=null;for(var s=0;s<this.order-1;s++)i.keys[s]=r.keys[s+this.order],r.keys[s+this.order]=null,r.isLeaf||(i.children[s]=r.children[s+this.order],r.children[s+this.order]=null);for(r.isLeaf||(i.children[s]=r.children[s+this.order],r.children[s+this.order]=null),r.numberActives=this.order-1,s=e.numberActives+1;s>t+1;s--)e.children[s]=e.children[s-1];for(e.children[t+1]=i,s=e.numberActives;s>t;s--)e.keys[s]=e.keys[s-1];e.keys[t]=o,e.numberActives++;var a=this;this._diskWrite(i,(function(i){a._diskWrite(e,(function(e){e.children[t+1]=i,a._diskWrite(r,(function(t){return n(e)}))}))}))},o.prototype.insert=function(e,t,r){if(this.root.numberActives===2*this.order-1){var n=this._allocateNode();n.isLeaf=!1,n.level=this.root.level+1,n.numberActives=0,n.children[0]=this.root;var i=this;this._splitChild(n,0,this.root,(function(o){n=o,i.root=n,i._updateRootNode(n,(function(n){i._insertNonFull(n,e,t,r)}))}))}else this._insertNonFull(this.root,e,t,r)},o.prototype._insertNonFull=function(e,t,r,n){this.__insertNonFull(this,e,e.numberActives-1,t,r,n)},o.prototype.__insertNonFull=function(e,t,r,n,i,o){if(t.isLeaf){for(;0<=r&&-1===e.comparator(n,t.keys[r].key);)t.keys[r+1]=t.keys[r],r--;0<=r&&0===e.comparator(n,t.keys[r].key)?t.keys[r]={key:n,data:i}:(t.keys[r+1]={key:n,data:i},t.numberActives++),e._diskWrite(t,(function(e){return o(e)}))}else{for(;0<=r&&-1===e.comparator(n,t.keys[r].key);)r--;r++,e._diskRead(t.children[r],(function(s){s.numberActives===2*e.order-1?e._splitChild(t,r,s,(function(){1===e.comparator(n,t.keys[r].key)&&r++,e._diskRead(t.children[r],(function(t){r=t.numberActives-1,e.__insertNonFull(e,t,r,n,i,o)}))})):e._diskRead(t.children[r],(function(t){r=t.numberActives-1,e.__insertNonFull(e,t,r,n,i,o)}))}))}},o.prototype.delete=function(e,t){o.prototype.__deleteSearchNode(this,e,this.root,t)},o.prototype.__deleteSearchNode=function(e,t,r,n){var i=0;if(0===r.numberActives)return n(!1);for(;i<r.numberActives&&1===e.comparator(t,r.keys[i].key);)i++;var o=i;return i<r.numberActives&&0===e.comparator(t,r.keys[i].key)?e.__deleteNodeFound(e,o,t,r,n):!0===r.isLeaf?n(!1):void e._diskRead(r.children[i],(function(s){if(null===s)return n(!1);var a=!1,l=!1,u=null,c=null;o===r.numberActives?(l=!0,c=r.children[o-1],u=r.children[o-1]):0===o?(a=!0,u=r.children[1],c=r.children[1]):(c=r.children[o-1],u=r.children[o+1]),e._diskRead(c,(function(o){e._diskRead(u,(function(u){!0===l&&(u=null),!0===a&&(o=null),s.numberActives===e.order-1&&null!=r?null!=u&&u.numberActives>e.order-1?e._moveKey(r,i,-1,(function(r){e.__deleteSearchNode(e,t,s,n)})):null!=o&&o.numberActives>e.order-1?e._moveKey(r,i,1,(function(r){e.__deleteSearchNode(e,t,s,n)})):null!=o&&o.numberActives===e.order-1?e._mergeSiblings(r,i,-1,(function(r){e.__deleteSearchNode(e,t,r,n)})):null!=u&&u.numberActives===e.order-1&&e._mergeSiblings(r,i,1,(function(r){e.__deleteSearchNode(e,t,r,n)})):e.__deleteSearchNode(e,t,s,n)}))}))}))},o.prototype.__deleteNodeFound=function(e,t,r,n,i){if(n.isLeaf&&n.numberActives>e.order-1||n.isLeaf&&n===e.root)return e._deleteKeyFromNode(n,t,(function(){i(!0)})),!0;!1===n.isLeaf&&e._diskRead(n.children[t],(function(o){o.numberActives>e.order-1?e._getMaxKeyPos(e,o,(function(s){r=s.node.keys[s.index],n.keys[t]=r,e._diskWrite(n,(function(t){t=o,r=r.key,e.__deleteSearchNode(e,r,t,i)}))})):e._diskRead(n.children[t+1],(function(s){s.numberActives>e.order-1?e._getMinKeyPos(e,s,(function(o){r=o.node.keys[o.index],n.keys[t]=r,e._diskWrite(n,(function(t){t=s,r=r.key,e.__deleteSearchNode(e,r,t,i)}))})):o.numberActives===e.order-1&&s.numberActives===e.order-1&&e._mergeNodes(o,n.keys[t],s,(function(o){n.children[t]=o;for(var s=++t;s<n.numberActives;s++)n.children[s]=n.children[s+1],n.keys[s-1]=n.keys[s];n.children[s]=null,n.keys[s-1]=null,n.numberActives--,0===n.numberActives&&e.root===n&&(e.root=o),e._diskWrite(n,(function(t){e.__deleteSearchNode(e,r,o,i)}))}))}))})),n.isLeaf&&n.numberActives>e.order-1&&e._deleteKeyFromNode(n,t,(function(t){e.__deleteSearchNode(e,r,t,i)}))},o.prototype._moveKey=function(e,t,r,n){1===r&&t--;var i=this;i._diskRead(e.children[t],(function(o){i._diskRead(e.children[t+1],(function(s){if(-1==r){o.keys[o.numberActives]=e.keys[t],o.children[o.numberActives+1]=s.children[0],s.children[0]=null,o.numberActives++,e.keys[t]=s.keys[0];for(var a=1;a<s.numberActives;a++)s.keys[a-1]=s.keys[a],s.children[a-1]=s.children[a];s.children[s.numberActives-1]=s.children[s.numberActives],s.numberActives--}else{for(s.children[s.numberActives+1]=s.children[s.numberActives],a=s.numberActives;0<a;a--)s.children[a]=s.children[a-1],s.keys[a]=s.keys[a-1];s.keys[0]=null,s.children[0]=null,s.children[0]=o.children[o.numberActives],s.keys[0]=e.keys[t],s.numberActives++,o.children[o.numberActives]=null,e.keys[t]=o.keys[o.numberActives-1],o.keys[o.numberActives-1]=null,o.numberActives--}i._diskWrite(o,(function(t){i._diskWrite(s,(function(t){i._diskWrite(e,(function(e){return n(e)}))}))}))}))}))},o.prototype._mergeSiblings=function(e,t,r,n){var i,o,s;t===e.numberActives?(t--,r=e.children[e.numberActives-1],s=e.children[e.numberActives]):(r=e.children[t],s=e.children[t+1]);var a=this;a._diskRead(r,(function(r){a._diskRead(s,(function(s){var l=a._allocateNode();for(l.isLeaf=r.isLeaf,l.level=r.level,o=0;o<a.order-1;o++)l.keys[o]=r.keys[o],l.children[o]=r.children[o];for(l.keys[a.order-1]=e.keys[t],l.children[a.order-1]=r.children[a.order-1],o=0;o<a.order-1;o++)l.keys[o+a.order]=s.keys[o],l.children[o+a.order]=s.children[o];for(l.children[2*a.order-1]=s.children[a.order-1],e.children[t]=l,o=t;o<e.numberActives;o++)e.keys[o]=e.keys[o+1],e.children[o+1]=e.children[o+2];for(l.numberActives=r.numberActives+s.numberActives+1,e.numberActives--,i=e.numberActives;i<2*a.order-1;i++)e.keys[i]=null;0===e.numberActives&&a.root===e&&(a.root=l,l.isLeaf=!l.level),a._diskWrite(l,(function(t){a._diskWrite(e,(function(e){a._diskDelete(r,(function(){a._diskDelete(s,(function(){if(a.root!==t)return n(t);a._updateRootNode(a.root,(function(){return n(t)}))}))}))}))}))}))}))},o.prototype._deleteKeyFromNode=function(e,t,r){var n=2*this.order-1;if(e.numberActives<n&&(n=e.numberActives),!1===e.isLeaf)return!1;for(;t<n-1;t++)e.keys[t]=e.keys[t+1];e.keys.pop(),e.numberActives--,this._diskWrite(e,(function(e){return r(e)}))},o.prototype._mergeNodes=function(e,t,r,n){var i,o;for((i=this._allocateNode()).isLeaf=!0,o=0;o<e.numberActives;o++)i.keys[o]=e.keys[o],i.children[o]=e.children[o];for(i.children[e.numberActives]=e.children[e.numberActives],i.keys[e.numberActives]=t,o=0;o<r.numberActives;o++)i.keys[o+e.numberActives+1]=r.keys[o],i.children[o+e.numberActives+1]=r.children[o];i.children[2*this.order-1]=r.children[r.numberActives],i.numberActives=e.numberActives+r.numberActives+1,i.isLeaf=e.isLeaf,i.level=e.level;var s=this;this._diskWrite(i,(function(t){s._diskDelete(e,(function(){s._diskDelete(r,(function(){return n(t)}))}))}))},o.prototype.audit=function(e){var t=[],r=[],n=this,i=function(i){for(var o=0;o<r.length;o++)if(0===n.comparator(r[o],i)){var s=" !!! duplicated key "+i;!0===e&&console.log(s),t.push(s)}},o=null;n=this;return this.walkNodes((function(s){!0===e&&(console.log("--- Node at "+s.level+" level"),console.log(" - leaf? "+s.isLeaf),console.log(" - num actives? "+s.numberActives),console.log(" - keys: "));for(var a=s.numberActives;a<s.keys.length;a++)null!=s.keys[a]&&!0===e&&(console.log(" * warning : redundant key data"),t.push(" * warning : redundant key data"));for(a=s.numberActives+1;a<s.children.length;a++)null!=s.children[a]&&!0===e&&(console.log(" * warning : redundant children data"),t.push(" * warning : redundant key data"));if(!1===s.isLeaf)for(a=0;a<s.numberActives;a++){var l=this._diskRead(s.children[a]).keys[this._diskRead(s.children[a]).numberActives-1].key,u=this._diskRead(s.children[a+1]).keys[0].key;if(!0===e&&console.log("   "+s.keys[a].key+"("+l+","+u+")"),-1===n.comparator(s.keys[a].key,l)){var c=" !!! value max left "+l+" > key "+s.keys[a].key;!0===e&&console.log(c),t.push(c)}1===n.comparator(s.keys[a].key,u)&&(c=" !!! value min right "+u+" < key "+s.keys[a].key,!0===e&&console.log(c),t.push(c)),i(s.keys[a].key),r.push(s.keys[a].key)}else for(null===o?o=s.level:o!=s.level&&(c=" !!! Leaf node with wrong level value",!0===e&&console.log(c),t.push(c)),a=0;a<s.numberActives;a++)!0===e&&console.log(" "+s.keys[a].key),i(s.keys[a].key),r.push(s.keys[a].key);s!=n.root&&(s.numberActives>2*n.order-1&&(!0===e&&(c=" !!!! MAX num keys restriction violated "),console.log(c),t.push(c)),s.numberActives<n.order-1&&(!0===e&&(c=" !!!! MIN num keys restriction violated "),console.log(c),t.push(c)))})),t},o.prototype._getMaxKeyPos=function(e,t,r){var n={};return null===t?r(null):!0===t.isLeaf?(n.node=t,n.index=t.numberActives-1,r(n)):(n.node=t,n.index=t.numberActives-1,void e._diskRead(t.children[t.numberActives],(function(t){return e._getMaxKeyPos(e,t,r)})))},o.prototype._getMinKeyPos=function(e,t,r){var n={};if(null===t&&r(null),!0===t.isLeaf)return n.node=t,n.index=0,r(n);n.node=t,n.index=0,e._diskRead(t.children[0],(function(t){return e._getMinKeyPos(e,t,r)}))};var s=function(){this.numberActives=0,this.isLeaf=null,this.keys=[],this.children=[],this.level=0};t.exports={Tree:o,Node:s}},{"./utils":57}],41:[function(e,t,r){var n=e("./query_engine").QueryEngine,i=e("./quad_backend").QuadBackend,o=e("./persistent_quad_backend").PersistentQuadBackend,s=e("./lexicon").Lexicon,a=e("./persistent_lexicon").PersistentLexicon,l=e("./rdf_model"),u=e("./utils");Store=function(e,t){var r=null,l=null;if(0==arguments.length)l={};else if(1==arguments.length)l={},r=e;else{if(!(1<arguments.length))throw"An optional argument map and a callback must be provided";l=e,r=t}null==l.treeOrder&&(l.treeOrder=15);var u=s,c=i;!0===l.persistent&&(u=a,c=o),this.functionMap={};var f=this;this.customFns={},new u((function(e){var t=function(){new c(l,(function(t){var i=function(){l.backend=t,l.lexicon=e,f.engine=new n(l),r(null,f)};l.overwrite?t.clear(i):i()}))};!0===l.overwrite?e.clear(t):t()}),l.name)},Store.prototype.rdf=l.rdf,Store.prototype.rdf.api=l,Store.prototype.registerCustomFunction=function(e,t){this.customFns[e]=t,this.engine.setCustomFunctions(this.customFns)},Store.prototype.execute=function(){if(3===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(4===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var e,t;1===arguments.length?(e=arguments[0],t=function(){}):2===arguments.length&&(e=arguments[0],t=arguments[1]),this.engine.execute(e,t)}},Store.prototype.executeWithEnvironment=function(){var e,t,r;if(3===arguments.length){e=arguments[0];var n=function(){};t=arguments[1],r=arguments[2]}else 4===arguments.length&&(e=arguments[0],n=arguments[3],t=arguments[1],r=arguments[2]);t=u.map(t,(function(e){return{token:"uri",value:e}})),r=u.map(r,(function(e){return{token:"uri",value:e}})),this.engine.execute(e,n,t,r)},Store.prototype.graph=function(){var e=null,t=null;if(1===arguments.length)t=arguments[0]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(2!==arguments.length)throw"An optional graph URI and a callback function must be provided";t=arguments[1]||function(){},e=arguments[0]}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",t)},Store.prototype.node=function(){var e=null,t=null,r=null;if(2===arguments.length)r=arguments[0],t=arguments[1]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(3!==arguments.length)throw"An optional graph URI, node URI and a callback function must be provided";r=arguments[0],e=arguments[1],t=arguments[2]||function(){}}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),null!=this.rdf.resolve(r)&&(r=this.rdf.resolve(r)),this.engine.execute("CONSTRUCT { <"+r+"> ?p ?o } WHERE { GRAPH <"+e+"> { <"+r+"> ?p ?o } }",t)},Store.prototype.startObservingNode=function(){var e,t,r;2===arguments.length?(e=arguments[0],r=arguments[1],this.engine.callbacksBackend.observeNode(e,r,(function(){}))):3===arguments.length&&(e=arguments[0],t=arguments[1],r=arguments[2],this.engine.callbacksBackend.observeNode(e,t,r,(function(){})))},Store.prototype.stopObservingNode=function(e){this.engine.callbacksBackend.stopObservingNode(e)},Store.prototype.startObservingQuery=function(e,t,r){null!=r?this.engine.callbacksBackend.observeQuery(e,t,r):this.engine.callbacksBackend.observeQuery(e,t,(function(){}))},Store.prototype.stopObservingQuery=function(e){this.engine.callbacksBackend.stopObservingQuery(e)},Store.prototype.subscribe=function(e,t,r,n,i){var o=this,s=function(e,t){var r=[],n={blanks:{},outCache:{}},s=[];u.each(t,(function(e){var t=l.buildRDFResource(e.subject,s,o.engine,n),i=l.buildRDFResource(e.predicate,s,o.engine,n);e=l.buildRDFResource(e.object,s,o.engine,n),null!=t&&null!=i&&null!=e&&(e=new l.Triple(t,i,e),r.push(e))})),i(e,r)};this.functionMap[i]=s,this.engine.callbacksBackend.subscribe(e,t,r,n,s,(function(){}))},Store.prototype.unsubscribe=function(e){this.engine.callbacksBackend.unsubscribe(this.functionMap[e]),delete this.functionMap[e]},Store.prototype.setPrefix=function(e,t){this.rdf.setPrefix(e,t)},Store.prototype.setDefaultPrefix=function(e){this.rdf.setDefaultPrefix(e)},Store.prototype.insert=function(){var e,t,r;if(1===arguments.length)t=arguments[0],r=function(){};else if(2===arguments.length)t=arguments[0],r=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to insert, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),r=arguments[2]||function(){}}var n="",i=this;t.forEach((function(e){n=n+i._nodeToQuery(e.subject)+i._nodeToQuery(e.predicate)+i._nodeToQuery(e.object)+"."})),n=null!=e?"INSERT DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"INSERT DATA { "+n+" }",this.engine.execute(n,r)},Store.prototype._nodeToQuery=function(e){if("NamedNode"===e.interfaceName){var t=this.rdf.resolve(e.valueOf());return null!=t?"<"+t+">":"<"+e.valueOf()+">"}return e.toString()},Store.prototype.delete=function(){var e,t,r;if(1===arguments.length)t=arguments[0],r=function(){};else if(2===arguments.length)t=arguments[0],r=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to delete, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),r=arguments[2]||function(){}}var n="",i=this;t.forEach((function(e){n=n+i._nodeToQuery(e.subject)+i._nodeToQuery(e.predicate)+i._nodeToQuery(e.object)+"."})),n=null!=e?"DELETE DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"DELETE DATA { "+n+" }",this.engine.execute(n,r)},Store.prototype.clear=function(){var e,t;if(0===arguments.length)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),t=function(){};else if(1===arguments.length)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),t=arguments[0]||function(){};else{if(2!==arguments.length)throw"The optional graph and a callback must be provided";e=this.rdf.createNamedNode(arguments[0]),t=arguments[1]||function(){}}e="CLEAR GRAPH "+this._nodeToQuery(e),this.engine.execute(e,t)},Store.prototype.setBatchLoadEvents=function(e){this.engine.eventsOnBatchLoad=e},Store.prototype.registerDefaultNamespace=function(e,t){this.rdf.prefixes.set(e,t),this.engine.registerDefaultNamespace(e,t)},Store.prototype.registerDefaultProfileNamespaces=function(){var e,t=this.rdf.prefixes.values();for(e in t)this.registerDefaultNamespace(e,t[e])},Store.prototype.load=function(){var e,t,r,n,i={};if(3===arguments.length)r=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),e=arguments[0],t=arguments[1],n=arguments[2]||function(){};else if(4===arguments.length)e=arguments[0],t=arguments[1],"string"==typeof(i=arguments[2])?(r=this.rdf.createNamedNode(i),i={}):(r=this.rdf.createNamedNode(i.graph||this.engine.lexicon.defaultGraphUri),delete i.graph),n=arguments[3]||function(){};else if(2===arguments.length)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if("remote"===e)t=this.rdf.createNamedNode(t),this.engine.execute("LOAD <"+t.valueOf()+"> INTO GRAPH <"+r.valueOf()+">",n);else{var o=this,s=this.engine.rdfLoader.parsers[e];if(!s)return n(Error("Cannot find parser for the provided media type:"+e));e=[s,{token:"uri",value:r.valueOf()},t,i,function(e,t){e?n(e,t):o.engine.batchLoad(t,(function(e){null!=e?n(null,e):n(Error("Erro batch-loading triples."))}))}],t&&"string"==typeof t&&0===t.indexOf("file://")?this.engine.rdfLoader.loadFromFile.apply(null,e):this.engine.rdfLoader.tryToParse.apply(null,e)}},Store.prototype.registerParser=function(e,t){this.engine.rdfLoader.registerParser(e,t)},Store.prototype.registeredGraphs=function(e){this.engine.lexicon.registeredGraphs(!0,(function(t){t=u.map(t,(function(e){return new l.NamedNode(e)})),e(null,t)}))},Store.prototype.getNetworkTransport=function(){return NetworkTransport},Store.prototype.setNetworkTransport=function(e){NetworkTransport=e},Store.prototype.close=function(e){null==e&&(e=function(){}),this.engine.close?this.engine.close(e):e()},Store.VERSION="0.9.17",Store.yieldFrequency=function(e){u.yieldFrequency(e)},t.exports.Store=Store,t.exports.create=function(){return 1==arguments.length?new Store(arguments[0]):2==arguments.length?new Store(arguments[0],arguments[1]):new Store},t.exports.connect=function(){(1==arguments.length?arguments[0]:2==arguments.length?arguments[1]:arguments[2])(Error("Store#connect is not supported in the 0.9.X series of the library"))}},{"./lexicon":44,"./persistent_lexicon":47,"./persistent_quad_backend":48,"./quad_backend":49,"./query_engine":51,"./rdf_model":55,"./utils":57}],42:[function(e,t,r){var n=e("./utils"),i=e("./utils");e("./quad_index");var o=e("./quad_index").Pattern,s=e("./rdf_model"),a=e("./abstract_query_tree").AbstractQueryTree;Callbacks={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(e){for(this.aqt=new a,this.engine=e,this.indexMap={},this.observersMap={},this.queriesIndexMap={},this.emptyNotificationsMap={},this.queriesList=[],this.pendingQueries=[],this.matchedQueries=[],this.updateInProgress=null,this.indices="SPOG GP OGS POG GSP OS".split(" "),this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},this.callbackCounter=0,this.callbacksMap={},this.callbacksInverseMap={},this.queryCounter=0,this.queriesMap={},this.queriesCallbacksMap={},this.queriesInverseMap={},e=0;e<this.indices.length;e++){var t=this.indices[e];this.indexMap[t]={},this.queriesIndexMap[t]={}}}},Callbacks.CallbacksBackend.prototype.startGraphModification=function(){!0!==this.ongoingModification&&(this.pendingQueries=[].concat(this.queriesList),this.matchedQueries=[],null==this.updateInProgress&&(this.updateInProgress={},this.updateInProgress[Callbacks.added]=[],this.updateInProgress[Callbacks.deleted]=[]))},Callbacks.CallbacksBackend.prototype.nextGraphModification=function(e,t){this.updateInProgress[e].push(t)},Callbacks.CallbacksBackend.prototype.endGraphModification=function(e){if(!0!==this.ongoingModification){var t=this;if(null!=this.updateInProgress){var r=t.updateInProgress;t.updateInProgress=null,this.sendNotification(Callbacks.deleted,r[Callbacks.deleted],(function(){t.sendNotification(Callbacks.added,r[Callbacks.added],(function(){t.sendEmptyNotification(Callbacks.eventsFlushed,null,(function(){t.dispatchQueries((function(){e(!0)}))}))}))}))}else e(!0)}else e(!0)},Callbacks.CallbacksBackend.prototype.cancelGraphModification=function(){!0!==this.ongoingModification&&(this.updateInProgress=null)},Callbacks.CallbacksBackend.prototype.sendNotification=function(e,t,r){for(var n={},i=0;i<t.length;i++){var o,s=t[i];for(o in this.indexMap){var a=this.indexMap[o],l=this.componentOrders[o];this._searchCallbacksInIndex(a,l,e,s,n),0!=this.pendingQueries.length&&(a=this.queriesIndexMap[o],this._searchQueriesInIndex(a,l,s))}}this.dispatchNotifications(n),null!=r&&r(!0)},Callbacks.CallbacksBackend.prototype.sendEmptyNotification=function(e,t,r){for(var n=this.emptyNotificationsMap[e]||[],i=0;i<n.length;i++)n[i](e,t);r()},Callbacks.CallbacksBackend.prototype.dispatchNotifications=function(e){for(var t in e){var r=this.callbacksMap[t],n=e[t][Callbacks.deleted];if(null!=n)try{r(Callbacks.deleted,n)}catch(i){}for(var o in e[t])if(o!=Callbacks.deleted)try{r(o,e[t][o])}catch(i){}}},Callbacks.CallbacksBackend.prototype._searchCallbacksInIndex=function(e,t,r,n,i){var o=n[1];n=n[0];for(var s=0;s<t.length+1;s++){for(var a=e._||[],l=[],u=0;u<a.length;u++){var c=a[u];null!=this.callbacksMap[c]&&(i[c]=i[c]||{},i[c][r]=i[c][r]||[],i[c][r].push(n),l.push(c))}if(e._=l,null==e[""+o[a=t[s]]])break;e=e[""+o[a]]}},Callbacks.CallbacksBackend.prototype.subscribeEmpty=function(e,t){var r=this.emptyNotificationsMap[e]||[];r.push(t),this.emptyNotificationsMap[e]=r},Callbacks.CallbacksBackend.prototype.unsubscribeEmpty=function(e,t){var r=this.emptyNotificationsMap[e];null!=r&&(r=n.reject(r,(function(e){return e===t}))),this.emptyNotificationsMap[e]=r},Callbacks.CallbacksBackend.prototype.subscribe=function(e,t,r,n,i,s){e=this._tokenizeComponents(e,t,r,n),t={blanks:{},outCache:{}},this.engine.registerNsInEnvironment(null,t);var a=this;this.engine.normalizeQuad(e,t,!0,(function(e){for(var t=new o(e),r=a._indexForPattern(t),n=(t=a.componentOrders[r],r=a.indexMap[r],0);n<t.length;n++){var l=e[t[n]];if("_"===l){null==r._&&(r._=[]),a.callbackCounter++,r._.push(a.callbackCounter),a.callbacksMap[a.callbackCounter]=i,a.callbacksInverseMap[i]=a.callbackCounter;break}n===t.length-1?(r[l]=r[l]||{_:[]},a.callbackCounter++,r[l]._.push(a.callbackCounter),a.callbacksMap[a.callbackCounter]=i,a.callbacksInverseMap[i]=a.callbackCounter):(r[l]=r[l]||{},r=r[l])}null!=s&&s(!0)}))},Callbacks.CallbacksBackend.prototype.unsubscribe=function(e){var t=this.callbacksInverseMap[e];null!=t&&(delete this.callbacksInverseMap[e],delete this.callbacksMap[t])},Callbacks.CallbacksBackend.prototype._tokenizeComponents=function(e,t,r,n){var i={};return null==e?i.subject=Callbacks.ANYTHING:0==e.indexOf("_:")?i.subject={token:"blank",value:e}:i.subject={token:"uri",value:e},i.predicate=null==t?Callbacks.ANYTHING:{token:"uri",value:t},i.object=null==r?Callbacks.ANYTHING:{token:"uri",value:r},i.graph=null==n?Callbacks.ANYTHING:{token:"uri",value:n},i},Callbacks.CallbacksBackend.prototype._indexForPattern=function(e){e=e.indexKey;for(var t=this.indices,r=0;r<t.length;r++)for(var i=t[r],o=this.componentOrders[i],s=0;s<o.length&&!1!==n.include(e,o[s]);s++)if(s==e.length-1)return i;return"SPOG"},Callbacks.CallbacksBackend.prototype.observeNode=function(){var e,t,r,n;4===arguments.length?(e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3]):(e=arguments[0],t=this.engine.lexicon.defaultGraphUri,r=arguments[1],n=arguments[2]),t="CONSTRUCT { <"+e+"> ?p ?o } WHERE { GRAPH <"+t+"> { <"+e+"> ?p ?o } }";var i=this,o={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,o);var a=[];this.engine.execute(t,(function(t,l){if(t)n&&n(!1);else{var u=!1,c=function(e,n){if("eventsFlushed"===e&&u){u=!1;try{r(l)}catch(t){}}else if("eventsFlushed"!==e){u=!0;for(var c=0;c<n.length;c++){var f=n[c],h=s.buildRDFResource(f.subject,a,i.engine,o),p=s.buildRDFResource(f.predicate,a,i.engine,o);f=s.buildRDFResource(f.object,a,i.engine,o);null!=h&&null!=p&&null!=f&&(f=new s.Triple(h,p,f),e===Callbacks.added?l.add(f):e===Callbacks.deleted&&l.remove(f))}}};i.observersMap[r]=c,i.subscribeEmpty(Callbacks.eventsFlushed,c),i.subscribe(e,null,null,null,c,(function(){try{r(l)}catch(e){}n&&n(!0)}))}}))},Callbacks.CallbacksBackend.prototype.stopObservingNode=function(e){return!!(e=this.observersMap[e])&&(this.unsubscribe(e),this.unsubscribeEmpty(Callbacks.eventsFlushed,e),!0)},Callbacks.CallbacksBackend.prototype.observeQuery=function(e,t,r){var n=this.aqt.parseQueryString(e),s=(n=this.aqt.parseSelect(n.units[0]),n=this.aqt.collectBasicTriples(n),this),a={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,a);var l=this.queryCounter;this.queryCounter++,this.queriesMap[l]=e,this.queriesInverseMap[e]=l,this.queriesList.push(l),this.queriesCallbacksMap[l]=t,i.eachSeries(n,(function(e,t){null==e.graph&&(e.graph=s.engine.lexicon.defaultGraphUriTerm),s.engine.normalizeQuad(e,a,!0,(function(e){for(var r=new o(e),n=s._indexForPattern(r),i=(r=s.componentOrders[n],n=s.queriesIndexMap[n],0);i<r.length;i++){var a=e[r[i]];if("string"==typeof a){null==n._&&(n._=[]),n._.push(l);break}i===r.length-1?(n[a]=n[a]||{_:[]},n[a]._.push(l)):(n[a]=n[a]||{},n=n[a])}t()}))}),(function(){s.engine.execute(e,(function(e,r){e?console.log("ERROR in query callback "+r):t(r)})),null!=r&&r()}))},Callbacks.CallbacksBackend.prototype.stopObservingQuery=function(e){var t=this.queriesInverseMap[e];null!=t&&(delete this.queriesInverseMap[e],delete this.queriesMap[t],this.queriesList=n.reject(this.queriesList,(function(e){return e===t})))},Callbacks.CallbacksBackend.prototype._searchQueriesInIndex=function(e,t,r){var i=r[1];for(r=r[0],r=0;r<t.length+1;r++){for(var o=e._||[],s=[],a=0;a<o.length;a++){var l=o[a];n.include(this.pendingQueries,l)&&(n.remove(this.pendingQueries,(function(e){return e===l})),this.matchedQueries.push(l)),null!=this.queriesMap[l]&&s.push(l)}if(e._=s,null==e[""+i[o=t[r]]])break;e=e[""+i[o]]}},Callbacks.CallbacksBackend.prototype.dispatchQueries=function(e){var t,r,n=this,o={};i.eachSeries(this.matchedQueries,(function(e,i){null==o[e]?(o[e]=!0,t=n.queriesMap[e],r=n.queriesCallbacksMap[e],n.engine.execute(t,(function(e,n){if(!e)try{r(n)}catch(t){}i()}))):i()}),(function(){e()}))},Callbacks.CallbacksBackend.added=Callbacks.added,Callbacks.CallbacksBackend.deleted=Callbacks.deleted,Callbacks.CallbacksBackend.eventsFlushed=Callbacks.eventsFlushed,t.exports=Callbacks},{"./abstract_query_tree":39,"./quad_index":50,"./rdf_model":55,"./utils":57}],43:[function(e,t,r){var n=e("jsonld");r.JSONLDParser={},(e=r.JSONLDParser).parser={async:!0,parse:function(e,t,r,i){try{"string"==typeof e&&(e=JSON.parse(e)),function(e,t,r){var i=null;n.normalize(e,{},(function(e,n){if(e)r(e);else{var o=function(e){return"blank node"===e.type?{blank:e.value}:"IRI"===e.type?{token:"uri",value:e.value}:"literal"===e.type?null!=e.language?{literal:'"'+e.value+'"@'+e.language}:null!==e.datatype?{literal:'"'+e.value+'"^^<'+e.datatype+">"}:{literal:'"'+e.value+'"'}:void 0};i=[];var s,a=function(e,r,n){i.push({subject:o(e),predicate:o(r),object:o(n),graph:t})};for(s in n)for(var l=n[s],u=0;u<l.length;u++){var c=l[u];a(c.subject,c.predicate,c.object)}r(null,i)}}))}(e,t,i)}catch(o){i(o)}}},t.exports={JSONLDParser:e}},{jsonld:26}],44:[function(e,t,r){var n=e("./utils"),i=e("./btree").Tree;Lexicon=function(e){var t=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,n.seq((function(e){new i(2,(function(r){t.uris=r,e()}))}),(function(e){new i(2,(function(r){t.literals=r,e()}))}),(function(e){new i(2,(function(r){t.knownGraphs=r,e()}))}),(function(e){new i(2,(function(r){t.oidUris=r,e()}))}),(function(e){new i(2,(function(r){t.oidLiterals=r,e()}))}),(function(e){new i(2,(function(r){t.oidBlanks=r,e()}))}))((function(){null!=e&&e(t)}))},Lexicon.prototype.registerGraph=function(e,t,r){e!=this.defaultGraphOid?this.knownGraphs.insert(e,t,(function(){r()})):r()},Lexicon.prototype.registeredGraphs=function(e,t){var r=[];this.knownGraphs.walk((function(t){!0===e?r.push(t.data):r.push(t.key)}),(function(){t(r)}))},Lexicon.prototype.registerUri=function(e,t){var r=this;e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,(function(i){if(null==i){var o=r.oidCounter,s="u"+o;r.oidCounter++,n.seq((function(t){r.uris.insert(e,[o,0],(function(){t()}))}),(function(t){r.oidUris.insert(s,e,(function(){t()}))}))((function(){t(o)}))}else o=i[0],i[1]+=1,t(o)}))},Lexicon.prototype.resolveUri=function(e,t){e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,(function(e){t(null!=e?e[0]:-1)}))},Lexicon.prototype.resolveUriCost=function(e,t){e===this.defaultGraphUri?t(0):this.uris.search(e,(function(e){t(null!=e?e[1]:-1)}))},Lexicon.prototype.registerBlank=function(e){var t=this.oidCounter;this.oidCounter++;var r=""+t;this.oidBlanks.insert(r,r,(function(){e(t)}))},Lexicon.prototype.resolveBlank=function(e,t){var r=this;this.oidBlanks.search(e,(function(e){null!=e?t(e):(e=r.oidCounter,this.oidCounter++,t(""+e))}))},Lexicon.prototype.resolveBlankCost=function(e,t){t(0)},Lexicon.prototype.registerLiteral=function(e,t){var r=this;this.literals.search(e,(function(i){if(null==i){var o=r.oidCounter,s="l"+o;r.oidCounter++,n.seq((function(t){r.literals.insert(e,[o,0],(function(){t()}))}),(function(t){r.oidLiterals.insert(s,e,(function(){t()}))}))((function(){t(o)}))}else o=i[0],i[1]+=1,t(o)}))},Lexicon.prototype.resolveLiteral=function(e,t){this.literals.search(e,(function(e){t(null!=e?e[0]:-1)}))},Lexicon.prototype.resolveLiteralCost=function(e,t){this.literals.search(e,(function(e){t(null!=e?e[1]:-1)}))},Lexicon.prototype.parseLiteral=function(e){var t=e.lastIndexOf("@");if(-1!=t&&'"'===e[t-1]&&null!=e.substring(t,e.length).match(/^@[a-zA-Z\-]+$/g)){var r=e.substring(1,t-1);return{token:"literal",value:r,lang:e=e.substring(t+1,e.length)}}return-1!=(t=e.lastIndexOf("^^"))&&'"'===e[t-1]&&"<"===e[t+2]&&">"===e[e.length-1]?{token:"literal",value:r=e.substring(1,t-1),type:e=e.substring(t+3,e.length-1)}:{token:"literal",value:r=e.substring(1,e.length-1)}},Lexicon.prototype.parseUri=function(e){return{token:"uri",value:e}},Lexicon.prototype.retrieve=function(e,t){var r=this;e===this.defaultGraphOid?t({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):n.seq((function(t,n){r.oidUris.search("u"+e,(function(e){n(null,null!=e?r.parseUri(e):null)}))}),(function(t,n){null==t?r.oidLiterals.search("l"+e,(function(e){n(null,null!=e?r.parseLiteral(e):null)})):n(null,t)}),(function(t,n){null==t?r.oidBlanks.search(""+e,(function(t){n(null,null!=t?{token:"blank",value:"_:"+e}:null)})):n(null,t)}))(null,(function(e,r){t(r)}))},Lexicon.prototype.clear=function(e){var t=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,n.seq((function(e){new i(2,(function(r){t.uris=r,e()}))}),(function(e){new i(2,(function(r){t.literals=r,e()}))}),(function(e){new i(2,(function(r){t.knownGraphs=r,e()}))}),(function(e){new i(2,(function(r){t.oidUris=r,e()}))}),(function(e){new i(2,(function(r){t.oidLiterals=r,e()}))}),(function(e){new i(2,(function(r){t.oidBlanks=r,e()}))}))((function(){null!=e&&e()}))},Lexicon.prototype.unregister=function(e,t,r){var i=this;n.seq((function(r){i._unregisterTerm(e.subject.token,t.subject,r)}),(function(r){i._unregisterTerm(e.predicate.token,t.predicate,r)}),(function(r){i._unregisterTerm(e.object.token,t.object,r)}),(function(r){null!=e.graph?i._unregisterTerm(e.graph.token,t.graph,r):r()}))((function(){r(!0)}))},Lexicon.prototype._unregisterTerm=function(e,t,r){var i=this;if("uri"===e)if(t!=this.defaultGraphOid){var o="u"+t;i.oidUris.search(o,(function(e){i.uris.search(e,(function(s){var a=s[1];""+s[0]==""+t?0===a?n.seq((function(e){i.oidUris.delete(o,(function(){e()}))}),(function(t){i.uris.delete(e,(function(){t()}))}),(function(e){i.knownGraphs.delete(t,(function(){e()}))}))((function(){r()})):i.uris.insert(e,[t,a-1],(function(){r()})):r()}))}))}else r();else"literal"===e?(this.oidCounter++,o="l"+t,i.oidLiterals.search(o,(function(e){i.literals.search(e,(function(s){var a=s[1];""+s[0]==""+t?0===a?n.seq((function(e){i.oidLiterals.delete(o,(function(){e()}))}),(function(t){i.literals.delete(e,(function(){t()}))}))((function(){r()})):i.literals.insert(e,[t,a-1],(function(){r()})):r()}))}))):"blank"===e?i.oidBlanks.delete(""+t,(function(){r()})):r()},t.exports={Lexicon:Lexicon}},{"./btree":40,"./utils":57}],45:[function(e,t,r){if(!e("./utils").isWorker()){var n=e("http"),i=e("https"),o=e("url");NetworkTransport={load:function(e,t,r,s){var a=null==s?3:s;s={host:(e=o.parse(e,!0,!0)).host,hostname:e.hostname,method:"GET",path:e.path,headers:{host:e.hostname,Accept:t}};var l=null;"http:"===e.protocol?(s.port=e.port||80,l=n):"https:"===e.protocol&&(s.port=e.port||443,l=i),(e=l.request(s,(function(e){var n=e.headers,i="";"2"==(""+e.statusCode)[0]?(e.on("end",(function(){r(null,{headers:n,data:i})})),e.on("data",(function(e){i+=e}))):"3"==(""+e.statusCode)[0]?0==a?r(Error("Too many redirections")):null!=(e=n.Location||n.location)?NetworkTransport.load(e,t,r,a-1):r(Error("Redirection without location header")):r(Error("HTTP error: "+e.statusCode))}))).on("error",r),e.end()}},t.exports={NetworkTransport:NetworkTransport}}},{"./utils":57,http:7,https:22,url:36}],46:[function(e,t,r){t.exports=function(){function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}var o={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r=Array(e.length);for(t=0;t<e.length;t++){var n,i=t;n=e[t],n=o[n.type](n),r[i]=n}if(r.sort(),0<r.length){for(e=t=1;t<r.length;t++)r[t-1]!==r[t]&&(r[e]=r[t],e++);r.length=e}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){function n(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function o(e){return{type:"other",description:e}}function s(e){var r,n=Ah[e];if(!n){for(r=e-1;!Ah[r];)r--;for(n={line:(n=Ah[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;Ah[e]=n}return n}function a(e,t){var r=s(e),n=s(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function l(e){_h<Eh||(_h>Eh&&(Eh=_h,Lh=[]),Lh.push(e))}function u(){var e,r,n;if(Th++,Th++,e=_h,(r=c())!==qe){var i,o,s,a,u,f;if(Th++,i=_h,(o=h())!==qe){for(s=[],n=Oe();n!==qe;)s.push(n),n=Oe();if(s!==qe){for(n=[],a=p();a!==qe;)n.push(a),a=p();if(n!==qe){for(a=[],s=Oe();s!==qe;)a.push(s),s=Oe();if(a!==qe)if((s=g())!==qe){for(u=[],a=Oe();a!==qe;)u.push(a),a=Oe();if(u!==qe)if((a=v())!==qe){for(u=[],f=Oe();f!==qe;)u.push(f),f=Oe();if(u!==qe){var d,y,m,b,x,w,S;if(Th++,u=_h,t.substr(_h,8)===$r?(f=$r,_h+=8):(f=qe,0===Th&&l(Zr)),f!==qe){for(d=[],y=fe();y!==qe;)d.push(y),y=fe();if(d!==qe)if(123===t.charCodeAt(_h)?(y=Qt,_h++):(y=qe,0===Th&&l(Ut)),y!==qe){if(m=[],b=_h,40===t.charCodeAt(_h)?(x=wt,_h++):(x=qe,0===Th&&l(kt)),x!==qe){if(w=[],(S=k())!==qe)for(;S!==qe;)w.push(S),S=k();else w=qe;w!==qe?(41===t.charCodeAt(_h)?(S=At,_h++):(S=qe,0===Th&&l(Et)),S!==qe?b=x=[x,w,S]:(_h=b,b=qe)):(_h=b,b=qe)}else _h=b,b=qe;for(b===qe&&(b=je());b!==qe;){if(m.push(b),b=_h,40===t.charCodeAt(_h)?(x=wt,_h++):(x=qe,0===Th&&l(kt)),x!==qe){if(w=[],(S=k())!==qe)for(;S!==qe;)w.push(S),S=k();else w=qe;w!==qe?(41===t.charCodeAt(_h)?(S=At,_h++):(S=qe,0===Th&&l(Et)),S!==qe?b=x=[x,w,S]:(_h=b,b=qe)):(_h=b,b=qe)}else _h=b,b=qe;b===qe&&(b=je())}m!==qe?(125===t.charCodeAt(_h)?(b=Gt,_h++):(b=qe,0===Th&&l(zt)),b!==qe?u=f=[f,d,y,m,b]:(_h=u,u=qe)):(_h=u,u=qe)}else _h=u,u=qe;else _h=u,u=qe}else _h=u,u=qe;if(u===qe&&(u=null),Th--,u===qe&&0===Th&&l(Yr),u!==qe){for(i=o,o={named:[],implicit:[]},u=0;u<n.length;u++)"default"===(f=n[u]).kind?o.implicit.push(f.graph):o.named.push(f.graph);0===o.named.length&&0===o.implicit.length&&o.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(n={kind:"select",token:"executableunit"}).dataset=o,n.projection=i.vars,n.modifier=i.modifier,n.pattern=s,null!=a&&null!=a.limit&&(n.limit=a.limit),null!=a&&null!=a.offset&&(n.offset=a.offset),null!=a&&null!=a.order&&""!=a.order&&(n.order=a.order),null!=a&&null!=a.group&&(n.group=a.group),i=n}else _h=i,i=qe}else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe}else _h=i,i=qe}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(st),(n=i)===qe){for(Th++,n=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(t.substr(_h,9)===Mt?(a=Mt,_h+=9):(a=qe,0===Th&&l(It)),a===qe&&(t.substr(_h,9)===jt?(a=jt,_h+=9):(a=qe,0===Th&&l(Ot))),a!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe){if(Th++,s=_h,123===t.charCodeAt(_h)?(a=Qt,_h++):(a=qe,0===Th&&l(Ut)),a!==qe){for(i=[],a=Oe();a!==qe;)i.push(a),a=Oe();if(i!==qe)if((a=G())===qe&&(a=null),a!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();i!==qe?(125===t.charCodeAt(_h)?(o=Gt,_h++):(o=qe,0===Th&&l(zt)),o!==qe?s=a:(_h=s,s=qe)):(_h=s,s=qe)}else _h=s,s=qe;else _h=s,s=qe}else _h=s,s=qe;if(Th--,s===qe&&0===Th&&l(Ao),(a=s)!==qe){for(s=[],i=Oe();i!==qe;)s.push(i),i=Oe();if(s!==qe){for(i=[],s=p();s!==qe;)i.push(s),s=p();if(i!==qe){for(s=[],o=Oe();o!==qe;)s.push(o),o=Oe();if(s!==qe)if((o=g())!==qe){for(u=[],s=Oe();s!==qe;)u.push(s),s=Oe();if(u!==qe)if((s=v())!==qe){for(n=a,a=i,i=o,o={named:[],implicit:[]},u=0;u<a.length;u++)"default"===(f=a[u]).kind?o.implicit.push(f.graph):o.named.push(f.graph);0===o.named.length&&0===o.implicit.length&&o.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(a={kind:"construct",token:"executableunit"}).dataset=o,a.template=n,a.pattern=i,null!=s&&null!=s.limit&&(a.limit=s.limit),null!=s&&null!=s.offset&&(a.offset=s.offset),null!=s&&null!=s.order&&""!=s.order&&(a.order=s.order),n=a}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe;if(n===qe){for(n=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(t.substr(_h,9)===Mt?(a=Mt,_h+=9):(a=qe,0===Th&&l(It)),a===qe&&(t.substr(_h,9)===jt?(a=jt,_h+=9):(a=qe,0===Th&&l(Ot))),a!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe){for(a=[],s=p();s!==qe;)a.push(s),s=p();if(a!==qe){for(s=[],i=Oe();i!==qe;)s.push(i),i=Oe();if(s!==qe)if(t.substr(_h,5)===Dt?(i=Dt,_h+=5):(i=qe,0===Th&&l(Rt)),i===qe&&(t.substr(_h,5)===Bt?(i=Bt,_h+=5):(i=qe,0===Th&&l(Pt))),i!==qe){for(s=[],o=Oe();o!==qe;)s.push(o),o=Oe();if(s!==qe)if(123===t.charCodeAt(_h)?(o=Qt,_h++):(o=qe,0===Th&&l(Ut)),o!==qe){for(u=[],s=Oe();s!==qe;)u.push(s),s=Oe();if(u!==qe)if((s=M())===qe&&(s=null),s!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(125===t.charCodeAt(_h)?(o=Gt,_h++):(o=qe,0===Th&&l(zt)),o!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe)if((i=v())!==qe){for(n=a,a=i,i={named:[],implicit:[]},o=0;o<n.length;o++)"default"===(u=n[o]).kind?i.implicit.push(u.graph):i.named.push(u.graph);0===i.named.length&&0===i.implicit.length&&i.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(n={kind:"construct",token:"executableunit"}).dataset=i,n.template=s,n.pattern={token:"basicgraphpattern",triplesContext:s.triplesContext},null!=a&&null!=a.limit&&(n.limit=a.limit),null!=a&&null!=a.offset&&(n.offset=a.offset),null!=a&&null!=a.order&&""!=a.order&&(n.order=a.order)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}if(Th--,n===qe&&0===Th&&l(Nt),n===qe){if(Th++,n=_h,t.substr(_h,8)===Xt?(s=Xt,_h+=8):(s=qe,0===Th&&l(Ht)),s!==qe){if(a=[],(i=ce())!==qe)for(;i!==qe;)a.push(i),i=ce();else a=qe;if(a===qe&&(42===t.charCodeAt(_h)?(a=Lt,_h++):(a=qe,0===Th&&l(Tt))),a!==qe){for(i=[],o=p();o!==qe;)i.push(o),o=p();i!==qe?((o=g())===qe&&(o=null),o!==qe?(u=v())!==qe?n=s=[s,a,i,o,u]:(_h=n,n=qe):(_h=n,n=qe)):(_h=n,n=qe)}else _h=n,n=qe}else _h=n,n=qe;if(Th--,n===qe&&0===Th&&l(qt),n===qe){for(Th++,n=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(t.substr(_h,3)===Vt?(a=Vt,_h+=3):(a=qe,0===Th&&l(Jt)),a===qe&&(t.substr(_h,3)===Kt?(a=Kt,_h+=3):(a=qe,0===Th&&l(Yt))),a!==qe){for(a=[],s=Oe();s!==qe;)a.push(s),s=Oe();if(a!==qe){for(s=[],i=p();i!==qe;)s.push(i),i=p();if(s!==qe){for(i=[],a=Oe();a!==qe;)i.push(a),a=Oe();if(i!==qe)if((a=g())!==qe){for(n=s,s=a,a={named:[],implicit:[]},i=0;i<n.length;i++)"implicit"===(o=n[i]).kind?a.implicit.push(o.graph):a.named.push(o.graph);0===a.named.length&&0===a.implicit.length&&a.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(n={kind:"ask",token:"executableunit"}).dataset=a,n.pattern=s}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe;Th--,n===qe&&0===Th&&l(Wt)}}}n!==qe?(Th++,s=_h,t.substr(_h,6)===on?(a=on,_h+=6):(a=qe,0===Th&&l(sn)),a===qe&&(t.substr(_h,6)===an?(a=an,_h+=6):(a=qe,0===Th&&l(ln))),a!==qe?(i=R())!==qe?s=a=[a,i]:(_h=s,s=qe):(_h=s,s=qe),s===qe&&(s=null),s!==qe&&(s=null!=s?s[1]:null),Th--,s===qe&&0===Th&&l(nn),s!==qe?e=r={token:"query",kind:"query",prologue:r,units:[n],inlineData:s}:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Ve),Th--,e===qe&&0===Th&&l(We),e===qe&&(Th++,e=C(),Th--,e===qe&&0===Th&&l(un)),e}function c(){var e,r,n,i;for(Th++,e=_h,Th++,r=_h,i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe)if(t.substr(_h,4)===Ye?(n=Ye,_h+=4):(n=qe,0===Th&&l($e)),n===qe&&(t.substr(_h,4)===Ze?(n=Ze,_h+=4):(n=qe,0===Th&&l(et))),n!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(i=Ae())!==qe?(r={token:"base"}).value=i:(_h=r,r=qe):(_h=r,r=qe)}else _h=r,r=qe;else _h=r,r=qe;if(Th--,r===qe&&0===Th&&l(Ke),r===qe&&(r=null),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){for(i=[],n=f();n!==qe;)i.push(n),n=f();i!==qe?e=r={token:"prologue",base:r,prefixes:i}:(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Je),e}function f(){var e,r,n,i;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,6)===rt?(n=rt,_h+=6):(n=qe,0===Th&&l(nt)),n===qe&&(t.substr(_h,6)===it?(n=it,_h+=6):(n=qe,0===Th&&l(ot))),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=Ee())!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();i!==qe?(n=Ae())!==qe?((e={token:"prefix"}).prefix=r,e.local=n):(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(tt),e}function h(){var e,r,n,i,o,s,a,u,c,f,h,p,d,g,v,y;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,6)===ut?(n=ut,_h+=6):(n=qe,0===Th&&l(ct)),n===qe&&(t.substr(_h,6)===ft?(n=ft,_h+=6):(n=qe,0===Th&&l(ht))),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if(t.substr(_h,8)===pt?(r=pt,_h+=8):(r=qe,0===Th&&l(dt)),r===qe&&(t.substr(_h,8)===gt?(r=gt,_h+=8):(r=qe,0===Th&&l(vt))),r===qe&&(t.substr(_h,7)===yt?(r=yt,_h+=7):(r=qe,0===Th&&l(mt)),r===qe&&(t.substr(_h,7)===bt?(r=bt,_h+=7):(r=qe,0===Th&&l(xt)))),r===qe&&(r=null),r!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe){for(n=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if((s=fe())!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?i=o=[o,s,a]:(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(40===t.charCodeAt(_h)?(s=wt,_h++):(s=qe,0===Th&&l(kt)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if((u=he())!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();if(c!==qe)if(t.substr(_h,2)===Ct?(f=Ct,_h+=2):(f=qe,0===Th&&l(St)),f===qe&&(t.substr(_h,2)===Ft?(f=Ft,_h+=2):(f=qe,0===Th&&l(_t))),f!==qe){for(h=[],p=Oe();p!==qe;)h.push(p),p=Oe();if(h!==qe)if((p=fe())!==qe){for(d=[],g=Oe();g!==qe;)d.push(g),g=Oe();if(d!==qe)if(41===t.charCodeAt(_h)?(g=At,_h++):(g=qe,0===Th&&l(Et)),g!==qe){for(v=[],y=Oe();y!==qe;)v.push(y),y=Oe();v!==qe?i=o=[o,s,a,u,c,f,h,p,d,g,v]:(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}if(i!==qe)for(;i!==qe;){for(n.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if((s=fe())!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?i=o=[o,s,a]:(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(40===t.charCodeAt(_h)?(s=wt,_h++):(s=qe,0===Th&&l(kt)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if((u=he())!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();if(c!==qe)if(t.substr(_h,2)===Ct?(f=Ct,_h+=2):(f=qe,0===Th&&l(St)),f===qe&&(t.substr(_h,2)===Ft?(f=Ft,_h+=2):(f=qe,0===Th&&l(_t))),f!==qe){for(h=[],p=Oe();p!==qe;)h.push(p),p=Oe();if(h!==qe)if((p=fe())!==qe){for(d=[],g=Oe();g!==qe;)d.push(g),g=Oe();if(d!==qe)if(41===t.charCodeAt(_h)?(g=At,_h++):(g=qe,0===Th&&l(Et)),g!==qe){for(v=[],y=Oe();y!==qe;)v.push(y),y=Oe();v!==qe?i=o=[o,s,a,u,c,f,h,p,d,g,v]:(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}}else n=qe;if(n===qe){for(n=_h,i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(42===t.charCodeAt(_h)?(o=Lt,_h++):(o=qe,0===Th&&l(Tt)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?n=i=[i,o,s]:(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}if(n!==qe){if(e=r,r=n,n=[],3===r.length&&"*"===r[1])r={vars:[{token:"variable",kind:"*"}],modifier:Ih(e)};else{for(i=0;i<r.length;i++)3===(o=r[i]).length?n.push({token:"variable",kind:"var",value:o[1]}):n.push({token:"variable",kind:"aliased",expression:o[3],alias:o[7]});r={vars:n,modifier:Ih(e)}}e=r}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(lt),e}function p(){var e,r,n,i;if(Th++,e=_h,t.substr(_h,4)===Zt?(r=Zt,_h+=4):(r=qe,0===Th&&l(er)),r===qe&&(t.substr(_h,4)===tr?(r=tr,_h+=4):(r=qe,0===Th&&l(rr))),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe){for(Th++,r=_h,n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe?(i=d())!==qe?r=n={graph:i,kind:"default",token:"graphClause"}:(_h=r,r=qe):(_h=r,r=qe),Th--,r===qe&&0===Th&&l(nr),r===qe){if(Th++,r=_h,t.substr(_h,5)===or?(n=or,_h+=5):(n=qe,0===Th&&l(sr)),n===qe&&(t.substr(_h,5)===ar?(n=ar,_h+=5):(n=qe,0===Th&&l(lr))),n!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(i=d())!==qe?r=n={graph:i,kind:"named",token:"graphCluase"}:(_h=r,r=qe):(_h=r,r=qe)}else _h=r,r=qe;Th--,r===qe&&0===Th&&l(ir)}if(r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r:(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l($t),e}function d(){var e;return Th++,e=_e(),Th--,e===qe&&0===Th&&l(ur),e}function g(){var e,r,n,i;if(Th++,e=_h,t.substr(_h,5)===Dt?(r=Dt,_h+=5):(r=qe,0===Th&&l(Rt)),r===qe&&(t.substr(_h,5)===Bt?(r=Bt,_h+=5):(r=qe,0===Th&&l(Pt))),r===qe&&(r=null),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=I())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(cr),e}function v(){var e,r,n,i;if(Th++,e=_h,Th++,r=_h,t.substr(_h,5)===pr?(n=pr,_h+=5):(n=qe,0===Th&&l(dr)),n===qe&&(t.substr(_h,5)===gr?(n=gr,_h+=5):(n=qe,0===Th&&l(vr))),n!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(t.substr(_h,2)===yr?(i=yr,_h+=2):(i=qe,0===Th&&l(mr)),i===qe&&(t.substr(_h,2)===br?(i=br,_h+=2):(i=qe,0===Th&&l(xr))),i!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe){if(n=[],(i=y())!==qe)for(;i!==qe;)n.push(i),i=y();else n=qe;n!==qe?r=n:(_h=r,r=qe)}else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe;if(Th--,r===qe&&0===Th&&l(hr),r===qe&&(r=null),r!==qe){var o,s;if(Th++,n=_h,t.substr(_h,6)===Cr?(i=Cr,_h+=6):(i=qe,0===Th&&l(Sr)),i!==qe){if(o=[],(s=m())!==qe)for(;s!==qe;)o.push(s),s=m();else o=qe;o!==qe?n=i=[i,o]:(_h=n,n=qe)}else _h=n,n=qe;if(Th--,n===qe&&0===Th&&l(kr),n===qe&&(n=null),n!==qe){if(Th++,n=_h,t.substr(_h,5)===Ar?(i=Ar,_h+=5):(i=qe,0===Th&&l(Er)),i===qe&&(t.substr(_h,5)===Lr?(i=Lr,_h+=5):(i=qe,0===Th&&l(Tr))),i!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(t.substr(_h,2)===yr?(o=yr,_h+=2):(o=qe,0===Th&&l(mr)),o===qe&&(t.substr(_h,2)===br?(o=br,_h+=2):(o=qe,0===Th&&l(xr))),o!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe){if(i=[],(o=b())!==qe)for(;o!==qe;)i.push(o),o=b();else i=qe;if(i!==qe){for(o=[],s=Oe();s!==qe;)o.push(s),s=Oe();o!==qe?n=i:(_h=n,n=qe)}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(Th--,n===qe&&0===Th&&l(_r),n===qe&&(n=null),n!==qe){if(Th++,i=_h,(o=x())!==qe?((s=w())===qe&&(s=null),s!==qe?i=o=[o,s]:(_h=i,i=qe)):(_h=i,i=qe),i===qe&&(i=_h,(o=w())!==qe?((s=x())===qe&&(s=null),s!==qe?i=o=[o,s]:(_h=i,i=qe)):(_h=i,i=qe)),i!==qe){for(o={},s=0;s<i.length;s++){var a=i[s];null!=a&&null!=a.limit?o.limit=a.limit:null!=a&&null!=a.offset&&(o.offset=a.offset)}i=o}Th--,i===qe&&0===Th&&l(Qr),i===qe&&(i=null),i!==qe?(e=r,r=i,i={},null!=r&&(null!=r.limit&&(i.limit=r.limit),null!=r.offset&&(i.offset=r.offset)),null!=e&&(i.group=e),i.order=n,e=i):(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(fr),e}function y(){var e,r,n,i,o,s;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if((n=xe())!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();i!==qe?e=n:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){for(e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if((n=P())!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();i!==qe?e=n:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){for(e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(40===t.charCodeAt(_h)?(n=wt,_h++):(n=qe,0===Th&&l(kt)),n!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=he())!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe){if(n=_h,t.substr(_h,2)===Ct?(o=Ct,_h+=2):(o=qe,0===Th&&l(St)),o===qe&&(t.substr(_h,2)===Ft?(o=Ft,_h+=2):(o=qe,0===Th&&l(_t))),o!==qe){for(s=[],i=Oe();i!==qe;)s.push(i),i=Oe();s!==qe?(i=fe())!==qe?n=o=[o,s,i]:(_h=n,n=qe):(_h=n,n=qe)}else _h=n,n=qe;if(n===qe&&(n=null),n!==qe){for(o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(41===t.charCodeAt(_h)?(s=At,_h++):(s=qe,0===Th&&l(Et)),s!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();i!==qe?e=r=0!=n.length?{token:"aliased_expression",expression:r,alias:n[2]}:r:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){for(e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if((n=fe())!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();i!==qe?e=n:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}}}return Th--,e===qe&&0===Th&&l(wr),e}function m(){var e;return Th++,e=D(),Th--,e===qe&&0===Th&&l(Fr),e}function b(){var e,r,n,i,o;if(Th++,e=_h,t.substr(_h,3)===Mr?(r=Mr,_h+=3):(r=qe,0===Th&&l(Ir)),r===qe&&(t.substr(_h,3)===jr?(r=jr,_h+=3):(r=qe,0===Th&&l(Or)),r===qe&&(t.substr(_h,4)===Dr?(r=Dr,_h+=4):(r=qe,0===Th&&l(Rr)),r===qe&&(t.substr(_h,4)===Br?(r=Br,_h+=4):(r=qe,0===Th&&l(Pr))))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if((i=be())!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();n!==qe?(e=i,e=r={direction:r.toUpperCase(),expression:e}):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe)if(e=_h,(r=D())===qe&&(r=fe()),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?("var"===r.token&&(r={token:"expression",expressionType:"atomic",primaryexpression:"var",value:r}),e=r={direction:"ASC",expression:r}):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Nr),e}function x(){var e,r,n,i;if(Th++,e=_h,t.substr(_h,5)===Gr?(r=Gr,_h+=5):(r=qe,0===Th&&l(zr)),r===qe&&(t.substr(_h,5)===qr?(r=qr,_h+=5):(r=qe,0===Th&&l(Xr))),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=Le())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r={limit:parseInt(r.value)}:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Ur),e}function w(){var e,r,n,i;if(Th++,e=_h,t.substr(_h,6)===Wr?(r=Wr,_h+=6):(r=qe,0===Th&&l(Vr)),r===qe&&(t.substr(_h,6)===Jr?(r=Jr,_h+=6):(r=qe,0===Th&&l(Kr))),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=Le())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r={offset:parseInt(r.value)}:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Hr),e}function k(){var e;return Th++,(e=_e())===qe&&((e=we())===qe&&((e=ke())===qe&&((e=Se())===qe&&(t.substr(_h,5)===tn?(e=tn,_h+=5):(e=qe,0===Th&&l(rn)))))),Th--,e===qe&&0===Th&&l(en),e}function C(){var e,r,n,i,o,s,a,u;if(Th++,e=_h,(r=c())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){if(Th++,Th++,n=_h,t.substr(_h,4)===gn?(i=gn,_h+=4):(i=qe,0===Th&&l(vn)),i===qe&&(t.substr(_h,4)===yn?(i=yn,_h+=4):(i=qe,0===Th&&l(mn))),i!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe)if((i=_e())!==qe){for(s=[],o=Oe();o!==qe;)s.push(o),o=Oe();if(s!==qe){if(o=_h,t.substr(_h,4)===bn?(s=bn,_h+=4):(s=qe,0===Th&&l(xn)),s===qe&&(t.substr(_h,4)===wn?(s=wn,_h+=4):(s=qe,0===Th&&l(kn))),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=_())!==qe?o=s=[s,a,u]:(_h=o,o=qe):(_h=o,o=qe)}else _h=o,o=qe;o===qe&&(o=null),o!==qe?(n=o,(o={kind:"load",token:"executableunit"}).sourceGraph=i,null!=n&&(o.destinyGraph=n[2]),n=o):(_h=n,n=qe)}else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(Th--,n===qe&&0===Th&&l(dn),(i=n)===qe){if(Th++,i=_h,t.substr(_h,5)===Sn?(n=Sn,_h+=5):(n=qe,0===Th&&l(Fn)),n===qe&&(t.substr(_h,5)===_n?(n=_n,_h+=5):(n=qe,0===Th&&l(An))),n!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();if(n!==qe)if(t.substr(_h,6)===En?(o=En,_h+=6):(o=qe,0===Th&&l(Ln)),o===qe&&(t.substr(_h,6)===Tn?(o=Tn,_h+=6):(o=qe,0===Th&&l(Nn))),o===qe&&(o=null),o!==qe){for(o=[],n=Oe();n!==qe;)o.push(n),n=Oe();o!==qe?(n=A())!==qe?(i={kind:"clear",token:"executableunit"}).destinyGraph=n:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(Cn),i===qe){if(Th++,i=_h,t.substr(_h,4)===In?(n=In,_h+=4):(n=qe,0===Th&&l(jn)),n===qe&&(t.substr(_h,4)===On?(n=On,_h+=4):(n=qe,0===Th&&l(Dn))),n!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();if(n!==qe)if(t.substr(_h,6)===En?(o=En,_h+=6):(o=qe,0===Th&&l(Ln)),o===qe&&(t.substr(_h,6)===Tn?(o=Tn,_h+=6):(o=qe,0===Th&&l(Nn))),o===qe&&(o=null),o!==qe){for(o=[],n=Oe();n!==qe;)o.push(n),n=Oe();o!==qe?(n=A())!==qe?(i={kind:"drop",token:"executableunit"}).destinyGraph=n:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(Mn),i===qe){if(Th++,i=_h,t.substr(_h,6)===Bn?(n=Bn,_h+=6):(n=qe,0===Th&&l(Pn)),n===qe&&(t.substr(_h,6)===Qn?(n=Qn,_h+=6):(n=qe,0===Th&&l(Un))),n!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();if(n!==qe)if(t.substr(_h,6)===En?(o=En,_h+=6):(o=qe,0===Th&&l(Ln)),o===qe&&(t.substr(_h,6)===Tn?(o=Tn,_h+=6):(o=qe,0===Th&&l(Nn))),o===qe&&(o=null),o!==qe){for(o=[],n=Oe();n!==qe;)o.push(n),n=Oe();o!==qe?(n=_())!==qe?(i={kind:"create",token:"executableunit"}).destinyGraph=n:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(Rn),i===qe){if(Th++,i=_h,t.substr(_h,6)===zn?(n=zn,_h+=6):(n=qe,0===Th&&l(qn)),n===qe&&(t.substr(_h,6)===Xn?(n=Xn,_h+=6):(n=qe,0===Th&&l(Hn))),n!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();if(n!==qe)if(t.substr(_h,4)===Wn?(o=Wn,_h+=4):(o=qe,0===Th&&l(Vn)),o===qe&&(t.substr(_h,4)===Jn?(o=Jn,_h+=4):(o=qe,0===Th&&l(Kn))),o!==qe){for(o=[],n=Oe();n!==qe;)o.push(n),n=Oe();o!==qe?(n=L())!==qe?(i={kind:"insertdata",token:"executableunit"}).quads=n:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(Gn),i===qe){if(Th++,i=_h,t.substr(_h,6)===$n?(n=$n,_h+=6):(n=qe,0===Th&&l(Zn)),n===qe&&(t.substr(_h,6)===ei?(n=ei,_h+=6):(n=qe,0===Th&&l(ti))),n!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();n!==qe?(t.substr(_h,4)===Wn?(o=Wn,_h+=4):(o=qe,0===Th&&l(Vn)),o===qe&&(t.substr(_h,4)===Jn?(o=Jn,_h+=4):(o=qe,0===Th&&l(Kn))),o!==qe?(n=L())!==qe?(i={kind:"deletedata",token:"executableunit"}).quads=n:(_h=i,i=qe):(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(Yn),i===qe){if(Th++,i=_h,t.substr(_h,6)===$n?(n=$n,_h+=6):(n=qe,0===Th&&l(Zn)),n===qe&&(t.substr(_h,6)===ei?(n=ei,_h+=6):(n=qe,0===Th&&l(ti))),n!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();if(n!==qe)if(t.substr(_h,5)===Dt?(o=Dt,_h+=5):(o=qe,0===Th&&l(Rt)),o===qe&&(t.substr(_h,5)===Bt?(o=Bt,_h+=5):(o=qe,0===Th&&l(Pt))),o!==qe){for(n=[],o=Oe();o!==qe;)n.push(o),o=Oe();if(n!==qe)if((o=I())!==qe){for((i={kind:"modify"}).pattern=o,i.with=null,i.using=null,n=[],o=null==(o=o.patterns[0]).triplesContext&&null!=o.patterns?o.patterns[0].triplesContext:o.triplesContext,s=0;s<o.length;s++)a={},u=o[s],a.subject=u.subject,a.predicate=u.predicate,a.object=u.object,a.graph=u.graph,n.push(a);i.delete=n}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;if(Th--,i===qe&&0===Th&&l(ri),i===qe){var f;if(Th++,o=n=_h,t.substr(_h,4)===ii?(s=ii,_h+=4):(s=qe,0===Th&&l(oi)),s===qe&&(t.substr(_h,4)===si?(s=si,_h+=4):(s=qe,0===Th&&l(ai))),s!==qe){for(i=[],a=Oe();a!==qe;)i.push(a),a=Oe();i!==qe?(a=_e())!==qe?o=s=[s,i,a]:(_h=o,o=qe):(_h=o,o=qe)}else _h=o,o=qe;if(o===qe&&(o=null),o!==qe){for(s=[],i=Oe();i!==qe;)s.push(i),i=Oe();if(s!==qe){if(i=_h,Th++,s=_h,t.substr(_h,6)===$n?(a=$n,_h+=6):(a=qe,0===Th&&l(Zn)),a===qe&&(t.substr(_h,6)===ei?(a=ei,_h+=6):(a=qe,0===Th&&l(ti))),a!==qe?(a=E())!==qe?s=a:(_h=s,s=qe):(_h=s,s=qe),Th--,s===qe&&0===Th&&l(li),(a=s)!==qe){for(s=[],u=Oe();u!==qe;)s.push(u),u=Oe();s!==qe?((u=S())===qe&&(u=null),u!==qe?i=a=[a,s,u]:(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe;if(i===qe&&(i=S()),i!==qe){for(a=[],s=Oe();s!==qe;)a.push(s),s=Oe();if(a!==qe){for(s=[],u=F();u!==qe;)s.push(u),u=F();if(s!==qe){for(u=[],a=Oe();a!==qe;)u.push(a),a=Oe();if(u!==qe)if(t.substr(_h,5)===Dt?(a=Dt,_h+=5):(a=qe,0===Th&&l(Rt)),a===qe&&(t.substr(_h,5)===Bt?(a=Bt,_h+=5):(a=qe,0===Th&&l(Pt))),a!==qe){for(u=[],a=Oe();a!==qe;)u.push(a),a=Oe();if(u!==qe)if((a=I())!==qe){for(u=[],f=Oe();f!==qe;)u.push(f),f=Oe();u!==qe?(n=o,o=s,(s={kind:"modify"}).with=""!=n&&null!=n?n[2]:null,3!==i.length||""!==i[2]&&null!=i[2]?3===i.length&&null!=i[0].length&&null!=i[1].length&&null!=i[2].length?(s.delete=i[0],s.insert=i[2]):(s.insert=i,s.delete=null):(s.delete=i[0],s.insert=null),""!=o&&(s.using=o),s.pattern=a,n=s):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;Th--,n===qe&&0===Th&&l(ni),i=n}}}}}}}if(Th--,i===qe&&0===Th&&l(pn),i!==qe){for(n=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(59===t.charCodeAt(_h)?(s=fn,_h++):(s=qe,0===Th&&l(hn)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?((u=C())===qe&&(u=null),u!==qe?n=o=[o,s,a,u]:(_h=n,n=qe)):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe;n===qe&&(n=null),n!==qe?(e=n,(n={token:"query",kind:"update"}).prologue=r,r=[i],null!=e&&null!=e.length&&null!=e[3]&&null!=e[3].units&&(r=r.concat(e[3].units)),n.units=r,e=n):(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(cn),e}function S(){var e,r;return Th++,e=_h,t.substr(_h,6)===zn?(r=zn,_h+=6):(r=qe,0===Th&&l(qn)),r===qe&&(t.substr(_h,6)===Xn?(r=Xn,_h+=6):(r=qe,0===Th&&l(Hn))),r!==qe?(r=E())!==qe?e=r:(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(ui),e}function F(){var e,r,n,i,o;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,5)===fi?(n=fi,_h+=5):(n=qe,0===Th&&l(hi)),n===qe&&(t.substr(_h,5)===pi?(n=pi,_h+=5):(n=qe,0===Th&&l(di))),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe){if((r=_e())===qe)if(r=_h,t.substr(_h,5)===or?(n=or,_h+=5):(n=qe,0===Th&&l(sr)),n===qe&&(t.substr(_h,5)===ar?(n=ar,_h+=5):(n=qe,0===Th&&l(lr))),n!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();i!==qe?(o=_e())!==qe?r=n=[n,i,o]:(_h=r,r=qe):(_h=r,r=qe)}else _h=r,r=qe;r!==qe?e=r=null!=r.length?{kind:"named",uri:r[2]}:{kind:"default",uri:r}:(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(ci),e}function _(){var e,r,n;if(Th++,e=_h,t.substr(_h,5)===vi?(r=vi,_h+=5):(r=qe,0===Th&&l(yi)),r===qe&&(t.substr(_h,5)===mi?(r=mi,_h+=5):(r=qe,0===Th&&l(bi))),r!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(n=_e())!==qe?e=n:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(gi),e}function A(){var e;return Th++,(e=_())===qe&&(t.substr(_h,7)===wi?(e=wi,_h+=7):(e=qe,0===Th&&l(ki)),e===qe&&(t.substr(_h,7)===Ci?(e=Ci,_h+=7):(e=qe,0===Th&&l(Si))),e!==qe&&(e="default"),e===qe&&(t.substr(_h,5)===or?(e=or,_h+=5):(e=qe,0===Th&&l(sr)),e===qe&&(t.substr(_h,5)===ar?(e=ar,_h+=5):(e=qe,0===Th&&l(lr))),e!==qe&&(e="named"),e===qe&&(t.substr(_h,3)===Fi?(e=Fi,_h+=3):(e=qe,0===Th&&l(_i)),e===qe&&(t.substr(_h,3)===Ai?(e=Ai,_h+=3):(e=qe,0===Th&&l(Ei))),e!==qe&&(e="all")))),Th--,e===qe&&0===Th&&l(xi),e}function E(){var e,r,n,i;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(123===t.charCodeAt(_h)?(n=Qt,_h++):(n=qe,0===Th&&l(Ut)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=T())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(125===t.charCodeAt(_h)?(i=Gt,_h++):(i=qe,0===Th&&l(zt)),i!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r=r.quadsContext:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Li),e}function L(){var e,r,n,i;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(123===t.charCodeAt(_h)?(n=Qt,_h++):(n=qe,0===Th&&l(Ut)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=T())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(125===t.charCodeAt(_h)?(i=Gt,_h++):(i=qe,0===Th&&l(zt)),i!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r=r.quadsContext:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Ti),e}function T(){var e,r,n,i,o,s,a;if(Th++,e=_h,(r=M())===qe&&(r=null),r!==qe){for(n=[],i=_h,(o=N())!==qe?(46===t.charCodeAt(_h)?(s=Mi,_h++):(s=qe,0===Th&&l(Ii)),s===qe&&(s=null),s!==qe?((a=M())===qe&&(a=null),a!==qe?i=o=[o,s,a]:(_h=i,i=qe)):(_h=i,i=qe)):(_h=i,i=qe);i!==qe;)n.push(i),i=_h,(o=N())!==qe?(46===t.charCodeAt(_h)?(s=Mi,_h++):(s=qe,0===Th&&l(Ii)),s===qe&&(s=null),s!==qe?((a=M())===qe&&(a=null),a!==qe?i=o=[o,s,a]:(_h=i,i=qe)):(_h=i,i=qe)):(_h=i,i=qe);if(n!==qe){if(e=r,r=[],null!=e&&null!=e.triplesContext)for(i=0;i<e.triplesContext.length;i++)(o=e.triplesContext[i]).graph=null,r.push(o);if(n&&0<n.length&&0<n[0].length&&(r=r.concat(n[0][0].quadsContext),null!=n[0][2]&&null!=n[0][2].triplesContext))for(i=0;i<n[0][2].triplesContext.length;i++)(o=n[0][2].triplesContext[i]).graph=null,r.push(o);e=r={token:"quads",quadsContext:r}}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Ni),e}function N(){var e,r,n,i,o;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,5)===vi?(n=vi,_h+=5):(n=qe,0===Th&&l(yi)),n===qe&&(t.substr(_h,5)===mi?(n=mi,_h+=5):(n=qe,0===Th&&l(bi))),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=ce())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(123===t.charCodeAt(_h)?(i=Qt,_h++):(i=qe,0===Th&&l(Ut)),i!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe)if((n=M())===qe&&(n=null),n!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(125===t.charCodeAt(_h)?(o=Gt,_h++):(o=qe,0===Th&&l(zt)),o!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe){if(e=r,r=n,n=[],null!=r)for(i=0;i<r.triplesContext.length;i++)(o=r.triplesContext[i]).graph=e,n.push(o);e=r={token:"quadsnottriples",quadsContext:n}}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(ji),e}function M(){var e,r,n,i,o,s,a;if(Th++,e=_h,(r=z())!==qe){for(n=_h,i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(46===t.charCodeAt(_h)?(o=Mi,_h++):(o=qe,0===Th&&l(Ii)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((a=M())===qe&&(a=null),a!==qe?n=i=[i,o,s,a]:(_h=n,n=qe)):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe;n===qe&&(n=null),n!==qe?(e=r.triplesContext,null!=n&&"object"==typeof n&&null!=n.length&&null!=n[3]&&null!=n[3].triplesContext&&(e=e.concat(n[3].triplesContext)),e=r={token:"triplestemplate",triplesContext:e}):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Oi),e}function I(){var e,r,n,i;if(Th++,e=_h,123===t.charCodeAt(_h)?(r=Qt,_h++):(r=qe,0===Th&&l(Ut)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();var o;if(n!==qe)if(Th++,i=_h,(o=h())!==qe?(r=g())!==qe?(n=v())!==qe?(i=o,(o={kind:"select",token:"subselect"}).projection=i.vars,o.modifier=i.modifier,o.pattern=r,null!=n&&null!=n.limit&&(o.limit=n.limit),null!=n&&null!=n.offset&&(o.offset=n.offset),null!=n&&null!=n.order&&""!=n.order&&(o.order=n.order),null!=n&&null!=n.group&&(o.group=n.group),i=o):(_h=i,i=qe):(_h=i,i=qe):(_h=i,i=qe),Th--,i===qe&&0===Th&&l(at),(r=i)!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(125===t.charCodeAt(_h)?(i=Gt,_h++):(i=qe,0===Th&&l(zt)),i!==qe?e=r:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe)if(e=_h,123===t.charCodeAt(_h)?(r=Qt,_h++):(r=qe,0===Th&&l(Ut)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe){var s,a,u,c,f;if(Th++,n=_h,(r=j())===qe&&(r=null),r!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe){if(i=[],o=_h,(s=O())!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if(46===t.charCodeAt(_h)?(u=Mi,_h++):(u=qe,0===Th&&l(Ii)),u===qe&&(u=null),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();c!==qe?((f=j())===qe&&(f=null),f!==qe?o=s=[s,a,u,c,f]:(_h=o,o=qe)):(_h=o,o=qe)}else _h=o,o=qe;else _h=o,o=qe}else _h=o,o=qe;for(;o!==qe;)if(i.push(o),o=_h,(s=O())!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if(46===t.charCodeAt(_h)?(u=Mi,_h++):(u=qe,0===Th&&l(Ii)),u===qe&&(u=null),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();c!==qe?((f=j())===qe&&(f=null),f!==qe?o=s=[s,a,u,c,f]:(_h=o,o=qe)):(_h=o,o=qe)}else _h=o,o=qe;else _h=o,o=qe}else _h=o,o=qe;if(i!==qe){for(o=i,n=[],null!=r&&r!=[]&&n.push(r),r=0;r<o.length;r++)for(i=0;i<o[r].length;i++)null!=o[r][i]&&null!=o[r][i].token&&n.push(o[r][i]);for(o=[],s=[],a=[],u=[],r=0;r<n.length;r++)if("triplespattern"!==n[r].token&&"filter"!==n[r].token&&"bind"!==n[r].token){if(0!=s.length||0!=a.length){for(c=[],i=0;i<s.length;i++)c=c.concat(s[i].triplesContext);0<c.length&&o.push({token:"basicgraphpattern",triplesContext:c}),s=[]}o.push(n[r])}else"triplespattern"===n[r].token?s.push(n[r]):"bind"===n[r].token?u.push(n[r]):a.push(n[r]);if(0!=s.length||0!=a.length){for(c=[],i=0;i<s.length;i++)c=c.concat(s[i].triplesContext);0<c.length&&o.push({token:"basicgraphpattern",triplesContext:c})}n=r={token:"groupgraphpattern",patterns:o,filters:a,binds:u}}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;if(Th--,n===qe&&0===Th&&l(Ri),(r=n)!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(125===t.charCodeAt(_h)?(i=Gt,_h++):(i=qe,0===Th&&l(zt)),i!==qe?e=r:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Di),e}function j(){var e,r,n,i,o,s;for(Th++,e=_h,Th++,n=_h,i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=ue())!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe)if((i=K())!==qe){if(n=r,r=i.triplesContext,i.pairs)for(o=0;o<i.pairs.length;o++){var a=null;null!=(s=i.pairs[o])[1].length&&(s[1]=s[1][0]),n.token&&"triplesnodecollection"===n.token?("path"===(a={subject:n.chainSubject[0],predicate:s[0],object:s[1]}).predicate.token&&"element"===a.predicate.kind&&(a.predicate=a.predicate.value),r.push(a),r=r.concat(n.triplesContext)):("path"===(a={subject:n,predicate:s[0],object:s[1]}).predicate.token&&"element"===a.predicate.kind&&(a.predicate=a.predicate.value),r.push(a))}(i={token:"triplessamesubject"}).triplesContext=r,i.chainSubject=n,n=i}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe;if(n===qe){for(n=_h,i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=oe())!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe){var u,c,f,h,p,d,g,v;if(Th++,Th++,s=_h,(a=Y())===qe&&(a=$()),a!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if((o=X())!==qe){for(i=[],u=_h,c=[],f=Oe();f!==qe;)c.push(f),f=Oe();if(c!==qe)if(59===t.charCodeAt(_h)?(f=fn,_h++):(f=qe,0===Th&&l(hn)),f!==qe){for(h=[],p=Oe();p!==qe;)h.push(p),p=Oe();if(h!==qe){if(p=_h,(d=Y())===qe&&(d=$()),d!==qe){for(g=[],v=Oe();v!==qe;)g.push(v),v=Oe();g!==qe?(v=H())!==qe?p=d=[d,g,v]:(_h=p,p=qe):(_h=p,p=qe)}else _h=p,p=qe;p===qe&&(p=null),p!==qe?u=c=[c,f,h,p]:(_h=u,u=qe)}else _h=u,u=qe}else _h=u,u=qe;else _h=u,u=qe;for(;u!==qe;){for(i.push(u),u=_h,c=[],f=Oe();f!==qe;)c.push(f),f=Oe();if(c!==qe)if(59===t.charCodeAt(_h)?(f=fn,_h++):(f=qe,0===Th&&l(hn)),f!==qe){for(h=[],p=Oe();p!==qe;)h.push(p),p=Oe();if(h!==qe){if(p=_h,(d=Y())===qe&&(d=$()),d!==qe){for(g=[],v=Oe();v!==qe;)g.push(v),v=Oe();g!==qe?(v=H())!==qe?p=d=[d,g,v]:(_h=p,p=qe):(_h=p,p=qe)}else _h=p,p=qe;p===qe&&(p=null),p!==qe?u=c=[c,f,h,p]:(_h=u,u=qe)}else _h=u,u=qe}else _h=u,u=qe;else _h=u,u=qe}if(i!==qe){for(c=a,f=o,o={token:"propertylist"},s=[],a=[],u=0;u<f.length;u++)null!=f[u].triplesContext?(s=s.concat(f[u].triplesContext),"triplesnodecollection"===f[u].token&&null!=f[u].chainSubject.length?a.push([c,f[u].chainSubject[0]]):a.push([c,f[u].chainSubject])):a.push([c,f[u]]);for(u=0;u<i.length;u++)for(c=(f=i[u][3])[0],f=f[2]||[],h=0;h<f.length;h++)null!=f[h].triplesContext?(s=s.concat(f[h].triplesContext),a.push([c,f[h].chainSubject])):a.push([c,f[h]]);o.pairs=a,o.triplesContext=s,s=o}else _h=s,s=qe}else _h=s,s=qe;else _h=s,s=qe}else _h=s,s=qe;if(Th--,s===qe&&0===Th&&l(To),(i=s)===qe&&(i=null),Th--,i===qe&&0===Th&&l(zo),i!==qe){if(o=i,r=(n=r).triplesContext,i=n.chainSubject,null!=o&&null!=o.pairs)for(s=0;s<o.pairs.length;s++)if(null!=(a=o.pairs[s])[1].length&&(a[1]=a[1][0]),"triplesnodecollection"===n.token)for(u=0;u<i.length;u++)null!=(c=i[u]).triplesContext?(f={subject:c.chainSubject,predicate:a[0],object:a[1]},r.concat(c.triplesContext)):(f={subject:i[u],predicate:a[0],object:a[1]},r.push(f));else f={subject:i,predicate:a[0],object:a[1]},r.push(f);(n={token:"triplessamesubject"}).triplesContext=r,n.chainSubject=i}else _h=n,n=qe}else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}if(Th--,n===qe&&0===Th&&l(Uo),(r=n)!==qe){for(n=_h,i=[],o=Oe();o!==qe;)i.push(o),o=Oe();i!==qe?(46===t.charCodeAt(_h)?(o=Mi,_h++):(o=qe,0===Th&&l(Ii)),o!==qe?((s=j())===qe&&(s=null),s!==qe?n=i=[i,o,s]:(_h=n,n=qe)):(_h=n,n=qe)):(_h=n,n=qe),n===qe&&(n=null),n!==qe?(e=r.triplesContext,null!=n&&"object"==typeof n&&null!=n&&null!=n.length&&null!=n[2]&&null!=n[2].triplesContext&&(e=e.concat(n[2].triplesContext)),e=r={token:"triplespattern",triplesContext:e}):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Bi),e}function O(){var e,r,n,i,o,s,a,u;if(Th++,Th++,r=_h,(n=I())!==qe){for(e=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,5)===to?(s=to,_h+=5):(s=qe,0===Th&&l(ro)),s===qe&&(t.substr(_h,5)===no?(s=no,_h+=5):(s=qe,0===Th&&l(io))),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=I())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;for(;i!==qe;){for(e.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,5)===to?(s=to,_h+=5):(s=qe,0===Th&&l(ro)),s===qe&&(t.substr(_h,5)===no?(s=no,_h+=5):(s=qe,0===Th&&l(io))),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=I())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}if(e!==qe){if(0!==e.length){for(r={token:"graphunionpattern",value:[n]},n=0;n<e.length;n++)n==e.length-1?r.value.push(e[n][3]):(r.value.push(e[n][3]),r={token:"graphunionpattern",value:[r]});n=r}r=n}else _h=r,r=qe}else _h=r,r=qe;if(Th--,r===qe&&0===Th&&l(eo),(e=r)===qe){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,8)===Ui?(n=Ui,_h+=8):(n=qe,0===Th&&l(Gi)),n===qe&&(t.substr(_h,8)===zi?(n=zi,_h+=8):(n=qe,0===Th&&l(qi))),n!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(n=I())!==qe?e=r={token:"optionalgraphpattern",value:n}:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(Qi),e===qe){if(Th++,e=_h,t.substr(_h,5)===Ki?(r=Ki,_h+=5):(r=qe,0===Th&&l(Yi)),r===qe&&(t.substr(_h,5)===$i?(r=$i,_h+=5):(r=qe,0===Th&&l(Zi))),r!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(n=I())!==qe?e=r={token:"minusgraphpattern",status:"todo",value:n}:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(Ji),e===qe){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,5)===vi?(n=vi,_h+=5):(n=qe,0===Th&&l(yi)),n===qe&&(t.substr(_h,5)===mi?(n=mi,_h+=5):(n=qe,0===Th&&l(bi))),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=ce())!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe)if((n=I())!==qe){for(e=r,r=n,n=0;n<r.patterns.length;n++)for(i=r.patterns[n],o=0;o<i.triplesContext.length;o++)i.triplesContext[o].graph=e;r.token="groupgraphpattern",e=r}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(Xi),e===qe&&(Th++,e=_h,t.substr(_h,7)===Wi?(r=Wi,_h+=7):(r=qe,0===Th&&l(Vi)),r!==qe?(r=ce())!==qe?(n=I())!==qe?e=r={token:"servicegraphpattern",status:"todo",value:[r,n]}:(_h=e,e=qe):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(Hi),e===qe)){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,6)===so?(n=so,_h+=6):(n=qe,0===Th&&l(ao)),n===qe&&(t.substr(_h,6)===lo?(n=lo,_h+=6):(n=qe,0===Th&&l(uo))),n!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(n=D())!==qe?e=r={token:"filter",value:n}:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(oo),e===qe){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,4)===fo?(n=fo,_h+=4):(n=qe,0===Th&&l(ho)),n===qe&&(t.substr(_h,4)===po?(n=po,_h+=4):(n=qe,0===Th&&l(go))),n!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(40===t.charCodeAt(_h)?(n=wt,_h++):(n=qe,0===Th&&l(kt)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=he())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(t.substr(_h,2)===Ft?(i=Ft,_h+=2):(i=qe,0===Th&&l(_t)),i===qe&&(t.substr(_h,2)===Ct?(i=Ct,_h+=2):(i=qe,0===Th&&l(St))),i!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe)if((n=fe())!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();i!==qe?(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe?e=r={token:"bind",expression:r,as:n}:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(co),e===qe){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(t.substr(_h,6)===on?(n=on,_h+=6):(n=qe,0===Th&&l(sn)),n===qe&&(t.substr(_h,6)===an?(n=an,_h+=6):(n=qe,0===Th&&l(ln))),n!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(n=R())!==qe?e=n:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;Th--,e===qe&&0===Th&&l(yo)}}}}}}return Th--,e===qe&&0===Th&&l(Pi),e}function D(){var e;return Th++,(e=be())===qe&&((e=xe())===qe&&(e=P())),Th--,e===qe&&0===Th&&l(vo),e}function R(){var e,r,n,i;for(Th++,Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if((n=fe())!==qe){for(r=[],i=Oe();i!==qe;)r.push(i),i=Oe();if(r!==qe)if(123===t.charCodeAt(_h)?(i=Qt,_h++):(i=qe,0===Th&&l(Ut)),i!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe){for(r=[],i=B();i!==qe;)r.push(i),i=B();r!==qe?(125===t.charCodeAt(_h)?(i=Gt,_h++):(i=qe,0===Th&&l(zt)),i!==qe?e=r={token:"inlineData",values:[{var:n,value:r}]}:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(bo),e===qe){var o,s,a,u,c,f,h;for(Th++,e=_h,n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){if((i=je())===qe)if(i=_h,40===t.charCodeAt(_h)?(o=wt,_h++):(o=qe,0===Th&&l(kt)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe){for(a=[],n=fe();n!==qe;)a.push(n),n=fe();if(a!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();n!==qe?(41===t.charCodeAt(_h)?(r=At,_h++):(r=qe,0===Th&&l(Et)),r!==qe?i=o=[o,s,a,n,r]:(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe}else _h=i,i=qe}else _h=i,i=qe;if(i!==qe){for(o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(123===t.charCodeAt(_h)?(s=Qt,_h++):(s=qe,0===Th&&l(Ut)),s!==qe){for(a=[],n=Oe();n!==qe;)a.push(n),n=Oe();if(a!==qe){for(n=[],r=_h,i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(40===t.charCodeAt(_h)?(o=wt,_h++):(o=qe,0===Th&&l(kt)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe){for(a=[],u=B();u!==qe;)a.push(u),u=B();if(a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();if(u!==qe)if(41===t.charCodeAt(_h)?(c=At,_h++):(c=qe,0===Th&&l(Et)),c!==qe){for(f=[],h=Oe();h!==qe;)f.push(h),h=Oe();f!==qe?r=i=[i,o,s,a,u,c,f]:(_h=r,r=qe)}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe}else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe;for(r===qe&&(r=je());r!==qe;){for(n.push(r),r=_h,i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(40===t.charCodeAt(_h)?(o=wt,_h++):(o=qe,0===Th&&l(kt)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe){for(a=[],u=B();u!==qe;)a.push(u),u=B();if(a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();if(u!==qe)if(41===t.charCodeAt(_h)?(c=At,_h++):(c=qe,0===Th&&l(Et)),c!==qe){for(f=[],h=Oe();h!==qe;)f.push(h),h=Oe();f!==qe?r=i=[i,o,s,a,u,c,f]:(_h=r,r=qe)}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe}else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe;r===qe&&(r=je())}if(n!==qe){for(r=[],i=Oe();i!==qe;)r.push(i),i=Oe();r!==qe?(125===t.charCodeAt(_h)?(i=Gt,_h++):(i=qe,0===Th&&l(zt)),i!==qe?e=n={token:"inlineData",values:[],todo:!0}:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;Th--,e===qe&&0===Th&&l(xo)}return Th--,e===qe&&0===Th&&l(mo),e}function B(){var e,r,n,i;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if((n=Ae())===qe&&((n=we())===qe&&((n=ke())===qe&&((n=Se())===qe&&(t.substr(_h,5)===tn?(n=tn,_h+=5):(n=qe,0===Th&&l(rn)))))),n!==qe){for(r=[],i=Oe();i!==qe;)r.push(i),i=Oe();r!==qe?e=n:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(wo),e}function P(){var e,t,r,n;if(Th++,e=_h,(t=_e())!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(n=Q())!==qe?((e={token:"expression",expressionType:"irireforfunction"}).iriref=t,e.args=n.value):(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(ko),e}function Q(){var e,r,n,i,o,s,a,u;if(Th++,(r=je())!==qe&&(r={token:"args",value:[]}),(e=r)===qe)if(e=_h,40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if(t.substr(_h,8)===pt?(r=pt,_h+=8):(r=qe,0===Th&&l(dt)),r===qe&&(t.substr(_h,8)===gt?(r=gt,_h+=8):(r=qe,0===Th&&l(vt))),r===qe&&(r=null),r!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe)if((n=he())!==qe){for(o=[],i=Oe();i!==qe;)o.push(i),i=Oe();if(o!==qe){if(i=[],o=_h,44===t.charCodeAt(_h)?(s=So,_h++):(s=qe,0===Th&&l(Fo)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=he())!==qe?o=s=[s,a,u]:(_h=o,o=qe):(_h=o,o=qe)}else _h=o,o=qe;for(;o!==qe;)if(i.push(o),o=_h,44===t.charCodeAt(_h)?(s=So,_h++):(s=qe,0===Th&&l(Fo)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=he())!==qe?o=s=[s,a,u]:(_h=o,o=qe):(_h=o,o=qe)}else _h=o,o=qe;if(i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(e=r,r=n,n=[],o=0;o<i.length;o++)n.push(i[o][2]);(i={token:"args"}).value=[r].concat(n),null!=e&&"DISTINCT"===e.toUpperCase()?i.distinct=!0:i.distinct=!1,e=i}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Co),e}function U(){var e,r,n,i,o,s,a;if(Th++,(r=je())!==qe&&(r={token:"args",value:[]}),(e=r)===qe)if(e=_h,40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=_e())===qe&&(r=he()),r!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe){if(n=[],i=_h,44===t.charCodeAt(_h)?(o=So,_h++):(o=qe,0===Th&&l(Fo)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((a=_e())===qe&&(a=he()),a!==qe?i=o=[o,s,a]:(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe;for(;i!==qe;)if(n.push(i),i=_h,44===t.charCodeAt(_h)?(o=So,_h++):(o=qe,0===Th&&l(Fo)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((a=_e())===qe&&(a=he()),a!==qe?i=o=[o,s,a]:(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe;if(n!==qe)if(41===t.charCodeAt(_h)?(i=At,_h++):(i=qe,0===Th&&l(Et)),i!==qe){for(e=r,r=[],i=0;i<n.length;i++)r.push(n[i][2]);(n={token:"args"}).value=[e].concat(r),e=n}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(_o),e}function G(){var e,r,n,i,o,s,a;if(Th++,e=_h,(r=z())!==qe){for(n=_h,i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(46===t.charCodeAt(_h)?(o=Mi,_h++):(o=qe,0===Th&&l(Ii)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((a=G())===qe&&(a=null),a!==qe?n=i=[i,o,s,a]:(_h=n,n=qe)):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe;n===qe&&(n=null),n!==qe?(e=r.triplesContext,null!=n&&"object"==typeof n&&null!=n.length&&null!=n[3]&&null!=n[3].triplesContext&&(e=e.concat(n[3].triplesContext)),e=r={token:"triplestemplate",triplesContext:e}):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Eo),e}function z(){var e,t,r,n;for(Th++,e=_h,t=[],r=Oe();r!==qe;)t.push(r),r=Oe();if(t!==qe)if((r=ue())!==qe){for(n=[],t=Oe();t!==qe;)n.push(t),t=Oe();if(n!==qe)if((t=q())!==qe){if(e=t.triplesContext,t.pairs)for(n=0;n<t.pairs.length;n++){var i=t.pairs[n],o=null;null!=i[1].length&&(i[1]=i[1][0]),r.token&&"triplesnodecollection"===r.token?(o={subject:r.chainSubject[0],predicate:i[0],object:i[1]},e.push(o),e=e.concat(r.triplesContext)):(o={subject:r,predicate:i[0],object:i[1]},e.push(o))}(t={token:"triplessamesubject"}).triplesContext=e,t.chainSubject=r,e=t}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){for(e=_h,t=[],r=Oe();r!==qe;)t.push(r),r=Oe();if(t!==qe)if((r=se())!==qe){for(n=[],t=Oe();t!==qe;)n.push(t),t=Oe();if(n!==qe)if(Th++,(t=q())===qe&&(t=null),Th--,t===qe&&0===Th&&l(Mo),t!==qe){if(n=t,e=r.triplesContext,t=r.chainSubject,n.pairs)for(i=0;i<n.pairs.length;i++)if(null!=(o=n.pairs[i])[1].length&&(o[1]=o[1][0]),"triplesnodecollection"===r.token)for(var s=0;s<t.length;s++){var a=t[s];if(null!=a.triplesContext){var u={subject:a.chainSubject,predicate:o[0],object:o[1]};e.concat(a.triplesContext)}else u={subject:t[s],predicate:o[0],object:o[1]},e.push(u)}else u={subject:t,predicate:o[0],object:o[1]},e.push(u);(r={token:"triplessamesubject"}).triplesContext=e,r.chainSubject=t,e=r}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}return Th--,e===qe&&0===Th&&l(Lo),e}function q(){var e,r,n,i,o,s,a,u,c,f,h,p;if(Th++,e=_h,(r=J())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if((i=H())!==qe){for(n=[],o=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(59===t.charCodeAt(_h)?(a=fn,_h++):(a=qe,0===Th&&l(hn)),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();if(u!==qe){if(c=_h,(f=J())!==qe){for(h=[],p=Oe();p!==qe;)h.push(p),p=Oe();h!==qe?(p=H())!==qe?c=f=[f,h,p]:(_h=c,c=qe):(_h=c,c=qe)}else _h=c,c=qe;c===qe&&(c=null),c!==qe?o=s=[s,a,u,c]:(_h=o,o=qe)}else _h=o,o=qe}else _h=o,o=qe;else _h=o,o=qe;for(;o!==qe;){for(n.push(o),o=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(59===t.charCodeAt(_h)?(a=fn,_h++):(a=qe,0===Th&&l(hn)),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();if(u!==qe){if(c=_h,(f=J())!==qe){for(h=[],p=Oe();p!==qe;)h.push(p),p=Oe();h!==qe?(p=H())!==qe?c=f=[f,h,p]:(_h=c,c=qe):(_h=c,c=qe)}else _h=c,c=qe;c===qe&&(c=null),c!==qe?o=s=[s,a,u,c]:(_h=o,o=qe)}else _h=o,o=qe}else _h=o,o=qe;else _h=o,o=qe}if(n!==qe){for(s=r,a=i,i={token:"propertylist"},e=[],r=[],o=0;o<a.length;o++)null!=a[o].triplesContext?(e=e.concat(a[o].triplesContext),"triplesnodecollection"===a[o].token&&null!=a[o].chainSubject.length?r.push([s,a[o].chainSubject[0]]):r.push([s,a[o].chainSubject])):r.push([s,a[o]]);for(o=0;o<n.length;o++)for(s=(a=n[o][3])[0],a=a[2]||[],u=0;u<a.length;u++)null!=a[u].triplesContext?(e=e.concat(a[u].triplesContext),r.push([s,a[u].chainSubject])):r.push([s,a[u]]);i.pairs=r,i.triplesContext=e,e=i}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(No),e}function X(){var e,r,n,i,o,s,a;if(Th++,e=_h,(r=W())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){if(i=[],n=_h,44===t.charCodeAt(_h)?(o=So,_h++):(o=qe,0===Th&&l(Fo)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(a=W())!==qe?n=o=[o,s,a]:(_h=n,n=qe):(_h=n,n=qe)}else _h=n,n=qe;for(;n!==qe;)if(i.push(n),n=_h,44===t.charCodeAt(_h)?(o=So,_h++):(o=qe,0===Th&&l(Fo)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(a=W())!==qe?n=o=[o,s,a]:(_h=n,n=qe):(_h=n,n=qe)}else _h=n,n=qe;if(i!==qe){for(e=i,(i=[]).push(r),r=0;r<e.length;r++)for(n=0;n<e[r].length;n++)"object"==typeof e[r][n]&&null!=e[r][n].token&&i.push(e[r][n]);e=i}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Io),e}function H(){var e,r,n,i,o,s,a;if(Th++,e=_h,(r=V())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){if(i=[],n=_h,44===t.charCodeAt(_h)?(o=So,_h++):(o=qe,0===Th&&l(Fo)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(a=V())!==qe?n=o=[o,s,a]:(_h=n,n=qe):(_h=n,n=qe)}else _h=n,n=qe;for(;n!==qe;)if(i.push(n),n=_h,44===t.charCodeAt(_h)?(o=So,_h++):(o=qe,0===Th&&l(Fo)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(a=V())!==qe?n=o=[o,s,a]:(_h=n,n=qe):(_h=n,n=qe)}else _h=n,n=qe;if(i!==qe){for(e=i,(i=[]).push(r),r=0;r<e.length;r++)for(n=0;n<e[r].length;n++)"object"==typeof e[r][n]&&null!=e[r][n].token&&i.push(e[r][n]);e=i}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(jo),e}function W(){var e;return Th++,e=ae(),Th--,e===qe&&0===Th&&l(Oo),e}function V(){var e;return Th++,e=le(),Th--,e===qe&&0===Th&&l(Do),e}function J(){var e;return Th++,(e=ce())===qe&&(97===t.charCodeAt(_h)?(e=Bo,_h++):(e=qe,0===Th&&l(Po)),e!==qe&&(e=Qo())),Th--,e===qe&&0===Th&&l(Ro),e}function K(){var e,r,n,i,o,s,a,u,c,f,h;if(Th++,e=_h,(r=Y())===qe&&(r=$()),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if((i=X())!==qe){for(n=[],o=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(59===t.charCodeAt(_h)?(a=fn,_h++):(a=qe,0===Th&&l(hn)),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();u!==qe?(c=_h,(f=Y())===qe&&(f=$()),f!==qe?(h=H())!==qe?c=f=[f,h]:(_h=c,c=qe):(_h=c,c=qe),c===qe&&(c=null),c!==qe?o=s=[s,a,u,c]:(_h=o,o=qe)):(_h=o,o=qe)}else _h=o,o=qe;else _h=o,o=qe;for(;o!==qe;){for(n.push(o),o=_h,s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(59===t.charCodeAt(_h)?(a=fn,_h++):(a=qe,0===Th&&l(hn)),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();u!==qe?(c=_h,(f=Y())===qe&&(f=$()),f!==qe?(h=H())!==qe?c=f=[f,h]:(_h=c,c=qe):(_h=c,c=qe),c===qe&&(c=null),c!==qe?o=s=[s,a,u,c]:(_h=o,o=qe)):(_h=o,o=qe)}else _h=o,o=qe;else _h=o,o=qe}if(n!==qe){for(s=r,a=i,i={token:"propertylist"},e=[],r=[],o=0;o<a.length;o++)null!=a[o].triplesContext?(e=e.concat(a[o].triplesContext),"triplesnodecollection"===a[o].token&&null!=a[o].chainSubject.length?r.push([s,a[o].chainSubject[0]]):r.push([s,a[o].chainSubject])):r.push([s,a[o]]);for(o=0;o<n.length;o++)for(s=(a=n[o][3])[0],a=a[1]||[],u=0;u<a.length;u++)null!=a[u].triplesContext?(e=e.concat(a[u].triplesContext),r.push([s,a[u].chainSubject])):r.push([s,a[u]]);i.pairs=r,i.triplesContext=e,e=i}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Go),e}function Y(){var e;return Th++,e=Z(),Th--,e===qe&&0===Th&&l(qo),e}function $(){var e;return Th++,e=fe(),Th--,e===qe&&0===Th&&l(Xo),e}function Z(){var e,r,n,i,o,s;if(Th++,Th++,r=_h,(n=ee())!==qe){for(e=[],i=_h,124===t.charCodeAt(_h)?(o=Vo,_h++):(o=qe,0===Th&&l(Jo)),o!==qe?(s=ee())!==qe?i=o=[o,s]:(_h=i,i=qe):(_h=i,i=qe);i!==qe;)e.push(i),i=_h,124===t.charCodeAt(_h)?(o=Vo,_h++):(o=qe,0===Th&&l(Jo)),o!==qe?(s=ee())!==qe?i=o=[o,s]:(_h=i,i=qe):(_h=i,i=qe);if(e!==qe){if(null!=e&&0!==e.length){for(r=[],n=0;n<e.length;n++)r.push(e[1]);(e={token:"path",kind:"alternative"}).value=r,n=e}r=n}else _h=r,r=qe}else _h=r,r=qe;return Th--,r===qe&&0===Th&&l(Wo),Th--,(e=r)===qe&&0===Th&&l(Ho),e}function ee(){var e,r,n,i,o,s;if(Th++,e=_h,(r=re())!==qe){for(n=[],i=_h,47===t.charCodeAt(_h)?(o=Yo,_h++):(o=qe,0===Th&&l($o)),o!==qe?(s=re())!==qe?i=o=[o,s]:(_h=i,i=qe):(_h=i,i=qe);i!==qe;)n.push(i),i=_h,47===t.charCodeAt(_h)?(o=Yo,_h++):(o=qe,0===Th&&l($o)),o!==qe?(s=re())!==qe?i=o=[o,s]:(_h=i,i=qe):(_h=i,i=qe);if(n!==qe){if(null!=n&&0!==n.length){for(e=[r],r=0;r<n.length;r++)e.push(n[r][1]);(n={token:"path",kind:"sequence"}).value=e,r=n}e=r}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Ko),e}function te(){var e,r,n,i;if(Th++,e=_h,Th++,(r=_e())===qe&&(97===t.charCodeAt(_h)?(n=Bo,_h++):(n=qe,0===Th&&l(Po)),n!==qe&&(n=Qo()),(r=n)===qe)){if(r=_h,33===t.charCodeAt(_h)?(n=us,_h++):(n=qe,0===Th&&l(cs)),n!==qe){var o,s,a,u,c,f,h;if((i=ne())===qe)if(i=_h,40===t.charCodeAt(_h)?(o=wt,_h++):(o=qe,0===Th&&l(kt)),o!==qe){if(s=_h,(a=ne())!==qe){for(u=[],c=_h,124===t.charCodeAt(_h)?(f=Vo,_h++):(f=qe,0===Th&&l(Jo)),f!==qe?(h=ne())!==qe?c=f=[f,h]:(_h=c,c=qe):(_h=c,c=qe);c!==qe;)u.push(c),c=_h,124===t.charCodeAt(_h)?(f=Vo,_h++):(f=qe,0===Th&&l(Jo)),f!==qe?(h=ne())!==qe?c=f=[f,h]:(_h=c,c=qe):(_h=c,c=qe);u!==qe?s=a=[a,u]:(_h=s,s=qe)}else _h=s,s=qe;s===qe&&(s=null),s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?i=o=[o,s,a]:(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe;i!==qe?r=n=[n,i]:(_h=r,r=qe)}else _h=r,r=qe;r===qe&&(r=_h,40===t.charCodeAt(_h)?(n=wt,_h++):(n=qe,0===Th&&l(kt)),n!==qe?(i=Z())!==qe?(41===t.charCodeAt(_h)?(n=At,_h++):(n=qe,0===Th&&l(Et)),n!==qe?r=i:(_h=r,r=qe)):(_h=r,r=qe):(_h=r,r=qe))}if(Th--,r===qe&&0===Th&&l(ls),r!==qe)if(Th++,42===t.charCodeAt(_h)?(n=Lt,_h++):(n=qe,0===Th&&l(Tt)),n===qe&&(63===t.charCodeAt(_h)?(n=is,_h++):(n=qe,0===Th&&l(os)),n===qe&&(43===t.charCodeAt(_h)?(n=ss,_h++):(n=qe,0===Th&&l(as)),n===qe&&(n=_h,123===t.charCodeAt(_h)?(i=Qt,_h++):(i=qe,0===Th&&l(Ut)),i!==qe?(o=_h,(s=ie())!==qe?(a=_h,44===t.charCodeAt(_h)?(u=So,_h++):(u=qe,0===Th&&l(Fo)),u!==qe?(125===t.charCodeAt(_h)?(c=Gt,_h++):(c=qe,0===Th&&l(zt)),c===qe&&(c=_h,(f=ie())!==qe?(125===t.charCodeAt(_h)?(h=Gt,_h++):(h=qe,0===Th&&l(zt)),h!==qe?c=f=[f,h]:(_h=c,c=qe)):(_h=c,c=qe)),c!==qe?a=u=[u,c]:(_h=a,a=qe)):(_h=a,a=qe),a===qe&&(125===t.charCodeAt(_h)?(a=Gt,_h++):(a=qe,0===Th&&l(zt))),a!==qe?o=s=[s,a]:(_h=o,o=qe)):(_h=o,o=qe),o===qe&&(o=_h,44===t.charCodeAt(_h)?(s=So,_h++):(s=qe,0===Th&&l(Fo)),s!==qe?(a=ie())!==qe?(125===t.charCodeAt(_h)?(u=Gt,_h++):(u=qe,0===Th&&l(zt)),u!==qe?o=s=[s,a,u]:(_h=o,o=qe)):(_h=o,o=qe):(_h=o,o=qe)),o!==qe?n=i=[i,o]:(_h=n,n=qe)):(_h=n,n=qe)))),Th--,n===qe&&0===Th&&l(ns),n===qe&&(n=null),n!==qe){if(e=r,r=n,e.token&&"path"!=e.token&&""==r)r=e;else if(e.token&&e.token!=p&&""!=r){var p={token:"path",kind:"element"};p.value=e,p.modifier=r,r=p}else e.modifier=r,r=e;e=r}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Zo),e}function re(){var e,r;return Th++,(e=te())===qe&&(e=_h,94===t.charCodeAt(_h)?(r=ts,_h++):(r=qe,0===Th&&l(rs)),r!==qe?(r=te())!==qe?(e={token:"path",kind:"inversePath"}).value=r:(_h=e,e=qe):(_h=e,e=qe)),Th--,e===qe&&0===Th&&l(es),e}function ne(){var e,r,n;return Th++,(e=_e())===qe&&(97===t.charCodeAt(_h)?(e=Bo,_h++):(e=qe,0===Th&&l(Po)),e===qe&&(e=_h,94===t.charCodeAt(_h)?(r=ts,_h++):(r=qe,0===Th&&l(rs)),r!==qe?((n=_e())===qe&&(97===t.charCodeAt(_h)?(n=Bo,_h++):(n=qe,0===Th&&l(Po))),n!==qe?e=r=[r,n]:(_h=e,e=qe)):(_h=e,e=qe))),Th--,e===qe&&0===Th&&l(fs),e}function ie(){var e;return Th++,e=Le(),Th--,e===qe&&0===Th&&l(hs),e}function oe(){var e,r,n,i;for(Th++,Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(40===t.charCodeAt(_h)?(n=wt,_h++):(n=qe,0===Th&&l(kt)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe){if(r=[],(n=ae())!==qe)for(;n!==qe;)r.push(n),n=ae();else r=qe;if(r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(41===t.charCodeAt(_h)?(i=At,_h++):(i=qe,0===Th&&l(Et)),i!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(ws),e!==qe){r=[],n=[];var o=null;for(i=0;i<e.length;i++)Mh++,o=null,null==e[i].chainSubject&&null==e[i].triplesContext?o=e[i]:(o=e[i].chainSubject,r=r.concat(e[i].triplesContext)),o={subject:{token:"blank",value:"_:"+Mh},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==i&&n.push(o.subject),r.push(o),o=i===e.length-1?{subject:{token:"blank",value:"_:"+Mh},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+Mh},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(Mh+1)}},r.push(o);e={token:"triplesnodecollection",triplesContext:r,chainSubject:n}}if(e===qe){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(91===t.charCodeAt(_h)?(n=vs,_h++):(n=qe,0===Th&&l(ys)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=K())!==qe)if(93===t.charCodeAt(_h)?(n=ms,_h++):(n=qe,0===Th&&l(bs)),n!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){for(e=r,r={token:"blank",value:"_:"+ ++Mh},n=[],i=0;i<e.pairs.length;i++){o=e.pairs[i];var s={};s.subject=r,s.predicate=o[0],null!=o[1].length&&(o[1]=o[1][0]),s.object=o[1],n.push(s)}e=r={token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(n),chainSubject:r}}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;Th--,e===qe&&0===Th&&l(gs)}return Th--,e===qe&&0===Th&&l(ps),e}function se(){var e,r,n,i;for(Th++,Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(40===t.charCodeAt(_h)?(n=wt,_h++):(n=qe,0===Th&&l(kt)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe){if(r=[],(n=le())!==qe)for(;n!==qe;)r.push(n),n=le();else r=qe;if(r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(41===t.charCodeAt(_h)?(i=At,_h++):(i=qe,0===Th&&l(Et)),i!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=r:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(ks),e!==qe){r=[],n=[];var o=null;for(i=0;i<e.length;i++)Mh++,o=null,null==e[i].chainSubject&&null==e[i].triplesContext?o=e[i]:(o=e[i].chainSubject,r=r.concat(o.triplesContext)),o={subject:{token:"blank",value:"_:"+Mh},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==i&&n.push(o.subject),r.push(o),o=i===e.length-1?{subject:{token:"blank",value:"_:"+Mh},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+Mh},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(Mh+1)}},r.push(o);e={token:"triplesnodecollection",triplesContext:r,chainSubject:n}}if(e===qe){for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(91===t.charCodeAt(_h)?(n=vs,_h++):(n=qe,0===Th&&l(ys)),n!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=q())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(93===t.charCodeAt(_h)?(i=ms,_h++):(i=qe,0===Th&&l(bs)),i!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){for(e=r,r={token:"blank",value:"_:"+ ++Mh},n=[],i=0;i<e.pairs.length;i++){o=e.pairs[i];var s={};s.subject=r,s.predicate=o[0],null!=o[1].length&&(o[1]=o[1][0]),s.object=o[1],n.push(s)}e=r={token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(n),chainSubject:r}}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe;Th--,e===qe&&0===Th&&l(xs)}return Th--,e===qe&&0===Th&&l(ds),e}function ae(){var e,t,r,n,i;for(Th++,e=_h,t=[],r=Oe();r!==qe;)t.push(r),r=Oe();if(t!==qe)if((r=ue())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=t=[t,r,n]:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){for(e=_h,t=[],r=Oe();r!==qe;)t.push(r),r=Oe();if(t!==qe)if((r=oe())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=t=[t,r,n]:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}return e!==qe&&(e=e[1]),Th--,e===qe&&0===Th&&l(Cs),e}function le(){var e,t,r,n,i;for(Th++,e=_h,t=[],r=Oe();r!==qe;)t.push(r),r=Oe();if(t!==qe)if((r=ue())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=t=[t,r,n]:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){for(e=_h,t=[],r=Oe();r!==qe;)t.push(r),r=Oe();if(t!==qe)if((r=se())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?e=t=[t,r,n]:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}return e!==qe&&(e=e[1]),Th--,e===qe&&0===Th&&l(Ss),e}function ue(){var e;if(Th++,(e=fe())===qe){if(Th++,(e=_e())===qe&&((e=we())===qe&&((e=ke())===qe&&(e=Se())===qe))){var r;if(Th++,Th++,e=_h,t.substr(_h,2)===oc?(r=oc,_h+=2):(r=qe,0===Th&&l(sc)),r!==qe?(r=Qe())!==qe?e=r:(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(ic),e!==qe&&(e={token:"blank",value:e}),e===qe){var n,i;if(Th++,e=_h,91===t.charCodeAt(_h)?(r=vs,_h++):(r=qe,0===Th&&l(ys)),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(93===t.charCodeAt(_h)?(i=ms,_h++):(i=qe,0===Th&&l(bs)),i!==qe?e=r=[r,n,i]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;Th--,e===qe&&0===Th&&l(Cf),e!==qe&&(e={token:"blank",value:"_:"+ ++Mh})}Th--,e===qe&&0===Th&&l(Ku),e===qe&&(e=je())}Th--,e===qe&&0===Th&&l(Es)}return Th--,e===qe&&0===Th&&l(Fs),e}function ce(){var e;return Th++,(e=fe())===qe&&(e=_e()),Th--,e===qe&&0===Th&&l(_s),e}function fe(){var e,r,n,i;for(Th++,e=_h,r=[],n=Oe();n!==qe;)r.push(n),n=Oe();if(r!==qe)if(Th++,n=_h,63===t.charCodeAt(_h)?(r=is,_h++):(r=qe,0===Th&&l(os)),r!==qe?(r=Be())!==qe?n=r:(_h=n,n=qe):(_h=n,n=qe),Th--,n===qe&&0===Th&&l(ac),n===qe&&(Th++,n=_h,36===t.charCodeAt(_h)?(r=uc,_h++):(r=qe,0===Th&&l(cc)),r!==qe?(r=Be())!==qe?n=r:(_h=n,n=qe):(_h=n,n=qe),Th--,n===qe&&0===Th&&l(lc)),n!==qe){for(r=[],i=Oe();i!==qe;)r.push(i),i=Oe();r!==qe?(e={token:"var"}).value=n:(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(As),e}function he(){var e,r,n,i,o,s,a,u;if(Th++,Th++,r=_h,(n=pe())!==qe){for(e=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Ns?(s=Ns,_h+=2):(s=qe,0===Th&&l(Ms)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=pe())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;for(;i!==qe;){for(e.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Ns?(s=Ns,_h+=2):(s=qe,0===Th&&l(Ms)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=pe())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}if(e!==qe){if(0!==e.length){for(r={token:"expression",expressionType:"conditionalor"},n=[n],i=0;i<e.length;i++)n.push(e[i][3]);r.operands=n,n=r}r=n}else _h=r,r=qe}else _h=r,r=qe;return Th--,r===qe&&0===Th&&l(Ts),Th--,(e=r)===qe&&0===Th&&l(Ls),e}function pe(){var e,r,n,i,o,s,a,u;if(Th++,e=_h,(r=de())!==qe){for(n=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===js?(s=js,_h+=2):(s=qe,0===Th&&l(Os)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=de())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;for(;i!==qe;){for(n.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===js?(s=js,_h+=2):(s=qe,0===Th&&l(Os)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=de())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}if(n!==qe){if(0!==n.length){for(e={token:"expression",expressionType:"conditionaland"},r=[r],i=0;i<n.length;i++)r.push(n[i][3]);e.operands=r,r=e}e=r}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Is),e}function de(){var e,r,n,i,o,s,a,u,c,f,h,p,d;if(Th++,Th++,r=_h,(n=ge())!==qe){for(e=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(61===t.charCodeAt(_h)?(s=Bs,_h++):(s=qe,0===Th&&l(Ps)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Qs?(s=Qs,_h+=2):(s=qe,0===Th&&l(Us)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(60===t.charCodeAt(_h)?(s=Gs,_h++):(s=qe,0===Th&&l(zs)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(62===t.charCodeAt(_h)?(s=qs,_h++):(s=qe,0===Th&&l(Xs)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Hs?(s=Hs,_h+=2):(s=qe,0===Th&&l(Ws)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Vs?(s=Vs,_h+=2):(s=qe,0===Th&&l(Js)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(73===t.charCodeAt(_h)?(s=Ks,_h++):(s=qe,0===Th&&l(Ys)),s===qe&&(105===t.charCodeAt(_h)?(s=$s,_h++):(s=qe,0===Th&&l(Zs))),s!==qe)if(78===t.charCodeAt(_h)?(a=ea,_h++):(a=qe,0===Th&&l(ta)),a===qe&&(110===t.charCodeAt(_h)?(a=ra,_h++):(a=qe,0===Th&&l(na))),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();u!==qe?(c=U())!==qe?i=o=[o,s,a,u,c]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(78===t.charCodeAt(_h)?(s=ea,_h++):(s=qe,0===Th&&l(ta)),s===qe&&(110===t.charCodeAt(_h)?(s=ra,_h++):(s=qe,0===Th&&l(na))),s!==qe)if(79===t.charCodeAt(_h)?(a=ia,_h++):(a=qe,0===Th&&l(oa)),a===qe&&(111===t.charCodeAt(_h)?(a=sa,_h++):(a=qe,0===Th&&l(aa))),a!==qe)if(84===t.charCodeAt(_h)?(u=la,_h++):(u=qe,0===Th&&l(ua)),u===qe&&(116===t.charCodeAt(_h)?(u=ca,_h++):(u=qe,0===Th&&l(fa))),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();if(c!==qe)if(73===t.charCodeAt(_h)?(f=Ks,_h++):(f=qe,0===Th&&l(Ys)),f===qe&&(105===t.charCodeAt(_h)?(f=$s,_h++):(f=qe,0===Th&&l(Zs))),f!==qe)if(78===t.charCodeAt(_h)?(h=ea,_h++):(h=qe,0===Th&&l(ta)),h===qe&&(110===t.charCodeAt(_h)?(h=ra,_h++):(h=qe,0===Th&&l(na))),h!==qe){for(p=[],d=Oe();d!==qe;)p.push(d),d=Oe();p!==qe?(d=U())!==qe?i=o=[o,s,a,u,c,f,h,p,d]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe}}}}}}}for(;i!==qe;){for(e.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(61===t.charCodeAt(_h)?(s=Bs,_h++):(s=qe,0===Th&&l(Ps)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Qs?(s=Qs,_h+=2):(s=qe,0===Th&&l(Us)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(60===t.charCodeAt(_h)?(s=Gs,_h++):(s=qe,0===Th&&l(zs)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(62===t.charCodeAt(_h)?(s=qs,_h++):(s=qe,0===Th&&l(Xs)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Hs?(s=Hs,_h+=2):(s=qe,0===Th&&l(Ws)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(t.substr(_h,2)===Vs?(s=Vs,_h+=2):(s=qe,0===Th&&l(Js)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ge())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(73===t.charCodeAt(_h)?(s=Ks,_h++):(s=qe,0===Th&&l(Ys)),s===qe&&(105===t.charCodeAt(_h)?(s=$s,_h++):(s=qe,0===Th&&l(Zs))),s!==qe)if(78===t.charCodeAt(_h)?(a=ea,_h++):(a=qe,0===Th&&l(ta)),a===qe&&(110===t.charCodeAt(_h)?(a=ra,_h++):(a=qe,0===Th&&l(na))),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();u!==qe?(c=U())!==qe?i=o=[o,s,a,u,c]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(78===t.charCodeAt(_h)?(s=ea,_h++):(s=qe,0===Th&&l(ta)),s===qe&&(110===t.charCodeAt(_h)?(s=ra,_h++):(s=qe,0===Th&&l(na))),s!==qe)if(79===t.charCodeAt(_h)?(a=ia,_h++):(a=qe,0===Th&&l(oa)),a===qe&&(111===t.charCodeAt(_h)?(a=sa,_h++):(a=qe,0===Th&&l(aa))),a!==qe)if(84===t.charCodeAt(_h)?(u=la,_h++):(u=qe,0===Th&&l(ua)),u===qe&&(116===t.charCodeAt(_h)?(u=ca,_h++):(u=qe,0===Th&&l(fa))),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();if(c!==qe)if(73===t.charCodeAt(_h)?(f=Ks,_h++):(f=qe,0===Th&&l(Ys)),f===qe&&(105===t.charCodeAt(_h)?(f=$s,_h++):(f=qe,0===Th&&l(Zs))),f!==qe)if(78===t.charCodeAt(_h)?(h=ea,_h++):(h=qe,0===Th&&l(ta)),h===qe&&(110===t.charCodeAt(_h)?(h=ra,_h++):(h=qe,0===Th&&l(na))),h!==qe){for(p=[],d=Oe();d!==qe;)p.push(d),d=Oe();p!==qe?(d=U())!==qe?i=o=[o,s,a,u,c,f,h,p,d]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe;else _h=i,i=qe}}}}}}}}if(e!==qe){if(r=n,0===e.length)n=r;else if("i"===e[0][1]||"I"===e[0][1]||"n"===e[0][1]||"N"===e[0][1]){for(n={},"i"===e[0][1]||"I"===e[0][1]?(i="=",n.expressionType="conditionalor"):(i="!=",n.expressionType="conditionaland"),o=[],s=0;s<e[0].length;s++)if("args"===e[0][s].token){o=e[0][s].value;break}for(n.token="expression",n.operands=[],e=0;e<o.length;e++)(s={token:"expression",expressionType:"relationalexpression"}).operator=i,s.op1=r,s.op2=o[e],n.operands.push(s)}else(n={expressionType:"relationalexpression"}).operator=e[0][1],n.op1=r,n.op2=e[0][3],n.token="expression";r=n}else _h=r,r=qe}else _h=r,r=qe;return Th--,r===qe&&0===Th&&l(Rs),Th--,(e=r)===qe&&0===Th&&l(Ds),e}function ge(){var e,r,n,i,o,s,a,u,c,f;if(Th++,Th++,r=_h,(n=ve())!==qe){for(e=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(43===t.charCodeAt(_h)?(s=ss,_h++):(s=qe,0===Th&&l(as)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ve())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(45===t.charCodeAt(_h)?(s=da,_h++):(s=qe,0===Th&&l(ga)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ve())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe)if(i=_h,(o=Ce())===qe&&(o=Ce()),o!==qe){for(s=_h,a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if(42===t.charCodeAt(_h)?(u=Lt,_h++):(u=qe,0===Th&&l(Tt)),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();c!==qe?(f=ye())!==qe?s=a=[a,u,c,f]:(_h=s,s=qe):(_h=s,s=qe)}else _h=s,s=qe;else _h=s,s=qe;if(s===qe){for(s=_h,a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if(47===t.charCodeAt(_h)?(u=Yo,_h++):(u=qe,0===Th&&l($o)),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();c!==qe?(f=ye())!==qe?s=a=[a,u,c,f]:(_h=s,s=qe):(_h=s,s=qe)}else _h=s,s=qe;else _h=s,s=qe}s===qe&&(s=null),s!==qe?i=o=[o,s]:(_h=i,i=qe)}else _h=i,i=qe}for(;i!==qe;){for(e.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(43===t.charCodeAt(_h)?(s=ss,_h++):(s=qe,0===Th&&l(as)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ve())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(45===t.charCodeAt(_h)?(s=da,_h++):(s=qe,0===Th&&l(ga)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ve())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe)if(i=_h,(o=Ce())===qe&&(o=Ce()),o!==qe){for(s=_h,a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if(42===t.charCodeAt(_h)?(u=Lt,_h++):(u=qe,0===Th&&l(Tt)),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();c!==qe?(f=ye())!==qe?s=a=[a,u,c,f]:(_h=s,s=qe):(_h=s,s=qe)}else _h=s,s=qe;else _h=s,s=qe;if(s===qe){for(s=_h,a=[],u=Oe();u!==qe;)a.push(u),u=Oe();if(a!==qe)if(47===t.charCodeAt(_h)?(u=Yo,_h++):(u=qe,0===Th&&l($o)),u!==qe){for(c=[],f=Oe();f!==qe;)c.push(f),f=Oe();c!==qe?(f=ye())!==qe?s=a=[a,u,c,f]:(_h=s,s=qe):(_h=s,s=qe)}else _h=s,s=qe;else _h=s,s=qe}s===qe&&(s=null),s!==qe?i=o=[o,s]:(_h=i,i=qe)}else _h=i,i=qe}}if(e!==qe){if(0!==e.length){for((r={token:"expression",expressionType:"additiveexpression"}).summand=n,r.summands=[],n=0;n<e.length;n++)i={},4==(o=e[n]).length&&"string"==typeof o[1]?(i.operator=o[1],i.expression=o[3]):(o={},s=i[0],a=i[1][1],u=i[1][3],a=null,0>s.value?(i.operator="-",s.value=-s.value):i.operator="+",o.token="expression",o.expressionType="multiplicativeexpression",o.operator=s,o.factors=[{operator:a,expression:u}],i.expression=o),r.summands.push(i);n=r}r=n}else _h=r,r=qe}else _h=r,r=qe;return Th--,r===qe&&0===Th&&l(pa),Th--,(e=r)===qe&&0===Th&&l(ha),e}function ve(){var e,r,n,i,o,s,a,u;if(Th++,e=_h,(r=ye())!==qe){for(n=[],i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(42===t.charCodeAt(_h)?(s=Lt,_h++):(s=qe,0===Th&&l(Tt)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ye())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(47===t.charCodeAt(_h)?(s=Yo,_h++):(s=qe,0===Th&&l($o)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ye())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}for(;i!==qe;){for(n.push(i),i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(42===t.charCodeAt(_h)?(s=Lt,_h++):(s=qe,0===Th&&l(Tt)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ye())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe;if(i===qe){for(i=_h,o=[],s=Oe();s!==qe;)o.push(s),s=Oe();if(o!==qe)if(47===t.charCodeAt(_h)?(s=Yo,_h++):(s=qe,0===Th&&l($o)),s!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=ye())!==qe?i=o=[o,s,a,u]:(_h=i,i=qe):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}}if(n!==qe){if(0!==n.length){for((e={token:"expression",expressionType:"multiplicativeexpression"}).factor=r,e.factors=[],r=0;r<n.length;r++)i=n[r],(o={}).operator=i[1],o.expression=i[3],e.factors.push(o);r=e}e=r}else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(va),e}function ye(){var e,r,n;if(Th++,e=_h,33===t.charCodeAt(_h)?(r=us,_h++):(r=qe,0===Th&&l(cs)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();n!==qe?(r=me())!==qe?(e={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"}).expression=r:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;if(e===qe){if(e=_h,43===t.charCodeAt(_h)?(r=ss,_h++):(r=qe,0===Th&&l(as)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();n!==qe?(r=me())!==qe?(e={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"}).expression=r:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;if(e===qe){if(e=_h,45===t.charCodeAt(_h)?(r=da,_h++):(r=qe,0===Th&&l(ga)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();n!==qe?(r=me())!==qe?(e={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"}).expression=r:(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;e===qe&&(e=me())}}return Th--,e===qe&&0===Th&&l(ya),e}function me(){var e;if(Th++,(e=be())===qe&&(e=xe())===qe){var r,n,i;if(Th++,r=_h,(e=_e())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?((i=Q())===qe&&(i=null),i!==qe?(r=i,(n={token:"expression",expressionType:"irireforfunction"}).iriref=e,n.args=null!=r?r.value:r,r=n):(_h=r,r=qe)):(_h=r,r=qe)}else _h=r,r=qe;if(Th--,r===qe&&0===Th&&l(Lu),(e=r)===qe&&((e=we())!==qe&&((r={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"}).value=e,e=r),e===qe&&((e=ke())!==qe&&((r={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"}).value=e,e=r),e===qe&&((e=Se())!==qe&&((r={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"}).value=e,e=r),e===qe)))){var o,s,a,u,c,f,h,p,d;if(Th++,n=_h,t.substr(_h,5)===nu?(e=nu,_h+=5):(e=qe,0===Th&&l(iu)),e===qe&&(t.substr(_h,5)===ou?(e=ou,_h+=5):(e=qe,0===Th&&l(su))),e!==qe){for(e=[],r=Oe();r!==qe;)e.push(r),r=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],e=Oe();e!==qe;)r.push(e),e=Oe();if(r!==qe)if(t.substr(_h,8)===pt?(e=pt,_h+=8):(e=qe,0===Th&&l(dt)),e===qe&&(t.substr(_h,8)===gt?(e=gt,_h+=8):(e=qe,0===Th&&l(vt))),e===qe&&(e=null),e!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if(42===t.charCodeAt(_h)?(r=Lt,_h++):(r=qe,0===Th&&l(Tt)),r===qe&&(r=he()),r!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((n={token:"expression",expressionType:"aggregate",aggregateType:"count"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(n===qe){if(n=_h,t.substr(_h,12)===au?(e=au,_h+=12):(e=qe,0===Th&&l(lu)),e===qe&&(t.substr(_h,12)===uu?(e=uu,_h+=12):(e=qe,0===Th&&l(cu))),e!==qe){for(e=[],r=Oe();r!==qe;)e.push(r),r=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],e=Oe();e!==qe;)r.push(e),e=Oe();if(r!==qe)if(t.substr(_h,8)===pt?(e=pt,_h+=8):(e=qe,0===Th&&l(dt)),e===qe&&(t.substr(_h,8)===gt?(e=gt,_h+=8):(e=qe,0===Th&&l(vt))),e===qe&&(e=null),e!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=he())!==qe){if(i=_h,59===t.charCodeAt(_h)?(o=fn,_h++):(o=qe,0===Th&&l(hn)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(t.substr(_h,9)===fu?(a=fu,_h+=9):(a=qe,0===Th&&l(hu)),a!==qe){for(u=[],c=Oe();c!==qe;)u.push(c),c=Oe();if(u!==qe)if(61===t.charCodeAt(_h)?(c=Bs,_h++):(c=qe,0===Th&&l(Ps)),c!==qe){for(f=[],h=Oe();h!==qe;)f.push(h),h=Oe();if(f!==qe)if((h=Fe())!==qe){for(p=[],d=Oe();d!==qe;)p.push(d),d=Oe();p!==qe?i=o=[o,s,a,u,c,f,h,p]:(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;if(i===qe&&(i=null),i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((n={token:"expression",expressionType:"aggregate",aggregateType:"group_concat"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r,n.separator=i):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(n===qe){if(n=_h,t.substr(_h,3)===pu?(e=pu,_h+=3):(e=qe,0===Th&&l(du)),e===qe&&(t.substr(_h,3)===gu?(e=gu,_h+=3):(e=qe,0===Th&&l(vu))),e!==qe){for(e=[],r=Oe();r!==qe;)e.push(r),r=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],e=Oe();e!==qe;)r.push(e),e=Oe();if(r!==qe)if(t.substr(_h,8)===pt?(e=pt,_h+=8):(e=qe,0===Th&&l(dt)),e===qe&&(t.substr(_h,8)===gt?(e=gt,_h+=8):(e=qe,0===Th&&l(vt))),e===qe&&(e=null),e!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=he())!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((n={token:"expression",expressionType:"aggregate",aggregateType:"sum"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(n===qe){if(n=_h,t.substr(_h,3)===yu?(e=yu,_h+=3):(e=qe,0===Th&&l(mu)),e===qe&&(t.substr(_h,3)===bu?(e=bu,_h+=3):(e=qe,0===Th&&l(xu))),e!==qe){for(e=[],r=Oe();r!==qe;)e.push(r),r=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],e=Oe();e!==qe;)r.push(e),e=Oe();if(r!==qe)if(t.substr(_h,8)===pt?(e=pt,_h+=8):(e=qe,0===Th&&l(dt)),e===qe&&(t.substr(_h,8)===gt?(e=gt,_h+=8):(e=qe,0===Th&&l(vt))),e===qe&&(e=null),e!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=he())!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((n={token:"expression",expressionType:"aggregate",aggregateType:"min"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(n===qe){if(n=_h,t.substr(_h,3)===wu?(e=wu,_h+=3):(e=qe,0===Th&&l(ku)),e===qe&&(t.substr(_h,3)===Cu?(e=Cu,_h+=3):(e=qe,0===Th&&l(Su))),e!==qe){for(e=[],r=Oe();r!==qe;)e.push(r),r=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],e=Oe();e!==qe;)r.push(e),e=Oe();if(r!==qe)if(t.substr(_h,8)===pt?(e=pt,_h+=8):(e=qe,0===Th&&l(dt)),e===qe&&(t.substr(_h,8)===gt?(e=gt,_h+=8):(e=qe,0===Th&&l(vt))),e===qe&&(e=null),e!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=he())!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((n={token:"expression",expressionType:"aggregate",aggregateType:"max"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;if(n===qe)if(n=_h,t.substr(_h,3)===Fu?(e=Fu,_h+=3):(e=qe,0===Th&&l(_u)),e===qe&&(t.substr(_h,3)===Au?(e=Au,_h+=3):(e=qe,0===Th&&l(Eu))),e!==qe){for(e=[],r=Oe();r!==qe;)e.push(r),r=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],e=Oe();e!==qe;)r.push(e),e=Oe();if(r!==qe)if(t.substr(_h,8)===pt?(e=pt,_h+=8):(e=qe,0===Th&&l(dt)),e===qe&&(t.substr(_h,8)===gt?(e=gt,_h+=8):(e=qe,0===Th&&l(vt))),e===qe&&(e=null),e!==qe){for(i=[],r=Oe();r!==qe;)i.push(r),r=Oe();if(i!==qe)if((r=he())!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(41===t.charCodeAt(_h)?(o=At,_h++):(o=qe,0===Th&&l(Et)),o!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?((n={token:"expression",expressionType:"aggregate",aggregateType:"avg"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(_h=n,n=qe)}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe;else _h=n,n=qe}else _h=n,n=qe}}}}Th--,n===qe&&0===Th&&l(ru),(e=n)===qe&&((e=fe())!==qe&&((r={token:"expression",expressionType:"atomic",primaryexpression:"var"}).value=e,e=r))}}return Th--,e===qe&&0===Th&&l(ma),e}function be(){var e,r,n,i;if(Th++,e=_h,40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(n=[],r=Oe();r!==qe;)n.push(r),r=Oe();if(n!==qe)if((r=he())!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(41===t.charCodeAt(_h)?(i=At,_h++):(i=qe,0===Th&&l(Et)),i!==qe?e=r:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(ba),e}function xe(){var e,r,n,i,o,s,a,u;if(Th++,e=_h,t.substr(_h,3)===wa?(r=wa,_h+=3):(r=qe,0===Th&&l(ka)),r===qe&&(t.substr(_h,3)===Ca?(r=Ca,_h+=3):(r=qe,0===Th&&l(Sa))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"str"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,4)===Fa?(r=Fa,_h+=4):(r=qe,0===Th&&l(_a)),r===qe&&(t.substr(_h,4)===Aa?(r=Aa,_h+=4):(r=qe,0===Th&&l(Ea))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"lang"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,11)===La?(r=La,_h+=11):(r=qe,0===Th&&l(Ta)),r===qe&&(t.substr(_h,11)===Na?(r=Na,_h+=11):(r=qe,0===Th&&l(Ma))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(44===t.charCodeAt(_h)?(a=So,_h++):(a=qe,0===Th&&l(Fo)),a!==qe){for(u=[],i=Oe();i!==qe;)u.push(i),i=Oe();if(u!==qe)if((i=he())!==qe){for(n=[],a=Oe();a!==qe;)n.push(a),a=Oe();n!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"langmatches"}).args=[r,i]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,8)===Ia?(r=Ia,_h+=8):(r=qe,0===Th&&l(ja)),r===qe&&(t.substr(_h,8)===Oa?(r=Oa,_h+=8):(r=qe,0===Th&&l(Da))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"datatype"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,5)===Ra?(r=Ra,_h+=5):(r=qe,0===Th&&l(Ba)),r===qe&&(t.substr(_h,5)===Pa?(r=Pa,_h+=5):(r=qe,0===Th&&l(Qa))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=fe())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"bound"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,3)===Ua?(r=Ua,_h+=3):(r=qe,0===Th&&l(Ga)),r===qe&&(t.substr(_h,3)===za?(r=za,_h+=3):(r=qe,0===Th&&l(qa))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"iri"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,3)===Xa?(r=Xa,_h+=3):(r=qe,0===Th&&l(Ha)),r===qe&&(t.substr(_h,3)===Wa?(r=Wa,_h+=3):(r=qe,0===Th&&l(Va))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"uri"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,5)===Ja?(r=Ja,_h+=5):(r=qe,0===Th&&l(Ka)),r===qe&&(t.substr(_h,5)===Ya?(r=Ya,_h+=5):(r=qe,0===Th&&l($a))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe){if(i=_h,40===t.charCodeAt(_h)?(o=wt,_h++):(o=qe,0===Th&&l(kt)),o!==qe){for(r=[],s=Oe();s!==qe;)r.push(s),s=Oe();if(r!==qe)if((s=he())!==qe){for(a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(41===t.charCodeAt(_h)?(u=At,_h++):(u=qe,0===Th&&l(Et)),u!==qe?i=o=[o,r,s,a,u]:(_h=i,i=qe)):(_h=i,i=qe)}else _h=i,i=qe;else _h=i,i=qe}else _h=i,i=qe;i===qe&&(i=je()),i!==qe?(r=i,(e={token:"expression",expressionType:"builtincall",builtincall:"bnode"}).args=5===r.length?[r[2]]:null):(_h=e,e=qe)}else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,8)===Za?(r=Za,_h+=8):(r=qe,0===Th&&l(el)),r===qe&&(t.substr(_h,8)===tl?(r=tl,_h+=8):(r=qe,0===Th&&l(rl))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();n!==qe?(i=U())!==qe?((r={token:"expression",expressionType:"builtincall",builtincall:"coalesce"}).args=i,e=r):(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,2)===nl?(r=nl,_h+=2):(r=qe,0===Th&&l(il)),r===qe&&(t.substr(_h,2)===ol?(r=ol,_h+=2):(r=qe,0===Th&&l(sl))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(44===t.charCodeAt(_h)?(a=So,_h++):(a=qe,0===Th&&l(Fo)),a!==qe){for(u=[],i=Oe();i!==qe;)u.push(i),i=Oe();if(u!==qe)if((i=he())!==qe){for(n=[],a=Oe();a!==qe;)n.push(a),a=Oe();if(n!==qe)if(44===t.charCodeAt(_h)?(a=So,_h++):(a=qe,0===Th&&l(Fo)),a!==qe){for(a=[],n=Oe();n!==qe;)a.push(n),n=Oe();if(a!==qe)if((n=he())!==qe){for(a=[],s=Oe();s!==qe;)a.push(s),s=Oe();a!==qe?(41===t.charCodeAt(_h)?(s=At,_h++):(s=qe,0===Th&&l(Et)),s!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"if"}).args=[r,i,n]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,9)===al?(r=al,_h+=9):(r=qe,0===Th&&l(ll)),r===qe&&(t.substr(_h,9)===ul?(r=ul,_h+=9):(r=qe,0===Th&&l(cl)),r===qe&&(t.substr(_h,9)===fl?(r=fl,_h+=9):(r=qe,0===Th&&l(hl)))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"isliteral"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,7)===pl?(r=pl,_h+=7):(r=qe,0===Th&&l(dl)),r===qe&&(t.substr(_h,7)===gl?(r=gl,_h+=7):(r=qe,0===Th&&l(vl)),r===qe&&(t.substr(_h,7)===yl?(r=yl,_h+=7):(r=qe,0===Th&&l(ml)))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"isblank"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,8)===bl?(r=bl,_h+=8):(r=qe,0===Th&&l(xl)),r===qe&&(t.substr(_h,8)===wl?(r=wl,_h+=8):(r=qe,0===Th&&l(kl))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if(44===t.charCodeAt(_h)?(a=So,_h++):(a=qe,0===Th&&l(Fo)),a!==qe){for(u=[],i=Oe();i!==qe;)u.push(i),i=Oe();if(u!==qe)if((i=he())!==qe){for(n=[],a=Oe();a!==qe;)n.push(a),a=Oe();n!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"sameterm"}).args=[r,i]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,5)===Cl?(r=Cl,_h+=5):(r=qe,0===Th&&l(Sl)),r===qe&&(t.substr(_h,5)===Fl?(r=Fl,_h+=5):(r=qe,0===Th&&l(_l)),r===qe&&(t.substr(_h,5)===Al?(r=Al,_h+=5):(r=qe,0===Th&&l(El)),r===qe&&(t.substr(_h,5)===Ll?(r=Ll,_h+=5):(r=qe,0===Th&&l(Tl)),r===qe&&(t.substr(_h,5)===Nl?(r=Nl,_h+=5):(r=qe,0===Th&&l(Ml)),r===qe&&(t.substr(_h,5)===Il?(r=Il,_h+=5):(r=qe,0===Th&&l(jl))))))),r!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(o=[],r=Oe();r!==qe;)o.push(r),r=Oe();if(o!==qe)if((r=he())!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();s!==qe?(41===t.charCodeAt(_h)?(a=At,_h++):(a=qe,0===Th&&l(Et)),a!==qe?(e={token:"expression",expressionType:"builtincall",builtincall:"isuri"}).args=[r]:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(e=_h,t.substr(_h,7)===Ol?(r=Ol,_h+=7):(r=qe,0===Th&&l(Dl)),r===qe&&(t.substr(_h,7)===Rl?(r=Rl,_h+=7):(r=qe,0===Th&&l(Bl))),r!==qe){if(n=[],Pl.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(Ql)),i!==qe)for(;i!==qe;)n.push(i),Pl.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(Ql));else n=qe;if(n!==qe){for(i=[],o=Oe();o!==qe;)i.push(o),o=Oe();if(i!==qe)if(40===t.charCodeAt(_h)?(o=wt,_h++):(o=qe,0===Th&&l(kt)),o!==qe){for(r=[],s=_h,a=[],u=Oe();u!==qe;)a.push(u),u=Oe();for(a!==qe?(u=he())!==qe?(44===t.charCodeAt(_h)?(i=So,_h++):(i=qe,0===Th&&l(Fo)),i!==qe?s=a=[a,u,i]:(_h=s,s=qe)):(_h=s,s=qe):(_h=s,s=qe);s!==qe;){for(r.push(s),s=_h,a=[],u=Oe();u!==qe;)a.push(u),u=Oe();a!==qe?(u=he())!==qe?(44===t.charCodeAt(_h)?(i=So,_h++):(i=qe,0===Th&&l(Fo)),i!==qe?s=a=[a,u,i]:(_h=s,s=qe)):(_h=s,s=qe):(_h=s,s=qe)}if(r!==qe){for(s=[],a=Oe();a!==qe;)s.push(a),a=Oe();if(s!==qe)if((a=he())!==qe){for(u=[],i=Oe();i!==qe;)u.push(i),i=Oe();if(u!==qe)if(41===t.charCodeAt(_h)?(i=At,_h++):(i=qe,0===Th&&l(Et)),i!==qe){for(e=a,(i={token:"expression",expressionType:"custom"}).name=n.join(""),n=[],a=0;a<r.length;a++)n.push(r[a][1]);n.push(e),i.args=n,e=i}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;else _h=e,e=qe}else _h=e,e=qe}else _h=e,e=qe;if(e===qe){if(Th++,r=_h,t.substr(_h,5)===Gl?(e=Gl,_h+=5):(e=qe,0===Th&&l(zl)),e===qe&&(t.substr(_h,5)===ql?(e=ql,_h+=5):(e=qe,0===Th&&l(Xl))),e!==qe){for(e=[],i=Oe();i!==qe;)e.push(i),i=Oe();if(e!==qe)if(40===t.charCodeAt(_h)?(i=wt,_h++):(i=qe,0===Th&&l(kt)),i!==qe){for(i=[],e=Oe();e!==qe;)i.push(e),e=Oe();if(i!==qe)if((e=he())!==qe){for(i=[],n=Oe();n!==qe;)i.push(n),n=Oe();if(i!==qe)if(44===t.charCodeAt(_h)?(n=So,_h++):(n=qe,0===Th&&l(Fo)),n!==qe){for(n=[],i=Oe();i!==qe;)n.push(i),i=Oe();if(n!==qe)if((i=he())!==qe){for(a=[],n=Oe();n!==qe;)a.push(n),n=Oe();if(a!==qe){if(n=_h,44===t.charCodeAt(_h)?(a=So,_h++):(a=qe,0===Th&&l(Fo)),a!==qe){for(s=[],u=Oe();u!==qe;)s.push(u),u=Oe();s!==qe?(u=he())!==qe?n=a=[a,s,u]:(_h=n,n=qe):(_h=n,n=qe)}else _h=n,n=qe;if(n===qe&&(n=null),n!==qe){for(a=[],s=Oe();s!==qe;)a.push(s),s=Oe();a!==qe?(41===t.charCodeAt(_h)?(s=At,_h++):(s=qe,0===Th&&l(Et)),s!==qe?(r=n,(n={token:"expression",expressionType:"regex"}).text=e,n.pattern=i,null!=r&&(n.flags=r[2]),r=n):(_h=r,r=qe)):(_h=r,r=qe)}else _h=r,r=qe}else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe;if(Th--,r===qe&&0===Th&&l(Ul),(e=r)===qe){if(Th++,r=_h,t.substr(_h,6)===Wl?(e=Wl,_h+=6):(e=qe,0===Th&&l(Vl)),e===qe&&(t.substr(_h,6)===Jl?(e=Jl,_h+=6):(e=qe,0===Th&&l(Kl))),e!==qe){for(i=[],e=Oe();e!==qe;)i.push(e),e=Oe();i!==qe?(e=I())!==qe?(r={token:"expression",expressionType:"builtincall",builtincall:"exists"}).args=[e]:(_h=r,r=qe):(_h=r,r=qe)}else _h=r,r=qe;if(Th--,r===qe&&0===Th&&l(Hl),(e=r)===qe){if(Th++,r=_h,t.substr(_h,3)===$l?(e=$l,_h+=3):(e=qe,0===Th&&l(Zl)),e===qe&&(t.substr(_h,3)===eu?(e=eu,_h+=3):(e=qe,0===Th&&l(tu))),e!==qe){for(e=[],i=Oe();i!==qe;)e.push(i),i=Oe();if(e!==qe)if(t.substr(_h,6)===Wl?(i=Wl,_h+=6):(i=qe,0===Th&&l(Vl)),i===qe&&(t.substr(_h,6)===Jl?(i=Jl,_h+=6):(i=qe,0===Th&&l(Kl))),i!==qe){for(i=[],e=Oe();e!==qe;)i.push(e),e=Oe();i!==qe?(e=I())!==qe?(r={token:"expression",expressionType:"builtincall",builtincall:"notexists"}).args=[e]:(_h=r,r=qe):(_h=r,r=qe)}else _h=r,r=qe;else _h=r,r=qe}else _h=r,r=qe;Th--,r===qe&&0===Th&&l(Yl),e=r}}}}}}}}}}}}}}}}}return Th--,e===qe&&0===Th&&l(xa),e}function we(){var e,r,n,i,o;if(Th++,e=_h,(r=Fe())!==qe){var s,a,u,c;if(Th++,n=_h,64===t.charCodeAt(_h)?(i=hc,_h++):(i=qe,0===Th&&l(pc)),i!==qe){if(o=[],dc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(gc)),i!==qe)for(;i!==qe;)o.push(i),dc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(gc));else o=qe;if(o!==qe){if(i=[],s=_h,45===t.charCodeAt(_h)?(a=da,_h++):(a=qe,0===Th&&l(ga)),a!==qe){if(u=[],vc.test(t.charAt(_h))?(c=t.charAt(_h),_h++):(c=qe,0===Th&&l(yc)),c!==qe)for(;c!==qe;)u.push(c),vc.test(t.charAt(_h))?(c=t.charAt(_h),_h++):(c=qe,0===Th&&l(yc));else u=qe;u!==qe?s=a=[a,u]:(_h=s,s=qe)}else _h=s,s=qe;for(;s!==qe;)if(i.push(s),s=_h,45===t.charCodeAt(_h)?(a=da,_h++):(a=qe,0===Th&&l(ga)),a!==qe){if(u=[],vc.test(t.charAt(_h))?(c=t.charAt(_h),_h++):(c=qe,0===Th&&l(yc)),c!==qe)for(;c!==qe;)u.push(c),vc.test(t.charAt(_h))?(c=t.charAt(_h),_h++):(c=qe,0===Th&&l(yc));else u=qe;u!==qe?s=a=[a,u]:(_h=s,s=qe)}else _h=s,s=qe;i!==qe?(n=o,n=i=0===i.length?("@"+n.join("")).toLowerCase():("@"+n.join("")+"-"+i[0][1].join("")).toLowerCase()):(_h=n,n=qe)}else _h=n,n=qe}else _h=n,n=qe;Th--,n===qe&&0===Th&&l(fc),n===qe&&(n=_h,t.substr(_h,2)===Nu?(i=Nu,_h+=2):(i=qe,0===Th&&l(Mu)),i!==qe?(o=_e())!==qe?n=i=[i,o]:(_h=n,n=qe):(_h=n,n=qe)),n===qe&&(n=null),n!==qe?(e=r,"string"==typeof(r=n)&&0<r.length?r={token:"literal",value:e.value,lang:r.slice(1),type:null}:null!=r&&"object"==typeof r?(r.shift(),r={token:"literal",value:e.value,lang:null,type:r[0]}):r={token:"literal",value:e.value,lang:null,type:null},e=r):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Tu),e}function ke(){var e,r;(Th++,Th++,(e=Ne())===qe&&((e=Te())===qe&&(e=Le())),Th--,e===qe&&0===Th&&l(ju),e===qe)&&(Th++,Th++,e=_h,43===t.charCodeAt(_h)?(r=ss,_h++):(r=qe,0===Th&&l(as)),r!==qe?(r=Ne())!==qe?e=r=Fc(r):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(_c),e===qe&&(Th++,e=_h,43===t.charCodeAt(_h)?(r=ss,_h++):(r=qe,0===Th&&l(as)),r!==qe?(r=Te())!==qe?e=r=Fc(r):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(Sc),e===qe&&(Th++,e=_h,43===t.charCodeAt(_h)?(r=ss,_h++):(r=qe,0===Th&&l(as)),r!==qe?(r=Le())!==qe?(r.value="+"+r.value,e=r):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(Cc))),Th--,e===qe&&0===Th&&l(Ou),e===qe&&(e=Ce()));return Th--,e===qe&&0===Th&&l(Iu),e}function Ce(){var e,r;return Th++,Th++,e=_h,45===t.charCodeAt(_h)?(r=da,_h++):(r=qe,0===Th&&l(ga)),r!==qe?(r=Ne())!==qe?e=r=Ec(r):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(Tc),e===qe&&(Th++,e=_h,45===t.charCodeAt(_h)?(r=da,_h++):(r=qe,0===Th&&l(ga)),r!==qe?(r=Te())!==qe?e=r=Ec(r):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(Lc),e===qe&&(Th++,e=_h,45===t.charCodeAt(_h)?(r=da,_h++):(r=qe,0===Th&&l(ga)),r!==qe?(r=Le())!==qe?e=r=Ec(r):(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(Ac))),Th--,e===qe&&0===Th&&l(Du),e}function Se(){var e;return Th++,t.substr(_h,4)===Bu?(e=Bu,_h+=4):(e=qe,0===Th&&l(Pu)),e===qe&&(t.substr(_h,4)===Qu?(e=Qu,_h+=4):(e=qe,0===Th&&l(Uu))),e!==qe&&(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}),e===qe&&(t.substr(_h,5)===Gu?(e=Gu,_h+=5):(e=qe,0===Th&&l(zu)),e===qe&&(t.substr(_h,5)===qu?(e=qu,_h+=5):(e=qe,0===Th&&l(Xu))),e!==qe&&(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1})),Th--,e===qe&&0===Th&&l(Ru),e}function Fe(){var e,r,n;if(Th++,Th++,e=_h,t.substr(_h,3)===Wc?(r=Wc,_h+=3):(r=qe,0===Th&&l(Vc)),r!==qe){for(r=[],Jc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Kc)),n===qe&&(n=Ie());n!==qe;)r.push(n),Jc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Kc)),n===qe&&(n=Ie());r!==qe?(t.substr(_h,3)===Wc?(n=Wc,_h+=3):(n=qe,0===Th&&l(Vc)),n!==qe?e=r=Nh(r):(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(Hc),e!==qe&&(e=Wu(e)),e===qe){if(Th++,e=_h,t.substr(_h,3)===$c?(r=$c,_h+=3):(r=qe,0===Th&&l(Zc)),r!==qe){for(r=[],ef.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(tf)),n===qe&&(n=Ie());n!==qe;)r.push(n),ef.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(tf)),n===qe&&(n=Ie());r!==qe?(t.substr(_h,3)===$c?(n=$c,_h+=3):(n=qe,0===Th&&l(Zc)),n!==qe?e=r=Nh(r):(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(Yc),e!==qe&&(e=Wu(e)),e===qe){if(Th++,e=_h,39===t.charCodeAt(_h)?(r=Rc,_h++):(r=qe,0===Th&&l(Bc)),r!==qe){for(r=[],Pc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Qc)),n===qe&&(n=Ie());n!==qe;)r.push(n),Pc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Qc)),n===qe&&(n=Ie());r!==qe?(39===t.charCodeAt(_h)?(n=Rc,_h++):(n=qe,0===Th&&l(Bc)),n!==qe?e=r=Nh(r):(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;if(Th--,e===qe&&0===Th&&l(Dc),e!==qe&&(e=Wu(e)),e===qe){if(Th++,e=_h,34===t.charCodeAt(_h)?(r=Gc,_h++):(r=qe,0===Th&&l(zc)),r!==qe){for(r=[],qc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Xc)),n===qe&&(n=Ie());n!==qe;)r.push(n),qc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Xc)),n===qe&&(n=Ie());r!==qe?(34===t.charCodeAt(_h)?(n=Gc,_h++):(n=qe,0===Th&&l(zc)),n!==qe?e=r=Nh(r):(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;Th--,e===qe&&0===Th&&l(Uc),e!==qe&&(e=Wu(e))}}}return Th--,e===qe&&0===Th&&l(Hu),e}function _e(){var e,t,r;(Th++,(e=Ae())!==qe&&(e={token:"uri",prefix:null,suffix:null,value:e}),e===qe)&&(Th++,Th++,e=_h,(t=Ee())!==qe?(r=Qe())!==qe?e=t=[t,r]:(_h=e,e=qe):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(nc),e!==qe&&(e={token:"uri",prefix:e[0],suffix:e[1],value:null}),e===qe&&((e=Ee())!==qe&&(e={token:"uri",prefix:e,suffix:"",value:null})),Th--,e===qe&&0===Th&&l(Ju));return Th--,e===qe&&0===Th&&l(Vu),e}function Ae(){var e,r,n;if(Th++,e=_h,60===t.charCodeAt(_h)?(r=Gs,_h++):(r=qe,0===Th&&l(zs)),r!==qe){for(r=[],$u.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Zu));n!==qe;)r.push(n),$u.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Zu));r!==qe?(62===t.charCodeAt(_h)?(n=qs,_h++):(n=qe,0===Th&&l(Xs)),n!==qe?e=r=r.join(""):(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Yu),e}function Ee(){var e,r,n,i,o;if(Th++,e=_h,Th++,r=_h,(n=De())!==qe){for(i=[],(o=Pe())===qe&&(46===t.charCodeAt(_h)?(o=Mi,_h++):(o=qe,0===Th&&l(Ii)));o!==qe;)i.push(o),(o=Pe())===qe&&(46===t.charCodeAt(_h)?(o=Mi,_h++):(o=qe,0===Th&&l(Ii)));if(i!==qe){if("."==i[i.length-1])throw Error("Wrong PN_PREFIX, cannot finish with '.'");r=n+=i.join("")}else _h=r,r=qe}else _h=r,r=qe;return Th--,r===qe&&0===Th&&l(ch),r===qe&&(r=null),r!==qe?(58===t.charCodeAt(_h)?(n=tc,_h++):(n=qe,0===Th&&l(rc)),n!==qe?e=r:(_h=e,e=qe)):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(ec),e}function Le(){var e,r;if(Th++,e=[],bc.test(t.charAt(_h))?(r=t.charAt(_h),_h++):(r=qe,0===Th&&l(xc)),r!==qe)for(;r!==qe;)e.push(r),bc.test(t.charAt(_h))?(r=t.charAt(_h),_h++):(r=qe,0===Th&&l(xc));else e=qe;return e!==qe&&((r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"}).value=Nh(e),e=r),Th--,e===qe&&0===Th&&l(mc),e}function Te(){var e,r,n,i,o;if(Th++,e=_h,r=[],bc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(xc)),n!==qe)for(;n!==qe;)r.push(n),bc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(xc));else r=qe;if(r!==qe)if(46===t.charCodeAt(_h)?(n=Mi,_h++):(n=qe,0===Th&&l(Ii)),n!==qe){for(i=[],bc.test(t.charAt(_h))?(o=t.charAt(_h),_h++):(o=qe,0===Th&&l(xc));o!==qe;)i.push(o),bc.test(t.charAt(_h))?(o=t.charAt(_h),_h++):(o=qe,0===Th&&l(xc));i!==qe?(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"}).value=Nh([r,n,i]):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(e===qe)if(e=_h,46===t.charCodeAt(_h)?(r=Mi,_h++):(r=qe,0===Th&&l(Ii)),r!==qe){if(n=[],bc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(xc)),i!==qe)for(;i!==qe;)n.push(i),bc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(xc));else n=qe;n!==qe?((i={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"}).value=Nh([r,n]),e=i):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(wc),e}function Ne(){var e,r,n,i,o;if(Th++,e=_h,r=[],bc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(xc)),n!==qe)for(;n!==qe;)r.push(n),bc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(xc));else r=qe;if(r!==qe)if(46===t.charCodeAt(_h)?(n=Mi,_h++):(n=qe,0===Th&&l(Ii)),n!==qe){for(i=[],bc.test(t.charAt(_h))?(o=t.charAt(_h),_h++):(o=qe,0===Th&&l(xc));o!==qe;)i.push(o),bc.test(t.charAt(_h))?(o=t.charAt(_h),_h++):(o=qe,0===Th&&l(xc));i!==qe?(o=Me())!==qe?(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=Nh([r,n,i,o]):(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;if(e===qe){if(e=_h,46===t.charCodeAt(_h)?(r=Mi,_h++):(r=qe,0===Th&&l(Ii)),r!==qe){if(n=[],bc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(xc)),i!==qe)for(;i!==qe;)n.push(i),bc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(xc));else n=qe;n!==qe?(i=Me())!==qe?((o={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=Nh([r,n,i]),e=o):(_h=e,e=qe):(_h=e,e=qe)}else _h=e,e=qe;if(e===qe){if(e=_h,r=[],bc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(xc)),n!==qe)for(;n!==qe;)r.push(n),bc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(xc));else r=qe;r!==qe?(n=Me())!==qe?((i={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=Nh([r,n]),e=i):(_h=e,e=qe):(_h=e,e=qe)}}return Th--,e===qe&&0===Th&&l(kc),e}function Me(){var e,r,n,i,o;if(Th++,e=_h,Mc.test(t.charAt(_h))?(r=t.charAt(_h),_h++):(r=qe,0===Th&&l(Ic)),r!==qe)if(jc.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(Oc)),n===qe&&(n=null),n!==qe){if(i=[],bc.test(t.charAt(_h))?(o=t.charAt(_h),_h++):(o=qe,0===Th&&l(xc)),o!==qe)for(;o!==qe;)i.push(o),bc.test(t.charAt(_h))?(o=t.charAt(_h),_h++):(o=qe,0===Th&&l(xc));else i=qe;i!==qe?e=r=Nh([r,n,i]):(_h=e,e=qe)}else _h=e,e=qe;else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(Nc),e}function Ie(){var e,r,n;return Th++,e=_h,92===t.charCodeAt(_h)?(r=nf,_h++):(r=qe,0===Th&&l(of)),r!==qe?(sf.test(t.charAt(_h))?(n=t.charAt(_h),_h++):(n=qe,0===Th&&l(af)),n!==qe?e=r=[r,n]:(_h=e,e=qe)):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(rf),e}function je(){var e,r,n;if(Th++,e=_h,40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r!==qe){for(r=[],n=Oe();n!==qe;)r.push(n),n=Oe();r!==qe?(41===t.charCodeAt(_h)?(n=At,_h++):(n=qe,0===Th&&l(Et)),n!==qe?e=r={token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}:(_h=e,e=qe)):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(lf),e}function Oe(){var e;if(Th++,cf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(ff)),e===qe&&(hf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(pf)),e===qe&&(df.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(gf)),e===qe&&(vf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(yf)),e===qe)))){var r,n,i;if(Th++,e=_h,35===t.charCodeAt(_h)?(r=bf,_h++):(r=qe,0===Th&&l(xf)),r!==qe){for(n=[],wf.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(kf));i!==qe;)n.push(i),wf.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(kf));n!==qe?e=r=[r,n]:(_h=e,e=qe)}else _h=e,e=qe;Th--,e===qe&&0===Th&&l(mf)}return Th--,e===qe&&0===Th&&l(uf),e}function De(){var e;return Th++,Ff.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(_f)),e===qe&&(Af.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Ef)),e===qe&&(Lf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Tf)),e===qe&&(Nf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Mf)),e===qe&&(If.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(jf)),e===qe&&(Of.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Df)),e===qe&&(Rf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Bf)),e===qe&&(Pf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Qf)),e===qe&&(Uf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Gf)),e===qe&&(zf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(qf)),e===qe&&(Xf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Hf)),e===qe&&(Wf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Vf)),e===qe&&(Jf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(Kf)),e===qe&&(Yf.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l($f))))))))))))))),Th--,e===qe&&0===Th&&l(Sf),e}function Re(){var e;return Th++,(e=De())===qe&&(95===t.charCodeAt(_h)?(e=eh,_h++):(e=qe,0===Th&&l(th))),Th--,e===qe&&0===Th&&l(Zf),e}function Be(){var e,r,n,i;if(Th++,e=_h,(r=Re())===qe&&(bc.test(t.charAt(_h))?(r=t.charAt(_h),_h++):(r=qe,0===Th&&l(xc))),r!==qe){for(n=[],(i=Re())===qe&&(bc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(xc)),i===qe&&(nh.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(ih)),i===qe&&(oh.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(sh)),i===qe&&(ah.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(lh))))));i!==qe;)n.push(i),(i=Re())===qe&&(bc.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(xc)),i===qe&&(nh.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(ih)),i===qe&&(oh.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(sh)),i===qe&&(ah.test(t.charAt(_h))?(i=t.charAt(_h),_h++):(i=qe,0===Th&&l(lh))))));n!==qe?e=r+=n.join(""):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(rh),e}function Pe(){var e;return Th++,(e=Re())===qe&&(45===t.charCodeAt(_h)?(e=da,_h++):(e=qe,0===Th&&l(ga)),e===qe&&(bc.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(xc)),e===qe&&(nh.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(ih)),e===qe&&(oh.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(sh)),e===qe&&(ah.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(lh))))))),Th--,e===qe&&0===Th&&l(uh),e}function Qe(){var e,r,n,i;if(Th++,e=_h,(r=Re())===qe&&(bc.test(t.charAt(_h))?(r=t.charAt(_h),_h++):(r=qe,0===Th&&l(xc)),r===qe&&(58===t.charCodeAt(_h)?(r=tc,_h++):(r=qe,0===Th&&l(rc)),r===qe&&(r=Ue()))),r!==qe){for(n=[],(i=Pe())===qe&&(46===t.charCodeAt(_h)?(i=Mi,_h++):(i=qe,0===Th&&l(Ii)),i===qe&&(58===t.charCodeAt(_h)?(i=tc,_h++):(i=qe,0===Th&&l(rc)),i===qe&&(i=Ue())));i!==qe;)n.push(i),(i=Pe())===qe&&(46===t.charCodeAt(_h)?(i=Mi,_h++):(i=qe,0===Th&&l(Ii)),i===qe&&(58===t.charCodeAt(_h)?(i=tc,_h++):(i=qe,0===Th&&l(rc)),i===qe&&(i=Ue())));n!==qe?e=r+=(n||[]).join(""):(_h=e,e=qe)}else _h=e,e=qe;return Th--,e===qe&&0===Th&&l(fh),e}function Ue(){var e,r,n,i;return Th++,Th++,e=_h,37===t.charCodeAt(_h)?(r=dh,_h++):(r=qe,0===Th&&l(gh)),r!==qe?(n=Ge())!==qe?(i=Ge())!==qe?e=r=[r,n,i]:(_h=e,e=qe):(_h=e,e=qe):(_h=e,e=qe),e!==qe&&(e=e.join("")),Th--,e===qe&&0===Th&&l(ph),e===qe&&(Th++,e=_h,92===t.charCodeAt(_h)?(r=nf,_h++):(r=qe,0===Th&&l(of)),r!==qe?(95===t.charCodeAt(_h)?(r=eh,_h++):(r=qe,0===Th&&l(th)),r===qe&&(126===t.charCodeAt(_h)?(r=kh,_h++):(r=qe,0===Th&&l(Ch)),r===qe&&(46===t.charCodeAt(_h)?(r=Mi,_h++):(r=qe,0===Th&&l(Ii)),r===qe&&(45===t.charCodeAt(_h)?(r=da,_h++):(r=qe,0===Th&&l(ga)),r===qe&&(33===t.charCodeAt(_h)?(r=us,_h++):(r=qe,0===Th&&l(cs)),r===qe&&(36===t.charCodeAt(_h)?(r=uc,_h++):(r=qe,0===Th&&l(cc)),r===qe&&(38===t.charCodeAt(_h)?(r=Sh,_h++):(r=qe,0===Th&&l(Fh)),r===qe&&(39===t.charCodeAt(_h)?(r=Rc,_h++):(r=qe,0===Th&&l(Bc)),r===qe&&(40===t.charCodeAt(_h)?(r=wt,_h++):(r=qe,0===Th&&l(kt)),r===qe&&(41===t.charCodeAt(_h)?(r=At,_h++):(r=qe,0===Th&&l(Et)),r===qe&&(42===t.charCodeAt(_h)?(r=Lt,_h++):(r=qe,0===Th&&l(Tt)),r===qe&&(43===t.charCodeAt(_h)?(r=ss,_h++):(r=qe,0===Th&&l(as)),r===qe&&(44===t.charCodeAt(_h)?(r=So,_h++):(r=qe,0===Th&&l(Fo)),r===qe&&(59===t.charCodeAt(_h)?(r=fn,_h++):(r=qe,0===Th&&l(hn)),r===qe&&(58===t.charCodeAt(_h)?(r=tc,_h++):(r=qe,0===Th&&l(rc)),r===qe&&(61===t.charCodeAt(_h)?(r=Bs,_h++):(r=qe,0===Th&&l(Ps)),r===qe&&(47===t.charCodeAt(_h)?(r=Yo,_h++):(r=qe,0===Th&&l($o)),r===qe&&(63===t.charCodeAt(_h)?(r=is,_h++):(r=qe,0===Th&&l(os)),r===qe&&(35===t.charCodeAt(_h)?(r=bf,_h++):(r=qe,0===Th&&l(xf)),r===qe&&(64===t.charCodeAt(_h)?(r=hc,_h++):(r=qe,0===Th&&l(pc)),r===qe&&(37===t.charCodeAt(_h)?(r=dh,_h++):(r=qe,0===Th&&l(gh)))))))))))))))))))))),r!==qe?e="\\"+r:(_h=e,e=qe)):(_h=e,e=qe),Th--,e===qe&&0===Th&&l(wh)),Th--,e===qe&&0===Th&&l(hh),e}function Ge(){var e;return Th++,bc.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(xc)),e===qe&&(yh.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(mh)),e===qe&&(bh.test(t.charAt(_h))?(e=t.charAt(_h),_h++):(e=qe,0===Th&&l(xh)))),Th--,e===qe&&0===Th&&l(vh),e}r=void 0!==r?r:{};var ze,qe={},Xe={DOCUMENT:u},He=u,We=o("[1] QueryUnit"),Ve=o("[2] Query"),Je=o("[3] Prologue"),Ke=o("[4] BaseDecl"),Ye="BASE",$e=n("BASE",!1),Ze="base",et=n("base",!1),tt=o("[5] PrefixDecl"),rt="PREFIX",nt=n("PREFIX",!1),it="prefix",ot=n("prefix",!1),st=o("[6] SelectQuery"),at=o("[7] SubSelect"),lt=o("[8] SelectClause"),ut="SELECT",ct=n("SELECT",!1),ft="select",ht=n("select",!1),pt="DISTINCT",dt=n("DISTINCT",!1),gt="distinct",vt=n("distinct",!1),yt="REDUCED",mt=n("REDUCED",!1),bt="reduced",xt=n("reduced",!1),wt="(",kt=n("(",!1),Ct="AS",St=n("AS",!1),Ft="as",_t=n("as",!1),At=")",Et=n(")",!1),Lt="*",Tt=n("*",!1),Nt=o("[9] ConstructQuery"),Mt="CONSTRUCT",It=n("CONSTRUCT",!1),jt="construct",Ot=n("construct",!1),Dt="WHERE",Rt=n("WHERE",!1),Bt="where",Pt=n("where",!1),Qt="{",Ut=n("{",!1),Gt="}",zt=n("}",!1),qt=o("[10] DescribeQuery"),Xt="DESCRIBE",Ht=n("DESCRIBE",!1),Wt=o("[11] AskQuery"),Vt="ASK",Jt=n("ASK",!1),Kt="ask",Yt=n("ask",!1),$t=o("[12] DatasetClause"),Zt="FROM",er=n("FROM",!1),tr="from",rr=n("from",!1),nr=o("[13] DefaultGraphClause"),ir=o("[14] NamedGraphClause"),or="NAMED",sr=n("NAMED",!1),ar="named",lr=n("named",!1),ur=o("[15] SourceSelector"),cr=o("[16] WhereClause"),fr=o("[17] SolutionModifier"),hr=o("[18] GroupClause"),pr="GROUP",dr=n("GROUP",!1),gr="group",vr=n("group",!1),yr="BY",mr=n("BY",!1),br="by",xr=n("by",!1),wr=o("[19] GroupCondition"),kr=o("[20] HavingClause"),Cr="HAVING",Sr=n("HAVING",!1),Fr=o("[21] HavingCondition"),_r=o("[22] OrderClause"),Ar="ORDER",Er=n("ORDER",!1),Lr="order",Tr=n("order",!1),Nr=o("[23] OrderCondition"),Mr="ASC",Ir=n("ASC",!1),jr="asc",Or=n("asc",!1),Dr="DESC",Rr=n("DESC",!1),Br="desc",Pr=n("desc",!1),Qr=o("[24] LimitOffsetClauses"),Ur=o("[25] LimitClause"),Gr="LIMIT",zr=n("LIMIT",!1),qr="limit",Xr=n("limit",!1),Hr=o("[26] OffsetClause"),Wr="OFFSET",Vr=n("OFFSET",!1),Jr="offset",Kr=n("offset",!1),Yr=o("[27] BindingsClause"),$r="BINDINGS",Zr=n("BINDINGS",!1),en=o("[28] BindingValue"),tn="UNDEF",rn=n("UNDEF",!1),nn=o("[28]\tValuesClause\t  ::=\t( 'VALUES' DataBlock )?"),on="VALUES",sn=n("VALUES",!1),an="values",ln=n("values",!1),un=o("[29] UpdateUnit"),cn=o("[30] Update"),fn=";",hn=n(";",!1),pn=o("[31] Update1"),dn=o("[32] Load"),gn="LOAD",vn=n("LOAD",!1),yn="load",mn=n("load",!1),bn="INTO",xn=n("INTO",!1),wn="into",kn=n("into",!1),Cn=o("[33] Clear"),Sn="CLEAR",Fn=n("CLEAR",!1),_n="clear",An=n("clear",!1),En="SILENT",Ln=n("SILENT",!1),Tn="silent",Nn=n("silent",!1),Mn=o("[34] Drop"),In="DROP",jn=n("DROP",!1),On="drop",Dn=n("drop",!1),Rn=o("[35] Create"),Bn="CREATE",Pn=n("CREATE",!1),Qn="create",Un=n("create",!1),Gn=o("[36] InsertData"),zn="INSERT",qn=n("INSERT",!1),Xn="insert",Hn=n("insert",!1),Wn="DATA",Vn=n("DATA",!1),Jn="data",Kn=n("data",!1),Yn=o("[37] DeleteData"),$n="DELETE",Zn=n("DELETE",!1),ei="delete",ti=n("delete",!1),ri=o("[38] DeleteWhere"),ni=o("[39] Modify"),ii="WITH",oi=n("WITH",!1),si="with",ai=n("with",!1),li=o("[40] DeleteClause"),ui=o("[41] InsertClause"),ci=o("[42] UsingClause"),fi="USING",hi=n("USING",!1),pi="using",di=n("using",!1),gi=o("[43] GraphRef"),vi="GRAPH",yi=n("GRAPH",!1),mi="graph",bi=n("graph",!1),xi=o("[44] GraphRefAll"),wi="DEFAULT",ki=n("DEFAULT",!1),Ci="default",Si=n("default",!1),Fi="ALL",_i=n("ALL",!1),Ai="all",Ei=n("all",!1),Li=o("[45] QuadPattern"),Ti=o("[46] QuadData"),Ni=o("[47] Quads"),Mi=".",Ii=n(".",!1),ji=o("[48] QuadsNotTriples"),Oi=o("[49] TriplesTemplate"),Di=o("[50] GroupGraphPattern"),Ri=o("[51] GroupGraphPatternSub"),Bi=o("[54] TriplesBlock"),Pi=o("[53] GraphPatternNotTriples"),Qi=o("[54] OptionalGraphPattern"),Ui="OPTIONAL",Gi=n("OPTIONAL",!1),zi="optional",qi=n("optional",!1),Xi=o("[55] GraphGraphPattern"),Hi=o("[56] ServiceGraphPattern"),Wi="SERVICE",Vi=n("SERVICE",!1),Ji=o("[57] MinusGraphPattern"),Ki="MINUS",Yi=n("MINUS",!1),$i="minus",Zi=n("minus",!1),eo=o("[58] GroupOrUnionGraphPattern"),to="UNION",ro=n("UNION",!1),no="union",io=n("union",!1),oo=o("[59] Filter"),so="FILTER",ao=n("FILTER",!1),lo="filter",uo=n("filter",!1),co=o("[60] Bind"),fo="BIND",ho=n("BIND",!1),po="bind",go=n("bind",!1),vo=o("[60] Constraint"),yo=o("[61] InlineData"),mo=o("[62] DataBlock"),bo=o("[63] InlineDataOneVar"),xo=o("[64] InlineDataFull"),wo=o("[65] DataBlockValue"),ko=o("[61] FunctionCall"),Co=o("[62] ArgList"),So=",",Fo=n(",",!1),_o=o("[63] ExpressionList"),Ao=o("[64] ConstructTemplate"),Eo=o("[65] ConstructTriples"),Lo=o("[66] TriplesSameSubject"),To=o("[83] PropertyListPathNotEmpty"),No=o("[67] PropertyListNotEmpty"),Mo=o("[68] PropertyList"),Io=o("[86] ObjectListPath"),jo=o("[69] ObjectList"),Oo=o("[87] ObjectPath"),Do=o("[70] Object"),Ro=o("[71] Verb"),Bo="a",Po=n("a",!1),Qo=function(){return{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}},Uo=o("[72] TriplesSameSubjectPath"),Go=o("[73] PropertyListNotEmptyPath"),zo=o("[74] PropertyListPath"),qo=o("[75]"),Xo=o("[76] VerbSimple"),Ho=o("[77] Path"),Wo=o("[78] PathAlternative"),Vo="|",Jo=n("|",!1),Ko=o("[79] PathSequence"),Yo="/",$o=n("/",!1),Zo=o("[88] PathElt"),es=o("[81] PathEltOrInverse"),ts="^",rs=n("^",!1),ns=o("[82] PathMod"),is="?",os=n("?",!1),ss="+",as=n("+",!1),ls=o("[83] PathPrimary"),us="!",cs=n("!",!1),fs=o("[85] PathOneInPropertySet"),hs=o("[86] Integer"),ps=o("[100] TriplesNodePath"),ds=o("[87] TriplesNode"),gs=o("[101] BlankNodePropertyListPath"),vs="[",ys=n("[",!1),ms="]",bs=n("]",!1),xs=o("[88] BlankNodePropertyList"),ws=o("[103] CollectionPath"),ks=o("[89] Collection"),Cs=o("[105] GraphNodePath"),Ss=o("[90] GraphNode"),Fs=o("[91] VarOrTerm"),_s=o("[92] VarOrIRIref"),As=o("[93] Var"),Es=o("[94] GraphTerm"),Ls=o("[95] Expression"),Ts=o("[96] ConditionalOrExpression"),Ns="||",Ms=n("||",!1),Is=o("[97] ConditionalAndExpression"),js="&&",Os=n("&&",!1),Ds=o("[98] ValueLogical"),Rs=o("[99] RelationalExpression"),Bs="=",Ps=n("=",!1),Qs="!=",Us=n("!=",!1),Gs="<",zs=n("<",!1),qs=">",Xs=n(">",!1),Hs="<=",Ws=n("<=",!1),Vs=">=",Js=n(">=",!1),Ks="I",Ys=n("I",!1),$s="i",Zs=n("i",!1),ea="N",ta=n("N",!1),ra="n",na=n("n",!1),ia="O",oa=n("O",!1),sa="o",aa=n("o",!1),la="T",ua=n("T",!1),ca="t",fa=n("t",!1),ha=o("[100] NumericExpression"),pa=o("[101] AdditiveExpression"),da="-",ga=n("-",!1),va=o("[102] MultiplicativeExpression"),ya=o("[103] UnaryExpression"),ma=o("[104] PrimaryExpression"),ba=o("[105] BrackettedExpression"),xa=o("[106] BuiltInCall"),wa="STR",ka=n("STR",!1),Ca="str",Sa=n("str",!1),Fa="LANG",_a=n("LANG",!1),Aa="lang",Ea=n("lang",!1),La="LANGMATCHES",Ta=n("LANGMATCHES",!1),Na="langmatches",Ma=n("langmatches",!1),Ia="DATATYPE",ja=n("DATATYPE",!1),Oa="datatype",Da=n("datatype",!1),Ra="BOUND",Ba=n("BOUND",!1),Pa="bound",Qa=n("bound",!1),Ua="IRI",Ga=n("IRI",!1),za="iri",qa=n("iri",!1),Xa="URI",Ha=n("URI",!1),Wa="uri",Va=n("uri",!1),Ja="BNODE",Ka=n("BNODE",!1),Ya="bnode",$a=n("bnode",!1),Za="COALESCE",el=n("COALESCE",!1),tl="coalesce",rl=n("coalesce",!1),nl="IF",il=n("IF",!1),ol="if",sl=n("if",!1),al="ISLITERAL",ll=n("ISLITERAL",!1),ul="isliteral",cl=n("isliteral",!1),fl="isLITERAL",hl=n("isLITERAL",!1),pl="ISBLANK",dl=n("ISBLANK",!1),gl="isblank",vl=n("isblank",!1),yl="isBLANK",ml=n("isBLANK",!1),bl="SAMETERM",xl=n("SAMETERM",!1),wl="sameterm",kl=n("sameterm",!1),Cl="ISURI",Sl=n("ISURI",!1),Fl="isuri",_l=n("isuri",!1),Al="isURI",El=n("isURI",!1),Ll="ISIRI",Tl=n("ISIRI",!1),Nl="isiri",Ml=n("isiri",!1),Il="isIRI",jl=n("isIRI",!1),Ol="custom:",Dl=n("custom:",!1),Rl="CUSTOM:",Bl=n("CUSTOM:",!1),Pl=/^[a-zA-Z0-9_]/,Ql=i([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),Ul=o("[107] RegexExpression"),Gl="REGEX",zl=n("REGEX",!1),ql="regex",Xl=n("regex",!1),Hl=o("[108] ExistsFunc"),Wl="EXISTS",Vl=n("EXISTS",!1),Jl="exists",Kl=n("exists",!1),Yl=o("[109] NotExistsFunc"),$l="NOT",Zl=n("NOT",!1),eu="not",tu=n("not",!1),ru=o("[110] Aggregate"),nu="COUNT",iu=n("COUNT",!1),ou="count",su=n("count",!1),au="GROUP_CONCAT",lu=n("GROUP_CONCAT",!1),uu="group_concat",cu=n("group_concat",!1),fu="SEPARATOR",hu=n("SEPARATOR",!1),pu="SUM",du=n("SUM",!1),gu="sum",vu=n("sum",!1),yu="MIN",mu=n("MIN",!1),bu="min",xu=n("min",!1),wu="MAX",ku=n("MAX",!1),Cu="max",Su=n("max",!1),Fu="AVG",_u=n("AVG",!1),Au="avg",Eu=n("avg",!1),Lu=o("[117] IRIrefOrFunction"),Tu=o("[112] RDFLiteral"),Nu="^^",Mu=n("^^",!1),Iu=o("[113] NumericLiteral"),ju=o("[114] NumericLiteralUnsigned"),Ou=o("[115] NumericLiteralPositive"),Du=o("[116] NumericLiteralNegative"),Ru=o("[117] BooleanLiteral"),Bu="TRUE",Pu=n("TRUE",!1),Qu="true",Uu=n("true",!1),Gu="FALSE",zu=n("FALSE",!1),qu="false",Xu=n("false",!1),Hu=o("[118] String"),Wu=function(e){return{token:"string",value:e}},Vu=o("[119] IRIref"),Ju=o("[120] PrefixedName"),Ku=o("[121] BlankNode"),Yu=o("[122] IRI_REF"),$u=/^[^<>"{}|\^`\\]/,Zu=i('<>"{}|^`\\'.split(""),!0,!1),ec=o("[123] PNAME_NS"),tc=":",rc=n(":",!1),nc=o("[124] PNAME_LN"),ic=o("[125] BLANK_NODE_LABEL"),oc="_:",sc=n("_:",!1),ac=o("[126] VAR1"),lc=o("[127] VAR2"),uc="$",cc=n("$",!1),fc=o("[128] LANGTAG"),hc="@",pc=n("@",!1),dc=/^[a-zA-Z]/,gc=i([["a","z"],["A","Z"]],!1,!1),vc=/^[a-zA-Z0-9]/,yc=i([["a","z"],["A","Z"],["0","9"]],!1,!1),mc=o("[129] INTEGER"),bc=/^[0-9]/,xc=i([["0","9"]],!1,!1),wc=o("[130] DECIMAL"),kc=o("[131] DOUBLE"),Cc=o("[132] INTEGER_POSITIVE"),Sc=o("[133] DECIMAL_POSITIVE"),Fc=function(e){return e.value="+"+e.value,e},_c=o("[134] DOUBLE_POSITIVE"),Ac=o("[135] INTEGER_NEGATIVE"),Ec=function(e){return e.value="-"+e.value,e},Lc=o("[136] DECIMAL_NEGATIVE"),Tc=o("[137] DOUBLE_NEGATIVE"),Nc=o("[138] EXPONENT"),Mc=/^[eE]/,Ic=i(["e","E"],!1,!1),jc=/^[+\-]/,Oc=i(["+","-"],!1,!1),Dc=o("[139] STRING_LITERAL1"),Rc="'",Bc=n("'",!1),Pc=/^[^'\\\n\r]/,Qc=i(["'","\\","\n","\r"],!0,!1),Uc=o("[140] STRING_LITERAL2"),Gc='"',zc=n('"',!1),qc=/^[^"\\\n\r]/,Xc=i(['"',"\\","\n","\r"],!0,!1),Hc=o("[141] STRING_LITERAL_LONG1"),Wc="'''",Vc=n("'''",!1),Jc=/^[^'\\]/,Kc=i(["'","\\"],!0,!1),Yc=o("[142] STRING_LITERAL_LONG2"),$c='"""',Zc=n('"""',!1),ef=/^[^"\\]/,tf=i(['"',"\\"],!0,!1),rf=o("[143] ECHAR"),nf="\\",of=n("\\",!1),sf=/^[tbnrf"']/,af=i("tbnrf\"'".split(""),!1,!1),lf=o("[144] NIL"),uf=o("[145] WS"),cf=/^[ ]/,ff=i([" "],!1,!1),hf=/^[\t]/,pf=i(["\t"],!1,!1),df=/^[\r]/,gf=i(["\r"],!1,!1),vf=/^[\n]/,yf=i(["\n"],!1,!1),mf=o(" COMMENT"),bf="#",xf=n("#",!1),wf=/^[^\n\r]/,kf=i(["\n","\r"],!0,!1),Cf=o("[146] ANON"),Sf=o("[147] PN_CHARS_BASE"),Ff=/^[A-Z]/,_f=i([["A","Z"]],!1,!1),Af=/^[a-z]/,Ef=i([["a","z"]],!1,!1),Lf=/^[\xC0-\xD6]/,Tf=i([["À","Ö"]],!1,!1),Nf=/^[\xD8-\xF6]/,Mf=i([["Ø","ö"]],!1,!1),If=/^[\xF8-\u02FF]/,jf=i([["ø","˿"]],!1,!1),Of=/^[\u0370-\u037D]/,Df=i([["Ͱ","ͽ"]],!1,!1),Rf=/^[\u037F-\u1FFF]/,Bf=i([["Ϳ","῿"]],!1,!1),Pf=/^[\u200C-\u200D]/,Qf=i([["‌","‍"]],!1,!1),Uf=/^[\u2070-\u218F]/,Gf=i([["⁰","↏"]],!1,!1),zf=/^[\u2C00-\u2FEF]/,qf=i([["Ⰰ","⿯"]],!1,!1),Xf=/^[\u3001-\uD7FF]/,Hf=i([["、","퟿"]],!1,!1),Wf=/^[\uF900-\uFDCF]/,Vf=i([["豈","﷏"]],!1,!1),Jf=/^[\uFDF0-\uFFFD]/,Kf=i([["ﷰ","�"]],!1,!1),Yf=/^[\u1000-\uEFFF]/,$f=i([["က",""]],!1,!1),Zf=o("[148] PN_CHARS_U"),eh="_",th=n("_",!1),rh=o("[149] VARNAME"),nh=/^[\xB7]/,ih=i(["·"],!1,!1),oh=/^[\u0300-\u036F]/,sh=i([["̀","ͯ"]],!1,!1),ah=/^[\u203F-\u2040]/,lh=i([["‿","⁀"]],!1,!1),uh=o("[150] PN_CHARS"),ch=o("[151] PN_PREFIX"),fh=o("[152] PN_LOCAL"),hh=o("[170] PLX"),ph=o("[171] PERCENT"),dh="%",gh=n("%",!1),vh=o("[172] HEX"),yh=/^[A-F]/,mh=i([["A","F"]],!1,!1),bh=/^[a-f]/,xh=i([["a","f"]],!1,!1),wh=o("[173] PN_LOCAL_ESC"),kh="~",Ch=n("~",!1),Sh="&",Fh=n("&",!1),_h=0,Ah=[{line:1,column:1}],Eh=0,Lh=[],Th=0;if("startRule"in r){if(!(r.startRule in Xe))throw Error("Can't start parsing from rule \""+r.startRule+'".');He=Xe[r.startRule]}var Nh=function(e){for(var t="",r=0;r<e.length;r++)t="string"==typeof e[r]?t+e[r]:t+e[r].join("");return t},Mh=0,Ih=function(e){var t="";if(null==e)return null;for(var r=0;r<e.length;r++)t+=e[r];return t.toUpperCase()};if((ze=He())!==qe&&_h===t.length)return ze;throw ze!==qe&&_h<t.length&&l({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(Lh,Eh<t.length?t.charAt(Eh):null,Eh<t.length?a(Eh,Eh+1):a(Eh,Eh))}}}()},{}],47:[function(e,t,r){e("./btree");var n=e("./utils"),i=e("./lexicon").Lexicon;PersistentLexicon=function(e,t){var r=this;n.registerIndexedDB(r),this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,r.dbName=t||"rdfstorejs";var i=r.indexedDB.open(this.dbName+"_lexicon",1);i.onerror=function(t){e(null,Error("Error opening IndexedDB: "+t.target.errorCode))},i.onsuccess=function(t){r.db=t.target.result,e(r)},i.onupgradeneeded=function(e){r.db=e.target.result,r.db.createObjectStore("knownGraphs",{keyPath:"oid"}).createIndex("uriToken","uriToken",{unique:!0}),r.db.createObjectStore("components",{keyPath:"id",autoIncrement:!0}).createIndex("value","value",{unique:!0})}},PersistentLexicon.prototype.registerGraph=function(e,t,r){if(e!=this.defaultGraphOid){var n=this.db.transaction(["knownGraphs"],"readwrite");n.onerror=function(e){r(null,Error(e.target.statusCode))};var i=n.objectStore("knownGraphs");i.get(t).onsuccess=function(n){n.target.result?r(!0):i.add({oid:e,uriToken:t}).onsuccess=function(e){r(!0)}}}else r()},PersistentLexicon.prototype.registeredGraphs=function(e,t){var r=[],n=this.db.transaction(["knownGraphs"],"readwrite").objectStore("knownGraphs").openCursor();n.onsuccess=function(n){(n=n.target.result)?(!0===e?r.push(n.value.uriToken):r.push(n.value.oid),n.continue()):t(r)},n.onerror=function(e){t(null,Error("Error retrieving data from the cursor: "+e.target.errorCode))}},PersistentLexicon.prototype.registerUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var r=this.db.transaction(["components"],"readwrite").objectStore("components"),n=r.index("value").get("_u:"+e);n.onsuccess=function(n){if(n=n.target.result){n.counter++;var i=n.id;(n=r.put(n)).onsuccess=function(e){t(i)},n.onerror=function(e){t(null,Error("Error updating the URI data"+e.target.errorCode))}}else(n=r.add({value:"_u:"+e,counter:0,uri:!0})).onsuccess=function(e){t(e.target.result)},n.onerror=function(e){t(null,Error("Error inserting the URI data"+e.target.errorCode))}},n.onerror=function(e){t(null,Error("Error retrieving the URI data"+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var r=this.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.id):t(-1)},r.onerror=function(e){t(null,Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUriCost=function(e,t){if(e===this.defaultGraphUri)t(0);else{var r=that.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.cost):t(-1)},r.onerror=function(e){t(null,Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.registerBlank=function(e){var t=guid();(t=this.db.transaction(["components"],"readwrite").objectStore("components").add({value:"_b:"+t,counter:0,label:!0})).onsuccess=function(t){e(t.target.result)},t.onerror=function(t){e(null,Error("Error inserting the URI data"+t.target.errorCode))}},PersistentLexicon.prototype.resolveBlankCost=function(e,t){t(0)},PersistentLexicon.prototype.registerLiteral=function(e,t){var r=this.db.transaction(["components"],"readwrite").objectStore("components"),n=r.index("value").get("_l:"+e);n.onsuccess=function(n){if(n=n.target.result){n.counter++;var i=n.id;(n=r.put(n)).onsuccess=function(e){t(i)},n.onerror=function(e){t(null,Error("Error updating the literal data"+e.target.errorCode))}}else(n=r.add({value:"_l:"+e,counter:0,literal:!0})).onsuccess=function(e){t(e.target.result)},n.onerror=function(e){t(null,Error("Error inserting the literal data"+e.target.errorCode))}},n.onerror=function(e){t(null,Error("Error retrieving the literal data"+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteral=function(e,t){var r=that.db.transaction(["components"]).objectStore("components").index("value").get("_l:"+e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.id):t(-1)},r.onerror=function(e){t(null,Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteralCost=function(e,t){var r=that.db.transaction(["components"]).objectStore("components").index("components").get(e);r.onsuccess=function(e){null!=e.target.result?t(e.target.result.cost):t(-1)},r.onerror=function(e){t(null,Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.parseLiteral=function(e){return i.prototype.parseLiteral(e)},PersistentLexicon.prototype.parseUri=function(e){return i.prototype.parseUri(e)},PersistentLexicon.prototype.retrieve=function(e,t){var r,n=this;e===this.defaultGraphOid?t({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):((r=(r=n.db.transaction(["components"])).objectStore("components").get(e)).onsuccess=function(e){null!=e.target.result?null!=e.target.result.label?t({token:"blank",value:"_:"+e.target.result.id}):null!=e.target.result.uri?t(n.parseUri(e.target.result.value.slice(3,e.target.result.value.length))):null!=e.target.result.literal?t(n.parseLiteral(e.target.result.value.slice(3,e.target.result.value.length))):(console.log(e.target.result),t(null,Error("Unknown type of component "+e.target.result))):t(null,null)},r.onerror=function(e){t(null,Error("Error searching in blanks data "+e.target.errorCode))})},PersistentLexicon.prototype.clear=function(e){this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri};var t,r=function(){null!=e&&e()};(t=this.db.transaction(["components"],"readwrite").objectStore("components").clear()).onsuccess=r,t.onerror=r},PersistentLexicon.prototype.unregister=function(e,t,r){var i=this;n.seq((function(r){i._unregisterTerm(e.subject.token,t.subject,r)}),(function(r){i._unregisterTerm(e.predicate.token,t.predicate,r)}),(function(r){i._unregisterTerm(e.object.token,t.object,r)}),(function(r){null!=e.graph?i._unregisterTerm(e.graph.token,t.graph,r):r()}))((function(){r(!0)}))},PersistentLexicon.prototype._unregisterTerm=function(e,t,r){var n=this.db.transaction(["components","knownGraphs"],"readwrite");"uri"===e?t!=this.defaultGraphOid?(e=n.objectStore("components").delete(t)).onsuccess=void(n.objectStore("knownGraphs").delete(t).onsuccess=function(){r()}):r():(e=n.objectStore("components").delete(t)).onsuccess=function(){r()}},t.exports={PersistentLexicon:PersistentLexicon}},{"./btree":40,"./lexicon":44,"./utils":57}],48:[function(e,t,r){var n=e("./utils");PersistentQuadBackend=function(e,t){var r=this;if(0!==arguments){for(var i in n.registerIndexedDB(r),this.indexMap={},this.indices="S P O G SP SO SG PO PG OG SPO SPG SOG POG SPOG".split(" "),this.componentOrders={S:["subject","predicate","object","graph"],P:["predicate","subject","object","graph"],O:["object","subject","predicate","graph"],G:["graph","subject","predicate","object"],SP:["subject","predicate","object","graph"],SO:["subject","object","predicate","graph"],SG:["subject","graph","predicate","object"],PO:["predicate","object","subject","graph"],PG:["predicate","graph","subject","object"],OG:["object","graph","subject","predicate"],SPO:["subject","predicate","object","graph"],SPG:["subject","predicate","graph","object"],SOG:["subject","object","graph","predicate"],POG:["predicate","object","graph","subject"],SPOG:["subject","predicate","object","graph"]},this.componentOrdersMap={},this.componentOrders){var o=this.componentOrders[i].slice(0,i.length).sort().join(".");this.componentOrdersMap[o]=i}r.dbName=e.name||"rdfstorejs",(i=r.indexedDB.open(this.dbName+"_db",1)).onerror=function(e){t(null,Error("Error opening IndexedDB: "+e.target.errorCode))},i.onsuccess=function(e){r.db=e.target.result,t(r)},i.onupgradeneeded=function(e){var t=e.target.result.createObjectStore(r.dbName,{keyPath:"SPOG"});n.each(r.indices,(function(e){"SPOG"!==e&&t.createIndex(e,e,{unique:!1})}))}}},PersistentQuadBackend.prototype.index=function(e,t){var r=this;n.each(this.indices,(function(t){e[t]=r._genMinIndexKey(e,t)}));var i=r.db.transaction([r.dbName],"readwrite");i.oncomplete=function(e){},i.onerror=function(e){t(null,Error(e.target.statusCode))},i.objectStore(r.dbName).add(e).onsuccess=function(e){t(!0)}},PersistentQuadBackend.prototype.range=function(e,t){var r=this.db.transaction([this.dbName]).objectStore(this.dbName),n=this._indexForPattern(e),i=this._genMinIndexKey(e,n),o=this._genMaxIndexKey(e,n),s=(i=this.IDBKeyRange.bound(i,o,!1,!1),[]);("SPOG"===n?r:r.index(n)).openCursor(i).onsuccess=function(e){(e=e.target.result)?(s.push(e.value),e.continue()):t(s)}},PersistentQuadBackend.prototype.search=function(e,t){var r=this.db.transaction([this.dbName]).objectStore(this.dbName),n=this._genMinIndexKey(e,"SPOG");(r=r.get(n)).onerror=function(e){t(null,Error(e.target.statusCode))},r.onsuccess=function(e){t(null!=e.target.result)}},PersistentQuadBackend.prototype.delete=function(e,t){var r=this._genMinIndexKey(e,"SPOG");(r=this.db.transaction([this.dbName],"readwrite").objectStore(this.dbName).delete(r)).onsuccess=function(){t(!0)},r.onerror=function(e){t(null,Error(e.target.statusCode))}},PersistentQuadBackend.prototype._genMinIndexKey=function(e,t){return n.map(this.componentOrders[t],(function(t){return"string"==typeof e[t]||null==e[t]?"0":e[t]})).join(".")},PersistentQuadBackend.prototype._genMaxIndexKey=function(e,t){for(var r=this.componentOrders[t],i=[],o=0;o<r.length;o++){var s=e[r[o]];i[o]="string"==typeof s?"z":s}return n.map(i,(function(e){return""+e})).join(".")},PersistentQuadBackend.prototype._indexForPattern=function(e){e=e.indexKey.sort().join(".");var t=this.componentOrdersMap[e];if(null==t)throw Error("Error, cannot find index for indexKey "+e);return t},PersistentQuadBackend.prototype.clear=function(e){var t;(t=this.db.transaction([this.dbName],"readwrite").objectStore(this.dbName).clear()).onsuccess=function(){e()},t.onerror=function(){e()}},t.exports.PersistentQuadBackend=PersistentQuadBackend},{"./utils":57}],49:[function(e,t,r){var n=e("./quad_index").QuadIndex,i=e("./utils");QuadBackend=function(e,t){this.indexMap={},this.treeOrder=e.treeOrder,this.indices=e.index||QuadBackend.allIndices,this.componentOrders=QuadBackend.componentOrders;var r=this;i.eachSeries(this.indices,(function(e,t){new n({order:r.treeOrder,componentOrder:r.componentOrders[e]},(function(n){r.indexMap[e]=n,t()}))}),(function(){t(r)}))},QuadBackend.allIndices="SPOG GP OGS POG GSP OS".split(" "),QuadBackend.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},QuadBackend.prototype._indexForPattern=function(e){e=e.indexKey;for(var t=0;t<QuadBackend.allIndices.length;t++)for(var r=QuadBackend.allIndices[t],n=QuadBackend.componentOrders[r],o=0;o<n.length&&!1!==i.include(e,n[o]);o++)if(o==e.length-1)return r;return"SPOG"},QuadBackend.prototype.index=function(e,t){var r=this;i.eachSeries(this.indices,(function(t,n){r.indexMap[t].insert(e,(function(){n()}))}),(function(){t(!0)}))},QuadBackend.prototype.range=function(e,t){var r=this._indexForPattern(e);null!=(r=this.indexMap[r])&&r.range(e,(function(e){t(e)}))},QuadBackend.prototype.search=function(e,t){var r=this.indexMap.SPOG;null!=r&&r.search(e,(function(e){t(null!=e)}))},QuadBackend.prototype.delete=function(e,t){var r=this;i.eachSeries(this.indices,(function(t,n){r.indexMap[t].delete(e,(function(){n()}))}),(function(){t(!0)}))},QuadBackend.prototype.clear=function(e){var t=this;i.eachSeries(this.indices,(function(e,r){new n({order:t.treeOrder,componentOrder:t.componentOrders[e]},(function(n){t.indexMap[e]=n,r()}))}),(function(){e(!0)}))},t.exports.QuadBackend=QuadBackend},{"./quad_index":50,"./utils":57}],50:[function(e,t,r){var n=e("./btree").Tree,i=e("./utils"),o=e("./utils");NodeKey=function(e,t){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.order=t},NodeKey.prototype.comparator=function(e){for(var t=0;t<this.order.length;t++){var r=this.order[t];if(null==e[r])break;if(this[r]<e[r])return-1;if(this[r]>e[r])return 1}return 0},Pattern=function(e){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.indexKey=[],this.keyComponents={};var t=[],r=[],n=this;i.forEach(["subject","predicate","object","graph"],(function(e){"string"==typeof n[e]?(r.push(e),n.keyComponents[e]=null):(t.push(e),n.keyComponents[e]=n[e],n.indexKey.push(e))})),this.order=t.concat(r),this.key=new NodeKey(this.keyComponents,this.order)},QuadIndex=function(e,t){0!=arguments&&(this.componentOrder=e.componentOrder,n.call(this,e.order,(function(e){e.comparator=function(t,r){for(var n=0;n<e.componentOrder.length;n++){var i,o=t[i=e.componentOrder[n]];if(o<(i=r[i]))return-1;if(o>i)return 1}return 0},e.rangeComparator=function(t,r){for(var n=0;n<e.componentOrder.length;n++){var i=e.componentOrder[n];if(null==r[i]||null==t[i])break;if(t[i]<r[i])return-1;if(t[i]>r[i])return 1}return 0},t(e)})))},QuadIndex.prototype=i.create(n.prototype,{constructor:n}),QuadIndex.prototype.insert=function(e,t){n.prototype.insert.call(this,e,null,(function(e){t(e)}))},QuadIndex.prototype.search=function(e,t){n.prototype.search.call(this,e,(function(e){t(e)}),!0)},QuadIndex.prototype.range=function(e,t){this._rangeTraverse(this,this.root,e,t)},QuadIndex.prototype._rangeTraverse=function(e,t,r,n){var i=r.key,s=[],a=[t];o.whilst((function(){return 0<a.length}),(function(t){for(var r=a.shift(),n=0;n<r.numberActives&&-1===e.rangeComparator(r.keys[n].key,i);)n++;if(!0===r.isLeaf){for(var l=n;l<r.numberActives&&0===e.rangeComparator(r.keys[l].key,i);)s.push(r.keys[l].key),l++;t()}else e._diskRead(r.children[n],(function(l){a.push(l);var u=n;o.whilst((function(){return u<r.numberActives&&0===e.rangeComparator(r.keys[u].key,i)}),(function(t){s.push(r.keys[u].key),u++,e._diskRead(r.children[u],(function(e){a.push(e),t()}))}),(function(){t()}))}))}),(function(){n(s)}))},t.exports={QuadIndex:QuadIndex,Pattern:Pattern,NodeKey:NodeKey}},{"./btree":40,"./utils":57}],51:[function(e,t,r){function n(e,t,r){this.name="BindExpressionError",this.bind=t,this.error=r,this.message=e}var i=e("./abstract_query_tree").AbstractQueryTree,o=e("./abstract_query_tree").NonSupportedSparqlFeatureError,s=e("./utils"),a=e("./quad_index"),l=e("./query_plan").QueryPlan,u=e("./query_filters").QueryFilters,c=e("./rdf_model"),f=e("./rdf_loader").RDFLoader,h=e("./graph_callbacks").CallbacksBackend,p=e("./utils"),d=e("./utils");n.prototype=Error(),n.constructor=n,QueryEngine=function(e){0!=arguments.length&&(this.backend=e.backend,this.lexicon=e.lexicon,this.eventsOnBatchLoad=e.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new i,this.rdfLoader=new f(e.communication),this.callbacksBackend=new h(this),this.customFns=e.customFns||{})},QueryEngine.prototype.setCustomFunctions=function(e){this.customFns=e},QueryEngine.prototype.registerNsInEnvironment=function(e,t){var r=[];null!=e&&null!=e.prefixes&&(r=e.prefixes);var n,i={};for(n in this.defaultPrefixes)i[n]=this.defaultPrefixes[n];for(n=0;n<r.length;n++){var o=r[n];"prefix"===o.token&&(i[o.prefix]=o.local)}t.namespaces=i,t.base=null!=e&&e.base&&"object"==typeof e.base?e.base.value:null},QueryEngine.prototype.applyModifier=function(e,t){if("DISTINCT"==e){for(var r={},n=[],i=0;i<t.length;i++){var o,s=t[i],a="";for(o in s){var l=s[o];null==l?a=a+o+"null":"literal"==l.token?(null!=l.value&&(a+=l.value),null!=l.lang&&(a+=l.lang),null!=l.type&&(a+=l.type)):a=l.value?a+o+l.value:a+o+l}null==r[a]&&(n.push(s),r[a]=!0)}return n}return t},QueryEngine.prototype.applyLimitOffset=function(e,t,r){return null==t&&null==e?r:(null==e&&(e=0),t=null==t?r.length:e+t,r.slice(e,t))},QueryEngine.prototype.applySingleOrderBy=function(e,t,r,n,i){var o=[],s=this;p.eachSeries(e,(function(e,i){u.collect(e.expression,[t],r,n,s,(function(e){o.push(e[0].value),i()}))}),(function(){i({binding:t,value:o})}))},QueryEngine.prototype.applyOrderBy=function(e,t,r,n,i){var o=this,s=[];null!=e&&0<e.length?p.eachSeries(t,(function(t,i){o.applySingleOrderBy(e,t,r,n,(function(e){s.push(e),i()}))}),(function(){s.sort((function(t,r){return o.compareFilteredBindings(t,r,e,n)}));for(var t=[],r=0;r<s.length;r++)t.push(s[r].binding);i(t)})):i(t)},QueryEngine.prototype.compareFilteredBindings=function(e,t,r,n){for(var i=0;;){if(i==e.value.length)return 0;var o=r[i].direction;if(null!=e.value[i]||null!=t.value[i]){if(null==e.value[i])e={value:!1};else if(null==t.value[i])e={value:!0};else{if("blank"===e.value[i].token&&"blank"===t.value[i].token){i++;continue}if("blank"===e.value[i].token)e={value:!1};else if("blank"===t.value[i].token)e={value:!0};else if("uri"===e.value[i].token&&"uri"===t.value[i].token){if(1==u.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}e=u.runTotalGtFunction(e.value[i],t.value[i],[])}else if("uri"===e.value[i].token)e={value:!1};else if("uri"===t.value[i].token)e={value:!0};else if("literal"===e.value[i].token&&"literal"===t.value[i].token&&null==e.value[i].type&&null==t.value[i].type){if(1==u.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}e=u.runTotalGtFunction(e.value[i],t.value[i],[])}else if("literal"===e.value[i].token&&null==e.value[i].type)e={value:!1};else if("literal"===t.value[i].token&&null==t.value[i].type)e={value:!0};else{if(1==u.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}e=u.runTotalGtFunction(e.value[i],t.value[i],[])}}return 1==e.value?"ASC"===o?1:-1:"ASC"===o?-1:1}i++}},QueryEngine.prototype.removeDefaultGraphBindings=function(e,t){for(var r=[],n={},i=0;i<t.named.length;i++)n[t.named[i].oid]=!0;for(i=0;i<t.implicit.length;i++)null==n[t.implicit[i].oid]&&r.push(t.implicit[i].oid);for(r=[],i=0;i<e.length;i++){var o,s=e[i],a=!1;for(o in s){for(var l=0;l<n.length;l++)if(s[o]===n[l]){a=!0;break}if(a)break}a||r.push(s)}return r},QueryEngine.prototype.aggregateBindings=function(e,t,r,n,i){this.copyDenormalizedBindings(t,n.outCache,(function(t){for(var o={},s=0;s<e.length;s++){var a=u.runAggregator(e[s],t,this,r,n);e[s].alias?o[e[s].alias.value]=a:o[e[s].value.value]=a}i(o)}))},QueryEngine.prototype.projectBindings=function(e,t,r){if("*"===e[0].kind)return t;for(var n=[],i=0;i<t.length;i++){for(var o=t[i],s={},a=!0,l=0;l<e.length;l++)if("variable"==e[l].token&&"aliased"!=e[l].kind)s[e[l].value.value]=o[e[l].value.value];else if("variable"==e[l].token&&"aliased"==e[l].kind){var c=u.runFilter(e[l].expression,o,this,r,{blanks:{},outCache:{}});if(u.isEbvError(c)){a=!1;break}s[e[l].alias.value]=c}!0===a&&n.push(s)}return n},QueryEngine.prototype.resolveNsInEnvironment=function(e,t){return t.namespaces[e]},QueryEngine.prototype.normalizeTerm=function(e,t,r,n){if("uri"===e.token)null==(e=s.lexicalFormBaseUri(e,t))?n(null):r?this.lexicon.registerUri(e,n):this.lexicon.resolveUri(e,n);else if("literal"===e.token)e=s.lexicalFormLiteral(e,t),r?this.lexicon.registerLiteral(e,n):this.lexicon.resolveLiteral(e,n);else if("blank"===e.token){var i=e.value;null!=(e=t.blanks[i])?n(e):r?this.lexicon.registerBlank((function(e){t.blanks[i]=e,n(e)})):this.lexicon.resolveBlank((function(e){t.blanks[i]=e,n(e)}))}else"var"===e.token?n(e.value):n(null)},QueryEngine.prototype.normalizeDatasets=function(e,t,r){var n=this;p.eachSeries(e,(function(e,r){e.value===n.lexicon.defaultGraphUri?(e.oid=n.lexicon.defaultGraphOid,r()):n.normalizeTerm(e,t,!1,(function(t){null!=t&&(e.oid=t),r()}))}),(function(){r(!0)}))},QueryEngine.prototype.normalizeQuad=function(e,t,r,n){var i=null,o=null,a=null,l=null,u=this,c=!1;p.seq((function(n){if(null==e.graph||e.graph.value===u.lexicon.defaultGraphUri)l=0,n();else{var i=s.lexicalFormBaseUri(e.graph,t);u.normalizeTerm(e.graph,t,r,(function(t){null!=t?(l=t,!0===r&&"var"!=e.graph.token?u.lexicon.registerGraph(t,i,(function(){n()})):n()):(c=!0,n())}))}}),(function(n){!1===c?u.normalizeTerm(e.subject,t,r,(function(e){null!=e?i=e:c=!0,n()})):n()}),(function(n){!1===c?u.normalizeTerm(e.predicate,t,r,(function(e){null!=e?o=e:c=!0,n()})):n()}),(function(n){!1===c?u.normalizeTerm(e.object,t,r,(function(e){null!=e?a=e:c=!0,n()})):n()}))((function(){n(!0===c?null:{subject:i,predicate:o,object:a,graph:l})}))},QueryEngine.prototype.denormalizeBindingsList=function(e,t,r){var n=this,i=[];p.eachSeries(e,(function(e,r){n.denormalizeBindings(e,t,(function(e){i.push(e),r()}))}),(function(){r(i)}))},QueryEngine.prototype.copyDenormalizedBindings=function(e,t,r){var n=this,i=[];p.eachSeries(e,(function(e,r){var o={},s=d.keys(e);p.eachSeries(s,(function(r,i){var s=e[r];if(null==s)o[r]=null,i();else if("object"==typeof s)o[r]=s,i();else{var a=t[s];null!=a?(o[r]=a,i()):n.lexicon.retrieve(s,(function(e){t[s]=e,o[r]=e,i()}))}}),(function(){i.push(o),r()}))}),(function(){r(i)}))},QueryEngine.prototype.denormalizeBindings=function(e,t,r){var n=d.keys(e),i=t.outCache,o=this;p.eachSeries(n,(function(r,n){var s=e[r];null==s?(e[r]=null,n()):"object"==typeof s?n():null!=i[s]?(e[r]=i[s],n()):o.lexicon.retrieve(s,(function(i){e[r]=i,"blank"===i.token&&(t.blanks[i.value]=s),n()}))}),(function(){r(e)}))},QueryEngine.prototype.execute=function(e,t,r,n){if(e=s.normalizeUnicodeLiterals(e),null==(e=this.abstractQueryTree.parseQueryString(e)))t(!1,"Error parsing query string");else if("query"===e.token&&"update"==e.kind){this.callbacksBackend.startGraphModification();var i=this;this.executeUpdate(e,(function(e,r){i.lexicon.updateAfterWrite&&i.lexicon.updateAfterWrite(),e?(i.callbacksBackend.cancelGraphModification(),t(e,r)):i.callbacksBackend.endGraphModification((function(){t(e,r)}))}))}else"query"===e.token&&"query"==e.kind&&this.executeQuery(e,t,r,n)},QueryEngine.prototype.executeQuery=function(e,t,r,n){var i=e.units,o=this,s={blanks:{},outCache:{}};this.registerNsInEnvironment(e.prologue,s);var a=o.abstractQueryTree.parseExecutableUnit(i[0]);"select"===a.kind?this.executeSelect(a,s,r,n,(function(e,r){null==e?"object"==typeof r&&!0===r.denorm?t(null,r.bindings):o.denormalizeBindingsList(r,s,(function(e){t(null,e)})):t(e)})):"ask"===a.kind?(a.projection=[{token:"variable",kind:"*"}],this.executeSelect(a,s,r,n,(function(e,r){null==e?0<r.length?t(null,!0):t(null,!1):t(e)}))):"construct"===a.kind&&(a.projection=[{token:"variable",kind:"*"}],o=this,this.executeSelect(a,s,r,n,(function(e,r){null==e?o.denormalizeBindingsList(r,s,(function(e){if(null!=e){var r=new c.Graph;null==a.template&&(a.template={triplesContext:a.pattern});for(var n=1,i=[],l=0;l<e.length;l++){for(var u=e[l],f=0;f<i.length;f++)delete i[f].valuetmp;for(f=0;f<a.template.triplesContext.length;f++){for(var h=["subject","predicate","object"],p=a.template.triplesContext[f],d=0;d<h.length;d++){var g=h[d];if("blank"===p[g].token&&(!p[g].valuetmp||null==p[g].valuetmp)){var v="_:b"+n;n++,p[g].valuetmp=v,i.push(p[g])}}h=c.buildRDFResource(p.subject,u,o,s),d=c.buildRDFResource(p.predicate,u,o,s),p=c.buildRDFResource(p.object,u,o,s),null!=h&&null!=d&&null!=p&&(d=new c.Triple(h,d,p),r.add(d))}}t(null,r)}else t(Error("Error denormalizing bindings."))})):t(e)})))},QueryEngine.prototype.executeSelect=function(e,t,r,n,i){if("select"===e.kind||"ask"===e.kind||"construct"===e.kind||"modify"===e.kind){var o=e.projection,s=e.dataset,a=e.modifier,l=e.limit,u=e.offset,c=e.order,f=this;null==r&&null==n||(s.implicit=r||[],s.named=n||[]),null!=s.implicit&&0===s.implicit.length&&null!=s.named&&0===s.named.length&&s.implicit.push(this.lexicon.defaultGraphUriTerm),f.normalizeDatasets(s.implicit.concat(s.named),t,(function(){try{f.executeSelectUnit(o,s,e.pattern,t,(function(r){if(null!=r){if(null!=e.group&&""===e.group){for(var n=!1,h=0;h<e.projection.length;h++)if(null!=e.projection[h].expression&&"aggregate"===e.projection[h].expression.expressionType){n=!0;break}!0===n&&(e.group="singleGroup")}e.group&&""!=e.group?f.checkGroupSemantics(e.group,o)?f.groupSolution(r,e.group,s,t,(function(e){var r=[];p.eachSeries(e,(function(e,n){f.aggregateBindings(o,e,s,t,(function(e){r.push(e),n()}))}),(function(){i(null,{bindings:r,denorm:!0})}))})):i(Error("Incompatible Group and Projection variables")):f.applyOrderBy(c,r,s,t,(function(e){e=f.projectBindings(o,e,s),e=f.applyModifier(a,e),e=f.applyLimitOffset(u,l,e),e=f.removeDefaultGraphBindings(e,s),i(null,e)}))}else i(Error("Error executing SELECT query."))}))}catch(r){i(r)}}))}else i(Error("Cannot execute "+e.kind+" query as a select query"))},QueryEngine.prototype.groupSolution=function(e,t,r,n,i){var o=[],s=[],a=!1,l=this;"singleGroup"===t?i([e]):p.eachSeries(e,(function(e,i){var c=!0;p.eachSeries(t,(function(t,i){var s=null;if("var"===t.token)s=t.value,0==a&&o.push(s),i();else if("aliased_expression"===t.token){if(s=t.alias.value,0==a&&o.push(s),"var"===t.expression.primaryexpression)e[t.alias.value]=e[t.expression.value.value];else{var f=l.copyDenormalizedBindings([e],n.outCache);f=u.runFilter(t.expression,f[0],l,r,n);u.isEbvError(f)?c=!1:(null!=f.value&&(f.value=""+f.value),e[t.alias.value]=f)}i()}else l.copyDenormalizedBindings([e],n.outCache,(function(r){r=u.runFilter(t,r[0],l,n),u.isEbvError(r)?c=!1:(e["groupCondition"+env._i]=r,s="groupCondition"+env._i,0==a&&o.push(s)),i()}))}),(function(){0==a&&(a=!0),!0===c&&s.push(e),i()}))}),(function(){for(var e={},t=0;t<s.length;t++){for(var r=s[t],n="",a=0;a<o.length;a++){var l=r[o[a]];n="object"==typeof l?n+l.value:n+l}null==e[n]?e[n]=[r]:e[n].push(r)}var u;t=[];for(u in e)t.push(e[u]);i(t)}))},QueryEngine.prototype.executeSelectUnit=function(e,t,r,n,i){if("BGP"===r.kind)this.executeAndBGP(e,t,r,n,i);else if("UNION"===r.kind)this.executeUNION(e,t,r.value,n,i);else if("JOIN"===r.kind)this.executeJOIN(e,t,r,n,i);else if("LEFT_JOIN"===r.kind)this.executeLEFT_JOIN(e,t,r,n,i);else if("FILTER"===r.kind){var s=this;this.executeSelectUnit(e,t,r.value,n,(function(e){null!=e?u.checkFilters(r,e,!1,t,n,s,i):i([])}))}else{if("EMPTY_PATTERN"!==r.kind)throw new o(r.kind);i([])}},QueryEngine.prototype.executeUNION=function(e,t,r,i,o){var s,a,c=r[0],f=r[1],h=null;if(2!=r.length)throw"SPARQL algebra UNION with more than two components";var d=this;p.seq((function(r){try{d.executeSelectUnit(e,t,c,i,(function(e){s=e,r()}))}catch(l){h=l,r()}}),(function(r){if(null==h)try{d.executeSelectUnit(e,t,f,i,(function(e){a=e,r()}))}catch(l){h=l,r()}else r()}))((function(){if(null!=h)o(h);else{var e=l.unionBindings(s,a);d.runBinds(r.binds,e,t,i,(function(e,s){if(null!=e)throw new n("Error processing bind expressions",r.binds,e);u.checkFilters(r,s,!1,t,i,d,o)}))}}))},QueryEngine.prototype.executeAndBGP=function(e,t,r,i,o){var s=this;l.executeAndBGPsDPSize(r.value,t,this,i,(function(e){null!=e?s.runBinds(r.binds,e,t,i,(function(e,a){if(null!=e)throw new n("Error processing bind expressions",r.binds,e);u.checkFilters(r,a,!1,t,i,s,o)})):o(null)}))},QueryEngine.prototype.executeLEFT_JOIN=function(e,t,r,i,o){var s=r.lvalue,a=r.rvalue;if("EMPTY_PATTERN"===s.kind)this.executeSelectUnit(e,t,a,i,o);else{var c,f,h=null,d=null,g=null,v=this;p.seq((function(r){try{v.executeSelectUnit(e,t,s,i,(function(e){h=e,r()}))}catch(l){g=l,r()}}),(function(r){if(null!=g)r();else try{v.executeSelectUnit(e,t,a,i,(function(e){d=e,r()}))}catch(l){g=l,r()}}))((function(){if(null!=g)o(g);else{var e=l.leftOuterJoinBindings(h,d);v.runBinds(r.binds,e,t,i,(function(s,a){if(null!=s)throw new n("Error processing bind expressions",r.binds,s);u.checkFilters(r,e,!0,t,i,v,(function(e){if(1<h.length&&1<d.length){var t,r=[],n={};for(t in h[0])n[t]=!0;for(t in d[0])1!=n[t]&&r.push(t);for(c=[],f={},n=0;n<e.length;n++)if(!0===e[n].__nullify__){for(var i=0;i<r.length;i++)e[n].bindings[r[i]]=null;i=[];var s=[];for(t in e[n].bindings)null!=e[n].bindings[t]&&(i.push(t+e[n].bindings[t]),i.sort(),s.push(i.join("")));if(null==f[i.join("")]){for(i=0;i<s.length;i++)f[s[i]]=!0;c.push(e[n].bindings)}}else for(t in c.push(e[n]),i=[],e[n])i.push(t+e[n][t]),i.sort(),f[i.join("")]=!0;o(c)}else o(e)}))}))}}))}},QueryEngine.prototype.executeJOIN=function(e,t,r,i,o){var s=r.lvalue,a=r.rvalue,c=null,f=null,h=null,d=this;p.seq((function(r){try{d.executeSelectUnit(e,t,s,i,(function(e){c=e,r()}))}catch(l){h=l,r()}}),(function(r){if(null!=h)r();else try{d.executeSelectUnit(e,t,a,i,(function(e){f=e,r()}))}catch(l){h=l,r()}}))((function(){var e=null;if(null!=h)o(h);else if(0===c.length||0===f.length)o([]);else{e={};var p,g=[];for(p in c[0])e[p]=!1;for(p in f[0])!1===e[p]&&g.push(p);e=0==g.length||d.abstractQueryTree.treeWithUnion(s)||d.abstractQueryTree.treeWithUnion(a)?l.joinBindings(c,f):l.joinBindings2(g,c,f),d.runBinds(r.binds,e,t,i,(function(e,s){if(null!=e)throw new n("Error processing bind expressions",r.binds,e);u.checkFilters(r,s,!1,t,i,d,o)}))}}))},QueryEngine.prototype.rangeQuery=function(e,t,r){var n=this;n.normalizeQuad(e,t,!1,(function(e){null!=e?n.backend.range(new a.Pattern(e),(function(e){null==e||0==e.length?r([]):r(e)})):r(null)}))},QueryEngine.prototype.executeUpdate=function(e,t){var r=e.units,n=this,i={blanks:{},outCache:{}};this.registerNsInEnvironment(e.prologue,i);for(var o=0;o<r.length;o++){var a=n.abstractQueryTree.parseExecutableUnit(r[o]);if("insertdata"===a.kind){var l=null;p.eachSeries(a.quads,(function(e,t){null===l?n._executeQuadInsert(e,i,(function(e){null!=e&&(l=e),t()})):t()}),(function(){null===l?t(null,!0):t(l)}))}else if("deletedata"===a.kind)l=null,p.eachSeries(a.quads,(function(e,t){null===l?n._executeQuadDelete(e,i,(function(e){null!=e&&(l=e),t()})):t()}),(function(){null===l?t(null,!0):t(l)}));else if("modify"===a.kind)this._executeModifyQuery(a,i,t);else if("create"===a.kind)t(!0);else if("load"===a.kind){var u={uri:s.lexicalFormBaseUri(a.sourceGraph,i)};null!=a.destinyGraph&&(u={uri:s.lexicalFormBaseUri(a.destinyGraph,i)}),n=this,this.rdfLoader.load(a.sourceGraph.value,u,(function(e,r){e?t(Error("error batch loading quads")):n.batchLoad(r,(function(e){null!==e?t(null,e):t(Error("Error batch loading quads"))}))}))}else if("drop"===a.kind)this._executeClearGraph(a.destinyGraph,i,t);else{if("clear"!==a.kind)throw Error("not supported execution unit");this._executeClearGraph(a.destinyGraph,i,t)}}},QueryEngine.prototype.batchLoad=function(e,t){var r=0,n={},i=this;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();var o=function(e,t,r,o){var s;if(e[t].uri||"uri"===e[t].token){var a=e[t].uri||e[t].value;i.lexicon.registerUri(a,(function(n){var s=function(){null!=e[t].uri&&(e[t]={token:"uri",value:e[t].uri},delete e[t].uri),r[t]=n,o()};"graph"===t?i.lexicon.registerGraph(n,a,(function(){s()})):s()}))}else e[t].literal||"literal"===e[t].token?i.lexicon.registerLiteral(e[t].literal||e[t].value,(function(n){null!=e[t].literal&&(e[t]=i.lexicon.parseLiteral(e[t].literal),delete e[t].literal),r[t]=n,o()})):null==(s=n[e[t].blank||e[t].value])?i.lexicon.registerBlank((function(i){n[e[t].blank||e[t].value]=i,null==e[t].token&&(e[t].token="blank",e[t].value=e[t].blank,delete e[t].blank),r[t]=i,o()})):(null==e[t].token&&(e[t].token="blank",e[t].value=e[t].blank,delete e[t].blank),r[t]=s,o())};p.eachSeries(e,(function(e,t){var n={};p.eachSeries(["subject","predicate","object","graph"],(function(t,r){o(e,t,n,r)}),(function(){var o=e;e=n;var s=new a.NodeKey(e);i.backend.search(s,(function(n){n?t():i.backend.index(s,(function(n){n&&(i.eventsOnBatchLoad&&i.callbacksBackend.nextGraphModification(h.added,[o,e]),r+=1),t()}))}))}))}),(function(){null!=i.lexicon.updateAfterWrite&&i.lexicon.updateAfterWrite();var e=function(){t(r)};i.eventsOnBatchLoad?i.callbacksBackend.endGraphModification(e()):e()}))},QueryEngine.prototype._executeModifyQuery=function(e,t,r){var n=this,i=!0,o=Error("Error executing modify query"),s=null,a=["subject","predicate","object","graph"];e.insert=null==e.insert?[]:e.insert,e.delete=null==e.delete?[]:e.delete,p.seq((function(r){var a=[],l=[];if(null!=e.with&&a.push(e.with),null!=e.using){l=[];for(var u=0;u<e.using.length;u++){var c=e.using[u];"named"===c.kind?l.push(c.uri):a.push(c.uri)}}e.dataset={},e.projection=[{token:"variable",kind:"*"}],n.executeSelect(e,t,a,l,(function(e,a){if(e)return o=e,i=!1,r();n.denormalizeBindingsList(a,t,(function(e){null!=e?s=e:(o=Error("Error denormalizing bindings list"),i=!1),r()}))}))}),(function(r){var o=e.with;if(i){for(var l=[],u=0;u<e.delete.length;u++)for(var c=e.delete[u],f=0;f<s.length;f++){for(var h={},d=s[f],g=0;g<a.length;g++){var v=a[g];"graph"==v&&null==c[v]?h.graph=o:h[v]="var"===c[v].token?d[c[v].value]:c[v]}l.push(h)}p.eachSeries(l,(function(e,r){n._executeQuadDelete(e,t,(function(){r()}))}),(function(){r()}))}else r()}),(function(r){var o=e.with;if(i){for(var l=[],u=0;u<e.insert.length;u++)for(var c=e.insert[u],f=0;f<s.length;f++){for(var h={},d=s[f],g=0;g<a.length;g++){var v=a[g];"graph"==v&&null==c[v]?h.graph=o:h[v]="var"===c[v].token?d[c[v].value]:c[v]}l.push(h)}p.eachSeries(l,(function(e,r){n._executeQuadInsert(e,t,(function(){r()}))}),(function(){r()}))}else r()}))((function(){r(i?null:o)}))},QueryEngine.prototype._executeQuadInsert=function(e,t,r){var n,i=this,o=!1,s=null;p.seq((function(r){i.normalizeQuad(e,t,!0,(function(e){null!=e?n=e:(o=!0,s="Error normalizing quad."),r()}))}),(function(t){if(!1===o){var r=new a.NodeKey(n);i.backend.search(r,(function(o){!0===o?t():i.backend.index(r,(function(){i.callbacksBackend.nextGraphModification(h.added,[e,n]),t()}))}))}else t()}))((function(){o?r(Error(s)):r(null,!0)}))},QueryEngine.prototype._executeQuadDelete=function(e,t,r){var n,i,o,s=this,l=!1;p.seq((function(r){s.normalizeQuad(e,t,!0,(function(e){null!=e?n=e:(l=!0,i="Error normalizing quad."),r()}))}),(function(e){!1===l?(o=new a.NodeKey(n),s.backend.delete(o,(function(){e()}))):e()}),(function(t){!1===l?s.lexicon.unregister(e,o,(function(){s.callbacksBackend.nextGraphModification(h.deleted,[e,n]),t()})):t()}))((function(){l?r(Error(i)):r(null,!0)}))},QueryEngine.prototype._executeClearGraph=function(e,t,r){var n=this;"default"===e?this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",r):"named"===e?n.lexicon.registeredGraphs(!0,(function(e){if(null!=e){var t=!1;p.eachSeries(e,(function(e,r){t?r():n.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",(function(i,o){i?(t=i,r()):n.lexicon.resolveUri(e,(function(i){-1!=i?n.lexicon.knownGraphs.delete(i,(function(){r()})):(t="Cannot find graph "+e+" to clear it",r())}))}))}),(function(){r(!t)}))}else r(!1,"Error deleting named graphs")})):"all"===e?(n=this,this.execute("CLEAR DEFAULT",(function(e,t){e?r(!1,t):n.execute("CLEAR NAMED",r)}))):"uri"==e.token?null!=(e=s.lexicalFormBaseUri(e,t))?(this.callbacksBackend.ongoingModification=!0,this.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",(function(e){n.callbacksBackend.ongoingModification=!1,r(e)}))):r(!1,"wrong graph URI"):r(!1,"wrong graph URI")},QueryEngine.prototype.checkGroupSemantics=function(e,t){if("singleGroup"===e)return!0;for(var r={},n=0;n<e.length;n++){var i=e[n];"var"===i.token?r[i.value]=!0:"aliased_expression"===i.token&&(r[i.alias.value]=!0)}for(n=0;n<t.length;n++)if("var"===(i=t[n]).kind){if(null==r[i.value.value])return!1}else if("aliased"===i.kind&&i.expression&&"var"===i.expression.primaryexpression&&null==r[i.expression.value.value])return!1;return!0},QueryEngine.prototype.runBinds=function(e,t,r,n,i){var o=this;null!=e&&0<e.length?o.copyDenormalizedBindings(t,n.outCache,(function(s){for(var a=0;a<t.length;a++)for(var l=0;l<e.length;l++){var c=e[l],f=u.runFilter(c.expression,s[a],o,r,n);u.isEbvError(f)?i(f):t[a][c.as.value]=f}i(null,t)})):i(null,t)},QueryEngine.prototype.computeCosts=function(e,t,r){for(var n=0;n<e.length;n++)e[n]._cost=this.quadCost(e[n],t);r(e)},QueryEngine.prototype.quadCost=function(e,t){return 1},QueryEngine.prototype.registerDefaultNamespace=function(e,t){this.defaultPrefixes[e]=t},t.exports={QueryEngine:QueryEngine}},{"./abstract_query_tree":39,"./graph_callbacks":42,"./quad_index":50,"./query_filters":52,"./query_plan":53,"./rdf_loader":54,"./rdf_model":55,"./utils":57}],52:[function(e,t,r){var n=e("./utils"),i=e("./utils");QueryFilters={checkFilters:function(e,t,r,n,o,s,a){var l=[];e.filter&&"function"!=typeof e.filter&&(l=e.filter);var u=[];if(null==l||0===l.length||null!=e.length)return a(t);QueryFilters.preprocessExistentialFilters(l,t,s,n,o,(function(e){i.eachSeries(e,(function(e,i){QueryFilters.run(e.value,t,r,n,o,s,(function(e){for(var r=[],n=0;n<e.length;n++){var o=e[n];null!=o.__nullify__?u.push(o):r.push(o)}t=r,i()}))}),(function(){a(t.concat(u))}))}))},preprocessExistentialFilters:function(e,t,r,o,s,a){var l=[];i.eachSeries(e,(function(e,a){if("builtincall"!==e.value.expressionType||"exists"!==e.value.builtincall&&"notexists"!==e.value.builtincall)if("conditionalor"===e.value.expressionType||"conditionaland"===e.value.expressionType){var u=n.map(e.value.operands,(function(e){return{value:e}}));QueryFilters.preprocessExistentialFilters(u,t,r,o,s,(function(t){e.value.operands=t.map((function(e){return e.value})),l.push(e),a()}))}else"multiplicativeexpression"===e.value.expressionType?(u=n.map(e.value.factors,(function(e){return{value:e}})),QueryFilters.preprocessExistentialFilters(u,t,r,o,s,(function(t){e.value.factors=t.map((function(e){return e.value})),l.push(e),a()}))):"additiveexpression"===e.value.expressionType?(u=n.map(e.value.summands,(function(e){return{value:e}})),QueryFilters.preprocessExistentialFilters(u,t,r,o,s,(function(t){e.value.summands=t.map((function(e){return e.value})),l.push(e),a()}))):"relationalexpression"===e.value.expressionType?(u=[{value:e.value.op1},{value:e.value.op2}],QueryFilters.preprocessExistentialFilters(u,t,r,o,s,(function(t){e.value.op1=t[0].value,e.value.op2=t[1].value,l.push(e),a()}))):("irireforfunction"===e.value.expressionType||"custom"===e.value.expressionType)&&null!=e.value.args?(u=n.map(e.value.args,(function(e){return{value:e}})),QueryFilters.preprocessExistentialFilters(u,t,r,o,s,(function(t){e.value.args=t.map((function(e){return e.value})),l.push(e),a()}))):(l.push(e),a());else{var c=e.value.builtincall,f=e.value.args,h={};r.copyDenormalizedBindings(t,s.outCache,(function(t){i.eachSeries(t,(function(e,t){var i=n.clone(f[0],!0);i=r.abstractQueryTree.parseSelect({pattern:i},e),i=r.abstractQueryTree.bind(i.pattern,e);r.executeSelectUnit([{kind:"*"}],o,i,s,(function(r){var n="exists"===c?QueryFilters.ebvBoolean(0!==r.length):QueryFilters.ebvBoolean(0===r.length);for(var i in r=[],e)r.push(JSON.stringify(e[i]));r=r.sort().join(""),h[r]=n,t()}))}),(function(){e.value.origArgs=e.value.args,e.value.args=h,l.push(e),a()}))}))}}),(function(){a(l)}))},boundVars:function(e){if(null==e.expressionType)throw"Cannot find bound expressions in a no expression token";if("relationalexpression"==(r=e.expressionType))return r=e.op2,QueryFilters.boundVars(e.op1)+QueryFilters.boundVars(r);if("conditionalor"==r||"conditionaland"==r){for(var t=[],r=0;r<e.operands;r++)t=t.concat(QueryFilters.boundVars(e.operands[r]));return t}if("builtincall"==r){if(null==e.args)return[];for(t=[],r=0;r<e.args.length;r++)t=t.concat(QueryFilters.boundVars(e.args[r]));return t}if("multiplicativeexpression"==r){for(t=QueryFilters.boundVars(e.factor),r=0;r<e.factors.length;r++)t=t.concat(QueryFilters.boundVars(e.factors[r].expression));return t}if("additiveexpression"==r){for(t=QueryFilters.boundVars(e.summand),r=0;r<e.summands.length;r++)t=t.concat(QueryFilters.boundVars(e.summands[r].expression));return t}return"regex"==r?(t=QueryFilters.boundVars(e.expression1)).concat(QueryFilters.boundVars(e.expression2)):"unaryexpression"==r?QueryFilters.boundVars(e.expression):"atomic"==r?"var"==e.primaryexpression?[e.value]:[]:void 0},run:function(e,t,r,n,i,o,s){o.copyDenormalizedBindings(t,i.outCache,(function(a){for(var l=[],u=0;u<t.length;u++){var c=QueryFilters.runFilter(e,a[u],o,n,i);c=QueryFilters.ebv(c);QueryFilters.isEbvError(c)?r&&(c={__nullify__:!0,bindings:t[u]},l.push(c)):!0===c?l.push(t[u]):r&&(c={__nullify__:!0,bindings:t[u]},l.push(c))}s(l)}))},collect:function(e,t,r,n,i,o){i.copyDenormalizedBindings(t,n.outCache,(function(s){for(var a=[],l=0;l<s.length;l++){var u=QueryFilters.runFilter(e,s[l],i,r,n);a.push({binding:t[l],value:u})}return o(a)}))},runDistinct:function(e,t){},runAggregator:function(e,t,r,i,o){if(null==t||0===t.length)return QueryFilters.ebvError();if("variable"===e.token&&"var"==e.kind)return t[0][e.value.value];if("variable"===e.token&&"aliased"===e.kind){if("atomic"===e.expression.expressionType&&"var"===e.expression.primaryexpression)return t[0][e.expression.value.value];if("aggregate"===e.expression.expressionType){if("max"===e.expression.aggregateType){for(var s=null,a=0;a<t.length;a++){var l=t[a];l=QueryFilters.runFilter(e.expression.expression,l,r,i,o);QueryFilters.isEbvError(l)||(null===s||!0===QueryFilters.runLtFunction(s,l).value)&&(s=l)}return null===s?QueryFilters.ebvError():s}if("min"===e.expression.aggregateType){for(s=null,a=0;a<t.length;a++)l=t[a],l=QueryFilters.runFilter(e.expression.expression,l,r,i,o),QueryFilters.isEbvError(l)||(null===s||!0===QueryFilters.runGtFunction(s,l).value)&&(s=l);return null===s?QueryFilters.ebvError():s}if("count"===e.expression.aggregateType){s={};var u=0;if("*"===e.expression.expression)if(null!=e.expression.distinct&&""!=e.expression.distinct)for(a=0;a<t.length;a++){l=t[a];var c=n.hashTerm(l);null==s[c]&&(s[c]=!0,u++)}else u=t.length;else for(a=0;a<t.length;a++)l=t[a],l=QueryFilters.runFilter(e.expression.expression,l,r,i,o),QueryFilters.isEbvError(l)||(null!=e.expression.distinct&&""!=e.expression.distinct?null==s[c=n.hashTerm(l)]&&(s[c]=!0,u++):u++);return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+u}}if("avg"===e.expression.aggregateType){s={};var f={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(a=u=0;a<t.length;a++)l=t[a],l=QueryFilters.runFilter(e.expression.expression,l,r,i,o),QueryFilters.isEbvError(l)||(null!=e.expression.distinct&&""!=e.expression.distinct?null==s[c=n.hashTerm(l)]&&(s[c]=!0,QueryFilters.isNumeric(l)&&(f=QueryFilters.runSumFunction(f,l),u++)):QueryFilters.isNumeric(l)&&(f=QueryFilters.runSumFunction(f,l),u++));return(e=QueryFilters.runDivFunction(f,{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+u})).value=""+e.value,e}if("sum"===e.expression.aggregateType){for(s={},f={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},a=0;a<t.length;a++)l=t[a],l=QueryFilters.runFilter(e.expression.expression,l,r,i,o),QueryFilters.isEbvError(l)||(null!=e.expression.distinct&&""!=e.expression.distinct?null==s[c=n.hashTerm(l)]&&(s[c]=!0,QueryFilters.isNumeric(l)&&(f=QueryFilters.runSumFunction(f,l))):QueryFilters.isNumeric(l)&&(f=QueryFilters.runSumFunction(f,l)));return f.value=""+f.value,f}return QueryFilters.runFilter(aggregate.expression,t[0],i,{blanks:{},outCache:{}})}}},runFilter:function(e,t,r,i,o){if(null!=e.expressionType){if("relationalexpression"==(s=e.expressionType)){var s=QueryFilters.runFilter(e.op1,t,r,i,o),a=QueryFilters.runFilter(e.op2,t,r,i,o);return QueryFilters.runRelationalFilter(e,s,a,t,r,i,o)}if("conditionalor"==s)return QueryFilters.runOrFunction(e,t,r,i,o);if("conditionaland"==s)return QueryFilters.runAndFunction(e,t,r,i,o);if("additiveexpression"==s)return QueryFilters.runAddition(e.summand,e.summands,t,r,i,o);if("builtincall"==s)return QueryFilters.runBuiltInCall(e.builtincall,e.args,t,r,i,o);if("multiplicativeexpression"==s)return QueryFilters.runMultiplication(e.factor,e.factors,t,r,i,o);if("unaryexpression"==s)return QueryFilters.runUnaryExpression(e.unaryexpression,e.expression,t,r,i,o);if("irireforfunction"==s)return QueryFilters.runIriRefOrFunction(e.iriref,e.args,t,r,i,o);if("regex"==s)return QueryFilters.runRegex(e.text,e.pattern,e.flags,t,r,i,o);if("custom"==s)return QueryFilters.runBuiltInCall(e.name,e.args,t,r,i,o);if("atomic"==s)return"var"==e.primaryexpression?t[e.value.value]:("object"==typeof e.value&&null!=e.value.type&&"object"==typeof e.value.type&&(e.value.type=n.lexicalFormBaseUri(e.value.type,o)),e.value);throw"Unknown filter expression type"}throw"Cannot find bound expressions in a no expression token"},isRDFTerm:function(e){return null!=e&&!!(e.token&&"literal"==e.token||e.token&&"uri"==e.token||e.token&&"blank"==e.token)},RDFTermEquality:function(e,t,r,i){return"literal"===e.token&&"literal"===t.token?e.lang==t.lang&&e.type==t.type&&e.value==t.value||(null!=e.type&&null!=t.type||QueryFilters.isSimpleLiteral(e)&&null!=t.type||!(!QueryFilters.isSimpleLiteral(t)||null==e.type))&&QueryFilters.ebvError():"uri"===e.token&&"uri"===t.token?n.lexicalFormBaseUri(e,i)==n.lexicalFormBaseUri(t,i):"blank"===e.token&&"blank"===t.token&&e.value==t.value},isInteger:function(e){return null!=e&&("literal"===e.token&&("http://www.w3.org/2001/XMLSchema#integer"==e.type||"http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type))},isFloat:function(e){return null!=e&&("literal"===e.token&&"http://www.w3.org/2001/XMLSchema#float"==e.type)},isDecimal:function(e){return null!=e&&("literal"===e.token&&"http://www.w3.org/2001/XMLSchema#decimal"==e.type)},isDouble:function(e){return null!=e&&("literal"===e.token&&"http://www.w3.org/2001/XMLSchema#double"==e.type)},isNumeric:function(e){return null!=e&&("literal"===e.token&&("http://www.w3.org/2001/XMLSchema#integer"==e.type||"http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#float"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type))},isSimpleLiteral:function(e){return!(!e||"literal"!=e.token)&&(null==e.type&&null==e.lang)},isXsdType:function(e,t){return!(!t||"literal"!=t.token)&&t.type=="http://www.w3.org/2001/XMLSchema#"+e},ebv:function(e){if(null==e||QueryFilters.isEbvError(e))return QueryFilters.ebvError();if(e.token&&"literal"===e.token){if("http://www.w3.org/2001/XMLSchema#integer"==e.type||"http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type){var t=parseFloat(e.value);return!isNaN(t)&&0!=parseFloat(e.value)}return"http://www.w3.org/2001/XMLSchema#boolean"===e.type?"true"===e.value||!0===e.value||"True"===e.value:"http://www.w3.org/2001/XMLSchema#string"===e.type?""!=e.value:"http://www.w3.org/2001/XMLSchema#dateTime"===e.type?null!=new Date(e.value):QueryFilters.isEbvError(e)?e:null==e.type?""!=e.value:QueryFilters.ebvError()}return!0===e.value}},QueryFilters.effectiveBooleanValue=QueryFilters.ebv,QueryFilters.ebvTrue=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}},QueryFilters.ebvFalse=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}},QueryFilters.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}},QueryFilters.isEbvError=function(e){return"object"==typeof e&&null!=e&&"https://github.com/antoniogarrote/js-tools/types#error"===e.type},QueryFilters.ebvBoolean=function(e){return QueryFilters.isEbvError(e)?e:!0===e?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.runRelationalFilter=function(e,t,r,n,i,o,s){if("="===(e=e.operator))return QueryFilters.runEqualityFunction(t,r,n,i,o,s);if("!="===e)return t=QueryFilters.runEqualityFunction(t,r,n,i,o,s),QueryFilters.isEbvError(t)||(t.value=!t.value),t;if("<"===e)return QueryFilters.runLtFunction(t,r,n);if(">"===e)return QueryFilters.runGtFunction(t,r,n);if("<="===e)return QueryFilters.runLtEqFunction(t,r,n);if(">="===e)return QueryFilters.runGtEqFunction(t,r,n);throw"Error applying relational filter, unknown operator"},QueryFilters.effectiveTypeValue=function(e){if("literal"!=e.token)throw console.log("not implemented yet"),console.log(e),"value not supported in operations yet";if("http://www.w3.org/2001/XMLSchema#integer"==e.type)return parseInt(e.value);if("http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#float"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type)return parseFloat(e.value);if("http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type)return parseInt(e.value);if("http://www.w3.org/2001/XMLSchema#date"!=e.type&&"http://www.w3.org/2001/XMLSchema#dateTime"!=e.type)return"http://www.w3.org/2001/XMLSchema#boolean"==e.type?!0===e.value||"true"===e.value||"1"===e.value||1===e.value||!0===e.value||!1!==e.value&&"false"!==e.value&&"0"!==e.value&&0!==e.value&&!1!==e.value&&void 0:"http://www.w3.org/2001/XMLSchema#string"==e.type?null===e.value||void 0===e.value?void 0:""+e.value:e.value;try{return n.parseISO8601(e.value)}catch(t){return null}},QueryFilters.runOrFunction=function(e,t,r,n,i){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,r,n,i);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=QueryFilters.isEbvError(o)?QueryFilters.ebvError():!0===o||QueryFilters.ebvError():!0===a?o=!0:QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError())}return QueryFilters.ebvBoolean(o)},QueryFilters.runAndFunction=function(e,t,r,n,i){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,r,n,i);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=(QueryFilters.isEbvError(o)||!0===o)&&QueryFilters.ebvError():!0===a?QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError()):o=!1}return QueryFilters.ebvBoolean(o)},QueryFilters.runEqualityFunction=function(e,t,r,i,o,s){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)?(r=QueryFilters.effectiveTypeValue(e),o=QueryFilters.effectiveTypeValue(t),isNaN(r)||isNaN(o)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,i,s)):QueryFilters.ebvBoolean(r==o)):(QueryFilters.isSimpleLiteral(e)||QueryFilters.isXsdType("string",e))&&(QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",t))||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)==QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?0==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.isRDFTerm(e)&&QueryFilters.isRDFTerm(t)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,i,s)):QueryFilters.ebvFalse()},QueryFilters.runGtFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?1==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runTotalGtFunction=function(e,t){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isSimpleLiteral("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isSimpleLiteral("boolean",t)||QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isSimpleLiteral("dateTime",t)?QueryFilters.runGtFunction(e,t,[]):e.token&&"uri"===e.token&&t.token&&"uri"===t.token?QueryFilters.ebvBoolean(e.value>t.value):e.token&&"literal"===e.token&&t.token&&"literal"===t.token?QueryFilters.ebvBoolean(""+e.value+e.type+e.lang>""+t.value+t.type+t.lang):e.token&&"blank"===e.token&&t.token&&"blank"===t.token||e.value&&t.value?QueryFilters.ebvBoolean(e.value>t.value):QueryFilters.ebvTrue()},QueryFilters.runLtFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?-1==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runGtEqFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?-1!=e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runLtEqFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?1!=e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runAddition=function(e,t,r,n,i,o){var s=QueryFilters.runFilter(e,r,n,i,o);if(QueryFilters.isEbvError(s))return QueryFilters.ebvError();if(e=s,QueryFilters.isNumeric(s)){for(s=0;s<t.length;s++){var a=QueryFilters.runFilter(t[s].expression,r,n,i,o);if(!QueryFilters.isNumeric(a))return QueryFilters.ebvFalse();"+"===t[s].operator?e=QueryFilters.runSumFunction(e,a):"-"===t[s].operator&&(e=QueryFilters.runSubFunction(e,a))}return e}return QueryFilters.ebvFalse()},QueryFilters.runSumFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)+QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runSubFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)-QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runMultiplication=function(e,t,r,n,i,o){if(e=QueryFilters.runFilter(e,r,n,i,o),QueryFilters.isEbvError(e))return e;var s=e;if(QueryFilters.isNumeric(e)){for(var a=0;a<t.length;a++){var l=QueryFilters.runFilter(t[a].expression,r,n,i,o);if(QueryFilters.isEbvError(l))return e;if(!QueryFilters.isNumeric(l))return QueryFilters.ebvFalse();"*"===t[a].operator?s=QueryFilters.runMulFunction(s,l):"/"===t[a].operator&&(s=QueryFilters.runDivFunction(s,l))}return s}return QueryFilters.ebvFalse()},QueryFilters.runMulFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)*QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runDivFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)/QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runBuiltInCall=function(e,t,r,n,i,o){if("notexists"===e||"exists"===e){for(var s in e=[],r)e.push(JSON.stringify(r[s]));return t[e=e.sort().join("")]}s=[];for(var a=0;a<t.length;a++)if("var"===t[a].token)s.push(t[a]);else{var l=QueryFilters.runFilter(t[a],r,n,i,o);if(QueryFilters.isEbvError(l))return l;s.push(l)}if("str"===e)return"literal"===s[0].token?{token:"literal",type:null,value:""+s[0].value}:"uri"===s[0].token?{token:"literal",type:null,value:s[0].value}:QueryFilters.ebvFalse();if("lang"===e)return"literal"===s[0].token?null!=s[0].lang?{token:"literal",value:""+s[0].lang}:{token:"literal",value:""}:QueryFilters.ebvError();if("datatype"===e)return"literal"===s[0].token?null!=(r=s[0]).type?"string"==typeof r.type?{token:"uri",value:r.type,prefix:null,suffix:null}:r.type:null==r.lang?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:QueryFilters.ebvError():QueryFilters.ebvError();if("isliteral"===e)return"literal"===s[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isblank"===e)return"blank"===s[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isuri"===e||"isiri"===e)return"uri"===s[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("sameterm"===e)return r=QueryFilters.RDFTermEquality(s[0],s[1],n,o),QueryFilters.isEbvError(r)&&(r=!1),QueryFilters.ebvBoolean(r);if("langmatches"===e)return r=s[0],t=s[1],"literal"===r.token&&"literal"===t.token?"*"===t.value&&""!=r.value?QueryFilters.ebvTrue():QueryFilters.ebvBoolean(0===r.value.toLowerCase().indexOf(t.value.toLowerCase())):QueryFilters.ebvError();if("bound"===e)return null==(t=s[0].value)?QueryFilters.ebvError():null!=r[t]?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if(null!=n.customFns[e])return n.customFns[e](QueryFilters,s);throw"Builtin call "+e+" not implemented yet"},QueryFilters.runUnaryExpression=function(e,t,r,n,i,o){if(t=QueryFilters.runFilter(t,r,n,i,o),QueryFilters.isEbvError(t))return t;if("!"===e){var s=QueryFilters.ebv(t);return QueryFilters.isEbvError(s)?QueryFilters.ebvFalse():QueryFilters.ebvBoolean(!s)}if("+"===e)return QueryFilters.isNumeric(t)?t:QueryFilters.ebvError();if("-"===e){if(QueryFilters.isNumeric(t)){for(s in e={},t)e[s]=t[s];return e.value=-e.value,e}return QueryFilters.ebvError()}},QueryFilters.runRegex=function(e,t,r,n,i,o,s){if(null==e)return QueryFilters.ebvError();if(e=QueryFilters.runFilter(e,n,i,o,s),null==t)return QueryFilters.ebvError();if(t=QueryFilters.runFilter(t,n,i,o,s),null!=r&&(r=QueryFilters.runFilter(r,n,i,o,s)),null==t||"literal"!==t.token||null!=r&&"literal"!==r.token)return QueryFilters.ebvError();if(t=t.value,r=null==r?null:r.value,null!=e&&"var"==e.token){if(null==n[e.value])return QueryFilters.ebvError();e=n[e.value]}else{if(null==e||"literal"!==e.token)return QueryFilters.ebvError();if(null!=e.type&&!QueryFilters.isXsdType("string",e))return QueryFilters.ebvError();e=e.value}return(null==r?new RegExp(t):new RegExp(t,r.toLowerCase())).exec(e)?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.normalizeLiteralDatatype=function(e,t,r){return null!=e.value.type&&"object"==typeof e.value.type&&(e.value.type=n.lexicalFormBaseUri(e.value.type,r)),e},QueryFilters.runIriRefOrFunction=function(e,t,r,i,o,s){if(null==t)return e;for(var a=[],l=0;l<t.length;l++)a.push(QueryFilters.runFilter(t[l],r,i,o,s));if("http://www.w3.org/2001/XMLSchema#integer"==(e=n.lexicalFormBaseUri(e,s))||"http://www.w3.org/2001/XMLSchema#decimal"==e||"http://www.w3.org/2001/XMLSchema#double"==e||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e||"http://www.w3.org/2001/XMLSchema#long"==e||"http://www.w3.org/2001/XMLSchema#int"==e||"http://www.w3.org/2001/XMLSchema#short"==e||"http://www.w3.org/2001/XMLSchema#byte"==e||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e){if("literal"!==(a=a[0]).token)return QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#integer"==(a=QueryFilters.normalizeLiteralDatatype(a,i,s)).type||"http://www.w3.org/2001/XMLSchema#decimal"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==a.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#long"==a.type||"http://www.w3.org/2001/XMLSchema#int"==a.type||"http://www.w3.org/2001/XMLSchema#short"==a.type||"http://www.w3.org/2001/XMLSchema#byte"==a.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==a.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==a.type)return a.type=e,a;if("http://www.w3.org/2001/XMLSchema#boolean"==a.type)return 1==QueryFilters.ebv(a)?(a.type=e,a.value=1):(a.type=e,a.value=0),a;if("http://www.w3.org/2001/XMLSchema#float"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type)return a.type=e,a.value=parseInt(a.value),a;if("http://www.w3.org/2001/XMLSchema#string"!=a.type&&null!=a.type)return QueryFilters.ebvError();if(2<a.value.split(".").length||2<a.value.split("-").length||2<a.value.split("/").length||2<a.value.split("+").length||"http://www.w3.org/2001/XMLSchema#decimal"==e&&(-1!=a.value.indexOf("e")||-1!=a.value.indexOf("E")))return QueryFilters.ebvError();if(!("http://www.w3.org/2001/XMLSchema#int"!=e&&"http://www.w3.org/2001/XMLSchema#integer"!=e||-1==a.value.indexOf("e")&&-1==a.value.indexOf("E")&&-1==a.value.indexOf(".")))return QueryFilters.ebvError();try{return a.value=parseInt(parseFloat(a.value)),isNaN(a.value)?QueryFilters.ebvError():(a.type=e,a)}catch(u){return QueryFilters.ebvError()}}else{if("http://www.w3.org/2001/XMLSchema#boolean"==e)return"literal"===(a=a[0]).token&&null==a.type?"true"===a.value||"1"===a.value?QueryFilters.ebvTrue():"false"===a.value||"0"===a.value?QueryFilters.ebvFalse():QueryFilters.ebvError():"literal"===a.token?QueryFilters.isEbvError(a)?a:QueryFilters.ebvBoolean(a):QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#string"==e)return"literal"===(a=a[0]).token?"http://www.w3.org/2001/XMLSchema#integer"==(a=QueryFilters.normalizeLiteralDatatype(a,i,s)).type||"http://www.w3.org/2001/XMLSchema#decimal"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==a.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#long"==a.type||"http://www.w3.org/2001/XMLSchema#int"==a.type||"http://www.w3.org/2001/XMLSchema#short"==a.type||"http://www.w3.org/2001/XMLSchema#byte"==a.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==a.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==a.type||"http://www.w3.org/2001/XMLSchema#float"==a.type?(a.type=e,a.value=""+a.value,a):"http://www.w3.org/2001/XMLSchema#string"==a.type?a:"http://www.w3.org/2001/XMLSchema#boolean"==a.type?(QueryFilters.ebv(a)?(a.type=e,a.value="true"):(a.type=e,a.value="false"),a):"http://www.w3.org/2001/XMLSchema#dateTime"==a.type||"http://www.w3.org/2001/XMLSchema#date"==a.type?(a.type=e,"string"!=typeof a.value&&(a.value=n.iso8601(a.value)),a):null==a.type?(a.value=""+a.value,a.type=e,a):QueryFilters.ebvError():"uri"===a.token?{token:"literal",value:n.lexicalFormBaseUri(a,s),type:e,lang:null}:QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#dateTime"==e||"http://www.w3.org/2001/XMLSchema#date"==e){if("http://www.w3.org/2001/XMLSchema#dateTime"==(a=a[0]).type||"http://www.w3.org/2001/XMLSchema#date"==a.type)return a;if("http://www.w3.org/2001/XMLSchema#string"!=a.type&&null!=a.type)return QueryFilters.ebvError();try{return a.value=n.iso8601(n.parseISO8601(a.value)),a.type=e,a}catch(u){return QueryFilters.ebvError()}}else{if("http://www.w3.org/2001/XMLSchema#float"!=e)return null!=i.customFns[e]?i.customFns[e](QueryFilters,a):QueryFilters.ebvError();if("literal"!==(a=a[0]).token)return QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#decimal"==(a=QueryFilters.normalizeLiteralDatatype(a,i,s)).type||"http://www.w3.org/2001/XMLSchema#int"==a.type)return a.type=e,a.value=parseFloat(a.value),a;if("http://www.w3.org/2001/XMLSchema#boolean"==a.type)return 1==QueryFilters.ebv(a)?(a.type=e,a.value=1):(a.type=e,a.value=0),a;if("http://www.w3.org/2001/XMLSchema#float"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type)return a.type=e,a.value=parseFloat(a.value),a;if("http://www.w3.org/2001/XMLSchema#string"==a.type)try{return a.value=parseFloat(a.value),isNaN(a.value)?QueryFilters.ebvError():(a.type=e,a)}catch(u){return QueryFilters.ebvError()}else{if(null!=a.type)return QueryFilters.ebvError();if(2<a.value.split(".").length||2<a.value.split("-").length||2<a.value.split("/").length||2<a.value.split("+").length)return QueryFilters.ebvError();try{return a.value=parseFloat(a.value),isNaN(a.value)?QueryFilters.ebvError():(a.type=e,a)}catch(u){return QueryFilters.ebvError()}}}}},t.exports={QueryFilters:QueryFilters}},{"./utils":57}],53:[function(e,t,r){var n=e("./utils"),i=e("./utils"),o={variablesInBGP:function(e){if(n=e.variables)return n;var t,r=e.value||e,n=[];for(t in r)r[t]&&"var"===r[t].token?n.push(r[t].value):r[t]&&"blank"===r[t].token&&n.push("blank:"+r[t].value);return e.variables=n},connected:function(e,t){for(var r="/"+e.vars.join("/")+"/",n=0;n<t.vars.length;n++)if(-1!=r.indexOf("/"+t.vars[n]+"/"))return!0;return!1},variablesIntersectionBGP:function(e,t){for(var r=o.variablesInBGP(e),n=o.variablesInBGP(t),i={},s=0;s<r.lenght;s++)i[r[s]]=1;for(s=0;s<n.length;s++)r=i[n[s]]||0,r++,i[n[s]]=r;var a;n=[];for(a in i)2==i[a]&&n.push(i[a]);return n},executeAndBGPsGroups:function(e){for(var t={},r={},i=0,s=function(e,t){for(var r=0;r<e.length;r++)if(-1!=t.indexOf("/"+e[r]+"/"))return!0;return!1},a=function(e,n,i,o){var s,a=[],l="",u="";for(s in n)l+=s,a=a.concat(t[s]),u+=r[s];u=u+p.join("/")+"/",a.push(e),i[l]=a,o[l]=u},l=0;l<e.length;l++){var u,c=e[l],f={},h={},p=o.variablesInBGP(c),d={};for(u in r)s(p,r[u])?d[u]=!0:(f[u]=t[u],h[u]=r[u]);0===n.size(d)?(f["g"+i]=[c],h["g"+i]="/"+p.join("/")+"/",i++):a(c,d,f,h),t=f,r=h}return n.values(t)},intersectionSize:function(e,t){for(var r=t.i.split("_"),n=0;n<r.length;n++)if(""!=r[n]&&-1!=e.i.indexOf("_"+r[n]+"_"))return 1;return 0},createJoinTree:function(e,t){for(var r="/"+e.vars.join("/")+"/",i=e.vars.concat([]),o=[],s=0;s<t.vars.length;s++)-1!=r.indexOf("/"+t.vars[s]+"/")?0==t.vars[s].indexOf("_:")?o.push("blank:"+t.vars[s]):o.push(t.vars[s]):i.push(t.vars[s]);r=t.i.split("_");var a=e.i.split("_"),l={};for(s=0;s<r.length;s++)""!=r[s]&&(l[r[s]]=!0);for(s=0;s<a.length;s++)""!=a[s]&&(l[a[s]]=!0);return s=n.keys(l),{left:e,right:t,cost:e.cost+t.cost,i:"_"+s.sort().join("_")+"_",vars:i,join:o}},executeBushyTree:function(e,t,r,n,i){null==e.left?o.executeEmptyJoinBGP(e.right,t,r,n,i):null==e.right?o.executeEmptyJoinBGP(e.left,t,r,n,i):o.executeBushyTree(e.left,t,r,n,(function(s){null!=s?o.executeBushyTree(e.right,t,r,n,(function(t){i(null!=t?o.joinBindings2(e.join,s,t):null)})):i(null)}))},executeAndBGPsDPSize:function(e,t,r,n,s){e=o.executeAndBGPsGroups(e);var a=[];i.eachSeries(e,(function(e,t){r.computeCosts(e,n,(function(e){var r={},n={},i={},s=1,l=null,u={};i[1]=[];for(var c=0;c<e.length;c++){for(var f in s=[],delete e[c].variables,e[c])"_cost"!=f&&("var"===e[c][f].token||"blank"===e[c][f].token)&&s.push(e[c][f].value);n["_"+c+"_"]={left:e[c],right:null,cost:e[c]._cost,i:"_"+c+"_",vars:s},s={left:e[c],right:null,cost:e[c]._cost,i:"_"+c+"_",vars:s},r["_"+c+"_"]=s,delete e[c]._cost,u["_"+c+"_"]=!0,i[1].push("_"+c+"_"),(null==l||l.cost>s.cost)&&(l=s)}for(f=2;f<=e.length;f++)for(var h=1;h<f;h++){var p=i[""+h]||[],d=i[""+(f-h)]||[];for(c=0;c<p.length;c++)for(var g=0;g<d.length;g++)if(p[c]!==d[g]){var v=n[p[c]],y=n[d[g]];if(0==o.intersectionSize(v,y)&&o.connected(v,y)&&(s=f,!u[(v=o.createJoinTree(r[v.i],r[y.i])).i])){u[v.i]=!0,y=v.cost+1,null!=r[v.i]&&(y=r[v.i].cost);var m=i[f]||[];m.push(v.i),n[v.i]=v,i[f]=m,y>v.cost&&(s===f&&(l=v),r[v.i]=v)}}}a.push(l),t()}))}),(function(){var e=null;i.eachSeries(a,(function(i,s){o.executeBushyTree(i,t,r,n,(function(t){t?(e=null==e?t:o.crossProductBindings(e,t),s()):s("Error executing bushy tree")}))}),(function(t){t?s(null,t):s(e)}))}))},executeEmptyJoinBGP:function(e,t,r,n,i){return o.executeBGPDatasets(e,t,r,n,i)},executeBGPDatasets:function(e,t,r,n,s){var a={};if(null==e.graph){var l=[];i.eachSeries(t.implicit,(function(t,i){null==a[t.oid]?(a[t.oid]=!0,e.graph=t,r.rangeQuery(e,n,(function(t){t=o.buildBindingsFromRange(t,e),l.push(t),i()}))):i()}),(function(){var e=o.unionManyBindings(l);s(e)}))}else if("var"===e.graph.token){var u=e.graph.value;l=[];i.eachSeries(t.named,(function(t,i){null==a[t.oid]?(a[t.oid]=!0,e.graph=t,null!=l?r.rangeQuery(e,n,(function(r){if(null!=r){r=o.buildBindingsFromRange(r,e);for(var n=0;n<r.length;n++)r[n][u]=t.oid;l.push(r)}else l=null;i()})):i()):i()}),(function(){if(null==l)s(null);else{var e=o.unionManyBindings(l);s(e)}}))}else r.rangeQuery(e,n,(function(t){null!=t?(t=o.buildBindingsFromRange(t,e),s(t)):s(null)}))},buildBindingsFromRange:function(e,t){o.variablesInBGP(t);var r=t.value||t,n={};for(s in r)r[s]&&"var"===r[s].token?n[s]=r[s].value:r[s]&&"blank"===r[s].token&&(n[s]="blank:"+r[s].value);if(r=[],null!=e)for(var i=0;i<e.length;i++){var s,a={},l=e[i],u=!1;for(s in n){var c=l[s];if(null!=a[n[s]]&&a[n[s]]!==c){u=!0;break}a[n[s]]=c}u||r.push(a)}return r},areCompatibleBindings:function(e,t){for(var r in e)if(null!=t[r]&&t[r]!=e[r])return!1;return!0},mergeBindings:function(e,t){var r,n={};for(r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n},joinBindings2:function(e,t,r){for(var n,i,s,a,l={},u=[],c=0;c<t.length;c++){n=t[c],a=l;for(var f=0;f<e.length;f++)i=n[i=e[f]],f==e.length-1?((s=a[i]||[]).push(n),a[i]=s):(s=a[i]||{},a=a[i]=s)}for(c=0;c<r.length;c++)for(n=r[c],a=l,f=0;f<e.length;f++)if(null!=a[i=n[i=e[f]]])if(f==e.length-1)for(t=0;t<a[i].length;t++)u.push(o.mergeBindings(a[i][t],n));else a=a[i];return u},joinBindings:function(e,t){for(var r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<t.length;s++){var a=t[s];o.areCompatibleBindings(i,a)&&r.push(o.mergeBindings(i,a))}return r},augmentMissingBindings:function(e,t){for(var r in t)null==e[r]&&(e[r]=null);return e},leftOuterJoinBindings:function(e,t){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],s=!1,a=0;a<t.length;a++){var l=t[a];o.areCompatibleBindings(i,l)&&(s=!0,r.push(o.mergeBindings(i,l)))}!1===s&&(o.augmentMissingBindings(i,l),r.push(i))}return r},crossProductBindings:function(e,t){for(var r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<t.length;s++)r.push(o.mergeBindings(i,t[s]));return r},unionBindings:function(e,t){return e.concat(t)},unionManyBindings:function(e){for(var t=[],r=0;r<e.length;r++)t=o.unionBindings(t,e[r]);return t}};t.exports={QueryPlan:o}},{"./utils":57}],54:[function(e,t,r){var n=e("./network_transport").NetworkTransport,i=e("./rvn3_parser").RVN3Parser,o=e("./jsonld_parser").JSONLDParser,s=e("./utils");(r=function(e){if(this.precedences=["text/turtle","text/n3","application/ld+json","application/json"],this.parsers={"text/turtle":i.parser,"text/n3":i.parser,"application/ld+json":o.parser,"application/json":o.parser},"undefined"!=typeof RDFXMLParser&&(this.precedences.push("application/rdf+xml"),this.parsers["application/rdf+xml"]=RDFXMLParser.parser),null!=e)for(var t in e.parsers)this.parsers[t]=e.parsers[t];if(e&&null!=e.precedences)for(t in this.precedences=e.precedences,e.parsers)s.include(this.precedences,t)||this.precedences.push(t);for(this.acceptHeaderValue="",e=0;e<this.precedences.length;e++)this.acceptHeaderValue=0!=e?this.acceptHeaderValue+","+this.precedences[e]:this.acceptHeaderValue+this.precedences[e]}).prototype.registerParser=function(e,t){this.parsers[e]=t,this.precedences.push(e)},r.prototype.unregisterParser=function(e){delete this.parsers[e];for(var t=[],r=0;r<this.precedences.length;r++)this.precedences[r]!=e&&t.push(this.precedences[r]);this.precedences=t},r.prototype.setAcceptHeaderPrecedence=function(e){this.precedences=e},r.prototype.load=function(e,t,r){var i=this;n.load(e,this.acceptHeaderValue,(function(n,o){if(n)r(n);else{var s=o.headers["Content-Type"]||o.headers["content-type"],a=o.data;if(null!=s){var l;s=s.split(";")[0];for(l in i.parsers)if(-1!=l.indexOf("/")){var u=l.split("/");if("*"===u[1]){if(-1!=s.indexOf(u[0]))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r)}else if(-1!=s.indexOf(l)||-1!=s.indexOf(u[1]))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r)}else if(-1!=s.indexOf(l))return i.tryToParse(i.parsers[l],t,a,{documentURI:e},r);r(Error("Unknown media type : "+s))}else r(Error("Uknown media type"))}}))},r.prototype.loadFromFile=function(t,r,n,i){try{var o=this;e("fs").readFile(n.split("file:/")[1],(function(e,s){e?i(e):(s=s.toString("utf8"),o.tryToParse(t,r,s,{documentURI:n},i))}))}catch(s){i(s)}},r.prototype.tryToParse=function(e,t,r,n,i){try{"string"==typeof r&&(r=s.normalizeUnicodeLiterals(r)),e.parse(r,t,n,i)}catch(o){console.log(o.message),console.log(o.stack),i(o)}},t.exports={RDFLoader:r}},{"./jsonld_parser":43,"./network_transport":45,"./rvn3_parser":56,"./utils":57,fs:5}],55:[function(e,t,r){var n=e("./utils"),i=e("./query_filters").QueryFilters;RDFModel={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#",ldp:"http://www.w3.org/ns/ldp#"},UrisMap:function(){this.defaultNs="",this.interfaceProperties="get remove set setDefault addAll resolve shrink".split(" ")}},RDFModel.UrisMap.prototype.values=function(){var e,t={};for(e in this)n.include(this.interfaceProperties,e)||"function"==typeof this[e]||"defaultNs"===e||"interfaceProperties"===e||(t[e]=this[e]);return t},RDFModel.UrisMap.prototype.get=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return this[e]},RDFModel.UrisMap.prototype.remove=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return delete this[e],null},RDFModel.UrisMap.prototype.set=function(e,t){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";this[e]=t},RDFModel.UrisMap.prototype.setDefault=function(e){this.defaultNs=e},RDFModel.UrisMap.prototype.addAll=function(e,t){for(var r in e)n.include(this.interfaceProperties,r)||(null!=this[r]?!0===t&&(this[r]=e[r]):this[r]=e[r]);return this},RDFModel.UrisMap.prototype.resolve=function(e){var t=e.split(":");return e=t[0],t=t[1],""===e?null==this.defaultNs?null:this.defaultNs+t:null!=this[e]?this[e]+t:null},RDFModel.UrisMap.prototype.shrink=function(e){for(var t in this){var r=this[t];if(0===e.indexOf(r)&&""!==r&&"defaultNs"!=t)return t+":"+(e=e.split(r)[1])}return e},RDFModel.Profile=function(){this.prefixes=new RDFModel.UrisMap,this.terms=new RDFModel.UrisMap},RDFModel.Profile.prototype.importProfile=function(e,t){this.prefixes.addAll(e.prefixes,t),this.terms.addAll(e.terms,t)},RDFModel.Profile.prototype.resolve=function(e){return-1!=e.indexOf(":")?this.prefixes.resolve(e):null!=this.terms[e]?this.terms.resolve(e):null},RDFModel.Profile.prototype.setDefaultPrefix=function(e){this.prefixes.setDefault(e)},RDFModel.Profile.prototype.setDefaultVocabulary=function(e){this.terms.setDefault(e)},RDFModel.Profile.prototype.setPrefix=function(e,t){this.prefixes.set(e,t)},RDFModel.Profile.prototype.setTerm=function(e,t){this.terms.set(e,t)},RDFModel.RDFEnvironment=function(){RDFModel.Profile.call(this),this.blankNodeCounter=0;var e=this;for(var t in this.filters={s:function(e){return function(t){return t.subject.equals(e)}},p:function(e){return function(t){return t.predicate.equals(e)}},o:function(e){return function(t){return t.object.equals(e)}},sp:function(e,t){return function(r){return r.subject.equals(e)&&r.predicate.equals(t)}},so:function(e,t){return function(r){return r.subject.equals(e)&&r.object.equals(t)}},po:function(e,t){return function(r){return r.predicate.equals(e)&&r.object.equals(t)}},spo:function(e,t,r){return function(n){return n.subject.equals(e)&&n.predicate.equals(t)&&n.object.equals(r)}},describes:function(e){return function(t){return t.subject.equals(e)||t.object.equals(e)}},type:function(t){var r=e.resolve("rdf:type");return function(e){return e.predicate.equals(r)&&e.object.equals(t)}}},RDFModel.defaultContext)this.prefixes.set(t,RDFModel.defaultContext[t])},RDFModel.RDFEnvironment.prototype=n.create(RDFModel.Profile.prototype,{constructor:RDFModel.RDFEnvironment}),RDFModel.RDFEnvironment.prototype.createBlankNode=function(){var e=new RDFModel.BlankNode(this.blankNodeCounter);return this.blankNodeCounter++,e},RDFModel.RDFEnvironment.prototype.createNamedNode=function(e){var t=this.resolve(e);return null!=t?new RDFModel.NamedNode(t):new RDFModel.NamedNode(e)},RDFModel.RDFEnvironment.prototype.createLiteral=function(e,t,r){return null!=r?new RDFModel.Literal(e,t,r.toString()):new RDFModel.Literal(e,t,r)},RDFModel.RDFEnvironment.prototype.createTriple=function(e,t,r){return new RDFModel.Triple(e,t,r)},RDFModel.RDFEnvironment.prototype.createGraph=function(e){var t=new RDFModel.Graph;if(null!=e)for(var r=0;r<e.length;r++)t.add(e[r]);return t},RDFModel.RDFEnvironment.prototype.createAction=function(e,t){return function(r){return e(r)?t(r):r}},RDFModel.RDFEnvironment.prototype.createProfile=function(e){return!0===e?new RDFModel.RDFEnvironment.Profile:((e=new RDFModel.RDFEnvironment.Profile).importProfile(this),e)},RDFModel.RDFEnvironment.prototype.createTermMap=function(e){if(!0===e)return new RDFModel.UrisMap;e=this.terms.values();var t,r=new RDFModel.UrisMap;for(t in e)r[t]=e[t];return r},RDFModel.RDFEnvironment.prototype.createPrefixMap=function(e){if(!0===e)return new RDFModel.UrisMap;e=this.prefixes.values();var t,r=new RDFModel.UrisMap;for(t in e)r[t]=e[t];return r},RDFModel.RDFNode=function(e){this.interfaceName=e,this.attributes=["interfaceName","nominalValue"]},RDFModel.RDFNode.prototype.equals=function(e){if(null==e.interfaceName)return this.valueOf()==e;for(var t in this.attributes){var r=this.attributes[t];if(this[r]!=e[r])return!1}return!0},RDFModel.BlankNode=function(e){RDFModel.RDFNode.call(this,"BlankNode"),this.nominalValue="_:"+e,this.bnodeId=e},RDFModel.BlankNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.BlankNode}),RDFModel.BlankNode.prototype.toString=function(){return this.nominalValue},RDFModel.BlankNode.prototype.toNT=function(){return this.nominalValue},RDFModel.BlankNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Literal=function(e,t,r){RDFModel.RDFNode.call(this,"Literal"),this.nominalValue=e,null!=t?this.language=t:null!=r&&(this.datatype=r)},RDFModel.Literal.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.Literal}),RDFModel.Literal.prototype.toString=function(){var e='"'+this.nominalValue+'"';return null!=this.language?e=e+"@"+this.language:(null!=this.datatype||this.type)&&(e=e+"^^<"+(this.datatype||this.type)+">"),e},RDFModel.Literal.prototype.toNT=function(){return this.toString()},RDFModel.Literal.prototype.valueOf=function(){return i.effectiveTypeValue({token:"literal",type:this.type||this.datatype,value:this.nominalValue,language:this.language})},RDFModel.NamedNode=function(e){RDFModel.RDFNode.call(this,"NamedNode"),this.nominalValue=null!=e.value?e.value:e},RDFModel.NamedNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.NamedNode}),RDFModel.NamedNode.prototype.toString=function(){return this.nominalValue},RDFModel.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"},RDFModel.NamedNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Triple=function(e,t,r){this.subject=e,this.predicate=t,this.object=r},RDFModel.Triple.prototype.equals=function(e){return this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)},RDFModel.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"},RDFModel.Graph=function(){this.triples=[],this.duplicates={},this.actions=[],this.length=0},RDFModel.Graph.prototype.add=function(e){for(var t=0;t<this.actions.length;t++)e=this.actions[t](e);return t=e.subject.toString()+e.predicate.toString()+e.object.toString(),this.duplicates[t]||(this.duplicates[t]=!0,this.triples.push(e)),this.length=this.triples.length,this},RDFModel.Graph.prototype.addAction=function(e,t){if(this.actions.push(e),1==t)for(var r=0;r<this.triples.length;r++)this.triples[r]=e(this.triples[r]);return this},RDFModel.Graph.prototype.addAll=function(e){e=e.toArray();for(var t=0;t<e.length;t++)this.add(e[t]);return this.length=this.triples.length,this},RDFModel.Graph.prototype.remove=function(e){for(var t=null,r=0;r<this.triples.length;r++)if(this.triples[r].equals(e)){delete this.duplicates[e.subject.toString()+e.predicate.toString()+e.object.toString()],t=r;break}return null!=t&&this.triples.splice(t,1),this.length=this.triples.length,this},RDFModel.Graph.prototype.toArray=function(){return this.triples},RDFModel.Graph.prototype.some=function(e){for(var t=0;t<this.triples.length;t++)if(!0===e(this.triples[t],this))return!0;return!1},RDFModel.Graph.prototype.every=function(e){for(var t=0;t<this.triples.length;t++)if(!1===e(this.triples[t],this))return!1;return!0},RDFModel.Graph.prototype.filter=function(e){for(var t=new RDFModel.Graph,r=0;r<this.triples.length;r++)!0===e(this.triples[r],this)&&t.add(this.triples[r]);return t},RDFModel.Graph.prototype.forEach=function(e){for(var t=0;t<this.triples.length;t++)e(this.triples[t],this)},RDFModel.Graph.prototype.merge=function(e){e=new RDFModel.Graph;for(var t=0;t<this.triples.length;t++)e.add(this.triples[t]);return e},RDFModel.Graph.prototype.match=function(e,t,r,n){for(var i=new RDFModel.Graph,o=0,s=0;s<this.triples.length;s++){var a=this.triples[s];if((null==e||a.subject.equals(e))&&(null==t||a.predicate.equals(t))&&(null==r||a.object.equals(r))){if(!(null==n||o<n))break;o++,i.add(a)}}return i},RDFModel.Graph.prototype.removeMatches=function(e,t,r){for(var n=[],i=0;i<this.triples.length;i++){var o=this.triples[i];(null==e||o.subject.equals(e))&&(null!=t&&!o.predicate.equals(t)||null!=r&&!o.object.equals(r)||n.push(o))}for(i=0;i<n.length;i++)this.remove(n[i]);return this},RDFModel.Graph.prototype.toNT=function(){var e="";return this.forEach((function(t){e+=t.toString()})),e},RDFModel.buildRDFResource=function(e,t,r,n){return"blank"===e.token?RDFModel.buildBlankNode(e,t,r,n):"literal"===e.token?RDFModel.buildLiteral(e,t,r,n):"uri"===e.token?RDFModel.buildNamedNode(e,t,r,n):"var"===e.token?null!=(e=t[e.value])?RDFModel.buildRDFResource(e,t,r,n):null:null},RDFModel.buildBlankNode=function(e,t,r,n){return null!=e.valuetmp&&(e.value=e.valuetmp),0===e.value.indexOf("_:")&&(e.value=e.value.split("_:")[1]),new RDFModel.BlankNode(e.value)},RDFModel.buildLiteral=function(e,t,r,n){return new RDFModel.Literal(e.value,e.lang,e.type)},RDFModel.buildNamedNode=function(e,t,r,n){return null==e.value&&null!=e.prefix&&(t=r.resolveNsInEnvironment(e.prefix,n),e.value=t+e.suffix),new RDFModel.NamedNode(e)},RDFModel.rdf=new RDFModel.RDFEnvironment,t.exports=RDFModel},{"./query_filters":52,"./utils":57}],56:[function(e,t,r){function n(e){switch(e[0]){case'"':return 0<e.indexOf("^^")?{literal:(e=e.split("^^"))[0]+"^^<"+e[1]+">"}:{literal:e};case"_":return{blank:e.replace("b","")};default:return{token:"uri",value:e,prefix:null,suffix:null}}}var i=e("n3").Parser;t.exports={RVN3Parser:{parser:{async:!0,parse:function(e,t,r,o){o||(o=r,r=t,t=null),t&&"string"==typeof t&&(t={token:"uri",value:t,prefix:null,suffix:null}),r&&r.baseURI&&(r.documentIRI=r.baseURI);var s=[];new i(r).parse(e,(function(e,r){e?o(e):r?s.push({subject:n(r.subject),predicate:n(r.predicate),object:n(r.object),graph:t}):o(!1,s)}))},resetBlankNodeIds:function(){i._resetBlankNodeIds()}}}}},{n3:27}],57:[function(x,B,A){(function(m){var h=void 0!==m&&m.nextTick?m.nextTick:"undefined"!=typeof window&&window.setImmediate?window.setImmediate:function(e){setTimeout(e,0)},c=0,b=100,a=function(e){++c<b?e():(c=0,h(e))},f=function(e){try{if(null==e)return"";if("uri"===e.token)return"u"+e.value;if("blank"===e.token)return"b"+e.value;var t;if("literal"===e.token)return(t=(t="l"+e.value)+(e.type||""))+(e.lang||"")}catch(c){if("object"==typeof e){for(p in t="",e)t=t+p+e[p];return t}return e}};parseISO8601=function(e){return Date.parse(e)},Date.prototype.toISOString||function(){function e(e){return 10>e?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),iso8601=function(e){return e.toISOString()},compareDateComponents=function(e,t){var r=parseISO8601(e),n=parseISO8601(t);return r==n?0:r<n?-1:1},lexicalFormLiteral=function(e,t){var r=e.value,n=e.lang,i=e.type,o=null;return null!=r&&null!=i&&"string"!=typeof i?(null==(r=i.value)&&(r=i.suffix,i=t.namespaces[i.prefix],e.type=i+r,r=i+r),o=-1!=r.indexOf("hexBinary")?'"'+e.value.toLowerCase()+'"^^<'+r+">":'"'+e.value+'"^^<'+r+">"):o=null==n&&null==i?'"'+r+'"':null==i?'"'+r+'"@'+n:-1!=i.indexOf("hexBinary")?'"'+e.value.toLowerCase()+'"^^<'+i+">":'"'+e.value+'"^^<'+i+">",o},normalizeUnicodeLiterals=function(a){for(var b=a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],c={},d=0;d<b.length;d++)null==c[b[d]]&&(c[b[d]]=!0,a=a.replace(new RegExp("\\"+b[d],"g"),eval("'"+b[d]+"'")));return a},registerIndexedDB=function(e){if("undefined"==typeof window&&void 0!==m&&!1===m.browser){var t=x("sqlite3"),r=x("indexeddb-js");t=new t.Database(":memory:"),r=r.makeScope("sqlite3",t);e.indexedDB=r.indexedDB,e.IDBKeyRange=r.IDBKeyRange}else(r="undefined"==typeof window?self:window).indexedDB=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,r.IDBKeyRange=r.IDBKeyRange||r.webkitIDBKeyRange||r.msIDBKeyRange,r.indexedDB?(e.indexedDB=r.indexedDB,e.IDBKeyRange=r.IDBKeyRange):console.log("The browser does not support IndexDB.")},guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};var f=function(e){try{if(null==e)return"";if("uri"===e.token)return"u"+e.value;if("blank"===e.token)return"b"+e.value;var t;if("literal"===e.token)return(t=(t="l"+e.value)+(e.type||""))+(e.lang||"")}catch(c){if("object"==typeof e){for(p in t="",e)t=t+p+e[p];return t}return e}},k=function(e,t){for(var r=[],n=0;n<e.length;n++)t(e[n])&&r.push(e[n]);return r},r=function(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r])};clone=function(e){return JSON.parse(JSON.stringify(e))};var d=function(){function e(){}return function(t){var r=typeof t;if("function"==r||t&&"object"==r){e.prototype=t;var n=new e;e.prototype=null}return n||void 0}}(),l=function(e,t,r){e()?t((function(n){if(n)return r(n);l(e,t,r)})):r()},v=function(e,t,r){if(r=r||function(){},!e.length)return r();var n=0,i=function(){t(e[n],(function(t){t?(r(t),r=function(){}):(n+=1)>=e.length?r():a(i)}))};i()},u=function(e,t,r,n){v(e,(function(e,n){r(t,e,(function(e,r){t=r,n(e)}))}),(function(e){n(e,t)}))};B.exports={isWorker:function(){return(void 0===m||!0===m.browser)&&"undefined"==typeof window},nextTick:a,hasTerm:f,lexicalFormBaseUri:function(e,t){var r=null;if(t=t||{},null==e.value){r=e.prefix;var n=e.suffix,i=t.namespaces[r];r=null!=i?i+n:r+":"+n}else r=e.value;return null===r?null:(-1==r.indexOf(":")&&(r=(t.base||"")+r),r)},parseISO8601:parseISO8601,compareDateComponents:compareDateComponents,iso8601:iso8601,normalizeUnicodeLiterals:normalizeUnicodeLiterals,lexicalFormLiteral:lexicalFormLiteral,registerIndexedDB:registerIndexedDB,guid:guid,hashTerm:f,keys:function(e){var t,r=[];for(t in e)r.push(t);return r},values:function(e){var t,r=[];for(t in e)r.push(e[t]);return r},size:function(e){if(e.length)return e.length;var t,r=0;for(t in e)r++;return r},map:function(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n]);return r},each:r,forEach:r,include:function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},reject:k,remove:k,clone:clone,create:d,whilst:l,eachSeries:v,eachParallel:function(e,t,r){if(r=r||function(){},!e.length)return r();for(var n=!1,i=0,o=function(t){if(t)throw n=!0,Error(t);n||++i===e.length&&r()},s=0;s<e.length;s++)!function(e,t,r,n){a((function(){try{n(e[t],(function(){r()}))}catch(a){r(a)}}))}(e,s,o,t)},seq:function(){var e=arguments;return function(){var t=this,r=Array.prototype.slice.call(arguments),n=r.pop();u(e,r,(function(e,r,n){r.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n(e,t)}]))}),(function(e,r){n.apply(t,[e].concat(r))}))}},yieldFrequency:function(e){b=e}}}).call(this,x("7YKIPe"))},{"7YKIPe":10}]},{},[41])(41)})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CodeMirror=t()}(this,(function(){"use strict";var e=navigator.userAgent,t=navigator.platform,r=/gecko\/\d/i.test(e),n=/MSIE \d/.test(e),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),o=/Edge\/(\d+)/.exec(e),s=n||i||o,a=s&&(n?document.documentMode||6:+(o||i)[1]),l=!o&&/WebKit\//.test(e),u=l&&/Qt\/\d+\.\d+/.test(e),c=!o&&/Chrome\//.test(e),f=/Opera\//.test(e),h=/Apple Computer/.test(navigator.vendor),p=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),d=/PhantomJS/.test(e),g=!o&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),v=/Android/.test(e),y=g||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),m=g||/Mac/.test(t),b=/\bCrOS\b/.test(e),x=/win/i.test(t),w=f&&e.match(/Version\/(\d*\.\d*)/);w&&(w=Number(w[1])),w&&w>=15&&(f=!1,l=!0);var k=m&&(u||f&&(null==w||w<12.11)),C=r||s&&a>=9;function S(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var F,_=function(e,t){var r=e.className,n=S(t).exec(r);if(n){var i=r.slice(n.index+n[0].length);e.className=r.slice(0,n.index)+(i?n[1]+i:"")}};function A(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function E(e,t){return A(e).appendChild(t)}function L(e,t,r,n){var i=document.createElement(e);if(r&&(i.className=r),n&&(i.style.cssText=n),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function T(e,t,r,n){var i=L(e,t,r,n);return i.setAttribute("role","presentation"),i}function N(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function M(){var e;try{e=document.activeElement}catch(Te){e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function I(e,t){var r=e.className;S(t).test(r)||(e.className+=(r?" ":"")+t)}function j(e,t){for(var r=e.split(" "),n=0;n<r.length;n++)r[n]&&!S(r[n]).test(t)&&(t+=" "+r[n]);return t}F=document.createRange?function(e,t,r,n){var i=document.createRange();return i.setEnd(n||e,r),i.setStart(e,t),i}:function(e,t,r){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(Te){return n}return n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n};var O=function(e){e.select()};function D(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function R(e,t,r){for(var n in t||(t={}),e)!e.hasOwnProperty(n)||!1===r&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function B(e,t,r,n,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=n||0,s=i||0;;){var a=e.indexOf("\t",o);if(a<0||a>=t)return s+(t-o);s+=a-o,s+=r-s%r,o=a+1}}g?O=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:s&&(O=function(e){try{e.select()}catch(t){}});var P=function(){this.id=null,this.f=null,this.time=0,this.handler=D(this.onTimeout,this)};function Q(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return r;return-1}P.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},P.prototype.set=function(e,t){this.f=t;var r=+new Date+e;(!this.id||r<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=r)};var U={toString:function(){return"CodeMirror.Pass"}},G={scroll:!1},z={origin:"*mouse"},q={origin:"+move"};function X(e,t,r){for(var n=0,i=0;;){var o=e.indexOf("\t",n);-1==o&&(o=e.length);var s=o-n;if(o==e.length||i+s>=t)return n+Math.min(s,t-i);if(i+=o-n,n=o+1,(i+=r-i%r)>=t)return n}}var H=[""];function W(e){for(;H.length<=e;)H.push(V(H)+" ");return H[e]}function V(e){return e[e.length-1]}function J(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n],n);return r}function K(){}function Y(e,t){var r;return Object.create?r=Object.create(e):(K.prototype=e,r=new K),t&&R(t,r),r}var $=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Z(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||$.test(e))}function ee(e,t){return t?!!(t.source.indexOf("\\w")>-1&&Z(e))||t.test(e):Z(e)}function te(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var re=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ne(e){return e.charCodeAt(0)>=768&&re.test(e)}function ie(e,t,r){for(;(r<0?t>0:t<e.length)&&ne(e.charAt(t));)t+=r;return t}function oe(e,t,r){for(var n=t>r?-1:1;;){if(t==r)return t;var i=(t+r)/2,o=n<0?Math.ceil(i):Math.floor(i);if(o==t)return e(o)?t:r;e(o)?r=o:t=o+n}}var se=null;function ae(e,t,r){var n;se=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&"before"==r?n=i:se=i),o.from==t&&(o.from!=o.to&&"before"!=r?n=i:se=i)}return null!=n?n:se}var le=function(){var e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,t=/[stwN]/,r=/[LRr]/,n=/[Lb1n]/,i=/[1n]/;function o(e,t,r){this.level=e,this.from=t,this.to=r}return function(s,a){var l="ltr"==a?"L":"R";if(0==s.length||"ltr"==a&&!e.test(s))return!1;for(var u,c=s.length,f=[],h=0;h<c;++h)f.push((u=s.charCodeAt(h))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(u):1424<=u&&u<=1524?"R":1536<=u&&u<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(u-1536):1774<=u&&u<=2220?"r":8192<=u&&u<=8203?"w":8204==u?"b":"L");for(var p=0,d=l;p<c;++p){var g=f[p];"m"==g?f[p]=d:d=g}for(var v=0,y=l;v<c;++v){var m=f[v];"1"==m&&"r"==y?f[v]="n":r.test(m)&&(y=m,"r"==m&&(f[v]="R"))}for(var b=1,x=f[0];b<c-1;++b){var w=f[b];"+"==w&&"1"==x&&"1"==f[b+1]?f[b]="1":","!=w||x!=f[b+1]||"1"!=x&&"n"!=x||(f[b]=x),x=w}for(var k=0;k<c;++k){var C=f[k];if(","==C)f[k]="N";else if("%"==C){var S=void 0;for(S=k+1;S<c&&"%"==f[S];++S);for(var F=k&&"!"==f[k-1]||S<c&&"1"==f[S]?"1":"N",_=k;_<S;++_)f[_]=F;k=S-1}}for(var A=0,E=l;A<c;++A){var L=f[A];"L"==E&&"1"==L?f[A]="L":r.test(L)&&(E=L)}for(var T=0;T<c;++T)if(t.test(f[T])){var N=void 0;for(N=T+1;N<c&&t.test(f[N]);++N);for(var M="L"==(T?f[T-1]:l),I=M==("L"==(N<c?f[N]:l))?M?"L":"R":l,j=T;j<N;++j)f[j]=I;T=N-1}for(var O,D=[],R=0;R<c;)if(n.test(f[R])){var B=R;for(++R;R<c&&n.test(f[R]);++R);D.push(new o(0,B,R))}else{var P=R,Q=D.length,U="rtl"==a?1:0;for(++R;R<c&&"L"!=f[R];++R);for(var G=P;G<R;)if(i.test(f[G])){P<G&&(D.splice(Q,0,new o(1,P,G)),Q+=U);var z=G;for(++G;G<R&&i.test(f[G]);++G);D.splice(Q,0,new o(2,z,G)),Q+=U,P=G}else++G;P<R&&D.splice(Q,0,new o(1,P,R))}return"ltr"==a&&(1==D[0].level&&(O=s.match(/^\s+/))&&(D[0].from=O[0].length,D.unshift(new o(0,0,O[0].length))),1==V(D).level&&(O=s.match(/\s+$/))&&(V(D).to-=O[0].length,D.push(new o(0,c-O[0].length,c)))),"rtl"==a?D.reverse():D}}();function ue(e,t){var r=e.order;return null==r&&(r=e.order=le(e.text,t)),r}var ce=[],fe=function(e,t,r){if(e.addEventListener)e.addEventListener(t,r,!1);else if(e.attachEvent)e.attachEvent("on"+t,r);else{var n=e._handlers||(e._handlers={});n[t]=(n[t]||ce).concat(r)}};function he(e,t){return e._handlers&&e._handlers[t]||ce}function pe(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(e.detachEvent)e.detachEvent("on"+t,r);else{var n=e._handlers,i=n&&n[t];if(i){var o=Q(i,r);o>-1&&(n[t]=i.slice(0,o).concat(i.slice(o+1)))}}}function de(e,t){var r=he(e,t);if(r.length)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,n)}function ge(e,t,r){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),de(e,r||t.type,e,t),we(t)||t.codemirrorIgnore}function ve(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==Q(r,t[n])&&r.push(t[n])}function ye(e,t){return he(e,t).length>0}function me(e){e.prototype.on=function(e,t){fe(this,e,t)},e.prototype.off=function(e,t){pe(this,e,t)}}function be(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function xe(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function we(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function ke(e){be(e),xe(e)}function Ce(e){return e.target||e.srcElement}function Se(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),m&&e.ctrlKey&&1==t&&(t=3),t}var Fe,_e,Ae=function(){if(s&&a<9)return!1;var e=L("div");return"draggable"in e||"dragDrop"in e}();function Ee(e){if(null==Fe){var t=L("span","​");E(e,L("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Fe=t.offsetWidth<=1&&t.offsetHeight>2&&!(s&&a<8))}var r=Fe?L("span","​"):L("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}function Le(e){if(null!=_e)return _e;var t=E(e,document.createTextNode("AخA")),r=F(t,0,1).getBoundingClientRect(),n=F(t,1,2).getBoundingClientRect();return A(e),!(!r||r.left==r.right)&&(_e=n.right-r.right<3)}var Te,Ne=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,r=[],n=e.length;t<=n;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),s=o.indexOf("\r");-1!=s?(r.push(o.slice(0,s)),t+=s+1):(r.push(o),t=i+1)}return r}:function(e){return e.split(/\r\n?|\n/)},Me=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(Te){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(Te){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Ie="oncopy"in(Te=L("div"))||(Te.setAttribute("oncopy","return;"),"function"==typeof Te.oncopy),je=null;var Oe={},De={};function Re(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Oe[e]=t}function Be(e){if("string"==typeof e&&De.hasOwnProperty(e))e=De[e];else if(e&&"string"==typeof e.name&&De.hasOwnProperty(e.name)){var t=De[e.name];"string"==typeof t&&(t={name:t}),(e=Y(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Be("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Be("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Pe(e,t){t=Be(t);var r=Oe[t.name];if(!r)return Pe(e,"text/plain");var n=r(e,t);if(Qe.hasOwnProperty(t.name)){var i=Qe[t.name];for(var o in i)i.hasOwnProperty(o)&&(n.hasOwnProperty(o)&&(n["_"+o]=n[o]),n[o]=i[o])}if(n.name=t.name,t.helperType&&(n.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)n[s]=t.modeProps[s];return n}var Qe={};function Ue(e,t){R(t,Qe.hasOwnProperty(e)?Qe[e]:Qe[e]={})}function Ge(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var r={};for(var n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r}function ze(e,t){for(var r;e.innerMode&&(r=e.innerMode(t))&&r.mode!=e;)t=r.state,e=r.mode;return r||{mode:e,state:t}}function qe(e,t,r){return!e.startState||e.startState(t,r)}var Xe=function(e,t,r){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=r};function He(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var r=e;!r.lines;)for(var n=0;;++n){var i=r.children[n],o=i.chunkSize();if(t<o){r=i;break}t-=o}return r.lines[t]}function We(e,t,r){var n=[],i=t.line;return e.iter(t.line,r.line+1,(function(e){var o=e.text;i==r.line&&(o=o.slice(0,r.ch)),i==t.line&&(o=o.slice(t.ch)),n.push(o),++i})),n}function Ve(e,t,r){var n=[];return e.iter(t,r,(function(e){n.push(e.text)})),n}function Je(e,t){var r=t-e.height;if(r)for(var n=e;n;n=n.parent)n.height+=r}function Ke(e){if(null==e.parent)return null;for(var t=e.parent,r=Q(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var i=0;n.children[i]!=t;++i)r+=n.children[i].chunkSize();return r+t.first}function Ye(e,t){var r=e.first;e:do{for(var n=0;n<e.children.length;++n){var i=e.children[n],o=i.height;if(t<o){e=i;continue e}t-=o,r+=i.chunkSize()}return r}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s].height;if(t<a)break;t-=a}return r+s}function $e(e,t){return t>=e.first&&t<e.first+e.size}function Ze(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function et(e,t,r){if(void 0===r&&(r=null),!(this instanceof et))return new et(e,t,r);this.line=e,this.ch=t,this.sticky=r}function tt(e,t){return e.line-t.line||e.ch-t.ch}function rt(e,t){return e.sticky==t.sticky&&0==tt(e,t)}function nt(e){return et(e.line,e.ch)}function it(e,t){return tt(e,t)<0?t:e}function ot(e,t){return tt(e,t)<0?e:t}function st(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function at(e,t){if(t.line<e.first)return et(e.first,0);var r=e.first+e.size-1;return t.line>r?et(r,He(e,r).text.length):function(e,t){var r=e.ch;return null==r||r>t?et(e.line,t):r<0?et(e.line,0):e}(t,He(e,t.line).text.length)}function lt(e,t){for(var r=[],n=0;n<t.length;n++)r[n]=at(e,t[n]);return r}Xe.prototype.eol=function(){return this.pos>=this.string.length},Xe.prototype.sol=function(){return this.pos==this.lineStart},Xe.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Xe.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Xe.prototype.eat=function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},Xe.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},Xe.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Xe.prototype.skipToEnd=function(){this.pos=this.string.length},Xe.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},Xe.prototype.backUp=function(e){this.pos-=e},Xe.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Xe.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Xe.prototype.match=function(e,t,r){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}var i=function(e){return r?e.toLowerCase():e};if(i(this.string.substr(this.pos,e.length))==i(e))return!1!==t&&(this.pos+=e.length),!0},Xe.prototype.current=function(){return this.string.slice(this.start,this.pos)},Xe.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},Xe.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},Xe.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var ut=function(e,t){this.state=e,this.lookAhead=t},ct=function(e,t,r,n){this.state=t,this.doc=e,this.line=r,this.maxLookAhead=n||0,this.baseTokens=null,this.baseTokenPos=1};function ft(e,t,r,n){var i=[e.state.modeGen],o={};xt(e,t.text,e.doc.mode,r,(function(e,t){return i.push(e,t)}),o,n);for(var s=r.state,a=function(n){r.baseTokens=i;var a=e.state.overlays[n],l=1,u=0;r.state=!0,xt(e,t.text,a.mode,r,(function(e,t){for(var r=l;u<e;){var n=i[l];n>e&&i.splice(l,1,e,i[l+1],n),l+=2,u=Math.min(e,n)}if(t)if(a.opaque)i.splice(r,l-r,e,"overlay "+t),l=r+2;else for(;r<l;r+=2){var o=i[r+1];i[r+1]=(o?o+" ":"")+"overlay "+t}}),o),r.state=s,r.baseTokens=null,r.baseTokenPos=1},l=0;l<e.state.overlays.length;++l)a(l);return{styles:i,classes:o.bgClass||o.textClass?o:null}}function ht(e,t,r){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=pt(e,Ke(t)),i=t.text.length>e.options.maxHighlightLength&&Ge(e.doc.mode,n.state),o=ft(e,t,n);i&&(n.state=i),t.stateAfter=n.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),r===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function pt(e,t,r){var n=e.doc,i=e.display;if(!n.mode.startState)return new ct(n,!0,t);var o=function(e,t,r){for(var n,i,o=e.doc,s=r?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>s;--a){if(a<=o.first)return o.first;var l=He(o,a-1),u=l.stateAfter;if(u&&(!r||a+(u instanceof ut?u.lookAhead:0)<=o.modeFrontier))return a;var c=B(l.text,null,e.options.tabSize);(null==i||n>c)&&(i=a-1,n=c)}return i}(e,t,r),s=o>n.first&&He(n,o-1).stateAfter,a=s?ct.fromSaved(n,s,o):new ct(n,qe(n.mode),o);return n.iter(o,t,(function(r){dt(e,r.text,a);var n=a.line;r.stateAfter=n==t-1||n%5==0||n>=i.viewFrom&&n<i.viewTo?a.save():null,a.nextLine()})),r&&(n.modeFrontier=a.line),a}function dt(e,t,r,n){var i=e.doc.mode,o=new Xe(t,e.options.tabSize,r);for(o.start=o.pos=n||0,""==t&&gt(i,r.state);!o.eol();)vt(i,o,r.state),o.start=o.pos}function gt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var r=ze(e,t);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function vt(e,t,r,n){for(var i=0;i<10;i++){n&&(n[0]=ze(e,r).mode);var o=e.token(t,r);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}ct.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ct.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ct.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},ct.fromSaved=function(e,t,r){return t instanceof ut?new ct(e,Ge(e.mode,t.state),r,t.lookAhead):new ct(e,Ge(e.mode,t),r)},ct.prototype.save=function(e){var t=!1!==e?Ge(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ut(t,this.maxLookAhead):t};var yt=function(e,t,r){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=r};function mt(e,t,r,n){var i,o,s=e.doc,a=s.mode,l=He(s,(t=at(s,t)).line),u=pt(e,t.line,r),c=new Xe(l.text,e.options.tabSize,u);for(n&&(o=[]);(n||c.pos<t.ch)&&!c.eol();)c.start=c.pos,i=vt(a,c,u.state),n&&o.push(new yt(c,i,Ge(s.mode,u.state)));return n?o:new yt(c,i,u.state)}function bt(e,t){if(e)for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var n=r[1]?"bgClass":"textClass";null==t[n]?t[n]=r[2]:new RegExp("(?:^|\\s)"+r[2]+"(?:$|\\s)").test(t[n])||(t[n]+=" "+r[2])}return e}function xt(e,t,r,n,i,o,s){var a=r.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,u=0,c=null,f=new Xe(t,e.options.tabSize,n),h=e.options.addModeClass&&[null];for(""==t&&bt(gt(r,n.state),o);!f.eol();){if(f.pos>e.options.maxHighlightLength?(a=!1,s&&dt(e,t,n,f.pos),f.pos=t.length,l=null):l=bt(vt(r,f,n.state,h),o),h){var p=h[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!a||c!=l){for(;u<f.start;)i(u=Math.min(f.start,u+5e3),c);c=l}f.start=f.pos}for(;u<f.pos;){var d=Math.min(f.pos,u+5e3);i(d,c),u=d}}var wt=!1,kt=!1;function Ct(e,t,r){this.marker=e,this.from=t,this.to=r}function St(e,t){if(e)for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t)return n}}function Ft(e,t){for(var r,n=0;n<e.length;++n)e[n]!=t&&(r||(r=[])).push(e[n]);return r}function _t(e,t){if(t.full)return null;var r=$e(e,t.from.line)&&He(e,t.from.line).markedSpans,n=$e(e,t.to.line)&&He(e,t.to.line).markedSpans;if(!r&&!n)return null;var i=t.from.ch,o=t.to.ch,s=0==tt(t.from,t.to),a=function(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var o=e[i],s=o.marker;if(null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t)||o.from==t&&"bookmark"==s.type&&(!r||!o.marker.insertLeft)){var a=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);(n||(n=[])).push(new Ct(s,o.from,a?null:o.to))}}return n}(r,i,s),l=function(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var o=e[i],s=o.marker;if(null==o.to||(s.inclusiveRight?o.to>=t:o.to>t)||o.from==t&&"bookmark"==s.type&&(!r||o.marker.insertLeft)){var a=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);(n||(n=[])).push(new Ct(s,a?null:o.from-t,null==o.to?null:o.to-t))}}return n}(n,o,s),u=1==t.text.length,c=V(t.text).length+(u?i:0);if(a)for(var f=0;f<a.length;++f){var h=a[f];if(null==h.to){var p=St(l,h.marker);p?u&&(h.to=null==p.to?null:p.to+c):h.to=i}}if(l)for(var d=0;d<l.length;++d){var g=l[d];if(null!=g.to&&(g.to+=c),null==g.from)St(a,g.marker)||(g.from=c,u&&(a||(a=[])).push(g));else g.from+=c,u&&(a||(a=[])).push(g)}a&&(a=At(a)),l&&l!=a&&(l=At(l));var v=[a];if(!u){var y,m=t.text.length-2;if(m>0&&a)for(var b=0;b<a.length;++b)null==a[b].to&&(y||(y=[])).push(new Ct(a[b].marker,null,null));for(var x=0;x<m;++x)v.push(y);v.push(l)}return v}function At(e){for(var t=0;t<e.length;++t){var r=e[t];null!=r.from&&r.from==r.to&&!1!==r.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Et(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function Lt(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}function Tt(e){return e.inclusiveLeft?-1:0}function Nt(e){return e.inclusiveRight?1:0}function Mt(e,t){var r=e.lines.length-t.lines.length;if(0!=r)return r;var n=e.find(),i=t.find(),o=tt(n.from,i.from)||Tt(e)-Tt(t);if(o)return-o;var s=tt(n.to,i.to)||Nt(e)-Nt(t);return s||t.id-e.id}function It(e,t){var r,n=kt&&e.markedSpans;if(n)for(var i=void 0,o=0;o<n.length;++o)(i=n[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!r||Mt(r,i.marker)<0)&&(r=i.marker);return r}function jt(e){return It(e,!0)}function Ot(e){return It(e,!1)}function Dt(e,t){var r,n=kt&&e.markedSpans;if(n)for(var i=0;i<n.length;++i){var o=n[i];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!r||Mt(r,o.marker)<0)&&(r=o.marker)}return r}function Rt(e,t,r,n,i){var o=He(e,t),s=kt&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var u=l.marker.find(0),c=tt(u.from,r)||Tt(l.marker)-Tt(i),f=tt(u.to,n)||Nt(l.marker)-Nt(i);if(!(c>=0&&f<=0||c<=0&&f>=0)&&(c<=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?tt(u.to,r)>=0:tt(u.to,r)>0)||c>=0&&(l.marker.inclusiveRight&&i.inclusiveLeft?tt(u.from,n)<=0:tt(u.from,n)<0)))return!0}}}function Bt(e){for(var t;t=jt(e);)e=t.find(-1,!0).line;return e}function Pt(e,t){var r=He(e,t),n=Bt(r);return r==n?t:Ke(n)}function Qt(e,t){if(t>e.lastLine())return t;var r,n=He(e,t);if(!Ut(e,n))return t;for(;r=Ot(n);)n=r.find(1,!0).line;return Ke(n)+1}function Ut(e,t){var r=kt&&t.markedSpans;if(r)for(var n=void 0,i=0;i<r.length;++i)if((n=r[i]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Gt(e,t,n))return!0}}function Gt(e,t,r){if(null==r.to){var n=r.marker.find(1,!0);return Gt(e,n.line,St(n.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==t.text.length)return!0;for(var i=void 0,o=0;o<t.markedSpans.length;++o)if((i=t.markedSpans[o]).marker.collapsed&&!i.marker.widgetNode&&i.from==r.to&&(null==i.to||i.to!=r.from)&&(i.marker.inclusiveLeft||r.marker.inclusiveRight)&&Gt(e,t,i))return!0}function zt(e){for(var t=0,r=(e=Bt(e)).parent,n=0;n<r.lines.length;++n){var i=r.lines[n];if(i==e)break;t+=i.height}for(var o=r.parent;o;o=(r=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==r)break;t+=a.height}return t}function qt(e){if(0==e.height)return 0;for(var t,r=e.text.length,n=e;t=jt(n);){var i=t.find(0,!0);n=i.from.line,r+=i.from.ch-i.to.ch}for(n=e;t=Ot(n);){var o=t.find(0,!0);r-=n.text.length-o.from.ch,r+=(n=o.to.line).text.length-o.to.ch}return r}function Xt(e){var t=e.display,r=e.doc;t.maxLine=He(r,r.first),t.maxLineLength=qt(t.maxLine),t.maxLineChanged=!0,r.iter((function(e){var r=qt(e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)}))}var Ht=function(e,t,r){this.text=e,Lt(this,t),this.height=r?r(this):1};function Wt(e){e.parent=null,Et(e)}Ht.prototype.lineNo=function(){return Ke(this)},me(Ht);var Vt={},Jt={};function Kt(e,t){if(!e||/^\s*$/.test(e))return null;var r=t.addModeClass?Jt:Vt;return r[e]||(r[e]=e.replace(/\S+/g,"cm-$&"))}function Yt(e,t){var r=T("span",null,null,l?"padding-right: .1px":null),n={pre:T("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o=i?t.rest[i-1]:t.line,s=void 0;n.pos=0,n.addToken=Zt,Le(e.display.measure)&&(s=ue(o,e.doc.direction))&&(n.addToken=er(n.addToken,s)),n.map=[],rr(o,n,ht(e,o,t!=e.display.externalMeasured&&Ke(o))),o.styleClasses&&(o.styleClasses.bgClass&&(n.bgClass=j(o.styleClasses.bgClass,n.bgClass||"")),o.styleClasses.textClass&&(n.textClass=j(o.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Ee(e.display.measure))),0==i?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(l){var a=n.content.lastChild;(/\bcm-tab\b/.test(a.className)||a.querySelector&&a.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack")}return de(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=j(n.pre.className,n.textClass||"")),n}function $t(e){var t=L("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Zt(e,t,r,n,i,o,l){if(t){var u,c=e.splitSpaces?function(e,t){if(e.length>1&&!/  /.test(e))return e;for(var r=t,n="",i=0;i<e.length;i++){var o=e.charAt(i);" "!=o||!r||i!=e.length-1&&32!=e.charCodeAt(i+1)||(o=" "),n+=o,r=" "==o}return n}(t,e.trailingSpace):t,f=e.cm.state.specialChars,h=!1;if(f.test(t)){u=document.createDocumentFragment();for(var p=0;;){f.lastIndex=p;var d=f.exec(t),g=d?d.index-p:t.length-p;if(g){var v=document.createTextNode(c.slice(p,p+g));s&&a<9?u.appendChild(L("span",[v])):u.appendChild(v),e.map.push(e.pos,e.pos+g,v),e.col+=g,e.pos+=g}if(!d)break;p+=g+1;var y=void 0;if("\t"==d[0]){var m=e.cm.options.tabSize,b=m-e.col%m;(y=u.appendChild(L("span",W(b),"cm-tab"))).setAttribute("role","presentation"),y.setAttribute("cm-text","\t"),e.col+=b}else"\r"==d[0]||"\n"==d[0]?((y=u.appendChild(L("span","\r"==d[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",d[0]),e.col+=1):((y=e.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),s&&a<9?u.appendChild(L("span",[y])):u.appendChild(y),e.col+=1);e.map.push(e.pos,e.pos+1,y),e.pos++}}else e.col+=t.length,u=document.createTextNode(c),e.map.push(e.pos,e.pos+t.length,u),s&&a<9&&(h=!0),e.pos+=t.length;if(e.trailingSpace=32==c.charCodeAt(t.length-1),r||n||i||h||o||l){var x=r||"";n&&(x+=n),i&&(x+=i);var w=L("span",[u],x,o);if(l)for(var k in l)l.hasOwnProperty(k)&&"style"!=k&&"class"!=k&&w.setAttribute(k,l[k]);return e.content.appendChild(w)}e.content.appendChild(u)}}function er(e,t){return function(r,n,i,o,s,a,l){i=i?i+" cm-force-border":"cm-force-border";for(var u=r.pos,c=u+n.length;;){for(var f=void 0,h=0;h<t.length&&!((f=t[h]).to>u&&f.from<=u);h++);if(f.to>=c)return e(r,n,i,o,s,a,l);e(r,n.slice(0,f.to-u),i,o,null,a,l),o=null,n=n.slice(f.to-u),u=f.to}}}function tr(e,t,r,n){var i=!n&&r.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!n&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",r.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function rr(e,t,r){var n=e.markedSpans,i=e.text,o=0;if(n)for(var s,a,l,u,c,f,h,p=i.length,d=0,g=1,v="",y=0;;){if(y==d){l=u=c=a="",h=null,f=null,y=1/0;for(var m=[],b=void 0,x=0;x<n.length;++x){var w=n[x],k=w.marker;if("bookmark"==k.type&&w.from==d&&k.widgetNode)m.push(k);else if(w.from<=d&&(null==w.to||w.to>d||k.collapsed&&w.to==d&&w.from==d)){if(null!=w.to&&w.to!=d&&y>w.to&&(y=w.to,u=""),k.className&&(l+=" "+k.className),k.css&&(a=(a?a+";":"")+k.css),k.startStyle&&w.from==d&&(c+=" "+k.startStyle),k.endStyle&&w.to==y&&(b||(b=[])).push(k.endStyle,w.to),k.title&&((h||(h={})).title=k.title),k.attributes)for(var C in k.attributes)(h||(h={}))[C]=k.attributes[C];k.collapsed&&(!f||Mt(f.marker,k)<0)&&(f=w)}else w.from>d&&y>w.from&&(y=w.from)}if(b)for(var S=0;S<b.length;S+=2)b[S+1]==y&&(u+=" "+b[S]);if(!f||f.from==d)for(var F=0;F<m.length;++F)tr(t,0,m[F]);if(f&&(f.from||0)==d){if(tr(t,(null==f.to?p+1:f.to)-d,f.marker,null==f.from),null==f.to)return;f.to==d&&(f=!1)}}if(d>=p)break;for(var _=Math.min(p,y);;){if(v){var A=d+v.length;if(!f){var E=A>_?v.slice(0,_-d):v;t.addToken(t,E,s?s+l:l,c,d+E.length==y?u:"",a,h)}if(A>=_){v=v.slice(_-d),d=_;break}d=A,c=""}v=i.slice(o,o=r[g++]),s=Kt(r[g++],t.cm.options)}}else for(var L=1;L<r.length;L+=2)t.addToken(t,i.slice(o,o=r[L]),Kt(r[L+1],t.cm.options))}function nr(e,t,r){this.line=t,this.rest=function(e){for(var t,r;t=Ot(e);)e=t.find(1,!0).line,(r||(r=[])).push(e);return r}(t),this.size=this.rest?Ke(V(this.rest))-r+1:1,this.node=this.text=null,this.hidden=Ut(e,t)}function ir(e,t,r){for(var n,i=[],o=t;o<r;o=n){var s=new nr(e.doc,He(e.doc,o),o);n=o+s.size,i.push(s)}return i}var or=null;var sr=null;function ar(e,t){var r=he(e,t);if(r.length){var n,i=Array.prototype.slice.call(arguments,2);or?n=or.delayedCallbacks:sr?n=sr:(n=sr=[],setTimeout(lr,0));for(var o=function(e){n.push((function(){return r[e].apply(null,i)}))},s=0;s<r.length;++s)o(s)}}function lr(){var e=sr;sr=null;for(var t=0;t<e.length;++t)e[t]()}function ur(e,t,r,n){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];"text"==o?hr(e,t):"gutter"==o?dr(e,t,r,n):"class"==o?pr(e,t):"widget"==o&&gr(e,t,n)}t.changes=null}function cr(e){return e.node==e.text&&(e.node=L("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),s&&a<8&&(e.node.style.zIndex=2)),e.node}function fr(e,t){var r=e.display.externalMeasured;return r&&r.line==t.line?(e.display.externalMeasured=null,t.measure=r.measure,r.built):Yt(e,t)}function hr(e,t){var r=t.text.className,n=fr(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,pr(e,t)):r&&(t.text.className=r)}function pr(e,t){!function(e,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(r&&(r+=" CodeMirror-linebackground"),t.background)r?t.background.className=r:(t.background.parentNode.removeChild(t.background),t.background=null);else if(r){var n=cr(t);t.background=n.insertBefore(L("div",null,r),n.firstChild),e.display.input.setUneditable(t.background)}}(e,t),t.line.wrapClass?cr(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var r=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=r||""}function dr(e,t,r,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var i=cr(t);t.gutterBackground=L("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),i.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var s=cr(t),a=t.gutter=L("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(e.display.input.setUneditable(a),s.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(L("div",Ze(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.display.gutterSpecs.length;++l){var u=e.display.gutterSpecs[l].className,c=o.hasOwnProperty(u)&&o[u];c&&a.appendChild(L("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[u]+"px; width: "+n.gutterWidth[u]+"px"))}}}function gr(e,t,r){t.alignable&&(t.alignable=null);for(var n=S("CodeMirror-linewidget"),i=t.node.firstChild,o=void 0;i;i=o)o=i.nextSibling,n.test(i.className)&&t.node.removeChild(i);yr(e,t,r)}function vr(e,t,r,n){var i=fr(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),pr(e,t),dr(e,t,r,n),yr(e,t,n),t.node}function yr(e,t,r){if(mr(e,t.line,t,r,!0),t.rest)for(var n=0;n<t.rest.length;n++)mr(e,t.rest[n],t,r,!1)}function mr(e,t,r,n,i){if(t.widgets)for(var o=cr(r),s=0,a=t.widgets;s<a.length;++s){var l=a[s],u=L("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:""));l.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),br(l,u,r,n),e.display.input.setUneditable(u),i&&l.above?o.insertBefore(u,r.gutter||r.text):o.appendChild(u),ar(l,"redraw")}}function br(e,t,r,n){if(e.noHScroll){(r.alignable||(r.alignable=[])).push(t);var i=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(i-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function xr(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!N(document.body,e.node)){var r="position: relative;";e.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),E(t.display.measure,L("div",[e.node],null,r))}return e.height=e.node.parentNode.offsetHeight}function wr(e,t){for(var r=Ce(t);r!=e.wrapper;r=r.parentNode)if(!r||1==r.nodeType&&"true"==r.getAttribute("cm-ignore-events")||r.parentNode==e.sizer&&r!=e.mover)return!0}function kr(e){return e.lineSpace.offsetTop}function Cr(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Sr(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=E(e.measure,L("pre","x","CodeMirror-line-like")),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function Fr(e){return 50-e.display.nativeBarWidth}function _r(e){return e.display.scroller.clientWidth-Fr(e)-e.display.barWidth}function Ar(e){return e.display.scroller.clientHeight-Fr(e)-e.display.barHeight}function Er(e,t,r){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var i=0;i<e.rest.length;i++)if(Ke(e.rest[i])>r)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Lr(e,t,r,n){return Mr(e,Nr(e,t),r,n)}function Tr(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[cn(e,t)];var r=e.display.externalMeasured;return r&&t>=r.lineN&&t<r.lineN+r.size?r:void 0}function Nr(e,t){var r=Ke(t),n=Tr(e,r);n&&!n.text?n=null:n&&n.changes&&(ur(e,n,r,on(e)),e.curOp.forceUpdate=!0),n||(n=function(e,t){var r=Ke(t=Bt(t)),n=e.display.externalMeasured=new nr(e.doc,t,r);n.lineN=r;var i=n.built=Yt(e,n);return n.text=i.pre,E(e.display.lineMeasure,i.pre),n}(e,t));var i=Er(n,t,r);return{line:t,view:n,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function Mr(e,t,r,n,i){t.before&&(r=-1);var o,l=r+(n||"");return t.cache.hasOwnProperty(l)?o=t.cache[l]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(!function(e,t,r){var n=e.options.lineWrapping,i=n&&_r(e);if(!t.measure.heights||n&&t.measure.width!=i){var o=t.measure.heights=[];if(n){t.measure.width=i;for(var s=t.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],u=s[a+1];Math.abs(l.bottom-u.bottom)>2&&o.push((l.bottom+u.top)/2-r.top)}}o.push(r.bottom-r.top)}}(e,t.view,t.rect),t.hasHeights=!0),(o=function(e,t,r,n){var i,o=Or(t.map,r,n),l=o.node,u=o.start,c=o.end,f=o.collapse;if(3==l.nodeType){for(var h=0;h<4;h++){for(;u&&ne(t.line.text.charAt(o.coverStart+u));)--u;for(;o.coverStart+c<o.coverEnd&&ne(t.line.text.charAt(o.coverStart+c));)++c;if((i=s&&a<9&&0==u&&c==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():Dr(F(l,u,c).getClientRects(),n)).left||i.right||0==u)break;c=u,u-=1,f="right"}s&&a<11&&(i=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=je)return je;var t=E(e,L("span","x")),r=t.getBoundingClientRect(),n=F(t,0,1).getBoundingClientRect();return je=Math.abs(r.left-n.left)>1}(e))return t;var r=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*r,right:t.right*r,top:t.top*n,bottom:t.bottom*n}}(e.display.measure,i))}else{var p;u>0&&(f=n="right"),i=e.options.lineWrapping&&(p=l.getClientRects()).length>1?p["right"==n?p.length-1:0]:l.getBoundingClientRect()}if(s&&a<9&&!u&&(!i||!i.left&&!i.right)){var d=l.parentNode.getClientRects()[0];i=d?{left:d.left,right:d.left+nn(e.display),top:d.top,bottom:d.bottom}:jr}for(var g=i.top-t.rect.top,v=i.bottom-t.rect.top,y=(g+v)/2,m=t.view.measure.heights,b=0;b<m.length-1&&!(y<m[b]);b++);var x=b?m[b-1]:0,w=m[b],k={left:("right"==f?i.right:i.left)-t.rect.left,right:("left"==f?i.left:i.right)-t.rect.left,top:x,bottom:w};i.left||i.right||(k.bogus=!0);e.options.singleCursorHeightPerLine||(k.rtop=g,k.rbottom=v);return k}(e,t,r,n)).bogus||(t.cache[l]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var Ir,jr={left:0,right:0,top:0,bottom:0};function Or(e,t,r){for(var n,i,o,s,a,l,u=0;u<e.length;u+=3)if(a=e[u],l=e[u+1],t<a?(i=0,o=1,s="left"):t<l?o=(i=t-a)+1:(u==e.length-3||t==l&&e[u+3]>t)&&(i=(o=l-a)-1,t>=l&&(s="right")),null!=i){if(n=e[u+2],a==l&&r==(n.insertLeft?"left":"right")&&(s=r),"left"==r&&0==i)for(;u&&e[u-2]==e[u-3]&&e[u-1].insertLeft;)n=e[2+(u-=3)],s="left";if("right"==r&&i==l-a)for(;u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft;)n=e[(u+=3)+2],s="right";break}return{node:n,start:i,end:o,collapse:s,coverStart:a,coverEnd:l}}function Dr(e,t){var r=jr;if("left"==t)for(var n=0;n<e.length&&(r=e[n]).left==r.right;n++);else for(var i=e.length-1;i>=0&&(r=e[i]).left==r.right;i--);return r}function Rr(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Br(e){e.display.externalMeasure=null,A(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Rr(e.display.view[t])}function Pr(e){Br(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Qr(){return c&&v?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Ur(){return c&&v?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Gr(e){var t=0;if(e.widgets)for(var r=0;r<e.widgets.length;++r)e.widgets[r].above&&(t+=xr(e.widgets[r]));return t}function zr(e,t,r,n,i){if(!i){var o=Gr(t);r.top+=o,r.bottom+=o}if("line"==n)return r;n||(n="local");var s=zt(t);if("local"==n?s+=kr(e.display):s-=e.display.viewOffset,"page"==n||"window"==n){var a=e.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==n?0:Ur());var l=a.left+("window"==n?0:Qr());r.left+=l,r.right+=l}return r.top+=s,r.bottom+=s,r}function qr(e,t,r){if("div"==r)return t;var n=t.left,i=t.top;if("page"==r)n-=Qr(),i-=Ur();else if("local"==r||!r){var o=e.display.sizer.getBoundingClientRect();n+=o.left,i+=o.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:i-s.top}}function Xr(e,t,r,n,i){return n||(n=He(e.doc,t.line)),zr(e,n,Lr(e,n,t.ch,i),r)}function Hr(e,t,r,n,i,o){function s(t,s){var a=Mr(e,i,t,s?"right":"left",o);return s?a.left=a.right:a.right=a.left,zr(e,n,a,r)}n=n||He(e.doc,t.line),i||(i=Nr(e,n));var a=ue(n,e.doc.direction),l=t.ch,u=t.sticky;if(l>=n.text.length?(l=n.text.length,u="before"):l<=0&&(l=0,u="after"),!a)return s("before"==u?l-1:l,"before"==u);function c(e,t,r){return s(r?e-1:e,1==a[t].level!=r)}var f=ae(a,l,u),h=se,p=c(l,f,"before"==u);return null!=h&&(p.other=c(l,h,"before"!=u)),p}function Wr(e,t){var r=0;t=at(e.doc,t),e.options.lineWrapping||(r=nn(e.display)*t.ch);var n=He(e.doc,t.line),i=zt(n)+kr(e.display);return{left:r,right:r,top:i,bottom:i+n.height}}function Vr(e,t,r,n,i){var o=et(e,t,r);return o.xRel=i,n&&(o.outside=n),o}function Jr(e,t,r){var n=e.doc;if((r+=e.display.viewOffset)<0)return Vr(n.first,0,null,-1,-1);var i=Ye(n,r),o=n.first+n.size-1;if(i>o)return Vr(n.first+n.size-1,He(n,o).text.length,null,1,1);t<0&&(t=0);for(var s=He(n,i);;){var a=Zr(e,s,i,t,r),l=Dt(s,a.ch+(a.xRel>0||a.outside>0?1:0));if(!l)return a;var u=l.find(1);if(u.line==i)return u;s=He(n,i=u.line)}}function Kr(e,t,r,n){n-=Gr(t);var i=t.text.length,o=oe((function(t){return Mr(e,r,t-1).bottom<=n}),i,0);return{begin:o,end:i=oe((function(t){return Mr(e,r,t).top>n}),o,i)}}function Yr(e,t,r,n){return r||(r=Nr(e,t)),Kr(e,t,r,zr(e,t,Mr(e,r,n),"line").top)}function $r(e,t,r,n){return!(e.bottom<=r)&&(e.top>r||(n?e.left:e.right)>t)}function Zr(e,t,r,n,i){i-=zt(t);var o=Nr(e,t),s=Gr(t),a=0,l=t.text.length,u=!0,c=ue(t,e.doc.direction);if(c){var f=(e.options.lineWrapping?tn:en)(e,t,r,o,c,n,i);a=(u=1!=f.level)?f.from:f.to-1,l=u?f.to:f.from-1}var h,p,d=null,g=null,v=oe((function(t){var r=Mr(e,o,t);return r.top+=s,r.bottom+=s,!!$r(r,n,i,!1)&&(r.top<=i&&r.left<=n&&(d=t,g=r),!0)}),a,l),y=!1;if(g){var m=n-g.left<g.right-n,b=m==u;v=d+(b?0:1),p=b?"after":"before",h=m?g.left:g.right}else{u||v!=l&&v!=a||v++,p=0==v?"after":v==t.text.length?"before":Mr(e,o,v-(u?1:0)).bottom+s<=i==u?"after":"before";var x=Hr(e,et(r,v,p),"line",t,o);h=x.left,y=i<x.top?-1:i>=x.bottom?1:0}return Vr(r,v=ie(t.text,v,1),p,y,n-h)}function en(e,t,r,n,i,o,s){var a=oe((function(a){var l=i[a],u=1!=l.level;return $r(Hr(e,et(r,u?l.to:l.from,u?"before":"after"),"line",t,n),o,s,!0)}),0,i.length-1),l=i[a];if(a>0){var u=1!=l.level,c=Hr(e,et(r,u?l.from:l.to,u?"after":"before"),"line",t,n);$r(c,o,s,!0)&&c.top>s&&(l=i[a-1])}return l}function tn(e,t,r,n,i,o,s){var a=Kr(e,t,n,s),l=a.begin,u=a.end;/\s/.test(t.text.charAt(u-1))&&u--;for(var c=null,f=null,h=0;h<i.length;h++){var p=i[h];if(!(p.from>=u||p.to<=l)){var d=Mr(e,n,1!=p.level?Math.min(u,p.to)-1:Math.max(l,p.from)).right,g=d<o?o-d+1e9:d-o;(!c||f>g)&&(c=p,f=g)}}return c||(c=i[i.length-1]),c.from<l&&(c={from:l,to:c.to,level:c.level}),c.to>u&&(c={from:c.from,to:u,level:c.level}),c}function rn(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Ir){Ir=L("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)Ir.appendChild(document.createTextNode("x")),Ir.appendChild(L("br"));Ir.appendChild(document.createTextNode("x"))}E(e.measure,Ir);var r=Ir.offsetHeight/50;return r>3&&(e.cachedTextHeight=r),A(e.measure),r||1}function nn(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=L("span","xxxxxxxxxx"),r=L("pre",[t],"CodeMirror-line-like");E(e.measure,r);var n=t.getBoundingClientRect(),i=(n.right-n.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function on(e){for(var t=e.display,r={},n={},i=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;r[a]=o.offsetLeft+o.clientLeft+i,n[a]=o.clientWidth}return{fixedPos:sn(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function sn(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function an(e){var t=rn(e.display),r=e.options.lineWrapping,n=r&&Math.max(5,e.display.scroller.clientWidth/nn(e.display)-3);return function(i){if(Ut(e.doc,i))return 0;var o=0;if(i.widgets)for(var s=0;s<i.widgets.length;s++)i.widgets[s].height&&(o+=i.widgets[s].height);return r?o+(Math.ceil(i.text.length/n)||1)*t:o+t}}function ln(e){var t=e.doc,r=an(e);t.iter((function(e){var t=r(e);t!=e.height&&Je(e,t)}))}function un(e,t,r,n){var i=e.display;if(!r&&"true"==Ce(t).getAttribute("cm-not-content"))return null;var o,s,a=i.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,s=t.clientY-a.top}catch(f){return null}var l,u=Jr(e,o,s);if(n&&u.xRel>0&&(l=He(e.doc,u.line).text).length==u.ch){var c=B(l,l.length,e.options.tabSize)-l.length;u=et(u.line,Math.max(0,Math.round((o-Sr(e.display).left)/nn(e.display))-c))}return u}function cn(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var r=e.display.view,n=0;n<r.length;n++)if((t-=r[n].size)<0)return n}function fn(e,t,r,n){null==t&&(t=e.doc.first),null==r&&(r=e.doc.first+e.doc.size),n||(n=0);var i=e.display;if(n&&r<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)kt&&Pt(e.doc,t)<i.viewTo&&pn(e);else if(r<=i.viewFrom)kt&&Qt(e.doc,r+n)>i.viewFrom?pn(e):(i.viewFrom+=n,i.viewTo+=n);else if(t<=i.viewFrom&&r>=i.viewTo)pn(e);else if(t<=i.viewFrom){var o=dn(e,r,r+n,1);o?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=n):pn(e)}else if(r>=i.viewTo){var s=dn(e,t,t,-1);s?(i.view=i.view.slice(0,s.index),i.viewTo=s.lineN):pn(e)}else{var a=dn(e,t,t,-1),l=dn(e,r,r+n,1);a&&l?(i.view=i.view.slice(0,a.index).concat(ir(e,a.lineN,l.lineN)).concat(i.view.slice(l.index)),i.viewTo+=n):pn(e)}var u=i.externalMeasured;u&&(r<u.lineN?u.lineN+=n:t<u.lineN+u.size&&(i.externalMeasured=null))}function hn(e,t,r){e.curOp.viewChanged=!0;var n=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var o=n.view[cn(e,t)];if(null!=o.node){var s=o.changes||(o.changes=[]);-1==Q(s,r)&&s.push(r)}}}function pn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function dn(e,t,r,n){var i,o=cn(e,t),s=e.display.view;if(!kt||r==e.doc.first+e.doc.size)return{index:o,lineN:r};for(var a=e.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=t){if(n>0){if(o==s.length-1)return null;i=a+s[o].size-t,o++}else i=a-t;t+=i,r+=i}for(;Pt(e.doc,r)!=r;){if(o==(n<0?0:s.length-1))return null;r+=n*s[o-(n<0?1:0)].size,o+=n}return{index:o,lineN:r}}function gn(e){for(var t=e.display.view,r=0,n=0;n<t.length;n++){var i=t[n];i.hidden||i.node&&!i.changes||++r}return r}function vn(e){e.display.input.showSelection(e.display.input.prepareSelection())}function yn(e,t){void 0===t&&(t=!0);for(var r=e.doc,n={},i=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),s=0;s<r.sel.ranges.length;s++)if(t||s!=r.sel.primIndex){var a=r.sel.ranges[s];if(!(a.from().line>=e.display.viewTo||a.to().line<e.display.viewFrom)){var l=a.empty();(l||e.options.showCursorWhenSelecting)&&mn(e,a.head,i),l||xn(e,a,o)}}return n}function mn(e,t,r){var n=Hr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=r.appendChild(L("div"," ","CodeMirror-cursor"));if(i.style.left=n.left+"px",i.style.top=n.top+"px",i.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var o=r.appendChild(L("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=n.other.left+"px",o.style.top=n.other.top+"px",o.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function bn(e,t){return e.top-t.top||e.left-t.left}function xn(e,t,r){var n=e.display,i=e.doc,o=document.createDocumentFragment(),s=Sr(e.display),a=s.left,l=Math.max(n.sizerWidth,_r(e)-n.sizer.offsetLeft)-s.right,u="ltr"==i.direction;function c(e,t,r,n){t<0&&(t=0),t=Math.round(t),n=Math.round(n),o.appendChild(L("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==r?l-e:r)+"px;\n                             height: "+(n-t)+"px"))}function f(t,r,n){var o,s,f=He(i,t),h=f.text.length;function p(r,n){return Xr(e,et(t,r),"div",f,n)}function d(t,r,n){var i=Yr(e,f,null,t),o="ltr"==r==("after"==n)?"left":"right";return p("after"==n?i.begin:i.end-(/\s/.test(f.text.charAt(i.end-1))?2:1),o)[o]}var g=ue(f,i.direction);return function(e,t,r,n){if(!e)return n(t,r,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var s=e[o];(s.from<r&&s.to>t||t==r&&s.to==t)&&(n(Math.max(s.from,t),Math.min(s.to,r),1==s.level?"rtl":"ltr",o),i=!0)}i||n(t,r,"ltr")}(g,r||0,null==n?h:n,(function(e,t,i,f){var v="ltr"==i,y=p(e,v?"left":"right"),m=p(t-1,v?"right":"left"),b=null==r&&0==e,x=null==n&&t==h,w=0==f,k=!g||f==g.length-1;if(m.top-y.top<=3){var C=(u?x:b)&&k,S=(u?b:x)&&w?a:(v?y:m).left,F=C?l:(v?m:y).right;c(S,y.top,F-S,y.bottom)}else{var _,A,E,L;v?(_=u&&b&&w?a:y.left,A=u?l:d(e,i,"before"),E=u?a:d(t,i,"after"),L=u&&x&&k?l:m.right):(_=u?d(e,i,"before"):a,A=!u&&b&&w?l:y.right,E=!u&&x&&k?a:m.left,L=u?d(t,i,"after"):l),c(_,y.top,A-_,y.bottom),y.bottom<m.top&&c(a,y.bottom,null,m.top),c(E,m.top,L-E,m.bottom)}(!o||bn(y,o)<0)&&(o=y),bn(m,o)<0&&(o=m),(!s||bn(y,s)<0)&&(s=y),bn(m,s)<0&&(s=m)})),{start:o,end:s}}var h=t.from(),p=t.to();if(h.line==p.line)f(h.line,h.ch,p.ch);else{var d=He(i,h.line),g=He(i,p.line),v=Bt(d)==Bt(g),y=f(h.line,h.ch,v?d.text.length+1:null).end,m=f(p.line,v?0:null,p.ch).start;v&&(y.top<m.top-2?(c(y.right,y.top,null,y.bottom),c(a,m.top,m.left,m.bottom)):c(y.right,y.top,m.left-y.right,y.bottom)),y.bottom<m.top&&c(a,y.bottom,null,m.top)}r.appendChild(o)}function wn(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var r=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval((function(){e.hasFocus()||Fn(e),t.cursorDiv.style.visibility=(r=!r)?"":"hidden"}),e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function kn(e){e.state.focused||(e.display.input.focus(),Sn(e))}function Cn(e){e.state.delayingBlurEvent=!0,setTimeout((function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,Fn(e))}),100)}function Sn(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(de(e,"focus",e,t),e.state.focused=!0,I(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),l&&setTimeout((function(){return e.display.input.reset(!0)}),20)),e.display.input.receivedFocus()),wn(e))}function Fn(e,t){e.state.delayingBlurEvent||(e.state.focused&&(de(e,"blur",e,t),e.state.focused=!1,_(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout((function(){e.state.focused||(e.display.shift=!1)}),150))}function _n(e){for(var t=e.display,r=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var i=t.view[n],o=e.options.lineWrapping,l=void 0,u=0;if(!i.hidden){if(s&&a<8){var c=i.node.offsetTop+i.node.offsetHeight;l=c-r,r=c}else{var f=i.node.getBoundingClientRect();l=f.bottom-f.top,!o&&i.text.firstChild&&(u=i.text.firstChild.getBoundingClientRect().right-f.left-1)}var h=i.line.height-l;if((h>.005||h<-.005)&&(Je(i.line,l),An(i.line),i.rest))for(var p=0;p<i.rest.length;p++)An(i.rest[p]);if(u>e.display.sizerWidth){var d=Math.ceil(u/nn(e.display));d>e.display.maxLineLength&&(e.display.maxLineLength=d,e.display.maxLine=i.line,e.display.maxLineChanged=!0)}}}}function An(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var r=e.widgets[t],n=r.node.parentNode;n&&(r.height=n.offsetHeight)}}function En(e,t,r){var n=r&&null!=r.top?Math.max(0,r.top):e.scroller.scrollTop;n=Math.floor(n-kr(e));var i=r&&null!=r.bottom?r.bottom:n+e.wrapper.clientHeight,o=Ye(t,n),s=Ye(t,i);if(r&&r.ensure){var a=r.ensure.from.line,l=r.ensure.to.line;a<o?(o=a,s=Ye(t,zt(He(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=s&&(o=Ye(t,zt(He(t,l))-e.wrapper.clientHeight),s=l)}return{from:o,to:Math.max(s,o+1)}}function Ln(e,t){var r=e.display,n=rn(e.display);t.top<0&&(t.top=0);var i=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:r.scroller.scrollTop,o=Ar(e),s={};t.bottom-t.top>o&&(t.bottom=t.top+o);var a=e.doc.height+Cr(r),l=t.top<n,u=t.bottom>a-n;if(t.top<i)s.scrollTop=l?0:t.top;else if(t.bottom>i+o){var c=Math.min(t.top,(u?a:t.bottom)-o);c!=i&&(s.scrollTop=c)}var f=e.options.fixedGutter?0:r.gutters.offsetWidth,h=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:r.scroller.scrollLeft-f,p=_r(e)-r.gutters.offsetWidth,d=t.right-t.left>p;return d&&(t.right=t.left+p),t.left<10?s.scrollLeft=0:t.left<h?s.scrollLeft=Math.max(0,t.left+f-(d?0:10)):t.right>p+h-3&&(s.scrollLeft=t.right+(d?0:10)-p),s}function Tn(e,t){null!=t&&(In(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function Nn(e){In(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Mn(e,t,r){null==t&&null==r||In(e),null!=t&&(e.curOp.scrollLeft=t),null!=r&&(e.curOp.scrollTop=r)}function In(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,jn(e,Wr(e,t.from),Wr(e,t.to),t.margin))}function jn(e,t,r,n){var i=Ln(e,{left:Math.min(t.left,r.left),top:Math.min(t.top,r.top)-n,right:Math.max(t.right,r.right),bottom:Math.max(t.bottom,r.bottom)+n});Mn(e,i.scrollLeft,i.scrollTop)}function On(e,t){Math.abs(e.doc.scrollTop-t)<2||(r||li(e,{top:t}),Dn(e,t,!0),r&&li(e),ni(e,100))}function Dn(e,t,r){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),(e.display.scroller.scrollTop!=t||r)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function Rn(e,t,r,n){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),(r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!n||(e.doc.scrollLeft=t,fi(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Bn(e){var t=e.display,r=t.gutters.offsetWidth,n=Math.round(e.doc.height+Cr(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:n,scrollHeight:n+Fr(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}var Pn=function(e,t,r){this.cm=r;var n=this.vert=L("div",[L("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=L("div",[L("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n.tabIndex=i.tabIndex=-1,e(n),e(i),fe(n,"scroll",(function(){n.clientHeight&&t(n.scrollTop,"vertical")})),fe(i,"scroll",(function(){i.clientWidth&&t(i.scrollLeft,"horizontal")})),this.checkedZeroWidth=!1,s&&a<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Pn.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(r){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var i=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=r?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(r?n:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?n:0,bottom:t?n:0}},Pn.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Pn.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Pn.prototype.zeroWidthHack=function(){var e=m&&!p?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new P,this.disableVert=new P},Pn.prototype.enableZeroWidthBar=function(e,t,r){e.style.pointerEvents="auto",t.set(1e3,(function n(){var i=e.getBoundingClientRect();("vert"==r?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1))!=e?e.style.pointerEvents="none":t.set(1e3,n)}))},Pn.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var Qn=function(){};function Un(e,t){t||(t=Bn(e));var r=e.display.barWidth,n=e.display.barHeight;Gn(e,t);for(var i=0;i<4&&r!=e.display.barWidth||n!=e.display.barHeight;i++)r!=e.display.barWidth&&e.options.lineWrapping&&_n(e),Gn(e,Bn(e)),r=e.display.barWidth,n=e.display.barHeight}function Gn(e,t){var r=e.display,n=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=n.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=n.bottom)+"px",r.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=n.bottom+"px",r.scrollbarFiller.style.width=n.right+"px"):r.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=n.bottom+"px",r.gutterFiller.style.width=t.gutterWidth+"px"):r.gutterFiller.style.display=""}Qn.prototype.update=function(){return{bottom:0,right:0}},Qn.prototype.setScrollLeft=function(){},Qn.prototype.setScrollTop=function(){},Qn.prototype.clear=function(){};var zn={native:Pn,null:Qn};function qn(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&_(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new zn[e.options.scrollbarStyle]((function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),fe(t,"mousedown",(function(){e.state.focused&&setTimeout((function(){return e.display.input.focus()}),0)})),t.setAttribute("cm-not-content","true")}),(function(t,r){"horizontal"==r?Rn(e,t):On(e,t)}),e),e.display.scrollbars.addClass&&I(e.display.wrapper,e.display.scrollbars.addClass)}var Xn=0;function Hn(e){var t;e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Xn},t=e.curOp,or?or.ops.push(t):t.ownsGroup=or={ops:[t],delayedCallbacks:[]}}function Wn(e){var t=e.curOp;t&&function(e,t){var r=e.ownsGroup;if(r)try{!function(e){var t=e.delayedCallbacks,r=0;do{for(;r<t.length;r++)t[r].call(null);for(var n=0;n<e.ops.length;n++){var i=e.ops[n];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(r<t.length)}(r)}finally{or=null,t(r)}}(t,(function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;!function(e){for(var t=e.ops,r=0;r<t.length;r++)Vn(t[r]);for(var n=0;n<t.length;n++)Jn(t[n]);for(var i=0;i<t.length;i++)Kn(t[i]);for(var o=0;o<t.length;o++)Yn(t[o]);for(var s=0;s<t.length;s++)$n(t[s])}(e)}))}function Vn(e){var t=e.cm,r=t.display;!function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Fr(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Fr(e)+"px",t.scrollbarsClipped=!0)}(t),e.updateMaxLine&&Xt(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<r.viewFrom||e.scrollToPos.to.line>=r.viewTo)||r.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new oi(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Jn(e){e.updatedDisplay=e.mustUpdate&&si(e.cm,e.update)}function Kn(e){var t=e.cm,r=t.display;e.updatedDisplay&&_n(t),e.barMeasure=Bn(t),r.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Lr(t,r.maxLine,r.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+e.adjustWidthTo+Fr(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+e.adjustWidthTo-_r(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=r.input.prepareSelection())}function Yn(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Rn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var r=e.focus&&e.focus==M();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,r),(e.updatedDisplay||e.startHeight!=t.doc.height)&&Un(t,e.barMeasure),e.updatedDisplay&&ci(t,e.barMeasure),e.selectionChanged&&wn(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),r&&kn(e.cm)}function $n(e){var t=e.cm,r=t.display,n=t.doc;(e.updatedDisplay&&ai(t,e.update),null==r.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null!=e.scrollTop&&Dn(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&Rn(t,e.scrollLeft,!0,!0),e.scrollToPos)&&function(e,t){if(!ge(e,"scrollCursorIntoView")){var r=e.display,n=r.sizer.getBoundingClientRect(),i=null;if(t.top+n.top<0?i=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!d){var o=L("div","​",null,"position: absolute;\n                         top: "+(t.top-r.viewOffset-kr(e.display))+"px;\n                         height: "+(t.bottom-t.top+Fr(e)+r.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(i),e.display.lineSpace.removeChild(o)}}}(t,function(e,t,r,n){var i;null==n&&(n=0),e.options.lineWrapping||t!=r||(r="before"==(t=t.ch?et(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?et(t.line,t.ch+1,"before"):t);for(var o=0;o<5;o++){var s=!1,a=Hr(e,t),l=r&&r!=t?Hr(e,r):a,u=Ln(e,i={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-n,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+n}),c=e.doc.scrollTop,f=e.doc.scrollLeft;if(null!=u.scrollTop&&(On(e,u.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(s=!0)),null!=u.scrollLeft&&(Rn(e,u.scrollLeft),Math.abs(e.doc.scrollLeft-f)>1&&(s=!0)),!s)break}return i}(t,at(n,e.scrollToPos.from),at(n,e.scrollToPos.to),e.scrollToPos.margin));var i=e.maybeHiddenMarkers,o=e.maybeUnhiddenMarkers;if(i)for(var s=0;s<i.length;++s)i[s].lines.length||de(i[s],"hide");if(o)for(var a=0;a<o.length;++a)o[a].lines.length&&de(o[a],"unhide");r.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&de(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Zn(e,t){if(e.curOp)return t();Hn(e);try{return t()}finally{Wn(e)}}function ei(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Hn(e);try{return t.apply(e,arguments)}finally{Wn(e)}}}function ti(e){return function(){if(this.curOp)return e.apply(this,arguments);Hn(this);try{return e.apply(this,arguments)}finally{Wn(this)}}}function ri(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Hn(t);try{return e.apply(this,arguments)}finally{Wn(t)}}}function ni(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,D(ii,e))}function ii(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var r=+new Date+e.options.workTime,n=pt(e,t.highlightFrontier),i=[];t.iter(n.line,Math.min(t.first+t.size,e.display.viewTo+500),(function(o){if(n.line>=e.display.viewFrom){var s=o.styles,a=o.text.length>e.options.maxHighlightLength?Ge(t.mode,n.state):null,l=ft(e,o,n,!0);a&&(n.state=a),o.styles=l.styles;var u=o.styleClasses,c=l.classes;c?o.styleClasses=c:u&&(o.styleClasses=null);for(var f=!s||s.length!=o.styles.length||u!=c&&(!u||!c||u.bgClass!=c.bgClass||u.textClass!=c.textClass),h=0;!f&&h<s.length;++h)f=s[h]!=o.styles[h];f&&i.push(n.line),o.stateAfter=n.save(),n.nextLine()}else o.text.length<=e.options.maxHighlightLength&&dt(e,o.text,n),o.stateAfter=n.line%5==0?n.save():null,n.nextLine();if(+new Date>r)return ni(e,e.options.workDelay),!0})),t.highlightFrontier=n.line,t.modeFrontier=Math.max(t.modeFrontier,n.line),i.length&&Zn(e,(function(){for(var t=0;t<i.length;t++)hn(e,i[t],"text")}))}}var oi=function(e,t,r){var n=e.display;this.viewport=t,this.visible=En(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=_r(e),this.force=r,this.dims=on(e),this.events=[]};function si(e,t){var r=e.display,n=e.doc;if(t.editorIsHidden)return pn(e),!1;if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==gn(e))return!1;hi(e)&&(pn(e),t.dims=on(e));var i=n.first+n.size,o=Math.max(t.visible.from-e.options.viewportMargin,n.first),s=Math.min(i,t.visible.to+e.options.viewportMargin);r.viewFrom<o&&o-r.viewFrom<20&&(o=Math.max(n.first,r.viewFrom)),r.viewTo>s&&r.viewTo-s<20&&(s=Math.min(i,r.viewTo)),kt&&(o=Pt(e.doc,o),s=Qt(e.doc,s));var a=o!=r.viewFrom||s!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth;!function(e,t,r){var n=e.display;0==n.view.length||t>=n.viewTo||r<=n.viewFrom?(n.view=ir(e,t,r),n.viewFrom=t):(n.viewFrom>t?n.view=ir(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(cn(e,t))),n.viewFrom=t,n.viewTo<r?n.view=n.view.concat(ir(e,n.viewTo,r)):n.viewTo>r&&(n.view=n.view.slice(0,cn(e,r)))),n.viewTo=r}(e,o,s),r.viewOffset=zt(He(e.doc,r.viewFrom)),e.display.mover.style.top=r.viewOffset+"px";var u=gn(e);if(!a&&0==u&&!t.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var c=function(e){if(e.hasFocus())return null;var t=M();if(!t||!N(e.display.lineDiv,t))return null;var r={activeElt:t};if(window.getSelection){var n=window.getSelection();n.anchorNode&&n.extend&&N(e.display.lineDiv,n.anchorNode)&&(r.anchorNode=n.anchorNode,r.anchorOffset=n.anchorOffset,r.focusNode=n.focusNode,r.focusOffset=n.focusOffset)}return r}(e);return u>4&&(r.lineDiv.style.display="none"),function(e,t,r){var n=e.display,i=e.options.lineNumbers,o=n.lineDiv,s=o.firstChild;function a(t){var r=t.nextSibling;return l&&m&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),r}for(var u=n.view,c=n.viewFrom,f=0;f<u.length;f++){var h=u[f];if(h.hidden);else if(h.node&&h.node.parentNode==o){for(;s!=h.node;)s=a(s);var p=i&&null!=t&&t<=c&&h.lineNumber;h.changes&&(Q(h.changes,"gutter")>-1&&(p=!1),ur(e,h,c,r)),p&&(A(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(Ze(e.options,c)))),s=h.node.nextSibling}else{var d=vr(e,h,c,r);o.insertBefore(d,s)}c+=h.size}for(;s;)s=a(s)}(e,r.updateLineNumbers,t.dims),u>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,function(e){if(e&&e.activeElt&&e.activeElt!=M()&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&N(document.body,e.anchorNode)&&N(document.body,e.focusNode))){var t=window.getSelection(),r=document.createRange();r.setEnd(e.anchorNode,e.anchorOffset),r.collapse(!1),t.removeAllRanges(),t.addRange(r),t.extend(e.focusNode,e.focusOffset)}}(c),A(r.cursorDiv),A(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,a&&(r.lastWrapHeight=t.wrapperHeight,r.lastWrapWidth=t.wrapperWidth,ni(e,400)),r.updateLineNumbers=null,!0}function ai(e,t){for(var r=t.viewport,n=!0;;n=!1){if(n&&e.options.lineWrapping&&t.oldDisplayWidth!=_r(e))n&&(t.visible=En(e.display,e.doc,r));else if(r&&null!=r.top&&(r={top:Math.min(e.doc.height+Cr(e.display)-Ar(e),r.top)}),t.visible=En(e.display,e.doc,r),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!si(e,t))break;_n(e);var i=Bn(e);vn(e),Un(e,i),ci(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function li(e,t){var r=new oi(e,t);if(si(e,r)){_n(e),ai(e,r);var n=Bn(e);vn(e),Un(e,n),ci(e,n),r.finish()}}function ui(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function ci(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Fr(e)+"px"}function fi(e){var t=e.display,r=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=sn(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=n+"px",s=0;s<r.length;s++)if(!r[s].hidden){e.options.fixedGutter&&(r[s].gutter&&(r[s].gutter.style.left=o),r[s].gutterBackground&&(r[s].gutterBackground.style.left=o));var a=r[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=n+i+"px")}}function hi(e){if(!e.options.lineNumbers)return!1;var t=e.doc,r=Ze(e.options,t.first+t.size-1),n=e.display;if(r.length!=n.lineNumChars){var i=n.measure.appendChild(L("div",[L("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,s=i.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-s)+1,n.lineNumWidth=n.lineNumInnerWidth+s,n.lineNumChars=n.lineNumInnerWidth?r.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",ui(e.display),!0}return!1}function pi(e,t){for(var r=[],n=!1,i=0;i<e.length;i++){var o=e[i],s=null;if("string"!=typeof o&&(s=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;n=!0}r.push({className:o,style:s})}return t&&!n&&r.push({className:"CodeMirror-linenumbers",style:null}),r}function di(e){var t=e.gutters,r=e.gutterSpecs;A(t),e.lineGutter=null;for(var n=0;n<r.length;++n){var i=r[n],o=i.className,s=i.style,a=t.appendChild(L("div",null,"CodeMirror-gutter "+o));s&&(a.style.cssText=s),"CodeMirror-linenumbers"==o&&(e.lineGutter=a,a.style.width=(e.lineNumWidth||1)+"px")}t.style.display=r.length?"":"none",ui(e)}function gi(e){di(e.display),fn(e),fi(e)}function vi(e,t,n,i){var o=this;this.input=n,o.scrollbarFiller=L("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=L("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=T("div",null,"CodeMirror-code"),o.selectionDiv=L("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=L("div",null,"CodeMirror-cursors"),o.measure=L("div",null,"CodeMirror-measure"),o.lineMeasure=L("div",null,"CodeMirror-measure"),o.lineSpace=T("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none");var u=T("div",[o.lineSpace],"CodeMirror-lines");o.mover=L("div",[u],null,"position: relative"),o.sizer=L("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=L("div",null,null,"position: absolute; height: 50px; width: 1px;"),o.gutters=L("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=L("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=L("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),s&&a<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),l||r&&y||(o.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(o.wrapper):e(o.wrapper)),o.viewFrom=o.viewTo=t.first,o.reportedViewFrom=o.reportedViewTo=t.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,o.gutterSpecs=pi(i.gutters,i.lineNumbers),di(o),n.init(o)}oi.prototype.signal=function(e,t){ye(e,t)&&this.events.push(arguments)},oi.prototype.finish=function(){for(var e=0;e<this.events.length;e++)de.apply(null,this.events[e])};var yi=0,mi=null;function bi(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==r&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:null==r&&(r=e.wheelDelta),{x:t,y:r}}function xi(e){var t=bi(e);return t.x*=mi,t.y*=mi,t}function wi(e,t){var n=bi(t),i=n.x,o=n.y,s=e.display,a=s.scroller,u=a.scrollWidth>a.clientWidth,c=a.scrollHeight>a.clientHeight;if(i&&u||o&&c){if(o&&m&&l)e:for(var h=t.target,p=s.view;h!=a;h=h.parentNode)for(var d=0;d<p.length;d++)if(p[d].node==h){e.display.currentWheelTarget=h;break e}if(i&&!r&&!f&&null!=mi)return o&&c&&On(e,Math.max(0,a.scrollTop+o*mi)),Rn(e,Math.max(0,a.scrollLeft+i*mi)),(!o||o&&c)&&be(t),void(s.wheelStartX=null);if(o&&null!=mi){var g=o*mi,v=e.doc.scrollTop,y=v+s.wrapper.clientHeight;g<0?v=Math.max(0,v+g-50):y=Math.min(e.doc.height,y+g+50),li(e,{top:v,bottom:y})}yi<20&&(null==s.wheelStartX?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=i,s.wheelDY=o,setTimeout((function(){if(null!=s.wheelStartX){var e=a.scrollLeft-s.wheelStartX,t=a.scrollTop-s.wheelStartY,r=t&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX;s.wheelStartX=s.wheelStartY=null,r&&(mi=(mi*yi+r)/(yi+1),++yi)}}),200)):(s.wheelDX+=i,s.wheelDY+=o))}}s?mi=-.53:r?mi=15:c?mi=-.7:h&&(mi=-1/3);var ki=function(e,t){this.ranges=e,this.primIndex=t};ki.prototype.primary=function(){return this.ranges[this.primIndex]},ki.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],n=e.ranges[t];if(!rt(r.anchor,n.anchor)||!rt(r.head,n.head))return!1}return!0},ki.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new Ci(nt(this.ranges[t].anchor),nt(this.ranges[t].head));return new ki(e,this.primIndex)},ki.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},ki.prototype.contains=function(e,t){t||(t=e);for(var r=0;r<this.ranges.length;r++){var n=this.ranges[r];if(tt(t,n.from())>=0&&tt(e,n.to())<=0)return r}return-1};var Ci=function(e,t){this.anchor=e,this.head=t};function Si(e,t,r){var n=e&&e.options.selectionsMayTouch,i=t[r];t.sort((function(e,t){return tt(e.from(),t.from())})),r=Q(t,i);for(var o=1;o<t.length;o++){var s=t[o],a=t[o-1],l=tt(a.to(),s.from());if(n&&!s.empty()?l>0:l>=0){var u=ot(a.from(),s.from()),c=it(a.to(),s.to()),f=a.empty()?s.from()==s.head:a.from()==a.head;o<=r&&--r,t.splice(--o,2,new Ci(f?c:u,f?u:c))}}return new ki(t,r)}function Fi(e,t){return new ki([new Ci(e,t||e)],0)}function _i(e){return e.text?et(e.from.line+e.text.length-1,V(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function Ai(e,t){if(tt(e,t.from)<0)return e;if(tt(e,t.to)<=0)return _i(t);var r=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=_i(t).ch-t.to.ch),et(r,n)}function Ei(e,t){for(var r=[],n=0;n<e.sel.ranges.length;n++){var i=e.sel.ranges[n];r.push(new Ci(Ai(i.anchor,t),Ai(i.head,t)))}return Si(e.cm,r,e.sel.primIndex)}function Li(e,t,r){return e.line==t.line?et(r.line,e.ch-t.ch+r.ch):et(r.line+(e.line-t.line),e.ch)}function Ti(e){e.doc.mode=Pe(e.options,e.doc.modeOption),Ni(e)}function Ni(e){e.doc.iter((function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)})),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,ni(e,100),e.state.modeGen++,e.curOp&&fn(e)}function Mi(e,t){return 0==t.from.ch&&0==t.to.ch&&""==V(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ii(e,t,r,n){function i(e){return r?r[e]:null}function o(e,r,i){!function(e,t,r,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Et(e),Lt(e,r);var i=n?n(e):1;i!=e.height&&Je(e,i)}(e,r,i,n),ar(e,"change",e,t)}function s(e,t){for(var r=[],o=e;o<t;++o)r.push(new Ht(u[o],i(o),n));return r}var a=t.from,l=t.to,u=t.text,c=He(e,a.line),f=He(e,l.line),h=V(u),p=i(u.length-1),d=l.line-a.line;if(t.full)e.insert(0,s(0,u.length)),e.remove(u.length,e.size-u.length);else if(Mi(e,t)){var g=s(0,u.length-1);o(f,f.text,p),d&&e.remove(a.line,d),g.length&&e.insert(a.line,g)}else if(c==f)if(1==u.length)o(c,c.text.slice(0,a.ch)+h+c.text.slice(l.ch),p);else{var v=s(1,u.length-1);v.push(new Ht(h+c.text.slice(l.ch),p,n)),o(c,c.text.slice(0,a.ch)+u[0],i(0)),e.insert(a.line+1,v)}else if(1==u.length)o(c,c.text.slice(0,a.ch)+u[0]+f.text.slice(l.ch),i(0)),e.remove(a.line+1,d);else{o(c,c.text.slice(0,a.ch)+u[0],i(0)),o(f,h+f.text.slice(l.ch),p);var y=s(1,u.length-1);d>1&&e.remove(a.line+1,d-1),e.insert(a.line+1,y)}ar(e,"change",e,t)}function ji(e,t,r){!function e(n,i,o){if(n.linked)for(var s=0;s<n.linked.length;++s){var a=n.linked[s];if(a.doc!=i){var l=o&&a.sharedHist;r&&!l||(t(a.doc,l),e(a.doc,n,l))}}}(e,null,!0)}function Oi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,ln(e),Ti(e),Di(e),e.options.lineWrapping||Xt(e),e.options.mode=t.modeOption,fn(e)}function Di(e){("rtl"==e.doc.direction?I:_)(e.display.lineDiv,"CodeMirror-rtl")}function Ri(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Bi(e,t){var r={from:nt(t.from),to:_i(t),text:We(e,t.from,t.to)};return zi(e,r,t.from.line,t.to.line+1),ji(e,(function(e){return zi(e,r,t.from.line,t.to.line+1)}),!0),r}function Pi(e){for(;e.length;){if(!V(e).ranges)break;e.pop()}}function Qi(e,t,r,n){var i=e.history;i.undone.length=0;var o,s,a=+new Date;if((i.lastOp==n||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=function(e,t){return t?(Pi(e.done),V(e.done)):e.done.length&&!V(e.done).ranges?V(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),V(e.done)):void 0}(i,i.lastOp==n)))s=V(o.changes),0==tt(t.from,t.to)&&0==tt(t.from,s.to)?s.to=_i(t):o.changes.push(Bi(e,t));else{var l=V(i.done);for(l&&l.ranges||Gi(e.sel,i.done),o={changes:[Bi(e,t)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(r),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=a,i.lastOp=i.lastSelOp=n,i.lastOrigin=i.lastSelOrigin=t.origin,s||de(e,"historyAdded")}function Ui(e,t,r,n){var i=e.history,o=n&&n.origin;r==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||function(e,t,r,n){var i=t.charAt(0);return"*"==i||"+"==i&&r.ranges.length==n.ranges.length&&r.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,o,V(i.done),t))?i.done[i.done.length-1]=t:Gi(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=r,n&&!1!==n.clearRedo&&Pi(i.undone)}function Gi(e,t){var r=V(t);r&&r.ranges&&r.equals(e)||t.push(e)}function zi(e,t,r,n){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,r),Math.min(e.first+e.size,n),(function(r){r.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=r.markedSpans),++o}))}function qi(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t||(t=e.slice(0,r)):t&&t.push(e[r]);return t?t.length?t:null:e}function Xi(e,t){var r=function(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var n=[],i=0;i<t.text.length;++i)n.push(qi(r[i]));return n}(e,t),n=_t(e,t);if(!r)return n;if(!n)return r;for(var i=0;i<r.length;++i){var o=r[i],s=n[i];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],u=0;u<o.length;++u)if(o[u].marker==l.marker)continue e;o.push(l)}else s&&(r[i]=s)}return r}function Hi(e,t,r){for(var n=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges)n.push(r?ki.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];n.push({changes:a});for(var l=0;l<s.length;++l){var u=s[l],c=void 0;if(a.push({from:u.from,to:u.to,text:u.text}),t)for(var f in u)(c=f.match(/^spans_(\d+)$/))&&Q(t,Number(c[1]))>-1&&(V(a)[f]=u[f],delete u[f])}}}return n}function Wi(e,t,r,n){if(n){var i=e.anchor;if(r){var o=tt(t,i)<0;o!=tt(r,i)<0?(i=t,t=r):o!=tt(t,r)<0&&(t=r)}return new Ci(i,t)}return new Ci(r||t,t)}function Vi(e,t,r,n,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),Zi(e,new ki([Wi(e.sel.primary(),t,r,i)],0),n)}function Ji(e,t,r){for(var n=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)n[o]=Wi(e.sel.ranges[o],t[o],null,i);Zi(e,Si(e.cm,n,e.sel.primIndex),r)}function Ki(e,t,r,n){var i=e.sel.ranges.slice(0);i[t]=r,Zi(e,Si(e.cm,i,e.sel.primIndex),n)}function Yi(e,t,r,n){Zi(e,Fi(t,r),n)}function $i(e,t,r){var n=e.history.done,i=V(n);i&&i.ranges?(n[n.length-1]=t,eo(e,t,r)):Zi(e,t,r)}function Zi(e,t,r){eo(e,t,r),Ui(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function eo(e,t,r){(ye(e,"beforeSelectionChange")||e.cm&&ye(e.cm,"beforeSelectionChange"))&&(t=function(e,t,r){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var r=0;r<t.length;r++)this.ranges[r]=new Ci(at(e,t[r].anchor),at(e,t[r].head))},origin:r&&r.origin};return de(e,"beforeSelectionChange",e,n),e.cm&&de(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?Si(e.cm,n.ranges,n.ranges.length-1):t}(e,t,r));var n=r&&r.bias||(tt(t.primary().head,e.sel.primary().head)<0?-1:1);to(e,no(e,t,n,!0)),r&&!1===r.scroll||!e.cm||Nn(e.cm)}function to(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,ve(e.cm)),ar(e,"cursorActivity",e))}function ro(e){to(e,no(e,e.sel,null,!1))}function no(e,t,r,n){for(var i,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=oo(e,s.anchor,a&&a.anchor,r,n),u=oo(e,s.head,a&&a.head,r,n);(i||l!=s.anchor||u!=s.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new Ci(l,u))}return i?Si(e.cm,i,t.primIndex):t}function io(e,t,r,n,i){var o=He(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker,u="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,c="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(u?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(c?a.to>=t.ch:a.to>t.ch))){if(i&&(de(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(!l.atomic)continue;if(r){var f=l.find(n<0?1:-1),h=void 0;if((n<0?c:u)&&(f=so(e,f,-n,f&&f.line==t.line?o:null)),f&&f.line==t.line&&(h=tt(f,r))&&(n<0?h<0:h>0))return io(e,f,t,n,i)}var p=l.find(n<0?-1:1);return(n<0?u:c)&&(p=so(e,p,n,p.line==t.line?o:null)),p?io(e,p,t,n,i):null}}return t}function oo(e,t,r,n,i){var o=n||1,s=io(e,t,r,o,i)||!i&&io(e,t,r,o,!0)||io(e,t,r,-o,i)||!i&&io(e,t,r,-o,!0);return s||(e.cantEdit=!0,et(e.first,0))}function so(e,t,r,n){return r<0&&0==t.ch?t.line>e.first?at(e,et(t.line-1)):null:r>0&&t.ch==(n||He(e,t.line)).text.length?t.line<e.first+e.size-1?et(t.line+1,0):null:new et(t.line,t.ch+r)}function ao(e){e.setSelection(et(e.firstLine(),0),et(e.lastLine()),G)}function lo(e,t,r){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return n.canceled=!0}};return r&&(n.update=function(t,r,i,o){t&&(n.from=at(e,t)),r&&(n.to=at(e,r)),i&&(n.text=i),void 0!==o&&(n.origin=o)}),de(e,"beforeChange",e,n),e.cm&&de(e.cm,"beforeChange",e.cm,n),n.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:n.from,to:n.to,text:n.text,origin:n.origin}}function uo(e,t,r){if(e.cm){if(!e.cm.curOp)return ei(e.cm,uo)(e,t,r);if(e.cm.state.suppressEdits)return}if(!(ye(e,"beforeChange")||e.cm&&ye(e.cm,"beforeChange"))||(t=lo(e,t,!0))){var n=wt&&!r&&function(e,t,r){var n=null;if(e.iter(t.line,r.line+1,(function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;!r.readOnly||n&&-1!=Q(n,r)||(n||(n=[])).push(r)}})),!n)return null;for(var i=[{from:t,to:r}],o=0;o<n.length;++o)for(var s=n[o],a=s.find(0),l=0;l<i.length;++l){var u=i[l];if(!(tt(u.to,a.from)<0||tt(u.from,a.to)>0)){var c=[l,1],f=tt(u.from,a.from),h=tt(u.to,a.to);(f<0||!s.inclusiveLeft&&!f)&&c.push({from:u.from,to:a.from}),(h>0||!s.inclusiveRight&&!h)&&c.push({from:a.to,to:u.to}),i.splice.apply(i,c),l+=c.length-3}}return i}(e,t.from,t.to);if(n)for(var i=n.length-1;i>=0;--i)co(e,{from:n[i].from,to:n[i].to,text:i?[""]:t.text,origin:t.origin});else co(e,t)}}function co(e,t){if(1!=t.text.length||""!=t.text[0]||0!=tt(t.from,t.to)){var r=Ei(e,t);Qi(e,t,r,e.cm?e.cm.curOp.id:NaN),po(e,t,r,_t(e,t));var n=[];ji(e,(function(e,r){r||-1!=Q(n,e.history)||(mo(e.history,t),n.push(e.history)),po(e,t,null,_t(e,t))}))}}function fo(e,t,r){var n=e.cm&&e.cm.state.suppressEdits;if(!n||r){for(var i,o=e.history,s=e.sel,a="undo"==t?o.done:o.undone,l="undo"==t?o.undone:o.done,u=0;u<a.length&&(i=a[u],r?!i.ranges||i.equals(e.sel):i.ranges);u++);if(u!=a.length){for(o.lastOrigin=o.lastSelOrigin=null;;){if(!(i=a.pop()).ranges){if(n)return void a.push(i);break}if(Gi(i,l),r&&!i.equals(e.sel))return void Zi(e,i,{clearRedo:!1});s=i}var c=[];Gi(s,l),l.push({changes:c,generation:o.generation}),o.generation=i.generation||++o.maxGeneration;for(var f=ye(e,"beforeChange")||e.cm&&ye(e.cm,"beforeChange"),h=function(r){var n=i.changes[r];if(n.origin=t,f&&!lo(e,n,!1))return a.length=0,{};c.push(Bi(e,n));var o=r?Ei(e,n):V(a);po(e,n,o,Xi(e,n)),!r&&e.cm&&e.cm.scrollIntoView({from:n.from,to:_i(n)});var s=[];ji(e,(function(e,t){t||-1!=Q(s,e.history)||(mo(e.history,n),s.push(e.history)),po(e,n,null,Xi(e,n))}))},p=i.changes.length-1;p>=0;--p){var d=h(p);if(d)return d.v}}}}function ho(e,t){if(0!=t&&(e.first+=t,e.sel=new ki(J(e.sel.ranges,(function(e){return new Ci(et(e.anchor.line+t,e.anchor.ch),et(e.head.line+t,e.head.ch))})),e.sel.primIndex),e.cm)){fn(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,n=r.viewFrom;n<r.viewTo;n++)hn(e.cm,n,"gutter")}}function po(e,t,r,n){if(e.cm&&!e.cm.curOp)return ei(e.cm,po)(e,t,r,n);if(t.to.line<e.first)ho(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);ho(e,i),t={from:et(e.first,0),to:et(t.to.line+i,t.to.ch),text:[V(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:et(o,He(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=We(e,t.from,t.to),r||(r=Ei(e,t)),e.cm?function(e,t,r){var n=e.doc,i=e.display,o=t.from,s=t.to,a=!1,l=o.line;e.options.lineWrapping||(l=Ke(Bt(He(n,o.line))),n.iter(l,s.line+1,(function(e){if(e==i.maxLine)return a=!0,!0})));n.sel.contains(t.from,t.to)>-1&&ve(e);Ii(n,t,r,an(e)),e.options.lineWrapping||(n.iter(l,o.line+t.text.length,(function(e){var t=qt(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,a=!1)})),a&&(e.curOp.updateMaxLine=!0));(function(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var r=e.first,n=t-1;n>r;n--){var i=He(e,n).stateAfter;if(i&&(!(i instanceof ut)||n+i.lookAhead<t)){r=n+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,r)}})(n,o.line),ni(e,400);var u=t.text.length-(s.line-o.line)-1;t.full?fn(e):o.line!=s.line||1!=t.text.length||Mi(e.doc,t)?fn(e,o.line,s.line+1,u):hn(e,o.line,"text");var c=ye(e,"changes"),f=ye(e,"change");if(f||c){var h={from:o,to:s,text:t.text,removed:t.removed,origin:t.origin};f&&ar(e,"change",e,h),c&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(h)}e.display.selForContextMenu=null}(e.cm,t,n):Ii(e,t,n),eo(e,r,G),e.cantEdit&&oo(e,et(e.firstLine(),0))&&(e.cantEdit=!1)}}function go(e,t,r,n,i){var o;n||(n=r),tt(n,r)<0&&(r=(o=[n,r])[0],n=o[1]),"string"==typeof t&&(t=e.splitLines(t)),uo(e,{from:r,to:n,text:t,origin:i})}function vo(e,t,r,n){r<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function yo(e,t,r,n){for(var i=0;i<e.length;++i){var o=e[i],s=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)vo(o.ranges[a].anchor,t,r,n),vo(o.ranges[a].head,t,r,n)}else{for(var l=0;l<o.changes.length;++l){var u=o.changes[l];if(r<u.from.line)u.from=et(u.from.line+n,u.from.ch),u.to=et(u.to.line+n,u.to.ch);else if(t<=u.to.line){s=!1;break}}s||(e.splice(0,i+1),i=0)}}}function mo(e,t){var r=t.from.line,n=t.to.line,i=t.text.length-(n-r)-1;yo(e.done,r,n,i),yo(e.undone,r,n,i)}function bo(e,t,r,n){var i=t,o=t;return"number"==typeof t?o=He(e,st(e,t)):i=Ke(t),null==i?null:(n(o,i)&&e.cm&&hn(e.cm,i,r),o)}function xo(e){this.lines=e,this.parent=null;for(var t=0,r=0;r<e.length;++r)e[r].parent=this,t+=e[r].height;this.height=t}function wo(e){this.children=e;for(var t=0,r=0,n=0;n<e.length;++n){var i=e[n];t+=i.chunkSize(),r+=i.height,i.parent=this}this.size=t,this.height=r,this.parent=null}Ci.prototype.from=function(){return ot(this.anchor,this.head)},Ci.prototype.to=function(){return it(this.anchor,this.head)},Ci.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},xo.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r=e,n=e+t;r<n;++r){var i=this.lines[r];this.height-=i.height,Wt(i),ar(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,r){for(var n=e+t;e<n;++e)if(r(this.lines[e]))return!0}},wo.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r=0;r<this.children.length;++r){var n=this.children[r],i=n.chunkSize();if(e<i){var o=Math.min(t,i-e),s=n.height;if(n.removeInner(e,o),this.height-=s-n.height,i==o&&(this.children.splice(r--,1),n.parent=null),0==(t-=o))break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof xo))){var a=[];this.collapse(a),this.children=[new xo(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,r),i.lines&&i.lines.length>50){for(var s=i.lines.length%25+25,a=s;a<i.lines.length;){var l=new xo(i.lines.slice(a,a+=25));i.height-=l.height,this.children.splice(++n,0,l),l.parent=this}i.lines=i.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new wo(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var r=Q(e.parent.children,e);e.parent.children.splice(r+1,0,t)}else{var n=new wo(e.children);n.parent=e,e.children=[n,t],e=n}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(e<o){var s=Math.min(t,o-e);if(i.iterN(e,s,r))return!0;if(0==(t-=s))break;e=0}else e-=o}}};var ko=function(e,t,r){if(r)for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n]);this.doc=e,this.node=t};function Co(e,t,r){zt(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Tn(e,r)}ko.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,n=Ke(r);if(null!=n&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(r.widgets=null);var o=xr(this);Je(r,Math.max(0,r.height-o)),e&&(Zn(e,(function(){Co(e,r,-o),hn(e,n,"widget")})),ar(e,"lineWidgetCleared",e,this,n))}},ko.prototype.changed=function(){var e=this,t=this.height,r=this.doc.cm,n=this.line;this.height=null;var i=xr(this)-t;i&&(Ut(this.doc,n)||Je(n,n.height+i),r&&Zn(r,(function(){r.curOp.forceUpdate=!0,Co(r,n,i),ar(r,"lineWidgetChanged",r,e,Ke(n))})))},me(ko);var So=0,Fo=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++So};function _o(e,t,r,n,i){if(n&&n.shared)return function(e,t,r,n,i){(n=R(n)).shared=!1;var o=[_o(e,t,r,n,i)],s=o[0],a=n.widgetNode;return ji(e,(function(e){a&&(n.widgetNode=a.cloneNode(!0)),o.push(_o(e,at(e,t),at(e,r),n,i));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;s=V(o)})),new Ao(o,s)}(e,t,r,n,i);if(e.cm&&!e.cm.curOp)return ei(e.cm,_o)(e,t,r,n,i);var o=new Fo(e,i),s=tt(t,r);if(n&&R(n,o,!1),s>0||0==s&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=T("span",[o.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Rt(e,t.line,t,r,o)||t.line!=r.line&&Rt(e,r.line,t,r,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");kt=!0}o.addToHistory&&Qi(e,{from:t,to:r,origin:"markText"},e.sel,NaN);var a,l=t.line,u=e.cm;if(e.iter(l,r.line+1,(function(e){u&&o.collapsed&&!u.options.lineWrapping&&Bt(e)==u.display.maxLine&&(a=!0),o.collapsed&&l!=t.line&&Je(e,0),function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}(e,new Ct(o,l==t.line?t.ch:null,l==r.line?r.ch:null)),++l})),o.collapsed&&e.iter(t.line,r.line+1,(function(t){Ut(e,t)&&Je(t,0)})),o.clearOnEnter&&fe(o,"beforeCursorEnter",(function(){return o.clear()})),o.readOnly&&(wt=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++So,o.atomic=!0),u){if(a&&(u.curOp.updateMaxLine=!0),o.collapsed)fn(u,t.line,r.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var c=t.line;c<=r.line;c++)hn(u,c,"text");o.atomic&&ro(u.doc),ar(u,"markerAdded",u,o)}return o}Fo.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Hn(e),ye(this,"clear")){var r=this.find();r&&ar(this,"clear",r.from,r.to)}for(var n=null,i=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=St(s.markedSpans,this);e&&!this.collapsed?hn(e,Ke(s),"text"):e&&(null!=a.to&&(i=Ke(s)),null!=a.from&&(n=Ke(s))),s.markedSpans=Ft(s.markedSpans,a),null==a.from&&this.collapsed&&!Ut(this.doc,s)&&e&&Je(s,rn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var u=Bt(this.lines[l]),c=qt(u);c>e.display.maxLineLength&&(e.display.maxLine=u,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&fn(e,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&ro(e.doc)),e&&ar(e,"markerCleared",e,this,n,i),t&&Wn(e),this.parent&&this.parent.clear()}},Fo.prototype.find=function(e,t){var r,n;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var o=this.lines[i],s=St(o.markedSpans,this);if(null!=s.from&&(r=et(t?o:Ke(o),s.from),-1==e))return r;if(null!=s.to&&(n=et(t?o:Ke(o),s.to),1==e))return n}return r&&{from:r,to:n}},Fo.prototype.changed=function(){var e=this,t=this.find(-1,!0),r=this,n=this.doc.cm;t&&n&&Zn(n,(function(){var i=t.line,o=Ke(t.line),s=Tr(n,o);if(s&&(Rr(s),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!Ut(r.doc,i)&&null!=r.height){var a=r.height;r.height=null;var l=xr(r)-a;l&&Je(i,i.height+l)}ar(n,"markerChanged",n,e)}))},Fo.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Q(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Fo.prototype.detachLine=function(e){if(this.lines.splice(Q(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},me(Fo);var Ao=function(e,t){this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=this};function Eo(e){return e.findMarks(et(e.first,0),e.clipPos(et(e.lastLine())),(function(e){return e.parent}))}function Lo(e){for(var t=function(t){var r=e[t],n=[r.primary.doc];ji(r.primary.doc,(function(e){return n.push(e)}));for(var i=0;i<r.markers.length;i++){var o=r.markers[i];-1==Q(n,o.doc)&&(o.parent=null,r.markers.splice(i--,1))}},r=0;r<e.length;r++)t(r)}Ao.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ar(this,"clear")}},Ao.prototype.find=function(e,t){return this.primary.find(e,t)},me(Ao);var To=0,No=function(e,t,r,n,i){if(!(this instanceof No))return new No(e,t,r,n,i);null==r&&(r=0),wo.call(this,[new xo([new Ht("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=r;var o=et(r,0);this.sel=Fi(o),this.history=new Ri(null),this.id=++To,this.modeOption=t,this.lineSep=n,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Ii(this,{from:o,to:o,text:e}),Zi(this,Fi(o),G)};No.prototype=Y(wo.prototype,{constructor:No,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,n=0;n<t.length;++n)r+=t[n].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Ve(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:ri((function(e){var t=et(this.first,0),r=this.first+this.size-1;uo(this,{from:t,to:et(r,He(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Mn(this.cm,0,0),Zi(this,Fi(t),G)})),replaceRange:function(e,t,r,n){go(this,e,t=at(this,t),r=r?at(this,r):t,n)},getRange:function(e,t,r){var n=We(this,at(this,e),at(this,t));return!1===r?n:n.join(r||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if($e(this,e))return He(this,e)},getLineNumber:function(e){return Ke(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=He(this,e)),Bt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return at(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ri((function(e,t,r){Yi(this,at(this,"number"==typeof e?et(e,t||0):e),null,r)})),setSelection:ri((function(e,t,r){Yi(this,at(this,e),at(this,t||e),r)})),extendSelection:ri((function(e,t,r){Vi(this,at(this,e),t&&at(this,t),r)})),extendSelections:ri((function(e,t){Ji(this,lt(this,e),t)})),extendSelectionsBy:ri((function(e,t){Ji(this,lt(this,J(this.sel.ranges,e)),t)})),setSelections:ri((function(e,t,r){if(e.length){for(var n=[],i=0;i<e.length;i++)n[i]=new Ci(at(this,e[i].anchor),at(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Zi(this,Si(this.cm,n,t),r)}})),addSelection:ri((function(e,t,r){var n=this.sel.ranges.slice(0);n.push(new Ci(at(this,e),at(this,t||e))),Zi(this,Si(this.cm,n,n.length-1),r)})),getSelection:function(e){for(var t,r=this.sel.ranges,n=0;n<r.length;n++){var i=We(this,r[n].from(),r[n].to());t=t?t.concat(i):i}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],r=this.sel.ranges,n=0;n<r.length;n++){var i=We(this,r[n].from(),r[n].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[n]=i}return t},replaceSelection:function(e,t,r){for(var n=[],i=0;i<this.sel.ranges.length;i++)n[i]=e;this.replaceSelections(n,t,r||"+input")},replaceSelections:ri((function(e,t,r){for(var n=[],i=this.sel,o=0;o<i.ranges.length;o++){var s=i.ranges[o];n[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:r}}for(var a=t&&"end"!=t&&function(e,t,r){for(var n=[],i=et(e.first,0),o=i,s=0;s<t.length;s++){var a=t[s],l=Li(a.from,i,o),u=Li(_i(a),i,o);if(i=a.to,o=u,"around"==r){var c=e.sel.ranges[s],f=tt(c.head,c.anchor)<0;n[s]=new Ci(f?u:l,f?l:u)}else n[s]=new Ci(l,l)}return new ki(n,e.sel.primIndex)}(this,n,t),l=n.length-1;l>=0;l--)uo(this,n[l]);a?$i(this,a):this.cm&&Nn(this.cm)})),undo:ri((function(){fo(this,"undo")})),redo:ri((function(){fo(this,"redo")})),undoSelection:ri((function(){fo(this,"undo",!0)})),redoSelection:ri((function(){fo(this,"redo",!0)})),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,r=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++r;return{undo:t,redo:r}},clearHistory:function(){var e=this;this.history=new Ri(this.history.maxGeneration),ji(this,(function(t){return t.history=e.history}),!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Hi(this.history.done),undone:Hi(this.history.undone)}},setHistory:function(e){var t=this.history=new Ri(this.history.maxGeneration);t.done=Hi(e.done.slice(0),null,!0),t.undone=Hi(e.undone.slice(0),null,!0)},setGutterMarker:ri((function(e,t,r){return bo(this,e,"gutter",(function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=r,!r&&te(n)&&(e.gutterMarkers=null),!0}))})),clearGutter:ri((function(e){var t=this;this.iter((function(r){r.gutterMarkers&&r.gutterMarkers[e]&&bo(t,r,"gutter",(function(){return r.gutterMarkers[e]=null,te(r.gutterMarkers)&&(r.gutterMarkers=null),!0}))}))})),lineInfo:function(e){var t;if("number"==typeof e){if(!$e(this,e))return null;if(t=e,!(e=He(this,e)))return null}else if(null==(t=Ke(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:ri((function(e,t,r){return bo(this,e,"gutter"==t?"gutter":"class",(function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(S(r).test(e[n]))return!1;e[n]+=" "+r}else e[n]=r;return!0}))})),removeLineClass:ri((function(e,t,r){return bo(this,e,"gutter"==t?"gutter":"class",(function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",i=e[n];if(!i)return!1;if(null==r)e[n]=null;else{var o=i.match(S(r));if(!o)return!1;var s=o.index+o[0].length;e[n]=i.slice(0,o.index)+(o.index&&s!=i.length?" ":"")+i.slice(s)||null}return!0}))})),addLineWidget:ri((function(e,t,r){return function(e,t,r,n){var i=new ko(e,r,n),o=e.cm;return o&&i.noHScroll&&(o.display.alignWidgets=!0),bo(e,t,"widget",(function(t){var r=t.widgets||(t.widgets=[]);if(null==i.insertAt?r.push(i):r.splice(Math.min(r.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,o&&!Ut(e,t)){var n=zt(t)<e.scrollTop;Je(t,t.height+xr(i)),n&&Tn(o,i.height),o.curOp.forceUpdate=!0}return!0})),o&&ar(o,"lineWidgetAdded",o,i,"number"==typeof t?t:Ke(t)),i}(this,e,t,r)})),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return _o(this,at(this,e),at(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){var r={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return _o(this,e=at(this,e),e,r,"bookmark")},findMarksAt:function(e){var t=[],r=He(this,(e=at(this,e)).line).markedSpans;if(r)for(var n=0;n<r.length;++n){var i=r[n];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,r){e=at(this,e),t=at(this,t);var n=[],i=e.line;return this.iter(e.line,t.line+1,(function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];null!=l.to&&i==e.line&&e.ch>=l.to||null==l.from&&i!=e.line||null!=l.from&&i==t.line&&l.from>=t.ch||r&&!r(l.marker)||n.push(l.marker.parent||l.marker)}++i})),n},getAllMarks:function(){var e=[];return this.iter((function(t){var r=t.markedSpans;if(r)for(var n=0;n<r.length;++n)null!=r[n].from&&e.push(r[n].marker)})),e},posFromIndex:function(e){var t,r=this.first,n=this.lineSeparator().length;return this.iter((function(i){var o=i.text.length+n;if(o>e)return t=e,!0;e-=o,++r})),at(this,et(r,t))},indexFromPos:function(e){var t=(e=at(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var r=this.lineSeparator().length;return this.iter(this.first,e.line,(function(e){t+=e.text.length+r})),t},copy:function(e){var t=new No(Ve(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,r=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<r&&(r=e.to);var n=new No(Ve(this,t,r),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.find(),o=e.clipPos(i.from),s=e.clipPos(i.to);if(tt(o,s)){var a=_o(e,o,s,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}(n,Eo(this)),n},unlinkDoc:function(e){if(e instanceof As&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),Lo(Eo(this));break}}if(e.history==this.history){var r=[e.id];ji(e,(function(e){return r.push(e.id)}),!0),e.history=new Ri(null),e.history.done=Hi(this.history.done,r),e.history.undone=Hi(this.history.undone,r)}},iterLinkedDocs:function(e){ji(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Ne(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:ri((function(e){var t;("rtl"!=e&&(e="ltr"),e!=this.direction)&&(this.direction=e,this.iter((function(e){return e.order=null})),this.cm&&Zn(t=this.cm,(function(){Di(t),fn(t)})))}))}),No.prototype.eachLine=No.prototype.iter;var Mo=0;function Io(e){var t=this;if(jo(t),!ge(t,e)&&!wr(t.display,e)){be(e),s&&(Mo=+new Date);var r=un(t,e,!0),n=e.dataTransfer.files;if(r&&!t.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var i=n.length,o=Array(i),a=0,l=function(){++a==i&&ei(t,(function(){var e={from:r=at(t.doc,r),to:r,text:t.doc.splitLines(o.filter((function(e){return null!=e})).join(t.doc.lineSeparator())),origin:"paste"};uo(t.doc,e),$i(t.doc,Fi(at(t.doc,r),at(t.doc,_i(e))))}))()},u=function(e,r){if(t.options.allowDropFileTypes&&-1==Q(t.options.allowDropFileTypes,e.type))l();else{var n=new FileReader;n.onerror=function(){return l()},n.onload=function(){var e=n.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)||(o[r]=e),l()},n.readAsText(e)}},c=0;c<n.length;c++)u(n[c],c);else{if(t.state.draggingText&&t.doc.sel.contains(r)>-1)return t.state.draggingText(e),void setTimeout((function(){return t.display.input.focus()}),20);try{var f=e.dataTransfer.getData("Text");if(f){var h;if(t.state.draggingText&&!t.state.draggingText.copy&&(h=t.listSelections()),eo(t.doc,Fi(r,r)),h)for(var p=0;p<h.length;++p)go(t.doc,"",h[p].anchor,h[p].head,"drag");t.replaceSelection(f,"around","paste"),t.display.input.focus()}}catch(d){}}}}function jo(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Oo(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),r=[],n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&r.push(i)}r.length&&r[0].operation((function(){for(var t=0;t<r.length;t++)e(r[t])}))}}var Do=!1;function Ro(){var e;Do||(fe(window,"resize",(function(){null==e&&(e=setTimeout((function(){e=null,Oo(Bo)}),100))})),fe(window,"blur",(function(){return Oo(Fn)})),Do=!0)}function Bo(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Po={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Qo=0;Qo<10;Qo++)Po[Qo+48]=Po[Qo+96]=String(Qo);for(var Uo=65;Uo<=90;Uo++)Po[Uo]=String.fromCharCode(Uo);for(var Go=1;Go<=12;Go++)Po[Go+111]=Po[Go+63235]="F"+Go;var zo={};function qo(e){var t,r,n,i,o=e.split(/-(?!$)/);e=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))i=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);n=!0}}return t&&(e="Alt-"+e),r&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function Xo(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r))continue;if("..."==n){delete e[r];continue}for(var i=J(r.split(" "),qo),o=0;o<i.length;o++){var s=void 0,a=void 0;o==i.length-1?(a=i.join(" "),s=n):(a=i.slice(0,o+1).join(" "),s="...");var l=t[a];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+a)}else t[a]=s}delete e[r]}for(var u in t)e[u]=t[u];return e}function Ho(e,t,r,n){var i=(t=Ko(t)).call?t.call(e,n):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&r(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Ho(e,t.fallthrough,r,n);for(var o=0;o<t.fallthrough.length;o++){var s=Ho(e,t.fallthrough[o],r,n);if(s)return s}}}function Wo(e){var t="string"==typeof e?e:Po[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Vo(e,t,r){var n=e;return t.altKey&&"Alt"!=n&&(e="Alt-"+e),(k?t.metaKey:t.ctrlKey)&&"Ctrl"!=n&&(e="Ctrl-"+e),(k?t.ctrlKey:t.metaKey)&&"Mod"!=n&&(e="Cmd-"+e),!r&&t.shiftKey&&"Shift"!=n&&(e="Shift-"+e),e}function Jo(e,t){if(f&&34==e.keyCode&&e.char)return!1;var r=Po[e.keyCode];return null!=r&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(r=e.code),Vo(r,e,t))}function Ko(e){return"string"==typeof e?zo[e]:e}function Yo(e,t){for(var r=e.doc.sel.ranges,n=[],i=0;i<r.length;i++){for(var o=t(r[i]);n.length&&tt(o.from,V(n).to)<=0;){var s=n.pop();if(tt(s.from,o.from)<0){o.from=s.from;break}}n.push(o)}Zn(e,(function(){for(var t=n.length-1;t>=0;t--)go(e.doc,"",n[t].from,n[t].to,"+delete");Nn(e)}))}function $o(e,t,r){var n=ie(e.text,t+r,r);return n<0||n>e.text.length?null:n}function Zo(e,t,r){var n=$o(e,t.ch,r);return null==n?null:new et(t.line,n,r<0?"after":"before")}function es(e,t,r,n,i){if(e){"rtl"==t.doc.direction&&(i=-i);var o=ue(r,t.doc.direction);if(o){var s,a=i<0?V(o):o[0],l=i<0==(1==a.level)?"after":"before";if(a.level>0||"rtl"==t.doc.direction){var u=Nr(t,r);s=i<0?r.text.length-1:0;var c=Mr(t,u,s).top;s=oe((function(e){return Mr(t,u,e).top==c}),i<0==(1==a.level)?a.from:a.to-1,s),"before"==l&&(s=$o(r,s,1))}else s=i<0?a.to:a.from;return new et(n,s,l)}}return new et(n,i<0?r.text.length:0,i<0?"before":"after")}zo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},zo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},zo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},zo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},zo.default=m?zo.macDefault:zo.pcDefault;var ts={selectAll:ao,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),G)},killLine:function(e){return Yo(e,(function(t){if(t.empty()){var r=He(e.doc,t.head.line).text.length;return t.head.ch==r&&t.head.line<e.lastLine()?{from:t.head,to:et(t.head.line+1,0)}:{from:t.head,to:et(t.head.line,r)}}return{from:t.from(),to:t.to()}}))},deleteLine:function(e){return Yo(e,(function(t){return{from:et(t.from().line,0),to:at(e.doc,et(t.to().line+1,0))}}))},delLineLeft:function(e){return Yo(e,(function(e){return{from:et(e.from().line,0),to:e.from()}}))},delWrappedLineLeft:function(e){return Yo(e,(function(t){var r=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:r},"div"),to:t.from()}}))},delWrappedLineRight:function(e){return Yo(e,(function(t){var r=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div");return{from:t.from(),to:n}}))},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(et(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(et(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy((function(t){return rs(e,t.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy((function(t){return ns(e,t.head)}),{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy((function(t){return function(e,t){var r=He(e.doc,t),n=function(e){for(var t;t=Ot(e);)e=t.find(1,!0).line;return e}(r);n!=r&&(t=Ke(n));return es(!0,e,r,t,-1)}(e,t.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy((function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div")}),q)},goLineLeft:function(e){return e.extendSelectionsBy((function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:r},"div")}),q)},goLineLeftSmart:function(e){return e.extendSelectionsBy((function(t){var r=e.cursorCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:r},"div");return n.ch<e.getLine(n.line).search(/\S/)?ns(e,t.head):n}),q)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],r=e.listSelections(),n=e.options.tabSize,i=0;i<r.length;i++){var o=r[i].from(),s=B(e.getLine(o.line),o.ch,n);t.push(W(n-s%n))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Zn(e,(function(){for(var t=e.listSelections(),r=[],n=0;n<t.length;n++)if(t[n].empty()){var i=t[n].head,o=He(e.doc,i.line).text;if(o)if(i.ch==o.length&&(i=new et(i.line,i.ch-1)),i.ch>0)i=new et(i.line,i.ch+1),e.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),et(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var s=He(e.doc,i.line-1).text;s&&(i=new et(i.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+s.charAt(s.length-1),et(i.line-1,s.length-1),i,"+transpose"))}r.push(new Ci(i,i))}e.setSelections(r)}))},newlineAndIndent:function(e){return Zn(e,(function(){for(var t=e.listSelections(),r=t.length-1;r>=0;r--)e.replaceRange(e.doc.lineSeparator(),t[r].anchor,t[r].head,"+input");t=e.listSelections();for(var n=0;n<t.length;n++)e.indentLine(t[n].from().line,null,!0);Nn(e)}))},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function rs(e,t){var r=He(e.doc,t),n=Bt(r);return n!=r&&(t=Ke(n)),es(!0,e,n,t,1)}function ns(e,t){var r=rs(e,t.line),n=He(e.doc,r.line),i=ue(n,e.doc.direction);if(!i||0==i[0].level){var o=Math.max(r.ch,n.text.search(/\S/)),s=t.line==r.line&&t.ch<=o&&t.ch;return et(r.line,s?0:o,r.sticky)}return r}function is(e,t,r){if("string"==typeof t&&!(t=ts[t]))return!1;e.display.input.ensurePolled();var n=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r&&(e.display.shift=!1),i=t(e)!=U}finally{e.display.shift=n,e.state.suppressEdits=!1}return i}var os=new P;function ss(e,t,r,n){var i=e.state.keySeq;if(i){if(Wo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:os.set(50,(function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())})),as(e,i+" "+t,r,n))return!0}return as(e,t,r,n)}function as(e,t,r,n){var i=function(e,t,r){for(var n=0;n<e.state.keyMaps.length;n++){var i=Ho(t,e.state.keyMaps[n],r,e);if(i)return i}return e.options.extraKeys&&Ho(t,e.options.extraKeys,r,e)||Ho(t,e.options.keyMap,r,e)}(e,t,n);return"multi"==i&&(e.state.keySeq=t),"handled"==i&&ar(e,"keyHandled",e,t,r),"handled"!=i&&"multi"!=i||(be(r),wn(e)),!!i}function ls(e,t){var r=Jo(t,!0);return!!r&&(t.shiftKey&&!e.state.keySeq?ss(e,"Shift-"+r,t,(function(t){return is(e,t,!0)}))||ss(e,r,t,(function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return is(e,t)})):ss(e,r,t,(function(t){return is(e,t)})))}var us=null;function cs(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||(t.curOp.focus=M(),ge(t,e)))){s&&a<11&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var i=ls(t,e);f&&(us=i?n:null,i||88!=n||Ie||!(m?e.metaKey:e.ctrlKey)||t.replaceSelection("",null,"cut")),r&&!m&&!i&&46==n&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){var t=e.display.lineDiv;function r(e){18!=e.keyCode&&e.altKey||(_(t,"CodeMirror-crosshair"),pe(document,"keyup",r),pe(document,"mouseover",r))}I(t,"CodeMirror-crosshair"),fe(document,"keyup",r),fe(document,"mouseover",r)}(t)}}function fs(e){16==e.keyCode&&(this.doc.sel.shift=!1),ge(this,e)}function hs(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||wr(t.display,e)||ge(t,e)||e.ctrlKey&&!e.altKey||m&&e.metaKey)){var r=e.keyCode,n=e.charCode;if(f&&r==us)return us=null,void be(e);if(!f||e.which&&!(e.which<10)||!ls(t,e)){var i=String.fromCharCode(null==n?r:n);"\b"!=i&&(function(e,t,r){return ss(e,"'"+r+"'",t,(function(t){return is(e,t,!0)}))}(t,e,i)||t.display.input.onKeyPress(e))}}}var ps,ds,gs=function(e,t,r){this.time=e,this.pos=t,this.button=r};function vs(e){var t=this,r=t.display;if(!(ge(t,e)||r.activeTouch&&r.input.supportsTouch()))if(r.input.ensurePolled(),r.shift=e.shiftKey,wr(r,e))l||(r.scroller.draggable=!1,setTimeout((function(){return r.scroller.draggable=!0}),100));else if(!bs(t,e)){var n=un(t,e),i=Se(e),o=n?function(e,t){var r=+new Date;return ds&&ds.compare(r,e,t)?(ps=ds=null,"triple"):ps&&ps.compare(r,e,t)?(ds=new gs(r,e,t),ps=null,"double"):(ps=new gs(r,e,t),ds=null,"single")}(n,i):"single";window.focus(),1==i&&t.state.selectingText&&t.state.selectingText(e),n&&function(e,t,r,n,i){var o="Click";"double"==n?o="Double"+o:"triple"==n&&(o="Triple"+o);return ss(e,Vo(o=(1==t?"Left":2==t?"Middle":"Right")+o,i),i,(function(t){if("string"==typeof t&&(t=ts[t]),!t)return!1;var n=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n=t(e,r)!=U}finally{e.state.suppressEdits=!1}return n}))}(t,i,n,o,e)||(1==i?n?function(e,t,r,n){s?setTimeout(D(kn,e),0):e.curOp.focus=M();var i,o=function(e,t,r){var n=e.getOption("configureMouse"),i=n?n(e,t,r):{};if(null==i.unit){var o=b?r.shiftKey&&r.metaKey:r.altKey;i.unit=o?"rectangle":"single"==t?"char":"double"==t?"word":"line"}(null==i.extend||e.doc.extend)&&(i.extend=e.doc.extend||r.shiftKey);null==i.addNew&&(i.addNew=m?r.metaKey:r.ctrlKey);null==i.moveOnDrag&&(i.moveOnDrag=!(m?r.altKey:r.ctrlKey));return i}(e,r,n),u=e.doc.sel;e.options.dragDrop&&Ae&&!e.isReadOnly()&&"single"==r&&(i=u.contains(t))>-1&&(tt((i=u.ranges[i]).from(),t)<0||t.xRel>0)&&(tt(i.to(),t)>0||t.xRel<0)?function(e,t,r,n){var i=e.display,o=!1,u=ei(e,(function(t){l&&(i.scroller.draggable=!1),e.state.draggingText=!1,pe(i.wrapper.ownerDocument,"mouseup",u),pe(i.wrapper.ownerDocument,"mousemove",c),pe(i.scroller,"dragstart",f),pe(i.scroller,"drop",u),o||(be(t),n.addNew||Vi(e.doc,r,null,null,n.extend),l&&!h||s&&9==a?setTimeout((function(){i.wrapper.ownerDocument.body.focus({preventScroll:!0}),i.input.focus()}),20):i.input.focus())})),c=function(e){o=o||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},f=function(){return o=!0};l&&(i.scroller.draggable=!0);e.state.draggingText=u,u.copy=!n.moveOnDrag,i.scroller.dragDrop&&i.scroller.dragDrop();fe(i.wrapper.ownerDocument,"mouseup",u),fe(i.wrapper.ownerDocument,"mousemove",c),fe(i.scroller,"dragstart",f),fe(i.scroller,"drop",u),Cn(e),setTimeout((function(){return i.input.focus()}),20)}(e,n,t,o):function(e,t,r,n){var i=e.display,o=e.doc;be(t);var s,a,l=o.sel,u=l.ranges;n.addNew&&!n.extend?(a=o.sel.contains(r),s=a>-1?u[a]:new Ci(r,r)):(s=o.sel.primary(),a=o.sel.primIndex);if("rectangle"==n.unit)n.addNew||(s=new Ci(r,r)),r=un(e,t,!0,!0),a=-1;else{var c=ys(e,r,n.unit);s=n.extend?Wi(s,c.anchor,c.head,n.extend):c}n.addNew?-1==a?(a=u.length,Zi(o,Si(e,u.concat([s]),a),{scroll:!1,origin:"*mouse"})):u.length>1&&u[a].empty()&&"char"==n.unit&&!n.extend?(Zi(o,Si(e,u.slice(0,a).concat(u.slice(a+1)),0),{scroll:!1,origin:"*mouse"}),l=o.sel):Ki(o,a,s,z):(a=0,Zi(o,new ki([s],0),z),l=o.sel);var f=r;function h(t){if(0!=tt(f,t))if(f=t,"rectangle"==n.unit){for(var i=[],u=e.options.tabSize,c=B(He(o,r.line).text,r.ch,u),h=B(He(o,t.line).text,t.ch,u),p=Math.min(c,h),d=Math.max(c,h),g=Math.min(r.line,t.line),v=Math.min(e.lastLine(),Math.max(r.line,t.line));g<=v;g++){var y=He(o,g).text,m=X(y,p,u);p==d?i.push(new Ci(et(g,m),et(g,m))):y.length>m&&i.push(new Ci(et(g,m),et(g,X(y,d,u))))}i.length||i.push(new Ci(r,r)),Zi(o,Si(e,l.ranges.slice(0,a).concat(i),a),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var b,x=s,w=ys(e,t,n.unit),k=x.anchor;tt(w.anchor,k)>0?(b=w.head,k=ot(x.from(),w.anchor)):(b=w.anchor,k=it(x.to(),w.head));var C=l.ranges.slice(0);C[a]=function(e,t){var r=t.anchor,n=t.head,i=He(e.doc,r.line);if(0==tt(r,n)&&r.sticky==n.sticky)return t;var o=ue(i);if(!o)return t;var s=ae(o,r.ch,r.sticky),a=o[s];if(a.from!=r.ch&&a.to!=r.ch)return t;var l,u=s+(a.from==r.ch==(1!=a.level)?0:1);if(0==u||u==o.length)return t;if(n.line!=r.line)l=(n.line-r.line)*("ltr"==e.doc.direction?1:-1)>0;else{var c=ae(o,n.ch,n.sticky),f=c-s||(n.ch-r.ch)*(1==a.level?-1:1);l=c==u-1||c==u?f<0:f>0}var h=o[u+(l?-1:0)],p=l==(1==h.level),d=p?h.from:h.to,g=p?"after":"before";return r.ch==d&&r.sticky==g?t:new Ci(new et(r.line,d,g),n)}(e,new Ci(at(o,k),b)),Zi(o,Si(e,C,a),z)}}var p=i.wrapper.getBoundingClientRect(),d=0;function g(t){var r=++d,s=un(e,t,!0,"rectangle"==n.unit);if(s)if(0!=tt(s,f)){e.curOp.focus=M(),h(s);var a=En(i,o);(s.line>=a.to||s.line<a.from)&&setTimeout(ei(e,(function(){d==r&&g(t)})),150)}else{var l=t.clientY<p.top?-20:t.clientY>p.bottom?20:0;l&&setTimeout(ei(e,(function(){d==r&&(i.scroller.scrollTop+=l,g(t))})),50)}}function v(t){e.state.selectingText=!1,d=1/0,t&&(be(t),i.input.focus()),pe(i.wrapper.ownerDocument,"mousemove",y),pe(i.wrapper.ownerDocument,"mouseup",m),o.history.lastSelOrigin=null}var y=ei(e,(function(e){0!==e.buttons&&Se(e)?g(e):v(e)})),m=ei(e,v);e.state.selectingText=m,fe(i.wrapper.ownerDocument,"mousemove",y),fe(i.wrapper.ownerDocument,"mouseup",m)}(e,n,t,o)}(t,n,o,e):Ce(e)==r.scroller&&be(e):2==i?(n&&Vi(t.doc,n),setTimeout((function(){return r.input.focus()}),20)):3==i&&(C?t.display.input.onContextMenu(e):Cn(t)))}}function ys(e,t,r){if("char"==r)return new Ci(t,t);if("word"==r)return e.findWordAt(t);if("line"==r)return new Ci(et(t.line,0),at(e.doc,et(t.line+1,0)));var n=r(e,t);return new Ci(n.from,n.to)}function ms(e,t,r,n){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch(c){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&be(t);var s=e.display,a=s.lineDiv.getBoundingClientRect();if(o>a.bottom||!ye(e,r))return we(t);o-=a.top-s.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var u=s.gutters.childNodes[l];if(u&&u.getBoundingClientRect().right>=i)return de(e,r,e,Ye(e.doc,o),e.display.gutterSpecs[l].className,t),we(t)}}function bs(e,t){return ms(e,t,"gutterClick",!0)}function xs(e,t){wr(e.display,t)||function(e,t){if(!ye(e,"gutterContextMenu"))return!1;return ms(e,t,"gutterContextMenu",!1)}(e,t)||ge(e,t,"contextmenu")||C||e.display.input.onContextMenu(t)}function ws(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Pr(e)}gs.prototype.compare=function(e,t,r){return this.time+400>e&&0==tt(t,this.pos)&&r==this.button};var ks={toString:function(){return"CodeMirror.Init"}},Cs={},Ss={};function Fs(e,t,r){if(!t!=!(r&&r!=ks)){var n=e.display.dragFunctions,i=t?fe:pe;i(e.display.scroller,"dragstart",n.start),i(e.display.scroller,"dragenter",n.enter),i(e.display.scroller,"dragover",n.over),i(e.display.scroller,"dragleave",n.leave),i(e.display.scroller,"drop",n.drop)}}function _s(e){e.options.lineWrapping?(I(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(_(e.display.wrapper,"CodeMirror-wrap"),Xt(e)),ln(e),fn(e),Pr(e),setTimeout((function(){return Un(e)}),100)}function As(e,t){var r=this;if(!(this instanceof As))return new As(e,t);this.options=t=t?R(t):{},R(Cs,t,!1);var n=t.value;"string"==typeof n?n=new No(n,t.mode,null,t.lineSeparator,t.direction):t.mode&&(n.modeOption=t.mode),this.doc=n;var i=new As.inputStyles[t.inputStyle](this),o=this.display=new vi(e,n,i,t);for(var u in o.wrapper.CodeMirror=this,ws(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),qn(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new P,keySeq:null,specialChars:null},t.autofocus&&!y&&o.input.focus(),s&&a<11&&setTimeout((function(){return r.display.input.reset(!0)}),20),function(e){var t=e.display;fe(t.scroller,"mousedown",ei(e,vs)),fe(t.scroller,"dblclick",s&&a<11?ei(e,(function(t){if(!ge(e,t)){var r=un(e,t);if(r&&!bs(e,t)&&!wr(e.display,t)){be(t);var n=e.findWordAt(r);Vi(e.doc,n.anchor,n.head)}}})):function(t){return ge(e,t)||be(t)});fe(t.scroller,"contextmenu",(function(t){return xs(e,t)})),fe(t.input.getField(),"contextmenu",(function(r){t.scroller.contains(r.target)||xs(e,r)}));var r,n={end:0};function i(){t.activeTouch&&(r=setTimeout((function(){return t.activeTouch=null}),1e3),(n=t.activeTouch).end=+new Date)}function o(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function l(e,t){if(null==t.left)return!0;var r=t.left-e.left,n=t.top-e.top;return r*r+n*n>400}fe(t.scroller,"touchstart",(function(i){if(!ge(e,i)&&!o(i)&&!bs(e,i)){t.input.ensurePolled(),clearTimeout(r);var s=+new Date;t.activeTouch={start:s,moved:!1,prev:s-n.end<=300?n:null},1==i.touches.length&&(t.activeTouch.left=i.touches[0].pageX,t.activeTouch.top=i.touches[0].pageY)}})),fe(t.scroller,"touchmove",(function(){t.activeTouch&&(t.activeTouch.moved=!0)})),fe(t.scroller,"touchend",(function(r){var n=t.activeTouch;if(n&&!wr(t,r)&&null!=n.left&&!n.moved&&new Date-n.start<300){var o,s=e.coordsChar(t.activeTouch,"page");o=!n.prev||l(n,n.prev)?new Ci(s,s):!n.prev.prev||l(n,n.prev.prev)?e.findWordAt(s):new Ci(et(s.line,0),at(e.doc,et(s.line+1,0))),e.setSelection(o.anchor,o.head),e.focus(),be(r)}i()})),fe(t.scroller,"touchcancel",i),fe(t.scroller,"scroll",(function(){t.scroller.clientHeight&&(On(e,t.scroller.scrollTop),Rn(e,t.scroller.scrollLeft,!0),de(e,"scroll",e))})),fe(t.scroller,"mousewheel",(function(t){return wi(e,t)})),fe(t.scroller,"DOMMouseScroll",(function(t){return wi(e,t)})),fe(t.wrapper,"scroll",(function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0})),t.dragFunctions={enter:function(t){ge(e,t)||ke(t)},over:function(t){ge(e,t)||(!function(e,t){var r=un(e,t);if(r){var n=document.createDocumentFragment();mn(e,r,n),e.display.dragCursor||(e.display.dragCursor=L("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),E(e.display.dragCursor,n)}}(e,t),ke(t))},start:function(t){return function(e,t){if(s&&(!e.state.draggingText||+new Date-Mo<100))ke(t);else if(!ge(e,t)&&!wr(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!h)){var r=L("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",f&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),f&&r.parentNode.removeChild(r)}}(e,t)},drop:ei(e,Io),leave:function(t){ge(e,t)||jo(e)}};var u=t.input.getField();fe(u,"keyup",(function(t){return fs.call(e,t)})),fe(u,"keydown",ei(e,cs)),fe(u,"keypress",ei(e,hs)),fe(u,"focus",(function(t){return Sn(e,t)})),fe(u,"blur",(function(t){return Fn(e,t)}))}(this),Ro(),Hn(this),this.curOp.forceUpdate=!0,Oi(this,n),t.autofocus&&!y||this.hasFocus()?setTimeout((function(){r.hasFocus()&&!r.state.focused&&Sn(r)}),20):Fn(this),Ss)Ss.hasOwnProperty(u)&&Ss[u](this,t[u],ks);hi(this),t.finishInit&&t.finishInit(this);for(var c=0;c<Es.length;++c)Es[c](this);Wn(this),l&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}As.defaults=Cs,As.optionHandlers=Ss;var Es=[];function Ls(e,t,r,n){var i,o=e.doc;null==r&&(r="add"),"smart"==r&&(o.mode.indent?i=pt(e,t).state:r="prev");var s=e.options.tabSize,a=He(o,t),l=B(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var u,c=a.text.match(/^\s*/)[0];if(n||/\S/.test(a.text)){if("smart"==r&&((u=o.mode.indent(i,a.text.slice(c.length),a.text))==U||u>150)){if(!n)return;r="prev"}}else u=0,r="not";"prev"==r?u=t>o.first?B(He(o,t-1).text,null,s):0:"add"==r?u=l+e.options.indentUnit:"subtract"==r?u=l-e.options.indentUnit:"number"==typeof r&&(u=l+r),u=Math.max(0,u);var f="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(u/s);p;--p)h+=s,f+="\t";if(h<u&&(f+=W(u-h)),f!=c)return go(o,f,et(t,0),et(t,c.length),"+input"),a.stateAfter=null,!0;for(var d=0;d<o.sel.ranges.length;d++){var g=o.sel.ranges[d];if(g.head.line==t&&g.head.ch<c.length){var v=et(t,c.length);Ki(o,d,new Ci(v,v));break}}}As.defineInitHook=function(e){return Es.push(e)};var Ts=null;function Ns(e){Ts=e}function Ms(e,t,r,n,i){var o=e.doc;e.display.shift=!1,n||(n=o.sel);var s=+new Date-200,a="paste"==i||e.state.pasteIncoming>s,l=Ne(t),u=null;if(a&&n.ranges.length>1)if(Ts&&Ts.text.join("\n")==t){if(n.ranges.length%Ts.text.length==0){u=[];for(var c=0;c<Ts.text.length;c++)u.push(o.splitLines(Ts.text[c]))}}else l.length==n.ranges.length&&e.options.pasteLinesPerSelection&&(u=J(l,(function(e){return[e]})));for(var f=e.curOp.updateInput,h=n.ranges.length-1;h>=0;h--){var p=n.ranges[h],d=p.from(),g=p.to();p.empty()&&(r&&r>0?d=et(d.line,d.ch-r):e.state.overwrite&&!a?g=et(g.line,Math.min(He(o,g.line).text.length,g.ch+V(l).length)):a&&Ts&&Ts.lineWise&&Ts.text.join("\n")==l.join("\n")&&(d=g=et(d.line,0)));var v={from:d,to:g,text:u?u[h%u.length]:l,origin:i||(a?"paste":e.state.cutIncoming>s?"cut":"+input")};uo(e.doc,v),ar(e,"inputRead",e,v)}t&&!a&&js(e,t),Nn(e),e.curOp.updateInput<2&&(e.curOp.updateInput=f),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Is(e,t){var r=e.clipboardData&&e.clipboardData.getData("Text");if(r)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||Zn(t,(function(){return Ms(t,r,0,null,"paste")})),!0}function js(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var r=e.doc.sel,n=r.ranges.length-1;n>=0;n--){var i=r.ranges[n];if(!(i.head.ch>100||n&&r.ranges[n-1].head.line==i.head.line)){var o=e.getModeAt(i.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(t.indexOf(o.electricChars.charAt(a))>-1){s=Ls(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(He(e.doc,i.head.line).text.slice(0,i.head.ch))&&(s=Ls(e,i.head.line,"smart"));s&&ar(e,"electricInput",e,i.head.line)}}}function Os(e){for(var t=[],r=[],n=0;n<e.doc.sel.ranges.length;n++){var i=e.doc.sel.ranges[n].head.line,o={anchor:et(i,0),head:et(i+1,0)};r.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:r}}function Ds(e,t,r,n){e.setAttribute("autocorrect",r?"":"off"),e.setAttribute("autocapitalize",n?"":"off"),e.setAttribute("spellcheck",!!t)}function Rs(){var e=L("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=L("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?e.style.width="1000px":e.setAttribute("wrap","off"),g&&(e.style.border="1px solid black"),Ds(e),t}function Bs(e,t,r,n,i){var o=t,s=r,a=He(e,t.line),l=i&&"rtl"==e.direction?-r:r;function u(o){var s,u;if("codepoint"==n){var c=a.text.charCodeAt(t.ch+(n>0?0:-1));s=isNaN(c)?null:new et(t.line,Math.max(0,Math.min(a.text.length,t.ch+r*(c>=55296&&c<56320?2:1))),-r)}else s=i?function(e,t,r,n){var i=ue(t,e.doc.direction);if(!i)return Zo(t,r,n);r.ch>=t.text.length?(r.ch=t.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after");var o=ae(i,r.ch,r.sticky),s=i[o];if("ltr"==e.doc.direction&&s.level%2==0&&(n>0?s.to>r.ch:s.from<r.ch))return Zo(t,r,n);var a,l=function(e,r){return $o(t,e instanceof et?e.ch:e,r)},u=function(r){return e.options.lineWrapping?(a=a||Nr(e,t),Yr(e,t,a,r)):{begin:0,end:t.text.length}},c=u("before"==r.sticky?l(r,-1):r.ch);if("rtl"==e.doc.direction||1==s.level){var f=1==s.level==n<0,h=l(r,f?1:-1);if(null!=h&&(f?h<=s.to&&h<=c.end:h>=s.from&&h>=c.begin)){var p=f?"before":"after";return new et(r.line,h,p)}}var d=function(e,t,n){for(var o=function(e,t){return t?new et(r.line,l(e,1),"before"):new et(r.line,e,"after")};e>=0&&e<i.length;e+=t){var s=i[e],a=t>0==(1!=s.level),u=a?n.begin:l(n.end,-1);if(s.from<=u&&u<s.to)return o(u,a);if(u=a?s.from:l(s.to,-1),n.begin<=u&&u<n.end)return o(u,a)}},g=d(o+n,n,c);if(g)return g;var v=n>0?c.end:l(c.begin,-1);return null==v||n>0&&v==t.text.length||!(g=d(n>0?0:i.length-1,n,u(v)))?null:g}(e.cm,a,t,r):Zo(a,t,r);if(null==s){if(o||(u=t.line+l)<e.first||u>=e.first+e.size||(t=new et(u,t.ch,t.sticky),!(a=He(e,u))))return!1;t=es(i,e.cm,a,t.line,l)}else t=s;return!0}if("char"==n||"codepoint"==n)u();else if("column"==n)u(!0);else if("word"==n||"group"==n)for(var c=null,f="group"==n,h=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(r<0)||u(!p);p=!1){var d=a.text.charAt(t.ch)||"\n",g=ee(d,h)?"w":f&&"\n"==d?"n":!f||/\s/.test(d)?null:"p";if(!f||p||g||(g="s"),c&&c!=g){r<0&&(r=1,u(),t.sticky="after");break}if(g&&(c=g),r>0&&!u(!p))break}var v=oo(e,t,o,s,!0);return rt(o,v)&&(v.hitSide=!0),v}function Ps(e,t,r,n){var i,o,s=e.doc,a=t.left;if("page"==n){var l=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),u=Math.max(l-.5*rn(e.display),3);i=(r>0?t.bottom:t.top)+r*u}else"line"==n&&(i=r>0?t.bottom+3:t.top-3);for(;(o=Jr(e,a,i)).outside;){if(r<0?i<=0:i>=s.height){o.hitSide=!0;break}i+=5*r}return o}var Qs=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new P,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function Us(e,t){var r=Tr(e,t.line);if(!r||r.hidden)return null;var n=He(e.doc,t.line),i=Er(r,n,t.line),o=ue(n,e.doc.direction),s="left";o&&(s=ae(o,t.ch)%2?"right":"left");var a=Or(i.map,t.ch,s);return a.offset="right"==a.collapse?a.end:a.start,a}function Gs(e,t){return t&&(e.bad=!0),e}function zs(e,t,r){var n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[r]))return Gs(e.clipPos(et(e.display.viewTo-1)),!0);t=null,r=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==n)return qs(o,t,r)}}function qs(e,t,r){var n=e.text.firstChild,i=!1;if(!t||!N(n,t))return Gs(et(Ke(e.line),0),!0);if(t==n&&(i=!0,t=n.childNodes[r],r=0,!t)){var o=e.rest?V(e.rest):e.line;return Gs(et(Ke(o),o.text.length),i)}var s=3==t.nodeType?t:null,a=t;for(s||1!=t.childNodes.length||3!=t.firstChild.nodeType||(s=t.firstChild,r&&(r=s.nodeValue.length));a.parentNode!=n;)a=a.parentNode;var l=e.measure,u=l.maps;function c(t,r,n){for(var i=-1;i<(u?u.length:0);i++)for(var o=i<0?l.map:u[i],s=0;s<o.length;s+=3){var a=o[s+2];if(a==t||a==r){var c=Ke(i<0?e.line:e.rest[i]),f=o[s]+n;return(n<0||a!=t)&&(f=o[s+(n?1:0)]),et(c,f)}}}var f=c(s,a,r);if(f)return Gs(f,i);for(var h=a.nextSibling,p=s?s.nodeValue.length-r:0;h;h=h.nextSibling){if(f=c(h,h.firstChild,0))return Gs(et(f.line,f.ch-p),i);p+=h.textContent.length}for(var d=a.previousSibling,g=r;d;d=d.previousSibling){if(f=c(d,d.firstChild,-1))return Gs(et(f.line,f.ch+g),i);g+=d.textContent.length}}Qs.prototype.init=function(e){var t=this,r=this,n=r.cm,i=r.div=e.lineDiv;function o(e){for(var t=e.target;t;t=t.parentNode){if(t==i)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}return!1}function s(e){if(o(e)&&!ge(n,e)){if(n.somethingSelected())Ns({lineWise:!1,text:n.getSelections()}),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=Os(n);Ns({lineWise:!0,text:t.text}),"cut"==e.type&&n.operation((function(){n.setSelections(t.ranges,0,G),n.replaceSelection("",null,"cut")}))}if(e.clipboardData){e.clipboardData.clearData();var s=Ts.text.join("\n");if(e.clipboardData.setData("Text",s),e.clipboardData.getData("Text")==s)return void e.preventDefault()}var a=Rs(),l=a.firstChild;n.display.lineSpace.insertBefore(a,n.display.lineSpace.firstChild),l.value=Ts.text.join("\n");var u=document.activeElement;O(l),setTimeout((function(){n.display.lineSpace.removeChild(a),u.focus(),u==i&&r.showPrimarySelection()}),50)}}Ds(i,n.options.spellcheck,n.options.autocorrect,n.options.autocapitalize),fe(i,"paste",(function(e){!o(e)||ge(n,e)||Is(e,n)||a<=11&&setTimeout(ei(n,(function(){return t.updateFromDOM()})),20)})),fe(i,"compositionstart",(function(e){t.composing={data:e.data,done:!1}})),fe(i,"compositionupdate",(function(e){t.composing||(t.composing={data:e.data,done:!1})})),fe(i,"compositionend",(function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)})),fe(i,"touchstart",(function(){return r.forceCompositionEnd()})),fe(i,"input",(function(){t.composing||t.readFromDOMSoon()})),fe(i,"copy",s),fe(i,"cut",s)},Qs.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},Qs.prototype.prepareSelection=function(){var e=yn(this.cm,!1);return e.focus=document.activeElement==this.div,e},Qs.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},Qs.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Qs.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,n=t.doc.sel.primary(),i=n.from(),o=n.to();if(t.display.viewTo==t.display.viewFrom||i.line>=t.display.viewTo||o.line<t.display.viewFrom)e.removeAllRanges();else{var s=zs(t,e.anchorNode,e.anchorOffset),a=zs(t,e.focusNode,e.focusOffset);if(!s||s.bad||!a||a.bad||0!=tt(ot(s,a),i)||0!=tt(it(s,a),o)){var l=t.display.view,u=i.line>=t.display.viewFrom&&Us(t,i)||{node:l[0].measure.map[2],offset:0},c=o.line<t.display.viewTo&&Us(t,o);if(!c){var f=l[l.length-1].measure,h=f.maps?f.maps[f.maps.length-1]:f.map;c={node:h[h.length-1],offset:h[h.length-2]-h[h.length-3]}}if(u&&c){var p,d=e.rangeCount&&e.getRangeAt(0);try{p=F(u.node,u.offset,c.offset,c.node)}catch(Te){}p&&(!r&&t.state.focused?(e.collapse(u.node,u.offset),p.collapsed||(e.removeAllRanges(),e.addRange(p))):(e.removeAllRanges(),e.addRange(p)),d&&null==e.anchorNode?e.addRange(d):r&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},Qs.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout((function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation((function(){return e.cm.curOp.selectionChanged=!0}))}),20)},Qs.prototype.showMultipleSelections=function(e){E(this.cm.display.cursorDiv,e.cursors),E(this.cm.display.selectionDiv,e.selection)},Qs.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},Qs.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return N(this.div,t)},Qs.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&document.activeElement==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Qs.prototype.blur=function(){this.div.blur()},Qs.prototype.getField=function(){return this.div},Qs.prototype.supportsTouch=function(){return!0},Qs.prototype.receivedFocus=function(){var e=this;this.selectionInEditor()?this.pollSelection():Zn(this.cm,(function(){return e.cm.curOp.selectionChanged=!0})),this.polling.set(this.cm.options.pollInterval,(function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}))},Qs.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},Qs.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=this.getSelection(),t=this.cm;if(v&&c&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var r=zs(t,e.anchorNode,e.anchorOffset),n=zs(t,e.focusNode,e.focusOffset);r&&n&&Zn(t,(function(){Zi(t.doc,Fi(r,n),G),(r.bad||n.bad)&&(t.curOp.selectionChanged=!0)}))}}},Qs.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,r,n=this.cm,i=n.display,o=n.doc.sel.primary(),s=o.from(),a=o.to();if(0==s.ch&&s.line>n.firstLine()&&(s=et(s.line-1,He(n.doc,s.line-1).length)),a.ch==He(n.doc,a.line).text.length&&a.line<n.lastLine()&&(a=et(a.line+1,0)),s.line<i.viewFrom||a.line>i.viewTo-1)return!1;s.line==i.viewFrom||0==(e=cn(n,s.line))?(t=Ke(i.view[0].line),r=i.view[0].node):(t=Ke(i.view[e].line),r=i.view[e-1].node.nextSibling);var l,u,c=cn(n,a.line);if(c==i.view.length-1?(l=i.viewTo-1,u=i.lineDiv.lastChild):(l=Ke(i.view[c+1].line)-1,u=i.view[c+1].node.previousSibling),!r)return!1;for(var f=n.doc.splitLines(function(e,t,r,n,i){var o="",s=!1,a=e.doc.lineSeparator(),l=!1;function u(e){return function(t){return t.id==e}}function c(){s&&(o+=a,l&&(o+=a),s=l=!1)}function f(e){e&&(c(),o+=e)}function h(t){if(1==t.nodeType){var r=t.getAttribute("cm-text");if(r)return void f(r);var o,p=t.getAttribute("cm-marker");if(p){var d=e.findMarks(et(n,0),et(i+1,0),u(+p));return void(d.length&&(o=d[0].find(0))&&f(We(e.doc,o.from,o.to).join(a)))}if("false"==t.getAttribute("contenteditable"))return;var g=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;g&&c();for(var v=0;v<t.childNodes.length;v++)h(t.childNodes[v]);/^(pre|p)$/i.test(t.nodeName)&&(l=!0),g&&(s=!0)}else 3==t.nodeType&&f(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;h(t),t!=r;)t=t.nextSibling,l=!1;return o}(n,r,u,t,l)),h=We(n.doc,et(t,0),et(l,He(n.doc,l).text.length));f.length>1&&h.length>1;)if(V(f)==V(h))f.pop(),h.pop(),l--;else{if(f[0]!=h[0])break;f.shift(),h.shift(),t++}for(var p=0,d=0,g=f[0],v=h[0],y=Math.min(g.length,v.length);p<y&&g.charCodeAt(p)==v.charCodeAt(p);)++p;for(var m=V(f),b=V(h),x=Math.min(m.length-(1==f.length?p:0),b.length-(1==h.length?p:0));d<x&&m.charCodeAt(m.length-d-1)==b.charCodeAt(b.length-d-1);)++d;if(1==f.length&&1==h.length&&t==s.line)for(;p&&p>s.ch&&m.charCodeAt(m.length-d-1)==b.charCodeAt(b.length-d-1);)p--,d++;f[f.length-1]=m.slice(0,m.length-d).replace(/^\u200b+/,""),f[0]=f[0].slice(p).replace(/\u200b+$/,"");var w=et(t,p),k=et(l,h.length?V(h).length-d:0);return f.length>1||f[0]||tt(w,k)?(go(n.doc,f,w,k,"+input"),!0):void 0},Qs.prototype.ensurePolled=function(){this.forceCompositionEnd()},Qs.prototype.reset=function(){this.forceCompositionEnd()},Qs.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Qs.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout((function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()}),80))},Qs.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Zn(this.cm,(function(){return fn(e.cm)}))},Qs.prototype.setUneditable=function(e){e.contentEditable="false"},Qs.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||ei(this.cm,Ms)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},Qs.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},Qs.prototype.onContextMenu=function(){},Qs.prototype.resetPosition=function(){},Qs.prototype.needsContentAttribute=!0;var Xs=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new P,this.hasSelection=!1,this.composing=null};Xs.prototype.init=function(e){var t=this,r=this,n=this.cm;this.createField(e);var i=this.textarea;function o(e){if(!ge(n,e)){if(n.somethingSelected())Ns({lineWise:!1,text:n.getSelections()});else{if(!n.options.lineWiseCopyCut)return;var t=Os(n);Ns({lineWise:!0,text:t.text}),"cut"==e.type?n.setSelections(t.ranges,null,G):(r.prevInput="",i.value=t.text.join("\n"),O(i))}"cut"==e.type&&(n.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),g&&(i.style.width="0px"),fe(i,"input",(function(){s&&a>=9&&t.hasSelection&&(t.hasSelection=null),r.poll()})),fe(i,"paste",(function(e){ge(n,e)||Is(e,n)||(n.state.pasteIncoming=+new Date,r.fastPoll())})),fe(i,"cut",o),fe(i,"copy",o),fe(e.scroller,"paste",(function(t){if(!wr(e,t)&&!ge(n,t)){if(!i.dispatchEvent)return n.state.pasteIncoming=+new Date,void r.focus();var o=new Event("paste");o.clipboardData=t.clipboardData,i.dispatchEvent(o)}})),fe(e.lineSpace,"selectstart",(function(t){wr(e,t)||be(t)})),fe(i,"compositionstart",(function(){var e=n.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}})),fe(i,"compositionend",(function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)}))},Xs.prototype.createField=function(e){this.wrapper=Rs(),this.textarea=this.wrapper.firstChild},Xs.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Xs.prototype.prepareSelection=function(){var e=this.cm,t=e.display,r=e.doc,n=yn(e);if(e.options.moveInputWithCursor){var i=Hr(e,r.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+s.top-o.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+s.left-o.left))}return n},Xs.prototype.showSelection=function(e){var t=this.cm.display;E(t.cursorDiv,e.cursors),E(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Xs.prototype.reset=function(e){if(!this.contextMenuPending&&!this.composing){var t=this.cm;if(t.somethingSelected()){this.prevInput="";var r=t.getSelection();this.textarea.value=r,t.state.focused&&O(this.textarea),s&&a>=9&&(this.hasSelection=r)}else e||(this.prevInput=this.textarea.value="",s&&a>=9&&(this.hasSelection=null))}},Xs.prototype.getField=function(){return this.textarea},Xs.prototype.supportsTouch=function(){return!1},Xs.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!y||M()!=this.textarea))try{this.textarea.focus()}catch(Te){}},Xs.prototype.blur=function(){this.textarea.blur()},Xs.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Xs.prototype.receivedFocus=function(){this.slowPoll()},Xs.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,(function(){e.poll(),e.cm.state.focused&&e.slowPoll()}))},Xs.prototype.fastPoll=function(){var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,(function r(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,r))}))},Xs.prototype.poll=function(){var e=this,t=this.cm,r=this.textarea,n=this.prevInput;if(this.contextMenuPending||!t.state.focused||Me(r)&&!n&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=r.value;if(i==n&&!t.somethingSelected())return!1;if(s&&a>=9&&this.hasSelection===i||m&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203!=o||n||(n="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,u=Math.min(n.length,i.length);l<u&&n.charCodeAt(l)==i.charCodeAt(l);)++l;return Zn(t,(function(){Ms(t,i.slice(l),n.length-l,null,e.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?r.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))})),!0},Xs.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Xs.prototype.onKeyPress=function(){s&&a>=9&&(this.hasSelection=null),this.fastPoll()},Xs.prototype.onContextMenu=function(e){var t=this,r=t.cm,n=r.display,i=t.textarea;t.contextMenuPending&&t.contextMenuPending();var o=un(r,e),u=n.scroller.scrollTop;if(o&&!f){r.options.resetSelectionOnContextMenu&&-1==r.doc.sel.contains(o)&&ei(r,Zi)(r.doc,Fi(o),G);var c,h=i.style.cssText,p=t.wrapper.style.cssText,d=t.wrapper.offsetParent.getBoundingClientRect();if(t.wrapper.style.cssText="position: static",i.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-d.top-5)+"px; left: "+(e.clientX-d.left-5)+"px;\n      z-index: 1000; background: "+(s?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",l&&(c=window.scrollY),n.input.focus(),l&&window.scrollTo(null,c),n.input.reset(),r.somethingSelected()||(i.value=t.prevInput=" "),t.contextMenuPending=y,n.selForContextMenu=r.doc.sel,clearTimeout(n.detectingSelectAll),s&&a>=9&&v(),C){ke(e);var g=function(){pe(window,"mouseup",g),setTimeout(y,20)};fe(window,"mouseup",g)}else setTimeout(y,50)}function v(){if(null!=i.selectionStart){var e=r.somethingSelected(),o="​"+(e?i.value:"");i.value="⇚",i.value=o,t.prevInput=e?"":"​",i.selectionStart=1,i.selectionEnd=o.length,n.selForContextMenu=r.doc.sel}}function y(){if(t.contextMenuPending==y&&(t.contextMenuPending=!1,t.wrapper.style.cssText=p,i.style.cssText=h,s&&a<9&&n.scrollbars.setScrollTop(n.scroller.scrollTop=u),null!=i.selectionStart)){(!s||s&&a<9)&&v();var e=0,o=function(){n.selForContextMenu==r.doc.sel&&0==i.selectionStart&&i.selectionEnd>0&&"​"==t.prevInput?ei(r,ao)(r):e++<10?n.detectingSelectAll=setTimeout(o,500):(n.selForContextMenu=null,n.input.reset())};n.detectingSelectAll=setTimeout(o,200)}}},Xs.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e,this.textarea.readOnly=!!e},Xs.prototype.setUneditable=function(){},Xs.prototype.needsContentAttribute=!1,function(e){var t=e.optionHandlers;function r(r,n,i,o){e.defaults[r]=n,i&&(t[r]=o?function(e,t,r){r!=ks&&i(e,t,r)}:i)}e.defineOption=r,e.Init=ks,r("value","",(function(e,t){return e.setValue(t)}),!0),r("mode",null,(function(e,t){e.doc.modeOption=t,Ti(e)}),!0),r("indentUnit",2,Ti,!0),r("indentWithTabs",!1),r("smartIndent",!0),r("tabSize",4,(function(e){Ni(e),Pr(e),fn(e)}),!0),r("lineSeparator",null,(function(e,t){if(e.doc.lineSep=t,t){var r=[],n=e.doc.first;e.doc.iter((function(e){for(var i=0;;){var o=e.text.indexOf(t,i);if(-1==o)break;i=o+t.length,r.push(et(n,o))}n++}));for(var i=r.length-1;i>=0;i--)go(e.doc,t,r[i],et(r[i].line,r[i].ch+t.length))}})),r("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200c\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,(function(e,t,r){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),r!=ks&&e.refresh()})),r("specialCharPlaceholder",$t,(function(e){return e.refresh()}),!0),r("electricChars",!0),r("inputStyle",y?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),!0),r("spellcheck",!1,(function(e,t){return e.getInputField().spellcheck=t}),!0),r("autocorrect",!1,(function(e,t){return e.getInputField().autocorrect=t}),!0),r("autocapitalize",!1,(function(e,t){return e.getInputField().autocapitalize=t}),!0),r("rtlMoveVisually",!x),r("wholeLineUpdateBefore",!0),r("theme","default",(function(e){ws(e),gi(e)}),!0),r("keyMap","default",(function(e,t,r){var n=Ko(t),i=r!=ks&&Ko(r);i&&i.detach&&i.detach(e,n),n.attach&&n.attach(e,i||null)})),r("extraKeys",null),r("configureMouse",null),r("lineWrapping",!1,_s,!0),r("gutters",[],(function(e,t){e.display.gutterSpecs=pi(t,e.options.lineNumbers),gi(e)}),!0),r("fixedGutter",!0,(function(e,t){e.display.gutters.style.left=t?sn(e.display)+"px":"0",e.refresh()}),!0),r("coverGutterNextToScrollbar",!1,(function(e){return Un(e)}),!0),r("scrollbarStyle","native",(function(e){qn(e),Un(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)}),!0),r("lineNumbers",!1,(function(e,t){e.display.gutterSpecs=pi(e.options.gutters,t),gi(e)}),!0),r("firstLineNumber",1,gi,!0),r("lineNumberFormatter",(function(e){return e}),gi,!0),r("showCursorWhenSelecting",!1,vn,!0),r("resetSelectionOnContextMenu",!0),r("lineWiseCopyCut",!0),r("pasteLinesPerSelection",!0),r("selectionsMayTouch",!1),r("readOnly",!1,(function(e,t){"nocursor"==t&&(Fn(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)})),r("screenReaderLabel",null,(function(e,t){t=""===t?null:t,e.display.input.screenReaderLabelChanged(t)})),r("disableInput",!1,(function(e,t){t||e.display.input.reset()}),!0),r("dragDrop",!0,Fs),r("allowDropFileTypes",null),r("cursorBlinkRate",530),r("cursorScrollMargin",0),r("cursorHeight",1,vn,!0),r("singleCursorHeightPerLine",!0,vn,!0),r("workTime",100),r("workDelay",100),r("flattenSpans",!0,Ni,!0),r("addModeClass",!1,Ni,!0),r("pollInterval",100),r("undoDepth",200,(function(e,t){return e.doc.history.undoDepth=t})),r("historyEventDelay",1250),r("viewportMargin",10,(function(e){return e.refresh()}),!0),r("maxHighlightLength",1e4,Ni,!0),r("moveInputWithCursor",!0,(function(e,t){t||e.display.input.resetPosition()})),r("tabindex",null,(function(e,t){return e.display.input.getField().tabIndex=t||""})),r("autofocus",null),r("direction","ltr",(function(e,t){return e.doc.setDirection(t)}),!0),r("phrases",null)}(As),function(e){var t=e.optionHandlers,r=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,r){var n=this.options,i=n[e];n[e]==r&&"mode"!=e||(n[e]=r,t.hasOwnProperty(e)&&ei(this,t[e])(this,r,i),de(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Ko(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,r=0;r<t.length;++r)if(t[r]==e||t[r].name==e)return t.splice(r,1),!0},addOverlay:ti((function(t,r){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");!function(e,t,r){for(var n=0,i=r(t);n<e.length&&r(e[n])<=i;)n++;e.splice(n,0,t)}(this.state.overlays,{mode:n,modeSpec:t,opaque:r&&r.opaque,priority:r&&r.priority||0},(function(e){return e.priority})),this.state.modeGen++,fn(this)})),removeOverlay:ti((function(e){for(var t=this.state.overlays,r=0;r<t.length;++r){var n=t[r].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(r,1),this.state.modeGen++,void fn(this)}})),indentLine:ti((function(e,t,r){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),$e(this.doc,e)&&Ls(this,e,t,r)})),indentSelection:ti((function(e){for(var t=this.doc.sel.ranges,r=-1,n=0;n<t.length;n++){var i=t[n];if(i.empty())i.head.line>r&&(Ls(this,i.head.line,e,!0),r=i.head.line,n==this.doc.sel.primIndex&&Nn(this));else{var o=i.from(),s=i.to(),a=Math.max(r,o.line);r=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;l<r;++l)Ls(this,l,e);var u=this.doc.sel.ranges;0==o.ch&&t.length==u.length&&u[n].from().ch>0&&Ki(this.doc,n,new Ci(o,u[n].to()),G)}}})),getTokenAt:function(e,t){return mt(this,e,t)},getLineTokens:function(e,t){return mt(this,et(e),t,!0)},getTokenTypeAt:function(e){e=at(this.doc,e);var t,r=ht(this,He(this.doc,e.line)),n=0,i=(r.length-1)/2,o=e.ch;if(0==o)t=r[2];else for(;;){var s=n+i>>1;if((s?r[2*s-1]:0)>=o)i=s;else{if(!(r[2*s+1]<o)){t=r[2*s+2];break}n=s+1}}var a=t?t.indexOf("overlay "):-1;return a<0?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var r=this.doc.mode;return r.innerMode?e.innerMode(r,this.getTokenAt(t).state).mode:r},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!r.hasOwnProperty(t))return n;var i=r[t],o=this.getModeAt(e);if("string"==typeof o[t])i[o[t]]&&n.push(i[o[t]]);else if(o[t])for(var s=0;s<o[t].length;s++){var a=i[o[t][s]];a&&n.push(a)}else o.helperType&&i[o.helperType]?n.push(i[o.helperType]):i[o.name]&&n.push(i[o.name]);for(var l=0;l<i._global.length;l++){var u=i._global[l];u.pred(o,this)&&-1==Q(n,u.val)&&n.push(u.val)}return n},getStateAfter:function(e,t){var r=this.doc;return pt(this,(e=st(r,null==e?r.first+r.size-1:e))+1,t).state},cursorCoords:function(e,t){var r=this.doc.sel.primary();return Hr(this,null==e?r.head:"object"==typeof e?at(this.doc,e):e?r.from():r.to(),t||"page")},charCoords:function(e,t){return Xr(this,at(this.doc,e),t||"page")},coordsChar:function(e,t){return Jr(this,(e=qr(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=qr(this,{top:e,left:0},t||"page").top,Ye(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,r){var n,i=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,i=!0),n=He(this.doc,e)}else n=e;return zr(this,n,{top:0,left:0},t||"page",r||i).top+(i?this.doc.height-zt(n):0)},defaultTextHeight:function(){return rn(this.display)},defaultCharWidth:function(){return nn(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,r,n,i){var o,s,a,l=this.display,u=(e=Hr(this,at(this.doc,e))).bottom,c=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),l.sizer.appendChild(t),"over"==n)u=e.top;else if("above"==n||"near"==n){var f=Math.max(l.wrapper.clientHeight,this.doc.height),h=Math.max(l.sizer.clientWidth,l.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>f)&&e.top>t.offsetHeight?u=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=f&&(u=e.bottom),c+t.offsetWidth>h&&(c=h-t.offsetWidth)}t.style.top=u+"px",t.style.left=t.style.right="","right"==i?(c=l.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?c=0:"middle"==i&&(c=(l.sizer.clientWidth-t.offsetWidth)/2),t.style.left=c+"px"),r&&(o=this,s={left:c,top:u,right:c+t.offsetWidth,bottom:u+t.offsetHeight},null!=(a=Ln(o,s)).scrollTop&&On(o,a.scrollTop),null!=a.scrollLeft&&Rn(o,a.scrollLeft))},triggerOnKeyDown:ti(cs),triggerOnKeyPress:ti(hs),triggerOnKeyUp:fs,triggerOnMouseDown:ti(vs),execCommand:function(e){if(ts.hasOwnProperty(e))return ts[e].call(null,this)},triggerElectric:ti((function(e){js(this,e)})),findPosH:function(e,t,r,n){var i=1;t<0&&(i=-1,t=-t);for(var o=at(this.doc,e),s=0;s<t&&!(o=Bs(this.doc,o,i,r,n)).hitSide;++s);return o},moveH:ti((function(e,t){var r=this;this.extendSelectionsBy((function(n){return r.display.shift||r.doc.extend||n.empty()?Bs(r.doc,n.head,e,t,r.options.rtlMoveVisually):e<0?n.from():n.to()}),q)})),deleteH:ti((function(e,t){var r=this.doc.sel,n=this.doc;r.somethingSelected()?n.replaceSelection("",null,"+delete"):Yo(this,(function(r){var i=Bs(n,r.head,e,t,!1);return e<0?{from:i,to:r.head}:{from:r.head,to:i}}))})),findPosV:function(e,t,r,n){var i=1,o=n;t<0&&(i=-1,t=-t);for(var s=at(this.doc,e),a=0;a<t;++a){var l=Hr(this,s,"div");if(null==o?o=l.left:l.left=o,(s=Ps(this,l,i,r)).hitSide)break}return s},moveV:ti((function(e,t){var r=this,n=this.doc,i=[],o=!this.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy((function(s){if(o)return e<0?s.from():s.to();var a=Hr(r,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),i.push(a.left);var l=Ps(r,a,e,t);return"page"==t&&s==n.sel.primary()&&Tn(r,Xr(r,l,"div").top-a.top),l}),q),i.length)for(var s=0;s<n.sel.ranges.length;s++)n.sel.ranges[s].goalColumn=i[s]})),findWordAt:function(e){var t=He(this.doc,e.line).text,r=e.ch,n=e.ch;if(t){var i=this.getHelper(e,"wordChars");"before"!=e.sticky&&n!=t.length||!r?++n:--r;for(var o=t.charAt(r),s=ee(o,i)?function(e){return ee(e,i)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!ee(e)};r>0&&s(t.charAt(r-1));)--r;for(;n<t.length&&s(t.charAt(n));)++n}return new Ci(et(e.line,r),et(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?I(this.display.cursorDiv,"CodeMirror-overwrite"):_(this.display.cursorDiv,"CodeMirror-overwrite"),de(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==M()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:ti((function(e,t){Mn(this,e,t)})),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Fr(this)-this.display.barHeight,width:e.scrollWidth-Fr(this)-this.display.barWidth,clientHeight:Ar(this),clientWidth:_r(this)}},scrollIntoView:ti((function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:et(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?function(e,t){In(e),e.curOp.scrollToPos=t}(this,e):jn(this,e.from,e.to,e.margin)})),setSize:ti((function(e,t){var r=this,n=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&Br(this);var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,(function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){hn(r,i,"widget");break}++i})),this.curOp.forceUpdate=!0,de(this,"refresh",this)})),operation:function(e){return Zn(this,e)},startOperation:function(){return Hn(this)},endOperation:function(){return Wn(this)},refresh:ti((function(){var e=this.display.cachedTextHeight;fn(this),this.curOp.forceUpdate=!0,Pr(this),Mn(this,this.doc.scrollLeft,this.doc.scrollTop),ui(this.display),(null==e||Math.abs(e-rn(this.display))>.5||this.options.lineWrapping)&&ln(this),de(this,"refresh",this)})),swapDoc:ti((function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),Oi(this,e),Pr(this),this.display.input.reset(),Mn(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,ar(this,"swapDoc",this,t),t})),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},me(e),e.registerHelper=function(t,n,i){r.hasOwnProperty(t)||(r[t]=e[t]={_global:[]}),r[t][n]=i},e.registerGlobalHelper=function(t,n,i,o){e.registerHelper(t,n,o),r[t]._global.push({pred:i,val:o})}}(As);var Hs="iter insert remove copy getEditor constructor".split(" ");for(var Ws in No.prototype)No.prototype.hasOwnProperty(Ws)&&Q(Hs,Ws)<0&&(As.prototype[Ws]=function(e){return function(){return e.apply(this.doc,arguments)}}(No.prototype[Ws]));return me(No),As.inputStyles={textarea:Xs,contenteditable:Qs},As.defineMode=function(e){As.defaults.mode||"null"==e||(As.defaults.mode=e),Re.apply(this,arguments)},As.defineMIME=function(e,t){De[e]=t},As.defineMode("null",(function(){return{token:function(e){return e.skipToEnd()}}})),As.defineMIME("text/plain","null"),As.defineExtension=function(e,t){As.prototype[e]=t},As.defineDocExtension=function(e,t){No.prototype[e]=t},As.fromTextArea=function(e,t){if((t=t?R(t):{}).value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var r=M();t.autofocus=r==e||null!=e.getAttribute("autofocus")&&r==document.body}function n(){e.value=a.getValue()}var i;if(e.form&&(fe(e.form,"submit",n),!t.leaveSubmitMethodAlone)){var o=e.form;i=o.submit;try{var s=o.submit=function(){n(),o.submit=i,o.submit(),o.submit=s}}catch(Te){}}t.finishInit=function(r){r.save=n,r.getTextArea=function(){return e},r.toTextArea=function(){r.toTextArea=isNaN,n(),e.parentNode.removeChild(r.getWrapperElement()),e.style.display="",e.form&&(pe(e.form,"submit",n),t.leaveSubmitMethodAlone||"function"!=typeof e.form.submit||(e.form.submit=i))}},e.style.display="none";var a=As((function(t){return e.parentNode.insertBefore(t,e.nextSibling)}),t);return a},function(e){e.off=pe,e.on=fe,e.wheelEventPixels=xi,e.Doc=No,e.splitLines=Ne,e.countColumn=B,e.findColumn=X,e.isWordChar=Z,e.Pass=U,e.signal=de,e.Line=Ht,e.changeEnd=_i,e.scrollbarModel=zn,e.Pos=et,e.cmpPos=tt,e.modes=Oe,e.mimeModes=De,e.resolveMode=Be,e.getMode=Pe,e.modeExtensions=Qe,e.extendMode=Ue,e.copyState=Ge,e.startState=qe,e.innerMode=ze,e.commands=ts,e.keyMap=zo,e.keyName=Jo,e.isModifierKey=Wo,e.lookupKey=Ho,e.normalizeKeyMap=Xo,e.StringStream=Xe,e.SharedTextMarker=Ao,e.TextMarker=Fo,e.LineWidget=ko,e.e_preventDefault=be,e.e_stopPropagation=xe,e.e_stop=ke,e.addClass=I,e.contains=N,e.rmClass=_,e.keyNames=Po}(As),As.version="5.58.2",As})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.defineMode("turtle",(function(e){var t,r=e.indentUnit;function n(e){return new RegExp("^(?:"+e.join("|")+")$","i")}n([]);var i=n(["@prefix","@base","a"]),o=/[*+\-<>=&|]/;function s(e,r){var n,a=e.next();if(t=null,"<"!=a||e.match(/^[\s\u00a0=]/,!1)){if('"'==a||"'"==a)return r.tokenize=(n=a,function(e,t){for(var r,i=!1;null!=(r=e.next());){if(r==n&&!i){t.tokenize=s;break}i=!i&&"\\"==r}return"string"}),r.tokenize(e,r);if(/[{}\(\),\.;\[\]]/.test(a))return t=a,null;if("#"==a)return e.skipToEnd(),"comment";if(o.test(a))return e.eatWhile(o),null;if(":"==a)return"operator";if(e.eatWhile(/[_\w\d]/),":"==e.peek())return"variable-3";var l=e.current();return i.test(l)?"meta":a>="A"&&a<="Z"?"comment":"keyword"}return e.match(/^[^\s\u00a0>]*>?/),"atom"}function a(e,t,r){e.context={prev:e.context,indent:e.indent,col:r,type:t}}function l(e){e.indent=e.context.indent,e.context=e.context.prev}return{startState:function(){return{tokenize:s,context:null,indent:0,col:0}},token:function(e,r){if(e.sol()&&(r.context&&null==r.context.align&&(r.context.align=!1),r.indent=e.indentation()),e.eatSpace())return null;var n=r.tokenize(e,r);if("comment"!=n&&r.context&&null==r.context.align&&"pattern"!=r.context.type&&(r.context.align=!0),"("==t)a(r,")",e.column());else if("["==t)a(r,"]",e.column());else if("{"==t)a(r,"}",e.column());else if(/[\]\}\)]/.test(t)){for(;r.context&&"pattern"==r.context.type;)l(r);r.context&&t==r.context.type&&l(r)}else"."==t&&r.context&&"pattern"==r.context.type?l(r):/atom|string|variable/.test(n)&&r.context&&(/[\}\]]/.test(r.context.type)?a(r,"pattern",e.column()):"pattern"!=r.context.type||r.context.align||(r.context.align=!0,r.context.col=e.column()));return n},indent:function(e,t){var n=t&&t.charAt(0),i=e.context;if(/[\]\}]/.test(n))for(;i&&"pattern"==i.type;)i=i.prev;var o=i&&n==i.type;return i?"pattern"==i.type?i.col:i.align?i.col+(o?0:1):i.indent+(o?0:r):0},lineComment:"#"}})),e.defineMIME("text/turtle","turtle")})),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}((function(e){"use strict";e.defineMode("sparql",(function(e){var t,r=e.indentUnit;function n(e){return new RegExp("^(?:"+e.join("|")+")$","i")}var i=n(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","iri","uri","bnode","count","sum","min","max","avg","sample","group_concat","rand","abs","ceil","floor","round","concat","substr","strlen","replace","ucase","lcase","encode_for_uri","contains","strstarts","strends","strbefore","strafter","year","month","day","hours","minutes","seconds","timezone","tz","now","uuid","struuid","md5","sha1","sha256","sha384","sha512","coalesce","if","strlang","strdt","isnumeric","regex","exists","isblank","isliteral","a","bind"]),o=n(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","true","false","with","data","copy","to","move","add","create","drop","clear","load"]),s=/[*+\-<>=&|\^\/!\?]/;function a(e,r){var n,u=e.next();if(t=null,"$"==u||"?"==u)return"?"==u&&e.match(/\s/,!1)?"operator":(e.match(/^[A-Za-z0-9_\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][A-Za-z0-9_\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]*/),"variable-2");if("<"!=u||e.match(/^[\s\u00a0=]/,!1)){if('"'==u||"'"==u)return r.tokenize=(n=u,function(e,t){for(var r,i=!1;null!=(r=e.next());){if(r==n&&!i){t.tokenize=a;break}i=!i&&"\\"==r}return"string"}),r.tokenize(e,r);if(/[{}\(\),\.;\[\]]/.test(u))return t=u,"bracket";if("#"==u)return e.skipToEnd(),"comment";if("^"===u)return"^"===(u=e.peek())?e.eat("^"):e.eatWhile(s),"operator";if(s.test(u))return e.eatWhile(s),"operator";if(":"==u)return l(e),"atom";if("@"==u)return e.eatWhile(/[a-z\d\-]/i),"meta";if(e.eatWhile(/[_\w\d]/),e.eat(":"))return l(e),"atom";var c=e.current();return i.test(c)?"builtin":o.test(c)?"keyword":"variable"}return e.match(/^[^\s\u00a0>]*>?/),"atom"}function l(e){for(;e.match(/([:\w\d._-]|\\[-\\_~.!$&'()*+,;=/?#@%]|%[a-fA-F0-9][a-fA-F0-9])/););}function u(e,t,r){e.context={prev:e.context,indent:e.indent,col:r,type:t}}function c(e){e.indent=e.context.indent,e.context=e.context.prev}return{startState:function(){return{tokenize:a,context:null,indent:0,col:0}},token:function(e,r){if(e.sol()&&(r.context&&null==r.context.align&&(r.context.align=!1),r.indent=e.indentation()),e.eatSpace())return null;var n=r.tokenize(e,r);if("comment"!=n&&r.context&&null==r.context.align&&"pattern"!=r.context.type&&(r.context.align=!0),"("==t)u(r,")",e.column());else if("["==t)u(r,"]",e.column());else if("{"==t)u(r,"}",e.column());else if(/[\]\}\)]/.test(t)){for(;r.context&&"pattern"==r.context.type;)c(r);r.context&&t==r.context.type&&(c(r),"}"==t&&r.context&&"pattern"==r.context.type&&c(r))}else"."==t&&r.context&&"pattern"==r.context.type?c(r):/atom|string|variable/.test(n)&&r.context&&(/[\}\]]/.test(r.context.type)?u(r,"pattern",e.column()):"pattern"!=r.context.type||r.context.align||(r.context.align=!0,r.context.col=e.column()));return n},indent:function(e,t){var n=t&&t.charAt(0),i=e.context;if(/[\]\}]/.test(n))for(;i&&"pattern"==i.type;)i=i.prev;var o=i&&n==i.type;return i?"pattern"==i.type?i.col:i.align?i.col+(o?0:1):i.indent+(o?0:r):0},lineComment:"#"}})),e.defineMIME("application/sparql-query","sparql")})),function(e){var t=1721425.5,r=(new Array("Normal year","Leap year"),{GREGORIAN:{name:"Gregorian",short:"G",n_months:12},JULIAN:{name:"Julian",short:"Ju",n_months:12},JEWISH:{name:"Jewish",short:"Je",n_months:13},FRENCH:{name:"Revol.",short:"R",n_months:13}}),n=["So","Mo","Di","Mi","Do","Fr","Sa"],i={GREGORIAN:["ZERO","Jan","Feb","März","Apr","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"],JULIAN:["ZERO","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],JEWISH:["ZERO","Tishri","Heshvan","Kislev","Tevet","Shevat","AdarI","AdarII","Nisan","Iyyar","Sivan","Tammuz","Av","Elul"],FRENCH:["ZERO","Vendemiaire","Brumaire","Frimaire","Nivose","Pluviose","Ventose","Germinal","Floreal","Prairial","Messidor","Thermidor","Fructidor","Extra"]};function o(e,t){return e-t*Math.floor(e/t)}function s(e){return(e=parseInt(e))%4==0&&!(e%100==0&&e%400!=0)}function a(e,t,r){return 1721424.5+365*(e-1)+Math.floor((e-1)/4)+-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor((367*t-362)/12+(t<=2?0:s(e)?-1:-2)+r)}function l(e,r){e=parseInt(e);var n,i,l,u,c,f,h,p,d,g,v,y,m,b,x,w={};switch(r){case"GREGORIAN":case"gregorian":i=e,u=(l=Math.floor(i-.5)+.5)-t,c=Math.floor(u/146097),f=o(u,146097),h=Math.floor(f/36524),p=o(f,36524),d=Math.floor(p/1461),g=o(p,1461),y=400*c+100*h+4*d+(v=Math.floor(g/365)),4!=h&&4!=v&&y++,m=l-a(y,1,1),b=l<a(y,3,1)?0:s(y)?1:2,month=Math.floor((12*(m+b)+373)/367),day=l-a(y,month,1)+1,y<=0&&y--,n=new Array(y,month,day);break;case"JULIAN":case"julian":n=S.jd_to_julian(e);break;case"JEWISH":case"jewish":n=S.jd_to_hebrew(e);break;case"FRENCH":case"french":n=S.jd_to_french_revolutionary(e)}return w.year=n[0],w.month=n[1],w.day=n[2],w.weekday=(x=e,x=Number(x),o(Math.floor(x+1.5),7)),w}dateConverter=function(e){var t=l(e.dateval1,e.calendar),o=l(e.dateval2,e.calendar),s="";if(e.dateprecision1==e.dateprecision2)switch(e.dateprecision1){case"DAY":s=t.year==o.year&&t.month==o.month&&t.day==o.day?"["+n[t.weekday]+"] "+t.day+". "+i[e.calendar][t.month]+" "+t.year:"["+n[t.weekday]+"] "+t.day+". "+i[e.calendar][t.month]+" "+t.year+" – ["+n[o.weekday]+"] "+o.day+". "+i[e.calendar][o.month]+" "+o.year;break;case"MONTH":s=t.year==o.year&&t.month==o.month?i[e.calendar][t.month]+" "+t.year:i[e.calendar][t.month]+" "+t.year+" – "+i[e.calendar][o.month]+" "+o.year;break;case"YEAR":s=t.year==o.year?t.year:t.year+"–"+o.year}else{switch(e.dateprecision1){case"DAY":s="["+n[t.weekday]+"] "+t.day+". "+i[e.calendar][t.month]+" "+t.year;break;case"MONTH":s=i[e.calendar][t.month]+" "+t.year;break;case"YEAR":s=t.year}switch(s+=" – ",e.dateprecision2){case"DAY":s+="["+n[o.weekday]+"] "+o.day+". "+i[e.calendar][o.month]+" "+o.year;break;case"MONTH":s+=i[e.calendar][o.month]+" "+o.year;break;case"YEAR":s+=o.year}}return s+=" ("+r[e.calendar].short+")"}}(window.angular),window.angular,htmlConverter=function(e,t){var r,n,i,o,s,a,l,u,c,f="",h={p:0,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,ol:0,ul:0,li:1,a:2,strong:3,u:3,s:3,em:3,span:3,sup:3,sub:3},p={settings:{utf8str:"",textattr:{},css:{width:"100%",minHeight:"30px"},matching:{strong:"bold",u:"underline",s:"strikethrough",em:"italic",a:"_link",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",ol:"ol",ul:"ul",li:"li",span:"style",p:"p",sup:"sup",sub:"sub"}}},d={};for(var g in p.settings.matching)d[p.settings.matching[g]]=g;var v=Object.keys(e);for(a in v.sort((function(e,t){return h[d[e]]-h[d[t]]})),r=[],v)for(l in e[a=v[a]])void 0===r[i=e[a][l].start]&&(r[i]=[]),r[i].push({propname:a,proptype:"start"}),"_link"==r[i][r[i].length-1].propname?(r[i][r[i].length-1].href=e[a][l].href,void 0!==e[a][l].resid&&(r[i][r[i].length-1].resid=e[a][l].resid)):"style"==r[i][r[i].length-1].propname&&(r[i][r[i].length-1].css=e[a][l].css),void 0===r[i=e[a][l].end]&&(r[i]=[]),r[i].push({propname:a,proptype:"end"});for(n=[],u=0;u<=t.length;u++){if(void 0!==r[u]){for(s=[],c=r[u].length-1;c>=0;c--)if("end"==r[u][c].proptype&&"linebreak"!=r[u][c].propname){for(;void 0!==(o=n.pop())&&(f+="</"+d[o]+">",o!=r[u][c].propname);)s.push(o);for(;void 0!==(o=s.pop());)n.push(o),f+="<"+d[o]+">"}for(c in r[u])if("start"==r[u][c].proptype)if("linebreak"==r[u][c].propname)f+="<br/>";else if("_link"==r[u][c].propname){n.push(r[u][c].propname);var y=r[u][c].href;void 0===y&&void 0!==r[u][c].resid&&(y="http://www.salsah.org/api/resources/"+r[u][c].resid),f+="<"+d[r[u][c].propname]+' href="'+y,void 0!==r[u][c].resid?f+='" class="salsah-link">':f+='">'}else"style"==r[u][c].propname?(n.push(r[u][c].propname),f+="<"+d[r[u][c].propname]+' style="'+r[u][c].css+'">'):(n.push(r[u][c].propname),f+="<"+d[r[u][c].propname]+">")}u<t.length&&(f+=t.charAt(u))}return f=(f=f.replace(/\n/g,"<br/>")).replace(/\r/g,"")};