"use strict";(self.webpackChunkawg_app=self.webpackChunkawg_app||[]).push([[509],{2509:(a,M,s)=>{s.r(M),s.d(M,{DataViewModule:()=>L});var i=s(4762),t=s(7716),$=s(3133);var Q=s(6114);let m=class{constructor(){this.resourceRequest=new t.vpe}navigateToResource(e){!e||(e=e.toString(),this.resourceRequest.emit(e))}};m.propDecorators={header:[{type:t.IIB}],resourceUrl:[{type:t.IIB}],resourceRequest:[{type:t.r_U}]},m=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-header",template:'\x3c!-- resource detail header --\x3e\n<div class="resource-header">\n    <div class="row">\n        <div class="col-lg-8">\n            <h2 class="resource-title">\n                <div class="title">\n                    <span [compile-html]="header?.title" [compile-html-ref]="this"></span>\n                </div>\n                <div class="subtitle">\n                    <small></small>\n                </div>\n            </h2>\n            <div class="resource-link">\n                <small>\n                    API-Request:\n                    <a href="{{ resourceUrl }}">{{ resourceUrl }}</a>\n                    \x3c!-- TODO: (resource-detail-html-header): change then to stable URL for resource --\x3e\n                </small>\n            </div>\n        </div>\n        <div class="col-lg-4">\n            <table aria-label="Table with resource detail metadata" class="table table-sm resource-header-table">\n                <tbody>\n                    <tr>\n                        <th scope="row">ID:</th>\n                        <td id="header?.objID">{{ header?.objID }}</td>\n                    </tr>\n                    <tr>\n                        <th scope="row">Kategorie</th>\n                        <td>\n                            <span class="resource-type">{{ header?.type }}</span\n                            >&nbsp;<span class="resource-icon"><img [src]="header?.icon" alt="icon" /></span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <th scope="row">Zuletzt bearbeitet:</th>\n                        <td>\n                            <span class="resource-lastmod">{{ header?.lastmod }}</span> (UTC)\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n    </div>\n</div>\n',changeDetection:t.n4l.OnPush,styles:[Q]})],m);var J=s(3433);let v=class{constructor(){this.gndRequest=new t.vpe,this.resourceRequest=new t.vpe}exposeGnd(e){!e||this.gndRequest.emit(e)}navigateToResource(e){!e||(e=e.toString(),this.resourceRequest.emit(e))}};v.propDecorators={resourceDetailData:[{type:t.IIB}],gndRequest:[{type:t.r_U}],resourceRequest:[{type:t.r_U}]},v=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-html",template:'\x3c!-- resourceDetailData content --\x3e\n<awg-resource-detail-html-content\n    *ngIf="resourceDetailData?.content"\n    [content]="resourceDetailData?.content"\n    (gndRequest)="exposeGnd($event)"\n    (resourceRequest)="navigateToResource($event)">\n</awg-resource-detail-html-content>\n',changeDetection:t.n4l.OnPush,styles:[J]})],v);var Z=s(290);let b=class{constructor(){this.gndRequest=new t.vpe,this.resourceRequest=new t.vpe}exposeGnd(e){!e||this.gndRequest.emit(e)}navigateToResource(e){!e||(e=e.toString(),this.resourceRequest.emit(e))}};b.propDecorators={content:[{type:t.IIB}],gndRequest:[{type:t.r_U}],resourceRequest:[{type:t.r_U}]},b=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-html-content",template:'\x3c!--\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/ --\x3e\n\x3c!-- resourceDetailData content --\x3e\n<div class="awg-resource-content">\n    <div class="row">\n        \x3c!-- object properties --\x3e\n        <div class="col-lg-8">\n            <awg-resource-detail-html-content-props\n                [props]="content?.props"\n                (gndRequest)="exposeGnd($event)"\n                (resourceRequest)="navigateToResource($event)">\n            </awg-resource-detail-html-content-props>\n        </div>\n\n        \x3c!-- right side nav objects --\x3e\n        <div class="col-lg-4 mt-3 mt-lg-0 mb-3">\n            <div class="sidenav-right">\n                \x3c!-- image objects --\x3e\n                <awg-resource-detail-html-content-imageobjects [images]="content?.images">\n                </awg-resource-detail-html-content-imageobjects>\n\n                \x3c!-- connected objects --\x3e\n                <awg-resource-detail-html-content-linkedobjects\n                    [incomingGroups]="content?.incoming"\n                    (resourceRequest)="navigateToResource($event)">\n                </awg-resource-detail-html-content-linkedobjects>\n            </div>\n        </div>\n    </div>\n</div>\n',changeDetection:t.n4l.OnPush,styles:[Z]})],b);var Y=s(683),_=s(7191);let w=class{constructor(){this.galleryOptions=[new _.WB({width:"100%",imageSize:"contain",thumbnailSize:"contain",thumbnailMargin:5,thumbnailsMargin:0,previewCloseOnClick:!0,previewCloseOnEsc:!0,previewZoom:!0,previewRotate:!0,linkTarget:"_blank"})]}};w.propDecorators={images:[{type:t.IIB}]},w=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-html-content-imageobjects",template:'\x3c!--\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/ --\x3e\n\x3c!-- resourceDetailData content: image objects --\x3e\n<div class="awg-image-obj mb-3" *ngIf="images?.length > 0">\n    \x3c!-- header --\x3e\n    <h5>\n        Abbildungen (<span id="awg-image-number">{{ images?.length }}</span\n        >)\n    </h5>\n\n    \x3c!-- image slider --\x3e\n    <div class="card awg-image-slider">\n        <ngx-gallery class="ngx-gallery" [options]="galleryOptions" [images]="images"></ngx-gallery>\n    </div>\n    \x3c!-- end DIV image-slider --\x3e\n</div>\n\x3c!-- end DIV image-obj --\x3e\n',changeDetection:t.n4l.OnPush,styles:[Y]})],w);var te=s(6205);let y=class{constructor(){this.resourceRequest=new t.vpe}get totalNumber(){return this._getNestedArraysTotalItems(this.incomingGroups)||0}navigateToResource(e){!e||(e=e.toString(),this.resourceRequest.emit(e))}_getNestedArraysTotalItems(e){if(!e)return;return e.map(r=>r.links.length).reduce((r,o)=>r+o,0)}};y.propDecorators={incomingGroups:[{type:t.IIB}],resourceRequest:[{type:t.r_U}]},y=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-html-content-linkedobjects",template:'\x3c!--\n/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/ --\x3e\n\x3c!-- resourceDetailData content: linked objects --\x3e\n<div class="awg-linked-obj">\n    <h5>\n        \x3c!-- TODO: link to linked objects overview\n        <a (click)="navigateToSearchResults()">\n        --\x3e\n        Verkn\xfcpfte Objekte (<span id="awg-incoming-size" *ngIf="incomingGroups">{{ totalNumber }}</span\n        >)\n        \x3c!--\n        </a>\n        --\x3e\n    </h5>\n\n    <ngb-accordion [closeOthers]="true">\n        <ngb-panel\n            id="incoming-linkgroup-{{ i }}"\n            class="awg-linked-obj-incoming-linkgroup"\n            *ngFor="let restypeGroup of incomingGroups; let i = index">\n            <ng-template ngbPanelTitle>\n                <span class="awg-linked-obj-title-group">\n                    <span class="badge badge-info mr-2">{{ restypeGroup?.links?.length }}</span>\n                    <span class="awg-linked-obj-title single-line">{{ restypeGroup?.restypeLabel }}</span>\n                </span>\n            </ng-template>\n            <ng-template ngbPanelContent>\n                <ul class="awg-linked-obj-list nobullets mb-0">\n                    <li *ngFor="let link of restypeGroup.links; last as isLast">\n                        <a class="awg-linked-obj-link" (click)="navigateToResource(link?.id)">\n                            <img [src]="link?.restype?.icon" alt="icon" />\n                            &nbsp;[<span class="awg-linked-obj-link-id">{{ link?.id }}</span\n                            >]&nbsp;\n                            <span class="awg-linked-obj-link-value">{{ link?.value }}</span>\n                        </a>\n                        <hr *ngIf="!isLast" />\n                    </li>\n                </ul>\n            </ng-template>\n        </ngb-panel>\n    </ngb-accordion>\n</div>\n\x3c!-- end DIV linkedObj --\x3e\n',changeDetection:t.n4l.OnPush,styles:[te]})],y);var se=s(2664),N=s(7850);let R=class{constructor(){this.gndRequest=new t.vpe,this.resourceRequest=new t.vpe,this.metaBreakLine="Versionsdatum"}ngOnChanges(e){this._checkForGND(e.props)}navigateToResource(e){!e||(e=e.toString(),this.resourceRequest.emit(e))}ngOnDestroy(){this._removeGnd()}_checkForGND(e){const n=e.currentValue.filter(r=>"856"===r.pid&&r.values&&r.values.length>0);this._removeGnd(),n.length>0&&n.forEach(r=>{r.values.forEach(o=>{this._exposeGnd(o)})})}_exposeGnd(e){if(!e)return;const n=new N.zI(N.G0.SET,e);this.gndRequest.emit(n)}_removeGnd(){const e=new N.zI(N.G0.REMOVE,null);this.gndRequest.emit(e)}};R.propDecorators={props:[{type:t.IIB}],gndRequest:[{type:t.r_U}],resourceRequest:[{type:t.r_U}]},R=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-html-content-props",template:'\x3c!-- resource detail data content: props --\x3e\n<section class="awg-props">\n    <h4 class="awg-props-title ml-0">Objektdaten</h4>\n    <ul *ngFor="let prop of props">\n        <li id="breakLine" *ngIf="prop?.label === metaBreakLine">\n            <hr />\n        </li>\n        <li class="awg-prop" *ngIf="(prop?.values)[0]">\n            \x3c!-- value label --\x3e\n            <strong class="awg-prop-label" *ngIf="prop?.label">\n                {{ prop?.label }}\n            </strong>\n            \x3c!-- value content --\x3e\n            <ul *ngFor="let value of prop?.values">\n                <li class="awg-prop-value" *ngIf="value">\n                    <span [compile-html]="value" [compile-html-ref]="this"></span>\n                </li>\n            </ul>\n        </li>\n    </ul>\n</section>\n',changeDetection:t.n4l.OnPush,styles:[se]})],R);var ae=s(2503);let f=class{};f.propDecorators={resourceJsonConvertedData:[{type:t.IIB}]},f=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-json-converted",template:'<awg-json-viewer\n    jsonViewerHeader="Converted JSON response from Salsah-API"\n    [jsonViewerData]="resourceJsonConvertedData">\n</awg-json-viewer>\n',changeDetection:t.n4l.OnPush,styles:[ae]})],f);var ie=s(9812);let D=class{};D.propDecorators={resourceJsonRawData:[{type:t.IIB}]},D=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail-json-raw",template:'<awg-json-viewer jsonViewerHeader="Raw JSON response from Salsah-API" [jsonViewerData]="resourceJsonRawData">\n</awg-json-viewer>\n',changeDetection:t.n4l.OnPush,styles:[ie]})],D);let O=class{};O=(0,i.gn)([(0,t.LVF)({imports:[$.m],declarations:[m,v,b,w,y,R,f,D],exports:[m,v,b,w,y,R,f,D]})],O);var ce=s(8823),S=s(3679),he=s(5435),ue=s(4395),de=s(7519),q=s(9976);let I=class{constructor(e){this.formBuilder=e,this.searchRequest=new t.vpe,this.faSearch=q.wn1,this.searchFormStrings={label:"Search Input",placeholder:"Volltextsuche in der Webern-Datenbank \u2026",errorMessage:"Es wird ein Suchbegriff mit mindestens 3 Zeichen ben\xf6tigt!"},this.createFormGroup(),this.listenToUserInputChange()}get searchValueControl(){return this.searchForm.get("searchValueControl")}ngOnChanges(){this.setSearchValueFromInput()}createFormGroup(){this.searchForm=this.formBuilder.group({searchValueControl:["",S.kI.compose([S.kI.required,S.kI.minLength(3)])]})}listenToUserInputChange(){this.searchValueControl.valueChanges.pipe((0,he.h)(e=>e.length>=3),(0,ue.b)(500),(0,de.x)()).subscribe(e=>this.onSearch(e))}setSearchValueFromInput(){this.searchValueControl.setValue(this.searchValue)}onSearch(e){this.searchRequest.emit(e)}};I.ctorParameters=()=>[{type:S.qu}],I.propDecorators={searchValue:[{type:t.IIB}],searchRequest:[{type:t.r_U}]},I=(0,i.gn)([(0,t.wA2)({selector:"awg-search-form",template:'<form [formGroup]="searchForm">\n    <div class="form-row mb-4">\n        <div class="col-12">\n            <label class="sr-only" for="awg-search-input">{{ searchFormStrings.label }}</label>\n            <div class="input-group">\n                <div class="input-group-prepend">\n                    <div class="input-group-text" id="search-icon">\n                        <fa-icon [icon]="faSearch"></fa-icon>\n                    </div>\n                </div>\n                <input\n                    title="Search"\n                    type="search"\n                    id="awg-search-input"\n                    class="form-control"\n                    formControlName="searchValueControl"\n                    aria-label="Search input"\n                    aria-describedby="search-icon"\n                    placeholder="{{ searchFormStrings.placeholder }}"\n                    required />\n            </div>\n            <div *ngIf="searchValueControl.invalid && !searchValueControl.pristine" class="alert alert-danger">\n                <p *ngIf="searchValueControl.hasError(\'required\') || searchValueControl.errors.minlength"></p>\n                {{ searchFormStrings.errorMessage }}\n            </div>\n        </div>\n    </div>\n</form>\n',changeDetection:t.n4l.OnPush,styles:[ce]})],I);var pe=s(4116),d=s(4213),B=s(9765),V=s(6782),me=s(6203),u=s(9939),h=s(3951);let C=class{constructor(e,n,r,o,p){this.formBuilder=e,this.router=n,this.conversionService=r,this.dataStreamerService=o,this.sideInfoService=p,this.pageChangeRequest=new t.vpe,this.rowNumberChangeRequest=new t.vpe,this.viewChangeRequest=new t.vpe,this.errorMessage=void 0,this.rowNumbers=[5,10,25,50,100,200],this.faGripHorizontal=q.BUU,this.faTable=q.B3e,this._destroy$=new B.xQ}ngOnInit(){this.getSearchResponseWithQueryData(),this.searchParams.view&&(this.searchParams.view===u.wU.table||this.searchParams.view===u.wU.grid)&&this.createFormGroup(this.searchParams.view)}createFormGroup(e){this.searchResultControlForm=this.formBuilder.group({searchResultViewControl:u.wU[e]}),this.listenToUserInputChange()}listenToUserInputChange(){this.searchResultControlForm.get("searchResultViewControl").valueChanges.subscribe(e=>{this.onViewChange(e)})}isActiveResource(e){return this._selectedResourceId===e}isGridView(){return this.searchParams.view===u.wU.grid}isNoResults(){return 0==+this.searchResponseWithQuery.data.nhits}navigateToResource(e){this._selectedResourceId=e,this.router.navigate(["/data/resource",this._selectedResourceId])}onPageChange(e){const n=+this.searchParams.nRows,r=e*n-n;this.pageChangeRequest.emit(String(r))}onRowNumberChange(e){this.rowNumberChangeRequest.emit(String(e))}onViewChange(e){this.viewChangeRequest.emit(e)}setPagination(){const e=+this.searchParams.nRows,n=+this.searchParams.startAt;this.pageSize=e,this.page=Math.floor(n/e)+1}getSearchResponseWithQueryData(){this.dataStreamerService.getSearchResponseWithQuery().pipe((0,V.R)(this._destroy$)).subscribe(n=>{this.updateSearchParams(n),this.setPagination()},n=>{this.errorMessage=n,console.error("SearchResultList# searchResultData subscription error: ",this.errorMessage)})}trackById(e){return e.obj_id}updateSearchParams(e){if(!e)return;this.searchResponseWithQuery=Object.assign({},e),this.searchResultText=this.conversionService.prepareFullTextSearchResultText(e,this.searchUrl);const n=new me.W(this.searchResponseWithQuery.query,this.searchResultText);this.sideInfoService.updateSearchInfoData(n)}ngOnDestroy(){this.sideInfoService.clearSearchInfoData(),this._destroy$.next(!0),this._destroy$.unsubscribe()}};C.ctorParameters=()=>[{type:S.qu},{type:d.F0},{type:h.re},{type:h.k$},{type:h.Iu}],C.propDecorators={searchUrl:[{type:t.IIB}],searchParams:[{type:t.IIB}],pageChangeRequest:[{type:t.r_U}],rowNumberChangeRequest:[{type:t.r_U}],viewChangeRequest:[{type:t.r_U}]},C=(0,i.gn)([(0,t.wA2)({selector:"awg-search-result-list",template:'\x3c!-- content: search results --\x3e\n<div class="awg-search-results" *ngIf="searchResponseWithQuery?.data">\n    \x3c!-- header --\x3e\n    <div class="row d-flex justify-content-between mb-4 awg-search-results-header">\n        <div class="col-6 mr-auto awg-search-results-header-icons">\n            <div class="btn-group">\n                <form [formGroup]="searchResultControlForm">\n                    <div\n                        class="btn-group btn-group-toggle"\n                        ngbRadioGroup\n                        name="searchResultView"\n                        formControlName="searchResultViewControl">\n                        <label ngbButtonLabel class="btn-outline-info" ngbTooltip="Table view">\n                            <input ngbButton type="radio" value="table" [disabled]="isNoResults()" />\n                            <fa-icon [icon]="faTable"></fa-icon>\n                        </label>\n                        <label ngbButtonLabel class="btn-outline-info" ngbTooltip="Grid view">\n                            <input ngbButton type="radio" value="grid" [disabled]="isNoResults()" />\n                            <fa-icon [icon]="faGripHorizontal"></fa-icon>\n                        </label>\n                    </div>\n                </form>\n                <div class="btn-group">\n                    <button type="button" class="btn btn-outline-info" disabled aria-disabled="true">\n                        <span class="d-none d-lg-inline">Hits per page: </span>{{ searchParams?.nRows }}\n                    </button>\n                    <div\n                        class="btn-group"\n                        ngbDropdown\n                        role="group"\n                        aria-label="Button group with nested dropdown for row number">\n                        <button\n                            class="btn btn-info dropdown-toggle-split"\n                            ngbDropdownToggle\n                            [disabled]="isNoResults()"></button>\n                        <div class="dropdown-menu" ngbDropdownMenu>\n                            <button\n                                class="dropdown-item"\n                                *ngFor="let rowNumber of rowNumbers"\n                                (click)="onRowNumberChange(rowNumber)">\n                                {{ rowNumber }}\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="col-6 my-auto text-center awg-search-results-header-text">\n            {{ searchResultText }}\n        </div>\n    </div>\n\n    <ng-container *ngIf="searchResponseWithQuery?.data?.subjects && !isNoResults()">\n        \x3c!-- top pagination --\x3e\n        <ngb-pagination\n            class="d-flex justify-content-center"\n            [(page)]="page"\n            [pageSize]="pageSize"\n            [collectionSize]="+searchResponseWithQuery?.data?.nhits"\n            [maxSize]="4"\n            [boundaryLinks]="true"\n            (pageChange)="onPageChange($event)">\n        </ngb-pagination>\n\n        \x3c!-- table with searchResults --\x3e\n        <div *ngIf="!isGridView()" class="table-responsive">\n            <table aria-label="Table with search results" class="table table-sm awg-search-result-table">\n                <thead>\n                    <tr class="d-flex">\n                        <th scope="col" class="col-6 col-sm-4 col-md-5 col-lg-4 col-xl-3">Typ</th>\n                        <th scope="col" class="col-6 col-sm-8 col-md-7 col-lg-8 col-xl-9">Ressource</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \x3c!-- show searchResultDetail by clicking on single entry --\x3e\n                    <tr\n                        class="d-flex"\n                        *ngFor="let subject of searchResponseWithQuery?.data?.subjects; trackBy: trackById"\n                        (click)="navigateToResource(subject?.obj_id)"\n                        [class.active]="isActiveResource(subject?.obj_id)">\n                        <td class="col-6 col-sm-4 col-md-5 col-lg-4 col-xl-3">\n                            <span class="badge">\n                                <img [attr.src]="subject?.iconsrc" alt="iconsrc" />\n                                <small>&nbsp;{{ subject?.iconlabel }}</small>\n                            </span>\n                        </td>\n                        <td class="col-6 col-sm-8 col-md-7 col-lg-8 col-xl-9">\n                            <span [compile-html]="(subject?.value)[0]" [compile-html-ref]="this"></span>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n\n        \x3c!-- grid with searchResults --\x3e\n        <div *ngIf="isGridView()" class="card-columns">\n            <div class="card" *ngFor="let subject of searchResponseWithQuery?.data?.subjects; trackBy: trackById">\n                <div class="card-header">\n                    <img [attr.src]="subject?.iconsrc" alt="iconsrc" />\n                    &nbsp;{{ subject?.iconlabel }}\n                </div>\n                <div class="card-body">\n                    <h5 class="card-title">\n                        <span [compile-html]="(subject?.value)[0]" [compile-html-ref]="this"></span>\n                    </h5>\n                    <button type="button" class="btn btn-outline-info" (click)="navigateToResource(subject?.obj_id)">\n                        Mehr ...\n                    </button>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- bottom pagination --\x3e\n        <ngb-pagination\n            class="d-flex justify-content-center"\n            [(page)]="page"\n            [pageSize]="pageSize"\n            [collectionSize]="+searchResponseWithQuery?.data?.nhits"\n            [maxSize]="4"\n            [boundaryLinks]="true"\n            (pageChange)="onPageChange($event)">\n        </ngb-pagination>\n    </ng-container>\n</div>\n',changeDetection:t.n4l.Default,styles:[pe]})],C);var be=s(8412);let j=class{constructor(e){this.router=e,this.searchTitle="Suche",this.searchId="search"}ngOnInit(){this.routeToSidenav()}routeToSidenav(){this.router.navigate([{outlets:{side:"searchInfo"}}],{preserveFragment:!0,queryParamsHandling:"preserve"})}};j.ctorParameters=()=>[{type:d.F0}],j=(0,i.gn)([(0,t.wA2)({selector:"awg-data",template:'\x3c!-- content: search --\x3e\n\n\x3c!-- heading --\x3e\n<awg-heading [title]="searchTitle" [id]="searchId"></awg-heading>\n\n\x3c!-- help-block --\x3e\n<div class="help-block">BETA: Suche momentan noch mit eingeschr\xe4nkter Funktionalit\xe4t</div>\n\n\x3c!-- data (search) routes --\x3e\n<router-outlet></router-outlet>\n',styles:[be]})],j);var ye=s(7763),Re=s(3190),g=s(1841),c=s(7463);let G=class extends h.sM{constructor(e){super(e),this.projectId="6",this.resTypeId="126",this.bibShortTitlePropertyId="614",this.resourcesRoute="resources/",this.searchRoute="search/",this.serviceName="BibliographyService"}getBibliographyList(){const e=this.searchRoute,n=(new g.LE).set("searchtype","extended").set("property_id",this.bibShortTitlePropertyId).set("compop","EXISTS").set("filter_by_project",this.projectId).set("filter_by_restype",this.resTypeId);return this.getApiResponse(c.vX,e,n)}getBibliographyItemDetail(e){const n=this.resourcesRoute+e,r=new g.LE;return this.getApiResponse(c.wB,n,r)}};G.ctorParameters=()=>[{type:g.eN}],G=(0,i.gn)([(0,t.GSi)({providedIn:"root"})],G);var fe=s(5758),H=s(5242),E=s(8002);let x=class extends h.sM{constructor(e,n){super(e),this.conversionService=n,this.projectId="6",this.resourceSuffix="_-_local",this.routes={resources:"resources/",search:"search/",geonames:"geonames/",hlists:"hlists/",selections:"selections/"},this.serviceName="DataApiService"}getFulltextSearchData(e){if(!e||!e.query)return;const n={query:e.query,nRows:e.nRows||"-1",startAt:e.startAt||"0",view:e.view||u.wU.table},r=this.routes.search+n.query,o=(new g.LE).set("searchtype","fulltext").set("filter_by_project",this.projectId).set("show_nrows",n.nRows).set("start_at",n.startAt);return this.getApiResponse(c.vX,r,o).pipe((0,H.d)(new c.vX),(0,E.U)(A=>this.conversionService.convertFullTextSearchResults(A)))}getResourceData(e){if(!e)return;const n=this._getResourceFullResponseData(e),r=this._getResourceContextData(e);return(0,fe.D)([n,r]).pipe((0,H.d)([new c.wB,new c.QX]),(0,E.U)(o=>this._prepareResourceData(o,e)))}_prepareResourceData(e,n){if(0===Object.keys(e[0]).length&&e[0].constructor===Object)return new u.Li(new c.wB,void 0);const r=this.conversionService.convertResourceData(e,n);return new u.Li(e[0],r)}_getResourceContextData(e){return this._getResourceDataResponseFromApi(c.QX,e)}_getResourceFullResponseData(e){return this._getResourceDataResponseFromApi(c.wB,e)}_getGeoData(e){return this._getResourceDataResponseFromApi(c.gg,e)}_getHlistData(e){return this._getResourceDataResponseFromApi(c.xU,e)}_getSelectionsData(e){return this._getResourceDataResponseFromApi(c.nh,e)}_getResourceDataResponseFromApi(e,n){let r,o=new g.LE;switch(e){case c.gg:r=this.routes.geonames+n,o=o.set("reqtype","node");break;case c.xU:r=this.routes.hlists+n;break;case c.QX:r=this.routes.resources+n+this.resourceSuffix,o=o.set("reqtype","context");break;case c.wB:r=this.routes.resources+n+this.resourceSuffix;break;case c.nh:r=this.routes.selections+n}return this.getApiResponse(e,r,o)}_getNodeIdFromAttributes(e){return e.split("=")[1].toString()}};x.ctorParameters=()=>[{type:g.eN},{type:h.re}],x=(0,i.gn)([(0,t.GSi)({providedIn:"root"})],x);let P=class{constructor(e,n,r,o,p,A){this.route=e,this.router=n,this.dataApiService=r,this.dataStreamerService=o,this.gndService=p,this.loadingService=A,this.errorMessage=void 0,this.tabTitles={html:"Detail",raw:"JSON (raw)",converted:"JSON (converted)"},this._destroy$=new B.xQ}get httpGetUrl(){return this.dataApiService.httpGetUrl}get isLoading$(){return this.loadingService.getLoadingStatus()}ngOnInit(){this.routeToSidenav(),this.getResourceData()}getResourceData(){this.route.paramMap.pipe((0,Re.w)(e=>{const n=e.get("id");return this.updateResourceId(n),this.dataApiService.getResourceData(n)}),(0,V.R)(this._destroy$)).subscribe(e=>{this.resourceData=e},e=>this.errorMessage=e)}updateResourceId(e){this.resourceId=e,this.dataStreamerService.updateResourceId(e)}navigateToResource(e){const n=e||(this.oldId?this.oldId:this.resourceId);this.oldId=this.resourceId,this.router.navigate(["/data/resource",+n])}exposeGnd(e){!e||this.gndService.exposeGnd(e)}routeToSidenav(){this.router.navigate([{outlets:{side:"resourceInfo"}}],{preserveFragment:!0,queryParamsHandling:"preserve"})}ngOnDestroy(){this._destroy$.next(!0),this._destroy$.unsubscribe()}};P.ctorParameters=()=>[{type:d.gz},{type:d.F0},{type:x},{type:h.k$},{type:h.dW},{type:h.bz}],P=(0,i.gn)([(0,t.wA2)({selector:"awg-resource-detail",template:'\x3c!-- resource detail box --\x3e\n\n\x3c!-- loading spinner --\x3e\n<div *ngIf="isLoading$ | async; else notLoading">\n    <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n</div>\n\n<ng-template #notLoading>\n    \x3c!-- error message --\x3e\n    <div class="errorMessage" *ngIf="errorMessage">\n        <p>Die Anfrage "{{ errorMessage?.route }}" ist fehlgeschlagen.</p>\n        <p>Fehlermeldung: "{{ errorMessage?.statusText || errorMessage }}".</p>\n        <p>M\xf6glicherweise gab es ein Problem mit der Internetverbindung oder dem verwendeten Suchbegriff.</p>\n    </div>\n\n    \x3c!-- async data --\x3e\n    <div class="awg-resource-detail-tabs" *ngIf="resourceData">\n        \x3c!-- resourceDetailData header --\x3e\n        <awg-resource-detail-header\n            *ngIf="resourceData.detail.header"\n            [header]="resourceData.detail.header"\n            [resourceUrl]="httpGetUrl"\n            (resourceRequest)="navigateToResource($event)"></awg-resource-detail-header>\n\n        \x3c!-- resourceDetailData body --\x3e\n        <nav ngbNav #resourceDetailNav="ngbNav" class="nav-tabs">\n            <ng-container ngbNavItem>\n                <a ngbNavLink class="awg-resource-detail-long-tab">{{ tabTitles?.html }}</a>\n                <ng-template ngbNavContent>\n                    \x3c!-- html visualisation --\x3e\n                    <awg-resource-detail-html\n                        [resourceDetailData]="resourceData.detail"\n                        (gndRequest)="exposeGnd($event)"\n                        (resourceRequest)="navigateToResource($event)">\n                    </awg-resource-detail-html>\n                </ng-template>\n            </ng-container>\n            <ng-container ngbNavItem>\n                <a ngbNavLink class="ml-auto">{{ tabTitles?.converted }}</a>\n                <ng-template ngbNavContent>\n                    \x3c!-- converted json visualisation --\x3e\n                    <awg-resource-detail-json-converted [resourceJsonConvertedData]="resourceData.jsonConverted">\n                    </awg-resource-detail-json-converted>\n                </ng-template>\n            </ng-container>\n            <ng-container ngbNavItem>\n                <a ngbNavLink>{{ tabTitles?.raw }}</a>\n                <ng-template ngbNavContent>\n                    \x3c!-- raw json visualisation --\x3e\n                    <awg-resource-detail-json-raw [resourceJsonRawData]="resourceData.jsonRaw">\n                    </awg-resource-detail-json-raw>\n                </ng-template>\n            </ng-container>\n        </nav>\n        <div [ngbNavOutlet]="resourceDetailNav"></div>\n    </div>\n\n    \x3c!--\n    TODO: remove\n    <ul class="nav nav-tabs nav-justified" role="tablist">\n        <li class="active awg-resource-detail-long-tab"><a data-toggle="tab" href="#html">{{ tabTitles?.html }}</a></li>\n        <li class="dropdown awg-resource-detail-short-tab">\n            <a href="#" data-toggle="dropdown" class="dropdown-toggle">\n                {{ \'{\' }} JSON {{ \'}\' }} <b class="caret"></b>\n            </a>\n            <ul class="dropdown-menu dropdown-menu-right">\n                <li><a data-toggle="tab" href="#converted">{{ tabTitles?.converted }}</a></li>\n                <li><a data-toggle="tab" href="#raw">{{ tabTitles?.raw }}</a></li>\n            </ul>\n        </li>\n    </ul>\n    --\x3e\n</ng-template>\n',changeDetection:t.n4l.Default,styles:[ye]})],P);var Se=s(6579),F=s(849);let k=class{constructor(e,n){this.sideInfoService=e,this.route=n}ngOnInit(){this.setButtons(),this.updateSearchInfoTitleFromPath()}setButtons(){this.searchRouterLinkButtons=[new F.v("/data/search","fulltext","Volltext-Suche",!1),new F.v("/data/search","timeline","Timeline",!0),new F.v("/data/search","bibliography","Bibliographie",!0)]}updateSearchInfoTitleFromPath(){const e=this.route.snapshot.children[0].url[0].path,n=this.searchRouterLinkButtons.filter(r=>r.link===e);1===n.length&&this.sideInfoService.updateSearchInfoTitle(n[0].label)}onButtonSelect(e){const n=e instanceof F.v;!e||!n||!e.label||(this.sideInfoService.clearSearchInfoData(),this.sideInfoService.updateSearchInfoTitle(e.label))}};k.ctorParameters=()=>[{type:h.Iu},{type:d.gz}],k=(0,i.gn)([(0,t.wA2)({selector:"awg-search-overview",template:'<awg-router-link-button-group\n    *ngIf="searchRouterLinkButtons"\n    [routerLinkButtons]="searchRouterLinkButtons"\n    [queryParamsHandling]="\'preserve\'"\n    (selectButtonRequest)="onButtonSelect($event)">\n</awg-router-link-button-group>\n\n<router-outlet></router-outlet>\n',styles:[Se]})],k);var Ce=s(1587);let T=class{constructor(e,n,r,o,p,A){this.route=e,this.router=n,this.conversionService=r,this.dataApiService=o,this.dataStreamerService=p,this.loadingService=A,this.destroy$=new B.xQ,this.searchParams={query:"",nRows:"25",startAt:"0",view:u.wU.table},this.errorMessage=void 0,this.viewChanged=!1}get httpGetUrl(){return this.dataApiService.httpGetUrl}get isLoading$(){return this.loadingService.getLoadingStatus()}ngOnInit(){this.getFulltextSearchData()}getFulltextSearchData(){this.router.events.pipe((0,V.R)(this.destroy$)).subscribe(e=>{if(e instanceof d.m2){const n=this.route.snapshot.queryParamMap;if(n!==this.currentQueryParams)if(this.currentQueryParams=n,n.keys.length<4)this.updateSearchParamsFromRoute(n,!0);else if(this.updateSearchParamsFromRoute(n,!1),this.searchParams.query&&!this.viewChanged)return this.dataApiService.getFulltextSearchData(this.searchParams).subscribe(r=>{const o=new u.PY(r,this.searchParams.query);this.dataStreamerService.updateSearchResponseWithQuery(o)},r=>{this.errorMessage=r})}},e=>{this.errorMessage=e})}onPageChange(e){e!==this.searchParams.startAt&&(this.viewChanged=!1,this.searchParams={query:this.searchParams.query,nRows:this.searchParams.nRows,startAt:e,view:this.searchParams.view},this.routeToSelf(this.searchParams))}onRowNumberChange(e){e!==this.searchParams.nRows&&(this.viewChanged=!1,this.searchParams={query:this.searchParams.query,nRows:e,startAt:"0",view:this.searchParams.view},this.routeToSelf(this.searchParams))}onViewChange(e){e!==this.searchParams.view&&(this.viewChanged=!0,this.searchParams={query:this.searchParams.query,nRows:this.searchParams.nRows,startAt:this.searchParams.startAt,view:u.wU[e]},this.routeToSelf(this.searchParams))}onSearch(e){e!==this.searchParams.query&&(this.viewChanged=!1,this.searchParams={query:e,nRows:this.searchParams.nRows,startAt:this.searchParams.startAt,view:this.searchParams.view},this.routeToSelf(this.searchParams))}routeToSelf(e){this.router.navigate([],{relativeTo:this.route,queryParams:{query:e.query,nrows:e.nRows,startAt:e.startAt,view:e.view},queryParamsHandling:"merge"})}updateSearchParamsFromRoute(e,n){!e||(this.searchParams={query:e.get("query")||this.searchParams.query,nRows:e.get("nrows")||this.searchParams.nRows,startAt:e.get("startAt")||this.searchParams.startAt,view:u.wU[e.get("view")]||this.searchParams.view},n&&this.routeToSelf(this.searchParams))}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}};T.ctorParameters=()=>[{type:d.gz},{type:d.F0},{type:h.re},{type:x},{type:h.k$},{type:h.bz}],T=(0,i.gn)([(0,t.wA2)({selector:"awg-search-panel",template:'\x3c!-- content: search panel --\x3e\n\n<awg-search-form [searchValue]="searchParams?.query" (searchRequest)="onSearch($event)"> </awg-search-form>\n\n\x3c!-- loading spinner --\x3e\n<div *ngIf="isLoading$ | async; else notLoading">\n    <awg-twelve-tone-spinner></awg-twelve-tone-spinner>\n</div>\n\n<ng-template #notLoading>\n    <div class="errorMessage" *ngIf="errorMessage">\n        <p>Die Anfrage "{{ errorMessage?.route }}" ist fehlgeschlagen.</p>\n        <p>Fehlermeldung: "{{ errorMessage?.statusText || errorMessage }}".</p>\n        <p>M\xf6glicherweise gab es ein Problem mit der Internetverbindung oder dem verwendeten Suchbegriff.</p>\n    </div>\n\n    <awg-search-result-list\n        *ngIf="searchParams?.query"\n        [searchParams]="searchParams"\n        [searchUrl]="httpGetUrl"\n        (pageChangeRequest)="onPageChange($event)"\n        (rowNumberChangeRequest)="onRowNumberChange($event)"\n        (viewChangeRequest)="onViewChange($event)">\n    </awg-search-result-list>\n</ng-template>\n',styles:[Ce]})],T);const je=[{path:"",component:j,children:[{path:"search",component:k,children:[{path:"fulltext",component:T,data:{title:"AWG Online Edition \u2013 Search"}},{path:"detail/:id",redirectTo:"resource/:id"},{path:"",pathMatch:"full",redirectTo:"fulltext"}]}]},{path:"resource/:id",component:P,data:{title:"AWG Online Edition \u2013 Resource Detail"}}],xe=[j,k,T,P];let U=class{};U=(0,i.gn)([(0,t.LVF)({imports:[d.Bz.forChild(je)],exports:[d.Bz]})],U);let L=class{};L=(0,i.gn)([(0,t.LVF)({imports:[$.m,O,U],declarations:[xe,I,C]})],L)},6114:a=>{a.exports="/************************************************\n *\n *               CREDITS\n *\n * This code is inspired, adapted or taken from:\n *\n * ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n * https://arachne.dainst.org/entity/1121229**]\n * 20.11.2017\n *\n *\n *\n************************************************/\n\n/* resource header */\n\n.resource-header {\n    margin: 1rem 0 0 0;\n    border-bottom: 1px solid #ddd;\n}\n\n/* resource header title */\n\n.resource-title .title {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.resource-title .title:hover {\n    white-space: normal;\n    width: inherit;\n    height: auto;\n}\n\n/* resource header link */\n\n.resource-link {\n    margin: 2rem 0;\n}\n\n/* resource header table */\n\n/* remove top border from table */\n\n.resource-header table.resource-header-table tr:first-of-type th,\n.resource-header table.resource-header-table tr:first-of-type td {\n    border-top: none;\n}\n"},683:a=>{a.exports="/* slider container */\n.awg-image-slider {\n    height: 300px;\n}\n.awg-image-slider .ngx-gallery {\n    display: inline-block;\n}\n/* image preview */\nngx-gallery ::ng-deep .ngx-gallery-image-wrapper {\n    background-color: #e7e7e7;\n}\n/* arrows */\nngx-gallery ::ng-deep .ngx-gallery-arrow {\n    color: #676767;\n}\nngx-gallery ::ng-deep .ngx-gallery-arrow.ngx-gallery-disabled {\n    opacity: 0.3;\n}\n/* thumbnails */\nngx-gallery ::ng-deep .ngx-gallery-thumbnail {\n    opacity: 0.3;\n}\nngx-gallery ::ng-deep .ngx-gallery-thumbnail.ngx-gallery-active,\nngx-gallery ::ng-deep .ngx-gallery-thumbnail:hover {\n    opacity: 1;\n}\n"},6205:a=>{a.exports="/************************************************\n *\n *               CREDITS\n *\n * This code is inspired, adapted or taken from:\n *\n * ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n * https://arachne.dainst.org/entity/1121229**]\n * 20.11.2017\n *\n *\n *\n ************************************************/\n\nul.awg-linked-obj-list {\n    padding-left: 0;\n}\n\nul.awg-linked-obj-list li:hover {\n    background-color: #e7e7e7;\n}\n\nul.awg-linked-obj-list li a {\n    width: inherit;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: block;\n}\n\nul.awg-linked-obj-list li hr {\n    margin-top: 0.75rem;\n    margin-bottom: 0.75rem;\n}\n\n/* link objects */\n\n.awg-linked-obj-link {\n    cursor: pointer;\n    color: #333 !important;\n}\n\n.awg-linked-obj-link:hover {\n    border-bottom: none !important;\n}\n"},2664:a=>{a.exports="/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/\n\n/* props */\n\n.awg-props ul {\n    padding-left: 0;\n    margin-top: 0.5rem;\n    margin-bottom: 0.25rem;\n}\n\n.awg-props li {\n    list-style: none;\n    padding: 0.25rem 0;\n}\n\n.awg-props .awg-prop .awg-prop-label {\n    margin-top: 8px;\n    margin-bottom: -4px;\n    display: block;\n    font-size: 21px;\n    font-weight: 400;\n}\n\n.awg-props .awg-prop .awg-prop-value {\n    padding: 3px 0;\n    margin-left: 1rem;\n}\n"},290:a=>{a.exports=""},3433:a=>{a.exports=""},2503:a=>{a.exports=""},9812:a=>{a.exports=""},7763:a=>{a.exports="/************************************************\n*\n*               CREDITS\n*\n* This code is inspired, adapted or taken from:\n*\n* ARACHNE \u2013 Objektdatenbank des Deutschen Arch\xe4ologischen Instituts (DAI)\n* https://arachne.dainst.org/entity/1121229**]\n* 20.11.2017\n*\n*\n*\n************************************************/\n\n/* for resource-header see 'resource-detail-html-header.component.css' */\n\n/* for resource-html-props see 'props.component.css' */\n\n/* tabs */\n\n/* adjust tab size on larger screens */\n\n@media screen and (min-width: 768px) {\n    /* set auto width for long tab */\n    .awg-resource-detail-long-tab {\n        width: auto !important;\n    }\n    /* avoid line wrap in link text */\n    .awg-resource-detail-short-tab > a {\n        white-space: nowrap;\n    }\n}\n\n::ng-deep .tab-content .tab-pane.active {\n    margin: 2rem 0;\n}\n"},6579:a=>{a.exports=""},8823:a=>{a.exports=""},1587:a=>{a.exports=""},4116:a=>{a.exports=".awg-search-results .awg-search-result-table tbody tr {\n    cursor: pointer;\n}\n.awg-search-results .awg-search-result-table tbody tr:hover {\n    background-color: #e7e7e7;\n}\n.awg-search-results .awg-search-result-table tbody tr.active td {\n    background-color: #d7d7d7;\n}\n"},8412:a=>{a.exports=""}}]);